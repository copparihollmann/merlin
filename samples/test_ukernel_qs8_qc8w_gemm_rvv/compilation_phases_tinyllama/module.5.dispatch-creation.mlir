#executable_target_embedded_elf_x86_64 = #hal.executable.target<"llvm-cpu", "embedded-elf-x86_64", {cpu = "znver3", cpu_features = "+prfchw,-cldemote,+avx,+aes,+sahf,+pclmul,-xop,+crc32,-amx-fp8,+xsaves,-avx512fp16,-usermsr,-sm4,-egpr,+sse4.1,-avx512ifma,+xsave,+sse4.2,-tsxldtrk,-sm3,-ptwrite,-widekl,-movrs,+invpcid,+64bit,+xsavec,-avx10.1-512,-avx512vpopcntdq,+cmov,-avx512vp2intersect,-avx512cd,+movbe,-avxvnniint8,-ccmp,-amx-int8,-kl,-avx10.1-256,-sha512,-avxvnni,-rtm,+adx,+avx2,-hreset,-movdiri,-serialize,+vpclmulqdq,-avx512vl,-uintr,-cf,+clflushopt,-raoint,-cmpccxadd,+bmi,-amx-tile,+sse,-avx10.2-256,-gfni,-avxvnniint16,-amx-fp16,-zu,-ndd,+xsaveopt,+rdrnd,-avx512f,-amx-bf16,-avx512bf16,-avx512vnni,-push2pop2,+cx8,-avx512bw,+sse3,+pku,-nf,-amx-tf32,-amx-avx512,+fsgsbase,+clzero,+mwaitx,-lwp,+lzcnt,+sha,-movdir64b,-ppx,+wbnoinvd,-enqcmd,-amx-transpose,-avx10.2-512,-avxneconvert,-tbm,-pconfig,-amx-complex,+ssse3,+cx16,+bmi2,+fma,+popcnt,-avxifma,+f16c,-avx512bitalg,+rdpru,+clwb,+mmx,+sse2,+rdseed,-avx512vbmi2,-prefetchi,-amx-movrs,+rdpid,-fma4,-avx512vbmi,+shstk,+vaes,-waitpkg,-sgx,+fxsr,-avx512dq,+sse4a", data_layout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128", iree.encoding.resolver = #iree_cpu.cpu_encoding_resolver<>, max_stack_allocation_size = 32768 : i64, native_vector_size = 32 : i64, target_triple = "x86_64-unknown-unknown-eabi-elf"}>
#map = affine_map<(d0, d1) -> (d0)>
#map1 = affine_map<(d0, d1) -> (d0, d1)>
#map2 = affine_map<(d0) -> (d0)>
#map3 = affine_map<(d0, d1) -> (d1)>
#map4 = affine_map<(d0, d1, d2) -> (d0, d1)>
#map5 = affine_map<(d0, d1, d2) -> (d0, d1, d2)>
#map6 = affine_map<(d0, d1, d2, d3) -> (d0, d2, d3)>
#map7 = affine_map<(d0, d1, d2, d3) -> (d1, d2, d3)>
#map8 = affine_map<(d0, d1, d2, d3) -> (d0, d1)>
#map9 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d4)>
#map10 = affine_map<(d0, d1, d2, d3, d4) -> (d1, d4)>
#map11 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d3, d4)>
#map12 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, d3)>
#map13 = affine_map<(d0, d1, d2, d3) -> (d0, d2, d1, d3)>
#map14 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d2, d1, d4)>
#map15 = affine_map<(d0, d1, d2, d3, d4) -> (d2, d4)>
#map16 = affine_map<(d0, d1, d2, d3, d4, d5, d6) -> (d0, d1, d2, d3, d5)>
#map17 = affine_map<(d0, d1, d2, d3, d4, d5, d6) -> (d0, d6, d1, d5)>
#map18 = affine_map<(d0, d1, d2, d3, d4, d5, d6) -> (d0, d6, d1, d4)>
#map19 = affine_map<(d0, d1, d2, d3, d4, d5, d6) -> ()>
#map20 = affine_map<(d0, d1, d2, d3, d4, d5, d6) -> (d0, d1, d2, d3, d6)>
#map21 = affine_map<(d0, d1, d2, d3, d4, d5, d6) -> (d0, d1, d2, d3, d4)>
#map22 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d3, d1, d2, d4)>
#map23 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d3)>
#map24 = affine_map<(d0, d1, d2, d3) -> (d0, d3)>
#map25 = affine_map<(d0, d1, d2, d3, d4, d5) -> (d0, d3, d1, d4, d5)>
#map26 = affine_map<(d0, d1, d2, d3, d4, d5) -> (d0, d1, d2, d3, d4, d5)>
#map27 = affine_map<(d0, d1, d2, d3, d4, d5) -> (d0, d4, d1, d5, d3)>
#map28 = affine_map<(d0, d1, d2, d3) -> (d0, d2)>
#map29 = affine_map<(d0, d1, d2, d3) -> (d0, d3, d2)>
#map30 = affine_map<(d0, d1, d2, d3) -> ()>
#device_target_local = #hal.device.target<"local", [#executable_target_embedded_elf_x86_64]> : !hal.device
module @module attributes {stream.affinity.default = #hal.device.affinity<@__device_0>} {
  util.global private @__device_0 = #device_target_local
  util.func public @prefill_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.fence, %arg5: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %c1024 = arith.constant 1024 : index
    %c32768 = arith.constant 32768 : index
    %c8192 = arith.constant 8192 : index
    %c4 = arith.constant 4 : index
    %c44 = arith.constant 44 : index
    %0 = flow.tensor.constant #flow.parameter.named<"model"::"output.weight"> : tensor<32000x2176xi8>
    %1 = flow.tensor.constant #flow.parameter.named<"model"::"output_norm.weight"> : tensor<2048xf32>
    %2 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_down.weight"> : tensor<2048x5984xi8>
    %3 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_up.weight"> : tensor<5632x2176xi8>
    %4 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_gate.weight"> : tensor<5632x2176xi8>
    %5 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_norm.weight"> : tensor<2048xf32>
    %6 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_output.weight"> : tensor<2048x2176xi8>
    %7 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_v.weight"> : tensor<256x2176xi8>
    %8 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_k.weight"> : tensor<256x2176xi8>
    %9 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_q.weight"> : tensor<2048x2176xi8>
    %10 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_norm.weight"> : tensor<2048xf32>
    %11 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_down.weight"> : tensor<2048x5984xi8>
    %12 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_up.weight"> : tensor<5632x2176xi8>
    %13 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_gate.weight"> : tensor<5632x2176xi8>
    %14 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_norm.weight"> : tensor<2048xf32>
    %15 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_output.weight"> : tensor<2048x2176xi8>
    %16 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_v.weight"> : tensor<256x2176xi8>
    %17 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_k.weight"> : tensor<256x2176xi8>
    %18 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_q.weight"> : tensor<2048x2176xi8>
    %19 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_norm.weight"> : tensor<2048xf32>
    %20 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_down.weight"> : tensor<2048x5984xi8>
    %21 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_up.weight"> : tensor<5632x2176xi8>
    %22 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_gate.weight"> : tensor<5632x2176xi8>
    %23 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_norm.weight"> : tensor<2048xf32>
    %24 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_output.weight"> : tensor<2048x2176xi8>
    %25 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_v.weight"> : tensor<256x2176xi8>
    %26 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_k.weight"> : tensor<256x2176xi8>
    %27 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_q.weight"> : tensor<2048x2176xi8>
    %28 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_norm.weight"> : tensor<2048xf32>
    %29 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_down.weight"> : tensor<2048x5984xi8>
    %30 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_up.weight"> : tensor<5632x2176xi8>
    %31 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_gate.weight"> : tensor<5632x2176xi8>
    %32 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_norm.weight"> : tensor<2048xf32>
    %33 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_output.weight"> : tensor<2048x2176xi8>
    %34 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_v.weight"> : tensor<256x2176xi8>
    %35 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_k.weight"> : tensor<256x2176xi8>
    %36 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_q.weight"> : tensor<2048x2176xi8>
    %37 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_norm.weight"> : tensor<2048xf32>
    %38 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_down.weight"> : tensor<2048x5984xi8>
    %39 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_up.weight"> : tensor<5632x2176xi8>
    %40 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_gate.weight"> : tensor<5632x2176xi8>
    %41 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_norm.weight"> : tensor<2048xf32>
    %42 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_output.weight"> : tensor<2048x2176xi8>
    %43 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_v.weight"> : tensor<256x2176xi8>
    %44 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_k.weight"> : tensor<256x2176xi8>
    %45 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_q.weight"> : tensor<2048x2176xi8>
    %46 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_norm.weight"> : tensor<2048xf32>
    %47 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_down.weight"> : tensor<2048x5984xi8>
    %48 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_up.weight"> : tensor<5632x2176xi8>
    %49 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_gate.weight"> : tensor<5632x2176xi8>
    %50 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_norm.weight"> : tensor<2048xf32>
    %51 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_output.weight"> : tensor<2048x2176xi8>
    %52 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_v.weight"> : tensor<256x2176xi8>
    %53 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_k.weight"> : tensor<256x2176xi8>
    %54 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_q.weight"> : tensor<2048x2176xi8>
    %55 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_norm.weight"> : tensor<2048xf32>
    %56 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_down.weight"> : tensor<2048x5984xi8>
    %57 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_up.weight"> : tensor<5632x2176xi8>
    %58 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_gate.weight"> : tensor<5632x2176xi8>
    %59 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_norm.weight"> : tensor<2048xf32>
    %60 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_output.weight"> : tensor<2048x2176xi8>
    %61 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_v.weight"> : tensor<256x2176xi8>
    %62 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_k.weight"> : tensor<256x2176xi8>
    %63 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_q.weight"> : tensor<2048x2176xi8>
    %64 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_norm.weight"> : tensor<2048xf32>
    %65 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_down.weight"> : tensor<2048x5984xi8>
    %66 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_up.weight"> : tensor<5632x2176xi8>
    %67 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_gate.weight"> : tensor<5632x2176xi8>
    %68 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_norm.weight"> : tensor<2048xf32>
    %69 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_output.weight"> : tensor<2048x2176xi8>
    %70 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_v.weight"> : tensor<256x2176xi8>
    %71 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_k.weight"> : tensor<256x2176xi8>
    %72 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_q.weight"> : tensor<2048x2176xi8>
    %73 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_norm.weight"> : tensor<2048xf32>
    %74 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_down.weight"> : tensor<2048x5984xi8>
    %75 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_up.weight"> : tensor<5632x2176xi8>
    %76 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_gate.weight"> : tensor<5632x2176xi8>
    %77 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_norm.weight"> : tensor<2048xf32>
    %78 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_output.weight"> : tensor<2048x2176xi8>
    %79 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_v.weight"> : tensor<256x2176xi8>
    %80 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_k.weight"> : tensor<256x2176xi8>
    %81 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_q.weight"> : tensor<2048x2176xi8>
    %82 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_norm.weight"> : tensor<2048xf32>
    %83 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_down.weight"> : tensor<2048x5984xi8>
    %84 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_up.weight"> : tensor<5632x2176xi8>
    %85 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_gate.weight"> : tensor<5632x2176xi8>
    %86 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_norm.weight"> : tensor<2048xf32>
    %87 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_output.weight"> : tensor<2048x2176xi8>
    %88 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_v.weight"> : tensor<256x2176xi8>
    %89 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_k.weight"> : tensor<256x2176xi8>
    %90 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_q.weight"> : tensor<2048x2176xi8>
    %91 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_norm.weight"> : tensor<2048xf32>
    %92 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_down.weight"> : tensor<2048x5984xi8>
    %93 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_up.weight"> : tensor<5632x2176xi8>
    %94 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_gate.weight"> : tensor<5632x2176xi8>
    %95 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_norm.weight"> : tensor<2048xf32>
    %96 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_output.weight"> : tensor<2048x2176xi8>
    %97 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_v.weight"> : tensor<256x2176xi8>
    %98 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_k.weight"> : tensor<256x2176xi8>
    %99 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_q.weight"> : tensor<2048x2176xi8>
    %100 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_norm.weight"> : tensor<2048xf32>
    %101 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_down.weight"> : tensor<2048x5984xi8>
    %102 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_up.weight"> : tensor<5632x2176xi8>
    %103 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_gate.weight"> : tensor<5632x2176xi8>
    %104 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_norm.weight"> : tensor<2048xf32>
    %105 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_output.weight"> : tensor<2048x2176xi8>
    %106 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_v.weight"> : tensor<256x2176xi8>
    %107 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_k.weight"> : tensor<256x2176xi8>
    %108 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_q.weight"> : tensor<2048x2176xi8>
    %109 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_norm.weight"> : tensor<2048xf32>
    %110 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_down.weight"> : tensor<2048x5984xi8>
    %111 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_up.weight"> : tensor<5632x2176xi8>
    %112 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_gate.weight"> : tensor<5632x2176xi8>
    %113 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_norm.weight"> : tensor<2048xf32>
    %114 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_output.weight"> : tensor<2048x2176xi8>
    %115 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_v.weight"> : tensor<256x2176xi8>
    %116 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_k.weight"> : tensor<256x2176xi8>
    %117 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_q.weight"> : tensor<2048x2176xi8>
    %118 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_norm.weight"> : tensor<2048xf32>
    %119 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_down.weight"> : tensor<2048x5984xi8>
    %120 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_up.weight"> : tensor<5632x2176xi8>
    %121 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_gate.weight"> : tensor<5632x2176xi8>
    %122 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_norm.weight"> : tensor<2048xf32>
    %123 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_output.weight"> : tensor<2048x2176xi8>
    %124 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_v.weight"> : tensor<256x2176xi8>
    %125 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_k.weight"> : tensor<256x2176xi8>
    %126 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_q.weight"> : tensor<2048x2176xi8>
    %127 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_norm.weight"> : tensor<2048xf32>
    %128 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_down.weight"> : tensor<2048x5984xi8>
    %129 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_up.weight"> : tensor<5632x2176xi8>
    %130 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_gate.weight"> : tensor<5632x2176xi8>
    %131 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_norm.weight"> : tensor<2048xf32>
    %132 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_output.weight"> : tensor<2048x2176xi8>
    %133 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_v.weight"> : tensor<256x2176xi8>
    %134 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_k.weight"> : tensor<256x2176xi8>
    %135 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_q.weight"> : tensor<2048x2176xi8>
    %136 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_norm.weight"> : tensor<2048xf32>
    %137 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_down.weight"> : tensor<2048x5984xi8>
    %138 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_up.weight"> : tensor<5632x2176xi8>
    %139 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_gate.weight"> : tensor<5632x2176xi8>
    %140 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_norm.weight"> : tensor<2048xf32>
    %141 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_output.weight"> : tensor<2048x2176xi8>
    %142 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_v.weight"> : tensor<256x2176xi8>
    %143 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_k.weight"> : tensor<256x2176xi8>
    %144 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_q.weight"> : tensor<2048x2176xi8>
    %145 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_norm.weight"> : tensor<2048xf32>
    %146 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_down.weight"> : tensor<2048x5984xi8>
    %147 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_up.weight"> : tensor<5632x2176xi8>
    %148 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_gate.weight"> : tensor<5632x2176xi8>
    %149 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_norm.weight"> : tensor<2048xf32>
    %150 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_output.weight"> : tensor<2048x2176xi8>
    %151 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_v.weight"> : tensor<256x2176xi8>
    %152 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_k.weight"> : tensor<256x2176xi8>
    %153 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_q.weight"> : tensor<2048x2176xi8>
    %154 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_norm.weight"> : tensor<2048xf32>
    %155 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_down.weight"> : tensor<2048x5984xi8>
    %156 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_up.weight"> : tensor<5632x2176xi8>
    %157 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_gate.weight"> : tensor<5632x2176xi8>
    %158 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_norm.weight"> : tensor<2048xf32>
    %159 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_output.weight"> : tensor<2048x2176xi8>
    %160 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_v.weight"> : tensor<256x2176xi8>
    %161 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_k.weight"> : tensor<256x2176xi8>
    %162 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_q.weight"> : tensor<2048x2176xi8>
    %163 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_norm.weight"> : tensor<2048xf32>
    %164 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_down.weight"> : tensor<2048x5984xi8>
    %165 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_up.weight"> : tensor<5632x2176xi8>
    %166 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_gate.weight"> : tensor<5632x2176xi8>
    %167 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_norm.weight"> : tensor<2048xf32>
    %168 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_output.weight"> : tensor<2048x2176xi8>
    %169 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_v.weight"> : tensor<256x2176xi8>
    %170 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_k.weight"> : tensor<256x2176xi8>
    %171 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_q.weight"> : tensor<2048x2176xi8>
    %172 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_norm.weight"> : tensor<2048xf32>
    %173 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_down.weight"> : tensor<2048x5984xi8>
    %174 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_up.weight"> : tensor<5632x2176xi8>
    %175 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_gate.weight"> : tensor<5632x2176xi8>
    %176 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_norm.weight"> : tensor<2048xf32>
    %177 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_output.weight"> : tensor<2048x2176xi8>
    %178 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_v.weight"> : tensor<256x2176xi8>
    %179 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_k.weight"> : tensor<256x2176xi8>
    %180 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_q.weight"> : tensor<2048x2176xi8>
    %181 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_norm.weight"> : tensor<2048xf32>
    %182 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_down.weight"> : tensor<2048x5984xi8>
    %183 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_up.weight"> : tensor<5632x2176xi8>
    %184 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_gate.weight"> : tensor<5632x2176xi8>
    %185 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_norm.weight"> : tensor<2048xf32>
    %186 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_output.weight"> : tensor<2048x2176xi8>
    %187 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_v.weight"> : tensor<256x2176xi8>
    %188 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_k.weight"> : tensor<256x2176xi8>
    %189 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_q.weight"> : tensor<2048x2176xi8>
    %190 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_norm.weight"> : tensor<2048xf32>
    %191 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_down.weight"> : tensor<2048x5984xi8>
    %192 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_up.weight"> : tensor<5632x2176xi8>
    %193 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_gate.weight"> : tensor<5632x2176xi8>
    %194 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_norm.weight"> : tensor<2048xf32>
    %195 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_output.weight"> : tensor<2048x2176xi8>
    %196 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_v.weight"> : tensor<256x2176xi8>
    %197 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_k.weight"> : tensor<256x2176xi8>
    %198 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_q.weight"> : tensor<2048x2176xi8>
    %199 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_norm.weight"> : tensor<2048xf32>
    %200 = flow.tensor.constant #flow.parameter.named<"model"::"token_embd.weight"> : tensor<32000x2176xi8>
    %c8 = arith.constant 8 : index
    %c32 = arith.constant 32 : index
    %c1 = arith.constant 1 : index
    %201 = hal.buffer_view.dim<%arg0 : !hal.buffer_view>[1] : index
    %202 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg0 : !hal.buffer_view -> tensor<4x?xi64>{%201}
    %203 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %204 = hal.buffer_view.dim<%arg2 : !hal.buffer_view>[1] : index
    %205 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg2 : !hal.buffer_view -> tensor<4x?xi64>{%204}
    %206 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[0] : index
    %207 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg3 : !hal.buffer_view -> tensor<?x360448xf16>{%206}
    %208 = arith.muli %204, %c32 : index
    %209 = util.assume.int %208<umin = 32, umax = 2016, udiv = 32> : index
    %210 = flow.tensor.tie_shape %202 : tensor<4x?xi64>{%209}
    %211 = util.assume.int %204<umin = 1, umax = 63> : index
    %212 = flow.tensor.tie_shape %205 : tensor<4x?xi64>{%211}
    %213 = util.assume.int %206<umin = 1, umax = 9007199254740991> : index
    %214 = flow.tensor.tie_shape %207 : tensor<?x360448xf16>{%213}
    %215 = flow.tensor.bitcast %200 : tensor<32000x2176xi8> -> tensor<32000x64x17xi16>
    %216 = flow.tensor.bitcast %200 : tensor<32000x2176xi8> -> tensor<32000x64x1x17xi16>
    %217 = flow.dispatch.workgroups(%216) : (tensor<32000x64x1x17xi16>) -> tensor<32000x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [32000, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>> -> tensor<32000x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [32000, 64, 1], strides = [1, 1, 1] : tensor<32000x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %218 = flow.dispatch.workgroups(%215) : (tensor<32000x64x17xi16>) -> tensor<32000x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [32000, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>> -> tensor<32000x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [32000, 64, 16], strides = [1, 1, 1] : tensor<32000x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %219 = flow.tensor.bitcast %217 : tensor<32000x64x1xi16> -> tensor<2048000xf16>
    %220 = flow.tensor.bitcast %218 : tensor<32000x64x16xi16> -> tensor<2048000x32xi8>
    %221 = flow.dispatch.workgroups(%219, %220) : (tensor<2048000xf16>, tensor<2048000x32xi8>) -> tensor<2048000x32xf16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000x32xi8>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048000x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0], sizes = [2048000], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000xf16>> -> tensor<2048000xf16>
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048000, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000x32xi8>> -> tensor<2048000x32xi8>
      %2235 = tensor.empty() : tensor<2048000x32xf16>
      %2236 = linalg.generic {indexing_maps = [#map, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2233, %2234 : tensor<2048000xf16>, tensor<2048000x32xi8>) outs(%2235 : tensor<2048000x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2237 = arith.sitofp %in_0 : i8 to f16
        %2238 = arith.mulf %in, %2237 : f16
        linalg.yield %2238 : f16
      } -> tensor<2048000x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0], sizes = [2048000, 32], strides = [1, 1] : tensor<2048000x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048000x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %222 = flow.tensor.reshape %221 : tensor<2048000x32xf16> -> tensor<32000x2048xf16>
    %223 = arith.muli %209, %c4 overflow<nsw> : index
    %224 = flow.tensor.reshape %210 : tensor<4x?xi64>{%209} -> tensor<?xi64>{%223}
    %225 = flow.dispatch.workgroups[%223](%223, %222, %224) : (index, tensor<32000x2048xf16>, tensor<?xi64>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %c0_i64 = arith.constant 0 : i64
      %c32000 = arith.constant 32000 : index
      %c32_0 = arith.constant 32 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [32000, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x2048xf16>> -> tensor<32000x2048xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2235 : tensor<?xi64>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: i64, %out: f16):
        %2238 = linalg.index 1 : index
        %2239 = arith.remsi %2238, %c32_0 : index
        %2240 = arith.divsi %2238, %c32_0 : index
        %2241 = arith.index_cast %in : i64 to index
        %2242 = arith.muli %2240, %c32_0 overflow<nsw> : index
        %2243 = arith.addi %2239, %2242 : index
        %2244 = arith.cmpi slt, %2241, %c32000 : index
        cf.assert %2244, "index must be smaller than dim size"
        %2245 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2245, "index must be larger or equal to 0"
        %extracted = tensor.extract %2234[%2241, %2243] : tensor<32000x2048xf16>
        linalg.yield %extracted : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %226 = arith.muli %209, %c8192 overflow<nsw> : index
    %227 = flow.tensor.reshape %225 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %228 = flow.dispatch.workgroups[%226](%226, %227) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %229 = flow.dispatch.workgroups[%223](%223, %225) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %230 = flow.tensor.reshape %228 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %231 = flow.dispatch.workgroups[%223](%223, %230, %229) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %232 = flow.dispatch.workgroups[%223](%223, %199, %231) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %233 = flow.tensor.bitcast %198 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %234 = flow.tensor.bitcast %198 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %235 = flow.dispatch.workgroups(%234) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %236 = flow.dispatch.workgroups(%233) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %237 = flow.tensor.bitcast %236 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %238 = flow.tensor.bitcast %235 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %239 = flow.tensor.reshape %232 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %240 = flow.dispatch.workgroups[%223](%238, %237, %223, %239) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %241 = flow.tensor.reshape %240 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %242 = flow.tensor.bitcast %197 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %243 = flow.tensor.bitcast %197 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %244 = flow.dispatch.workgroups(%243) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %245 = flow.dispatch.workgroups(%242) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %246 = flow.tensor.bitcast %245 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %247 = flow.tensor.bitcast %244 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %248 = flow.dispatch.workgroups[%223](%247, %246, %223, %239) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %249 = flow.tensor.reshape %248 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %250 = flow.tensor.bitcast %196 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %251 = flow.tensor.bitcast %196 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %252 = flow.dispatch.workgroups(%251) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %253 = flow.dispatch.workgroups(%250) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %254 = flow.tensor.bitcast %253 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %255 = flow.tensor.bitcast %252 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %256 = flow.dispatch.workgroups[%223](%255, %254, %223, %239) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %257 = arith.divui %209, %c32 : index
    %258 = arith.subi %209, %c1 : index
    %259 = arith.divui %258, %c8 : index
    %260 = arith.addi %259, %c1 : index
    %261 = flow.dispatch.workgroups[%209, %260](%209, %260) : (index, index) -> tensor<1x?x1x8x1xf32>{%260} =
        (%arg6: index, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<1x?x1x8x1xf32>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 1 : index
      %2235 = tensor.empty(%2234) : tensor<1x?x1x8x1xf32>
      %2236 = tensor.empty(%2233) : tensor<1x1x?xf32>
      %2237 = linalg.generic {indexing_maps = [#map5], iterator_types = ["parallel", "parallel", "parallel"]} outs(%2236 : tensor<1x1x?xf32>) {
      ^bb0(%out: f32):
        %2238 = linalg.index 2 : index
        %2239 = arith.index_cast %2238 : index to i64
        %2240 = arith.sitofp %2239 : i64 to f32
        linalg.yield %2240 : f32
      } -> tensor<1x1x?xf32>
      %pack = linalg.pack %2237 padding_value(%cst : f32) outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [8, 1] into %2235 : tensor<1x1x?xf32> -> tensor<1x?x1x8x1xf32>
      iree_tensor_ext.dispatch.tensor.store %pack, %arg8, offsets = [0, 0, 0, 0, 0], sizes = [1, %2234, 1, 8, 1], strides = [1, 1, 1, 1, 1] : tensor<1x?x1x8x1xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<1x?x1x8x1xf32>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %262 = flow.dispatch.workgroups[%260](%261, %260) : (tensor<1x?x1x8x1xf32>{%260}, index) -> tensor<1x4x?x8x8xf32>{%260} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<1x?x1x8x1xf32>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<1x4x?x8x8xf32>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %cst_0 = arith.constant dense<[[[[[1.000000e+00], [0.749894261], [0.562341332], [0.421696514], [0.316227764], [0.237137362], [0.177827939], [0.133352146]]], [[[1.000000e-01], [0.0749894157], [0.056234125], [0.0421696492], [0.0316227749], [0.023713734], [0.0177827943], [0.0133352149]]], [[[0.00999999884], [0.00749894138], [0.00562341232], [0.00421696389], [0.00316227647], [0.00237137382], [0.00177827943], [0.00133352145]]], [[[9.99999931E-4], [7.49894068E-4], [5.62341185E-4], [4.21696401E-4], [3.16227786E-4], [2.37137268E-4], [1.7782794E-4], [1.33352063E-4]]]]]> : tensor<1x4x1x8x1xf32>
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0], sizes = [1, %2233, 1, 8, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<1x?x1x8x1xf32>>{%2233} -> tensor<1x?x1x8x1xf32>
      %2235 = tensor.empty(%2233) : tensor<1x4x?x8x8xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
      %2237 = linalg.batch_mmt4d ins(%cst_0, %2234 : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%2236 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg8, offsets = [0, 0, 0, 0, 0], sizes = [1, 4, %2233, 8, 8], strides = [1, 1, 1, 1, 1] : tensor<1x4x?x8x8xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<1x4x?x8x8xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %263 = flow.dispatch.workgroups[%260, %209](%262, %260, %209) : (tensor<1x4x?x8x8xf32>{%260}, index, index) -> tensor<?x1x32xf32>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<1x4x?x8x8xf32>>, %arg7: index, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x1x32xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0], sizes = [1, 4, %2233, 8, 8], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<1x4x?x8x8xf32>>{%2233} -> tensor<1x4x?x8x8xf32>
      %2236 = tensor.empty(%2234) : tensor<?x1x32xf32>
      %unpack = linalg.unpack %2235 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %2236 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
      iree_tensor_ext.dispatch.tensor.store %unpack, %arg9, offsets = [0, 0, 0], sizes = [%2234, 1, 32], strides = [1, 1, 1] : tensor<?x1x32xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x1x32xf32>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %264 = arith.divsi %209, %c32 : index
    %265 = arith.muli %264, %c32 overflow<nsw> : index
    %266 = arith.muli %209, %c32 overflow<nsw> : index
    %267 = flow.tensor.reshape %263 : tensor<?x1x32xf32>{%209} -> tensor<?xf32>{%266}
    %268 = arith.muli %264, %c1024 overflow<nsw> : index
    %269 = flow.dispatch.workgroups[%268, %266](%268, %267, %266) : (index, tensor<?xf32>{%266}, index) -> tensor<?xf16>{%268} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2234], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2234} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?xf16>
      %2237 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2235 : tensor<?xf32>) outs(%2236 : tensor<?xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2238 = math.cos %in : f32
        %2239 = arith.truncf %2238 : f32 to f16
        linalg.yield %2239 : f16
      } -> tensor<?xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %270 = flow.dispatch.workgroups[%268, %266](%268, %267, %266) : (index, tensor<?xf32>{%266}, index) -> tensor<?xf16>{%268} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2234], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2234} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?xf16>
      %2237 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2235 : tensor<?xf32>) outs(%2236 : tensor<?xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2238 = math.sin %in : f32
        %2239 = arith.truncf %2238 : f32 to f16
        linalg.yield %2239 : f16
      } -> tensor<?xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %271 = flow.dispatch.workgroups[%209](%241, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %272 = flow.dispatch.workgroups[%209](%241, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %273 = flow.dispatch.workgroups[%209](%249, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %274 = flow.dispatch.workgroups[%209](%249, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %275 = arith.muli %264, %c32 : index
    %276 = flow.tensor.reshape %269 : tensor<?xf16>{%268} -> tensor<?x32xf16>{%265}
    %277 = flow.tensor.reshape %270 : tensor<?xf16>{%268} -> tensor<?x32xf16>{%265}
    %278 = flow.dispatch.workgroups[%275, %265](%273, %276, %274, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %279 = arith.muli %211, %c4 overflow<nsw> : index
    %280 = flow.tensor.reshape %212 : tensor<4x?xi64>{%211} -> tensor<?xi64>{%279}
    %281:2 = flow.dispatch.workgroups[%279](%279, %280) : (index, tensor<?xi64>{%279}) -> (tensor<?xi64>{%279}, tensor<?xi64>{%279}) =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c44_i64 = arith.constant 44 : i64
      %c22_i64 = arith.constant 22 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236:2 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235, %2235 : tensor<?xi64>, tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64, %out_0: i64):
        %2237 = arith.muli %in, %c22_i64 : i64
        %2238 = arith.muli %in, %c44_i64 : i64
        linalg.yield %2237, %2238 : i64, i64
      } -> (tensor<?xi64>, tensor<?xi64>)
      iree_tensor_ext.dispatch.tensor.store %2236#0, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      iree_tensor_ext.dispatch.tensor.store %2236#1, %arg9, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %282 = flow.tensor.reshape %281#1 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %283 = arith.muli %264, %c4 overflow<nsw> : index
    %284 = flow.tensor.reshape %278 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %285 = flow.dispatch.workgroups[%283](%283, %284) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %286 = flow.tensor.reshape %285 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %287 = arith.muli %213, %c44 overflow<nsw> : index
    %288 = flow.tensor.reshape %214 : tensor<?x360448xf16>{%213} -> tensor<?x4x32x2x1x32xf16>{%287}
    %289 = flow.dispatch.workgroups[%264, %211, %287](%286, %282, %288, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %288{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %290 = flow.dispatch.workgroups[%279](%279, %281#1) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %291 = flow.tensor.reshape %290 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %292 = arith.muli %257, %c4 overflow<nsw> : index
    %293 = flow.tensor.reshape %256 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %294 = flow.dispatch.workgroups[%292](%292, %293) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %295 = flow.tensor.reshape %294 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %296 = flow.dispatch.workgroups[%257, %211, %287](%295, %291, %289, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %289{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %297 = flow.dispatch.workgroups[%275, %265](%271, %276, %272, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %298 = arith.muli %264, %264 overflow<nsw> : index
    %299 = arith.muli %298, %c32768 overflow<nsw> : index
    %300 = flow.dispatch.workgroups[%299, %264](%299, %264, %203) : (index, index, tensor<4xi64>) -> tensor<4x?xf16>{%299} =
        (%arg6: index, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?xf16>>) {
      %cst = arith.constant 0xFC00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f16
      %c32_1 = arith.constant 32 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2236 = tensor.empty(%2233) : tensor<4x?xf16>
      %2237 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2235 : tensor<4xi64>) outs(%2236 : tensor<4x?xf16>) {
      ^bb0(%in: i64, %out: f16):
        %2238 = linalg.index 1 : index
        %2239 = arith.remsi %2238, %c32_1 : index
        %2240 = arith.divsi %2238, %c32_1 : index
        %2241 = arith.remsi %2240, %2234 : index
        %2242 = arith.divsi %2240, %2234 : index
        %2243 = arith.remsi %2242, %c32_1 : index
        %2244 = arith.divsi %2242, %c32_1 : index
        %2245 = arith.remsi %2244, %2234 : index
        %2246 = arith.muli %2241, %c32_1 overflow<nsw> : index
        %2247 = arith.addi %2239, %2246 : index
        %2248 = arith.index_cast %2247 : index to i64
        %2249 = arith.cmpi sge, %2248, %in : i64
        %2250 = arith.muli %2245, %c32_1 overflow<nsw> : index
        %2251 = arith.addi %2243, %2250 : index
        %2252 = arith.index_cast %2251 : index to i64
        %2253 = arith.cmpi sgt, %2248, %2252 : i64
        %2254 = arith.ori %2253, %2249 : i1
        %2255 = arith.select %2254, %cst, %cst_0 : f16
        linalg.yield %2255 : f16
      } -> tensor<4x?xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [4, %2233], strides = [1, 1] : tensor<4x?xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %301 = flow.tensor.reshape %297 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %302 = flow.tensor.reshape %278 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %303 = flow.tensor.reshape %256 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %304 = flow.tensor.reshape %300 : tensor<4x?xf16>{%299} -> tensor<4x4x8x?x?xf16>{%265, %265}
    %305 = flow.dispatch.workgroups[%265, %209](%265, %301, %302, %303, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %306 = flow.tensor.bitcast %195 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %307 = flow.tensor.bitcast %195 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %308 = flow.dispatch.workgroups(%307) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %309 = flow.dispatch.workgroups(%306) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %310 = flow.tensor.bitcast %309 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %311 = flow.tensor.bitcast %308 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %312 = flow.tensor.reshape %305 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %313 = flow.dispatch.workgroups[%223](%311, %310, %223, %312, %225) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %314 = flow.tensor.reshape %313 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %315 = flow.dispatch.workgroups[%226](%226, %314) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %316 = flow.dispatch.workgroups[%223](%223, %313) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %317 = flow.tensor.reshape %315 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %318 = flow.dispatch.workgroups[%223](%223, %317, %316) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %319 = flow.dispatch.workgroups[%223](%223, %194, %318) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %320 = flow.tensor.bitcast %193 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %321 = flow.tensor.bitcast %193 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %322 = flow.dispatch.workgroups(%321) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %323 = flow.dispatch.workgroups(%320) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %324 = flow.tensor.bitcast %323 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %325 = flow.tensor.bitcast %322 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %326 = flow.tensor.bitcast %192 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %327 = flow.dispatch.workgroups(%326) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %328 = flow.tensor.bitcast %327 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %329 = flow.tensor.bitcast %192 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %330 = flow.dispatch.workgroups(%329) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %331 = flow.tensor.bitcast %330 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %332 = flow.tensor.reshape %319 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %333 = flow.dispatch.workgroups[%223](%328, %331, %223, %332) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %334 = flow.dispatch.workgroups[%223](%325, %324, %223, %332, %333) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %335 = flow.tensor.bitcast %191 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %336 = flow.tensor.bitcast %191 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %337 = flow.dispatch.workgroups(%336) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %338 = flow.dispatch.workgroups(%335) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %339 = flow.tensor.bitcast %338 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %340 = flow.tensor.bitcast %337 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %341 = flow.tensor.reshape %334 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %342 = flow.dispatch.workgroups[%223](%340, %339, %223, %341, %313) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %343 = flow.tensor.reshape %342 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %344 = flow.dispatch.workgroups[%226](%226, %343) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %345 = flow.dispatch.workgroups[%223](%223, %342) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %346 = flow.tensor.reshape %344 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %347 = flow.dispatch.workgroups[%223](%223, %346, %345) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %348 = flow.dispatch.workgroups[%223](%223, %190, %347) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %349 = flow.tensor.bitcast %189 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %350 = flow.tensor.bitcast %189 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %351 = flow.dispatch.workgroups(%350) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %352 = flow.dispatch.workgroups(%349) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %353 = flow.tensor.bitcast %352 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %354 = flow.tensor.bitcast %351 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %355 = flow.tensor.reshape %348 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %356 = flow.dispatch.workgroups[%223](%354, %353, %223, %355) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %357 = flow.tensor.reshape %356 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %358 = flow.tensor.bitcast %188 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %359 = flow.tensor.bitcast %188 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %360 = flow.dispatch.workgroups(%359) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %361 = flow.dispatch.workgroups(%358) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %362 = flow.tensor.bitcast %361 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %363 = flow.tensor.bitcast %360 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %364 = flow.dispatch.workgroups[%223](%363, %362, %223, %355) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %365 = flow.tensor.reshape %364 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %366 = flow.tensor.bitcast %187 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %367 = flow.tensor.bitcast %187 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %368 = flow.dispatch.workgroups(%367) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %369 = flow.dispatch.workgroups(%366) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %370 = flow.tensor.bitcast %369 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %371 = flow.tensor.bitcast %368 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %372 = flow.dispatch.workgroups[%223](%371, %370, %223, %355) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %373 = flow.dispatch.workgroups[%209](%357, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %374 = flow.dispatch.workgroups[%209](%357, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %375 = flow.dispatch.workgroups[%209](%365, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %376 = flow.dispatch.workgroups[%209](%365, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %377 = flow.dispatch.workgroups[%275, %265](%375, %276, %376, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %378 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %379 = flow.tensor.reshape %378 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %380 = flow.tensor.reshape %377 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %381 = flow.dispatch.workgroups[%283](%283, %380) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %382 = flow.tensor.reshape %381 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %383 = flow.dispatch.workgroups[%264, %211, %287](%382, %379, %296, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %296{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %384 = flow.dispatch.workgroups[%279](%279, %378) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %385 = flow.tensor.reshape %384 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %386 = flow.tensor.reshape %372 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %387 = flow.dispatch.workgroups[%292](%292, %386) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %388 = flow.tensor.reshape %387 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %389 = flow.dispatch.workgroups[%257, %211, %287](%388, %385, %383, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %383{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %390 = flow.dispatch.workgroups[%275, %265](%373, %276, %374, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %391 = flow.tensor.reshape %390 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %392 = flow.tensor.reshape %377 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %393 = flow.tensor.reshape %372 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %394 = flow.dispatch.workgroups[%265, %209](%265, %391, %392, %393, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %395 = flow.tensor.bitcast %186 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %396 = flow.tensor.bitcast %186 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %397 = flow.dispatch.workgroups(%396) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %398 = flow.dispatch.workgroups(%395) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %399 = flow.tensor.bitcast %398 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %400 = flow.tensor.bitcast %397 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %401 = flow.tensor.reshape %394 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %402 = flow.dispatch.workgroups[%223](%400, %399, %223, %401, %342) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %403 = flow.tensor.reshape %402 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %404 = flow.dispatch.workgroups[%226](%226, %403) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %405 = flow.dispatch.workgroups[%223](%223, %402) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %406 = flow.tensor.reshape %404 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %407 = flow.dispatch.workgroups[%223](%223, %406, %405) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %408 = flow.dispatch.workgroups[%223](%223, %185, %407) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %409 = flow.tensor.bitcast %184 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %410 = flow.tensor.bitcast %184 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %411 = flow.dispatch.workgroups(%410) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %412 = flow.dispatch.workgroups(%409) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %413 = flow.tensor.bitcast %412 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %414 = flow.tensor.bitcast %411 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %415 = flow.tensor.bitcast %183 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %416 = flow.dispatch.workgroups(%415) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %417 = flow.tensor.bitcast %416 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %418 = flow.tensor.bitcast %183 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %419 = flow.dispatch.workgroups(%418) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %420 = flow.tensor.bitcast %419 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %421 = flow.tensor.reshape %408 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %422 = flow.dispatch.workgroups[%223](%417, %420, %223, %421) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %423 = flow.dispatch.workgroups[%223](%414, %413, %223, %421, %422) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %424 = flow.tensor.bitcast %182 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %425 = flow.tensor.bitcast %182 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %426 = flow.dispatch.workgroups(%425) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %427 = flow.dispatch.workgroups(%424) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %428 = flow.tensor.bitcast %427 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %429 = flow.tensor.bitcast %426 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %430 = flow.tensor.reshape %423 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %431 = flow.dispatch.workgroups[%223](%429, %428, %223, %430, %402) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %432 = flow.tensor.reshape %431 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %433 = flow.dispatch.workgroups[%226](%226, %432) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %434 = flow.dispatch.workgroups[%223](%223, %431) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %435 = flow.tensor.reshape %433 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %436 = flow.dispatch.workgroups[%223](%223, %435, %434) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %437 = flow.dispatch.workgroups[%223](%223, %181, %436) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %438 = flow.tensor.bitcast %180 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %439 = flow.tensor.bitcast %180 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %440 = flow.dispatch.workgroups(%439) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %441 = flow.dispatch.workgroups(%438) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %442 = flow.tensor.bitcast %441 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %443 = flow.tensor.bitcast %440 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %444 = flow.tensor.reshape %437 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %445 = flow.dispatch.workgroups[%223](%443, %442, %223, %444) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %446 = flow.tensor.reshape %445 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %447 = flow.tensor.bitcast %179 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %448 = flow.tensor.bitcast %179 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %449 = flow.dispatch.workgroups(%448) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %450 = flow.dispatch.workgroups(%447) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %451 = flow.tensor.bitcast %450 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %452 = flow.tensor.bitcast %449 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %453 = flow.dispatch.workgroups[%223](%452, %451, %223, %444) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %454 = flow.tensor.reshape %453 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %455 = flow.tensor.bitcast %178 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %456 = flow.tensor.bitcast %178 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %457 = flow.dispatch.workgroups(%456) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %458 = flow.dispatch.workgroups(%455) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %459 = flow.tensor.bitcast %458 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %460 = flow.tensor.bitcast %457 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %461 = flow.dispatch.workgroups[%223](%460, %459, %223, %444) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %462 = flow.dispatch.workgroups[%209](%446, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %463 = flow.dispatch.workgroups[%209](%446, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %464 = flow.dispatch.workgroups[%209](%454, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %465 = flow.dispatch.workgroups[%209](%454, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %466 = flow.dispatch.workgroups[%275, %265](%464, %276, %465, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %467 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c2_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %468 = flow.tensor.reshape %467 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %469 = flow.tensor.reshape %466 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %470 = flow.dispatch.workgroups[%283](%283, %469) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %471 = flow.tensor.reshape %470 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %472 = flow.dispatch.workgroups[%264, %211, %287](%471, %468, %389, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %389{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %473 = flow.dispatch.workgroups[%279](%279, %467) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %474 = flow.tensor.reshape %473 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %475 = flow.tensor.reshape %461 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %476 = flow.dispatch.workgroups[%292](%292, %475) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %477 = flow.tensor.reshape %476 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %478 = flow.dispatch.workgroups[%257, %211, %287](%477, %474, %472, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %472{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %479 = flow.dispatch.workgroups[%275, %265](%462, %276, %463, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %480 = flow.tensor.reshape %479 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %481 = flow.tensor.reshape %466 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %482 = flow.tensor.reshape %461 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %483 = flow.dispatch.workgroups[%265, %209](%265, %480, %481, %482, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %484 = flow.tensor.bitcast %177 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %485 = flow.tensor.bitcast %177 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %486 = flow.dispatch.workgroups(%485) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %487 = flow.dispatch.workgroups(%484) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %488 = flow.tensor.bitcast %487 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %489 = flow.tensor.bitcast %486 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %490 = flow.tensor.reshape %483 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %491 = flow.dispatch.workgroups[%223](%489, %488, %223, %490, %431) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %492 = flow.tensor.reshape %491 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %493 = flow.dispatch.workgroups[%226](%226, %492) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %494 = flow.dispatch.workgroups[%223](%223, %491) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %495 = flow.tensor.reshape %493 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %496 = flow.dispatch.workgroups[%223](%223, %495, %494) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %497 = flow.dispatch.workgroups[%223](%223, %176, %496) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %498 = flow.tensor.bitcast %175 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %499 = flow.tensor.bitcast %175 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %500 = flow.dispatch.workgroups(%499) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %501 = flow.dispatch.workgroups(%498) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %502 = flow.tensor.bitcast %501 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %503 = flow.tensor.bitcast %500 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %504 = flow.tensor.bitcast %174 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %505 = flow.dispatch.workgroups(%504) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %506 = flow.tensor.bitcast %505 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %507 = flow.tensor.bitcast %174 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %508 = flow.dispatch.workgroups(%507) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %509 = flow.tensor.bitcast %508 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %510 = flow.tensor.reshape %497 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %511 = flow.dispatch.workgroups[%223](%506, %509, %223, %510) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %512 = flow.dispatch.workgroups[%223](%503, %502, %223, %510, %511) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %513 = flow.tensor.bitcast %173 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %514 = flow.tensor.bitcast %173 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %515 = flow.dispatch.workgroups(%514) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %516 = flow.dispatch.workgroups(%513) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %517 = flow.tensor.bitcast %516 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %518 = flow.tensor.bitcast %515 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %519 = flow.tensor.reshape %512 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %520 = flow.dispatch.workgroups[%223](%518, %517, %223, %519, %491) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %521 = flow.tensor.reshape %520 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %522 = flow.dispatch.workgroups[%226](%226, %521) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %523 = flow.dispatch.workgroups[%223](%223, %520) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %524 = flow.tensor.reshape %522 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %525 = flow.dispatch.workgroups[%223](%223, %524, %523) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %526 = flow.dispatch.workgroups[%223](%223, %172, %525) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %527 = flow.tensor.bitcast %171 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %528 = flow.tensor.bitcast %171 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %529 = flow.dispatch.workgroups(%528) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %530 = flow.dispatch.workgroups(%527) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %531 = flow.tensor.bitcast %530 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %532 = flow.tensor.bitcast %529 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %533 = flow.tensor.reshape %526 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %534 = flow.dispatch.workgroups[%223](%532, %531, %223, %533) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %535 = flow.tensor.reshape %534 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %536 = flow.tensor.bitcast %170 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %537 = flow.tensor.bitcast %170 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %538 = flow.dispatch.workgroups(%537) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %539 = flow.dispatch.workgroups(%536) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %540 = flow.tensor.bitcast %539 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %541 = flow.tensor.bitcast %538 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %542 = flow.dispatch.workgroups[%223](%541, %540, %223, %533) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %543 = flow.tensor.reshape %542 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %544 = flow.tensor.bitcast %169 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %545 = flow.tensor.bitcast %169 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %546 = flow.dispatch.workgroups(%545) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %547 = flow.dispatch.workgroups(%544) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %548 = flow.tensor.bitcast %547 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %549 = flow.tensor.bitcast %546 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %550 = flow.dispatch.workgroups[%223](%549, %548, %223, %533) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %551 = flow.dispatch.workgroups[%209](%535, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %552 = flow.dispatch.workgroups[%209](%535, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %553 = flow.dispatch.workgroups[%209](%543, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %554 = flow.dispatch.workgroups[%209](%543, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %555 = flow.dispatch.workgroups[%275, %265](%553, %276, %554, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %556 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c3_i64 = arith.constant 3 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c3_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %557 = flow.tensor.reshape %556 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %558 = flow.tensor.reshape %555 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %559 = flow.dispatch.workgroups[%283](%283, %558) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %560 = flow.tensor.reshape %559 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %561 = flow.dispatch.workgroups[%264, %211, %287](%560, %557, %478, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %478{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %562 = flow.dispatch.workgroups[%279](%279, %556) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %563 = flow.tensor.reshape %562 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %564 = flow.tensor.reshape %550 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %565 = flow.dispatch.workgroups[%292](%292, %564) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %566 = flow.tensor.reshape %565 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %567 = flow.dispatch.workgroups[%257, %211, %287](%566, %563, %561, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %561{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %568 = flow.dispatch.workgroups[%275, %265](%551, %276, %552, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %569 = flow.tensor.reshape %568 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %570 = flow.tensor.reshape %555 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %571 = flow.tensor.reshape %550 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %572 = flow.dispatch.workgroups[%265, %209](%265, %569, %570, %571, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %573 = flow.tensor.bitcast %168 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %574 = flow.tensor.bitcast %168 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %575 = flow.dispatch.workgroups(%574) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %576 = flow.dispatch.workgroups(%573) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %577 = flow.tensor.bitcast %576 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %578 = flow.tensor.bitcast %575 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %579 = flow.tensor.reshape %572 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %580 = flow.dispatch.workgroups[%223](%578, %577, %223, %579, %520) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %581 = flow.tensor.reshape %580 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %582 = flow.dispatch.workgroups[%226](%226, %581) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %583 = flow.dispatch.workgroups[%223](%223, %580) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %584 = flow.tensor.reshape %582 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %585 = flow.dispatch.workgroups[%223](%223, %584, %583) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %586 = flow.dispatch.workgroups[%223](%223, %167, %585) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %587 = flow.tensor.bitcast %166 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %588 = flow.tensor.bitcast %166 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %589 = flow.dispatch.workgroups(%588) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %590 = flow.dispatch.workgroups(%587) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %591 = flow.tensor.bitcast %590 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %592 = flow.tensor.bitcast %589 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %593 = flow.tensor.bitcast %165 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %594 = flow.dispatch.workgroups(%593) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %595 = flow.tensor.bitcast %594 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %596 = flow.tensor.bitcast %165 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %597 = flow.dispatch.workgroups(%596) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %598 = flow.tensor.bitcast %597 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %599 = flow.tensor.reshape %586 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %600 = flow.dispatch.workgroups[%223](%595, %598, %223, %599) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %601 = flow.dispatch.workgroups[%223](%592, %591, %223, %599, %600) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %602 = flow.tensor.bitcast %164 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %603 = flow.tensor.bitcast %164 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %604 = flow.dispatch.workgroups(%603) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %605 = flow.dispatch.workgroups(%602) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %606 = flow.tensor.bitcast %605 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %607 = flow.tensor.bitcast %604 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %608 = flow.tensor.reshape %601 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %609 = flow.dispatch.workgroups[%223](%607, %606, %223, %608, %580) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %610 = flow.tensor.reshape %609 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %611 = flow.dispatch.workgroups[%226](%226, %610) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %612 = flow.dispatch.workgroups[%223](%223, %609) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %613 = flow.tensor.reshape %611 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %614 = flow.dispatch.workgroups[%223](%223, %613, %612) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %615 = flow.dispatch.workgroups[%223](%223, %163, %614) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %616 = flow.tensor.bitcast %162 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %617 = flow.tensor.bitcast %162 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %618 = flow.dispatch.workgroups(%617) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %619 = flow.dispatch.workgroups(%616) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %620 = flow.tensor.bitcast %619 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %621 = flow.tensor.bitcast %618 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %622 = flow.tensor.reshape %615 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %623 = flow.dispatch.workgroups[%223](%621, %620, %223, %622) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %624 = flow.tensor.reshape %623 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %625 = flow.tensor.bitcast %161 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %626 = flow.tensor.bitcast %161 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %627 = flow.dispatch.workgroups(%626) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %628 = flow.dispatch.workgroups(%625) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %629 = flow.tensor.bitcast %628 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %630 = flow.tensor.bitcast %627 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %631 = flow.dispatch.workgroups[%223](%630, %629, %223, %622) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %632 = flow.tensor.reshape %631 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %633 = flow.tensor.bitcast %160 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %634 = flow.tensor.bitcast %160 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %635 = flow.dispatch.workgroups(%634) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %636 = flow.dispatch.workgroups(%633) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %637 = flow.tensor.bitcast %636 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %638 = flow.tensor.bitcast %635 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %639 = flow.dispatch.workgroups[%223](%638, %637, %223, %622) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %640 = flow.dispatch.workgroups[%209](%624, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %641 = flow.dispatch.workgroups[%209](%624, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %642 = flow.dispatch.workgroups[%209](%632, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %643 = flow.dispatch.workgroups[%209](%632, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %644 = flow.dispatch.workgroups[%275, %265](%642, %276, %643, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %645 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c4_i64 = arith.constant 4 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c4_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %646 = flow.tensor.reshape %645 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %647 = flow.tensor.reshape %644 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %648 = flow.dispatch.workgroups[%283](%283, %647) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %649 = flow.tensor.reshape %648 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %650 = flow.dispatch.workgroups[%264, %211, %287](%649, %646, %567, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %567{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %651 = flow.dispatch.workgroups[%279](%279, %645) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %652 = flow.tensor.reshape %651 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %653 = flow.tensor.reshape %639 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %654 = flow.dispatch.workgroups[%292](%292, %653) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %655 = flow.tensor.reshape %654 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %656 = flow.dispatch.workgroups[%257, %211, %287](%655, %652, %650, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %650{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %657 = flow.dispatch.workgroups[%275, %265](%640, %276, %641, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %658 = flow.tensor.reshape %657 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %659 = flow.tensor.reshape %644 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %660 = flow.tensor.reshape %639 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %661 = flow.dispatch.workgroups[%265, %209](%265, %658, %659, %660, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %662 = flow.tensor.bitcast %159 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %663 = flow.tensor.bitcast %159 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %664 = flow.dispatch.workgroups(%663) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %665 = flow.dispatch.workgroups(%662) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %666 = flow.tensor.bitcast %665 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %667 = flow.tensor.bitcast %664 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %668 = flow.tensor.reshape %661 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %669 = flow.dispatch.workgroups[%223](%667, %666, %223, %668, %609) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %670 = flow.tensor.reshape %669 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %671 = flow.dispatch.workgroups[%226](%226, %670) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %672 = flow.dispatch.workgroups[%223](%223, %669) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %673 = flow.tensor.reshape %671 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %674 = flow.dispatch.workgroups[%223](%223, %673, %672) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %675 = flow.dispatch.workgroups[%223](%223, %158, %674) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %676 = flow.tensor.bitcast %157 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %677 = flow.tensor.bitcast %157 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %678 = flow.dispatch.workgroups(%677) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %679 = flow.dispatch.workgroups(%676) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %680 = flow.tensor.bitcast %679 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %681 = flow.tensor.bitcast %678 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %682 = flow.tensor.bitcast %156 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %683 = flow.dispatch.workgroups(%682) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %684 = flow.tensor.bitcast %683 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %685 = flow.tensor.bitcast %156 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %686 = flow.dispatch.workgroups(%685) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %687 = flow.tensor.bitcast %686 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %688 = flow.tensor.reshape %675 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %689 = flow.dispatch.workgroups[%223](%684, %687, %223, %688) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %690 = flow.dispatch.workgroups[%223](%681, %680, %223, %688, %689) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %691 = flow.tensor.bitcast %155 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %692 = flow.tensor.bitcast %155 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %693 = flow.dispatch.workgroups(%692) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %694 = flow.dispatch.workgroups(%691) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %695 = flow.tensor.bitcast %694 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %696 = flow.tensor.bitcast %693 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %697 = flow.tensor.reshape %690 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %698 = flow.dispatch.workgroups[%223](%696, %695, %223, %697, %669) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %699 = flow.tensor.reshape %698 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %700 = flow.dispatch.workgroups[%226](%226, %699) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %701 = flow.dispatch.workgroups[%223](%223, %698) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %702 = flow.tensor.reshape %700 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %703 = flow.dispatch.workgroups[%223](%223, %702, %701) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %704 = flow.dispatch.workgroups[%223](%223, %154, %703) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %705 = flow.tensor.bitcast %153 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %706 = flow.tensor.bitcast %153 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %707 = flow.dispatch.workgroups(%706) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %708 = flow.dispatch.workgroups(%705) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %709 = flow.tensor.bitcast %708 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %710 = flow.tensor.bitcast %707 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %711 = flow.tensor.reshape %704 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %712 = flow.dispatch.workgroups[%223](%710, %709, %223, %711) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %713 = flow.tensor.reshape %712 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %714 = flow.tensor.bitcast %152 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %715 = flow.tensor.bitcast %152 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %716 = flow.dispatch.workgroups(%715) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %717 = flow.dispatch.workgroups(%714) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %718 = flow.tensor.bitcast %717 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %719 = flow.tensor.bitcast %716 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %720 = flow.dispatch.workgroups[%223](%719, %718, %223, %711) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %721 = flow.tensor.reshape %720 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %722 = flow.tensor.bitcast %151 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %723 = flow.tensor.bitcast %151 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %724 = flow.dispatch.workgroups(%723) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %725 = flow.dispatch.workgroups(%722) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %726 = flow.tensor.bitcast %725 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %727 = flow.tensor.bitcast %724 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %728 = flow.dispatch.workgroups[%223](%727, %726, %223, %711) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %729 = flow.dispatch.workgroups[%209](%713, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %730 = flow.dispatch.workgroups[%209](%713, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %731 = flow.dispatch.workgroups[%209](%721, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %732 = flow.dispatch.workgroups[%209](%721, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %733 = flow.dispatch.workgroups[%275, %265](%731, %276, %732, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %734 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c5_i64 = arith.constant 5 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c5_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %735 = flow.tensor.reshape %734 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %736 = flow.tensor.reshape %733 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %737 = flow.dispatch.workgroups[%283](%283, %736) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %738 = flow.tensor.reshape %737 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %739 = flow.dispatch.workgroups[%264, %211, %287](%738, %735, %656, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %656{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %740 = flow.dispatch.workgroups[%279](%279, %734) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %741 = flow.tensor.reshape %740 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %742 = flow.tensor.reshape %728 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %743 = flow.dispatch.workgroups[%292](%292, %742) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %744 = flow.tensor.reshape %743 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %745 = flow.dispatch.workgroups[%257, %211, %287](%744, %741, %739, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %739{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %746 = flow.dispatch.workgroups[%275, %265](%729, %276, %730, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %747 = flow.tensor.reshape %746 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %748 = flow.tensor.reshape %733 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %749 = flow.tensor.reshape %728 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %750 = flow.dispatch.workgroups[%265, %209](%265, %747, %748, %749, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %751 = flow.tensor.bitcast %150 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %752 = flow.tensor.bitcast %150 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %753 = flow.dispatch.workgroups(%752) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %754 = flow.dispatch.workgroups(%751) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %755 = flow.tensor.bitcast %754 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %756 = flow.tensor.bitcast %753 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %757 = flow.tensor.reshape %750 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %758 = flow.dispatch.workgroups[%223](%756, %755, %223, %757, %698) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %759 = flow.tensor.reshape %758 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %760 = flow.dispatch.workgroups[%226](%226, %759) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %761 = flow.dispatch.workgroups[%223](%223, %758) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %762 = flow.tensor.reshape %760 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %763 = flow.dispatch.workgroups[%223](%223, %762, %761) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %764 = flow.dispatch.workgroups[%223](%223, %149, %763) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %765 = flow.tensor.bitcast %148 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %766 = flow.tensor.bitcast %148 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %767 = flow.dispatch.workgroups(%766) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %768 = flow.dispatch.workgroups(%765) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %769 = flow.tensor.bitcast %768 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %770 = flow.tensor.bitcast %767 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %771 = flow.tensor.bitcast %147 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %772 = flow.dispatch.workgroups(%771) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %773 = flow.tensor.bitcast %772 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %774 = flow.tensor.bitcast %147 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %775 = flow.dispatch.workgroups(%774) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %776 = flow.tensor.bitcast %775 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %777 = flow.tensor.reshape %764 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %778 = flow.dispatch.workgroups[%223](%773, %776, %223, %777) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %779 = flow.dispatch.workgroups[%223](%770, %769, %223, %777, %778) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %780 = flow.tensor.bitcast %146 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %781 = flow.tensor.bitcast %146 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %782 = flow.dispatch.workgroups(%781) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %783 = flow.dispatch.workgroups(%780) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %784 = flow.tensor.bitcast %783 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %785 = flow.tensor.bitcast %782 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %786 = flow.tensor.reshape %779 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %787 = flow.dispatch.workgroups[%223](%785, %784, %223, %786, %758) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %788 = flow.tensor.reshape %787 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %789 = flow.dispatch.workgroups[%226](%226, %788) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %790 = flow.dispatch.workgroups[%223](%223, %787) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %791 = flow.tensor.reshape %789 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %792 = flow.dispatch.workgroups[%223](%223, %791, %790) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %793 = flow.dispatch.workgroups[%223](%223, %145, %792) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %794 = flow.tensor.bitcast %144 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %795 = flow.tensor.bitcast %144 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %796 = flow.dispatch.workgroups(%795) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %797 = flow.dispatch.workgroups(%794) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %798 = flow.tensor.bitcast %797 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %799 = flow.tensor.bitcast %796 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %800 = flow.tensor.reshape %793 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %801 = flow.dispatch.workgroups[%223](%799, %798, %223, %800) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %802 = flow.tensor.reshape %801 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %803 = flow.tensor.bitcast %143 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %804 = flow.tensor.bitcast %143 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %805 = flow.dispatch.workgroups(%804) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %806 = flow.dispatch.workgroups(%803) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %807 = flow.tensor.bitcast %806 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %808 = flow.tensor.bitcast %805 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %809 = flow.dispatch.workgroups[%223](%808, %807, %223, %800) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %810 = flow.tensor.reshape %809 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %811 = flow.tensor.bitcast %142 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %812 = flow.tensor.bitcast %142 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %813 = flow.dispatch.workgroups(%812) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %814 = flow.dispatch.workgroups(%811) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %815 = flow.tensor.bitcast %814 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %816 = flow.tensor.bitcast %813 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %817 = flow.dispatch.workgroups[%223](%816, %815, %223, %800) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %818 = flow.dispatch.workgroups[%209](%802, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %819 = flow.dispatch.workgroups[%209](%802, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %820 = flow.dispatch.workgroups[%209](%810, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %821 = flow.dispatch.workgroups[%209](%810, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %822 = flow.dispatch.workgroups[%275, %265](%820, %276, %821, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %823 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c6_i64 = arith.constant 6 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c6_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %824 = flow.tensor.reshape %823 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %825 = flow.tensor.reshape %822 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %826 = flow.dispatch.workgroups[%283](%283, %825) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %827 = flow.tensor.reshape %826 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %828 = flow.dispatch.workgroups[%264, %211, %287](%827, %824, %745, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %745{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %829 = flow.dispatch.workgroups[%279](%279, %823) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %830 = flow.tensor.reshape %829 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %831 = flow.tensor.reshape %817 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %832 = flow.dispatch.workgroups[%292](%292, %831) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %833 = flow.tensor.reshape %832 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %834 = flow.dispatch.workgroups[%257, %211, %287](%833, %830, %828, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %828{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %835 = flow.dispatch.workgroups[%275, %265](%818, %276, %819, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %836 = flow.tensor.reshape %835 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %837 = flow.tensor.reshape %822 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %838 = flow.tensor.reshape %817 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %839 = flow.dispatch.workgroups[%265, %209](%265, %836, %837, %838, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %840 = flow.tensor.bitcast %141 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %841 = flow.tensor.bitcast %141 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %842 = flow.dispatch.workgroups(%841) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %843 = flow.dispatch.workgroups(%840) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %844 = flow.tensor.bitcast %843 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %845 = flow.tensor.bitcast %842 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %846 = flow.tensor.reshape %839 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %847 = flow.dispatch.workgroups[%223](%845, %844, %223, %846, %787) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %848 = flow.tensor.reshape %847 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %849 = flow.dispatch.workgroups[%226](%226, %848) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %850 = flow.dispatch.workgroups[%223](%223, %847) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %851 = flow.tensor.reshape %849 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %852 = flow.dispatch.workgroups[%223](%223, %851, %850) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %853 = flow.dispatch.workgroups[%223](%223, %140, %852) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %854 = flow.tensor.bitcast %139 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %855 = flow.tensor.bitcast %139 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %856 = flow.dispatch.workgroups(%855) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %857 = flow.dispatch.workgroups(%854) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %858 = flow.tensor.bitcast %857 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %859 = flow.tensor.bitcast %856 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %860 = flow.tensor.bitcast %138 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %861 = flow.dispatch.workgroups(%860) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %862 = flow.tensor.bitcast %861 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %863 = flow.tensor.bitcast %138 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %864 = flow.dispatch.workgroups(%863) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %865 = flow.tensor.bitcast %864 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %866 = flow.tensor.reshape %853 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %867 = flow.dispatch.workgroups[%223](%862, %865, %223, %866) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %868 = flow.dispatch.workgroups[%223](%859, %858, %223, %866, %867) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %869 = flow.tensor.bitcast %137 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %870 = flow.tensor.bitcast %137 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %871 = flow.dispatch.workgroups(%870) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %872 = flow.dispatch.workgroups(%869) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %873 = flow.tensor.bitcast %872 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %874 = flow.tensor.bitcast %871 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %875 = flow.tensor.reshape %868 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %876 = flow.dispatch.workgroups[%223](%874, %873, %223, %875, %847) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %877 = flow.tensor.reshape %876 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %878 = flow.dispatch.workgroups[%226](%226, %877) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %879 = flow.dispatch.workgroups[%223](%223, %876) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %880 = flow.tensor.reshape %878 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %881 = flow.dispatch.workgroups[%223](%223, %880, %879) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %882 = flow.dispatch.workgroups[%223](%223, %136, %881) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %883 = flow.tensor.bitcast %135 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %884 = flow.tensor.bitcast %135 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %885 = flow.dispatch.workgroups(%884) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %886 = flow.dispatch.workgroups(%883) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %887 = flow.tensor.bitcast %886 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %888 = flow.tensor.bitcast %885 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %889 = flow.tensor.reshape %882 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %890 = flow.dispatch.workgroups[%223](%888, %887, %223, %889) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %891 = flow.tensor.reshape %890 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %892 = flow.tensor.bitcast %134 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %893 = flow.tensor.bitcast %134 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %894 = flow.dispatch.workgroups(%893) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %895 = flow.dispatch.workgroups(%892) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %896 = flow.tensor.bitcast %895 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %897 = flow.tensor.bitcast %894 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %898 = flow.dispatch.workgroups[%223](%897, %896, %223, %889) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %899 = flow.tensor.reshape %898 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %900 = flow.tensor.bitcast %133 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %901 = flow.tensor.bitcast %133 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %902 = flow.dispatch.workgroups(%901) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %903 = flow.dispatch.workgroups(%900) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %904 = flow.tensor.bitcast %903 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %905 = flow.tensor.bitcast %902 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %906 = flow.dispatch.workgroups[%223](%905, %904, %223, %889) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %907 = flow.dispatch.workgroups[%209](%891, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %908 = flow.dispatch.workgroups[%209](%891, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %909 = flow.dispatch.workgroups[%209](%899, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %910 = flow.dispatch.workgroups[%209](%899, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %911 = flow.dispatch.workgroups[%275, %265](%909, %276, %910, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %912 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c7_i64 = arith.constant 7 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c7_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %913 = flow.tensor.reshape %912 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %914 = flow.tensor.reshape %911 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %915 = flow.dispatch.workgroups[%283](%283, %914) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %916 = flow.tensor.reshape %915 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %917 = flow.dispatch.workgroups[%264, %211, %287](%916, %913, %834, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %834{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %918 = flow.dispatch.workgroups[%279](%279, %912) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %919 = flow.tensor.reshape %918 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %920 = flow.tensor.reshape %906 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %921 = flow.dispatch.workgroups[%292](%292, %920) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %922 = flow.tensor.reshape %921 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %923 = flow.dispatch.workgroups[%257, %211, %287](%922, %919, %917, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %917{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %924 = flow.dispatch.workgroups[%275, %265](%907, %276, %908, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %925 = flow.tensor.reshape %924 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %926 = flow.tensor.reshape %911 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %927 = flow.tensor.reshape %906 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %928 = flow.dispatch.workgroups[%265, %209](%265, %925, %926, %927, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %929 = flow.tensor.bitcast %132 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %930 = flow.tensor.bitcast %132 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %931 = flow.dispatch.workgroups(%930) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %932 = flow.dispatch.workgroups(%929) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %933 = flow.tensor.bitcast %932 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %934 = flow.tensor.bitcast %931 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %935 = flow.tensor.reshape %928 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %936 = flow.dispatch.workgroups[%223](%934, %933, %223, %935, %876) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %937 = flow.tensor.reshape %936 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %938 = flow.dispatch.workgroups[%226](%226, %937) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %939 = flow.dispatch.workgroups[%223](%223, %936) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %940 = flow.tensor.reshape %938 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %941 = flow.dispatch.workgroups[%223](%223, %940, %939) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %942 = flow.dispatch.workgroups[%223](%223, %131, %941) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %943 = flow.tensor.bitcast %130 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %944 = flow.tensor.bitcast %130 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %945 = flow.dispatch.workgroups(%944) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %946 = flow.dispatch.workgroups(%943) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %947 = flow.tensor.bitcast %946 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %948 = flow.tensor.bitcast %945 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %949 = flow.tensor.bitcast %129 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %950 = flow.dispatch.workgroups(%949) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %951 = flow.tensor.bitcast %950 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %952 = flow.tensor.bitcast %129 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %953 = flow.dispatch.workgroups(%952) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %954 = flow.tensor.bitcast %953 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %955 = flow.tensor.reshape %942 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %956 = flow.dispatch.workgroups[%223](%951, %954, %223, %955) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %957 = flow.dispatch.workgroups[%223](%948, %947, %223, %955, %956) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %958 = flow.tensor.bitcast %128 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %959 = flow.tensor.bitcast %128 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %960 = flow.dispatch.workgroups(%959) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %961 = flow.dispatch.workgroups(%958) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %962 = flow.tensor.bitcast %961 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %963 = flow.tensor.bitcast %960 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %964 = flow.tensor.reshape %957 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %965 = flow.dispatch.workgroups[%223](%963, %962, %223, %964, %936) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %966 = flow.tensor.reshape %965 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %967 = flow.dispatch.workgroups[%226](%226, %966) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %968 = flow.dispatch.workgroups[%223](%223, %965) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %969 = flow.tensor.reshape %967 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %970 = flow.dispatch.workgroups[%223](%223, %969, %968) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %971 = flow.dispatch.workgroups[%223](%223, %127, %970) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %972 = flow.tensor.bitcast %126 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %973 = flow.tensor.bitcast %126 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %974 = flow.dispatch.workgroups(%973) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %975 = flow.dispatch.workgroups(%972) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %976 = flow.tensor.bitcast %975 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %977 = flow.tensor.bitcast %974 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %978 = flow.tensor.reshape %971 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %979 = flow.dispatch.workgroups[%223](%977, %976, %223, %978) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %980 = flow.tensor.reshape %979 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %981 = flow.tensor.bitcast %125 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %982 = flow.tensor.bitcast %125 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %983 = flow.dispatch.workgroups(%982) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %984 = flow.dispatch.workgroups(%981) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %985 = flow.tensor.bitcast %984 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %986 = flow.tensor.bitcast %983 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %987 = flow.dispatch.workgroups[%223](%986, %985, %223, %978) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %988 = flow.tensor.reshape %987 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %989 = flow.tensor.bitcast %124 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %990 = flow.tensor.bitcast %124 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %991 = flow.dispatch.workgroups(%990) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %992 = flow.dispatch.workgroups(%989) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %993 = flow.tensor.bitcast %992 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %994 = flow.tensor.bitcast %991 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %995 = flow.dispatch.workgroups[%223](%994, %993, %223, %978) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %996 = flow.dispatch.workgroups[%209](%980, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %997 = flow.dispatch.workgroups[%209](%980, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %998 = flow.dispatch.workgroups[%209](%988, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %999 = flow.dispatch.workgroups[%209](%988, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1000 = flow.dispatch.workgroups[%275, %265](%998, %276, %999, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1001 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c8_i64 = arith.constant 8 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c8_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1002 = flow.tensor.reshape %1001 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1003 = flow.tensor.reshape %1000 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1004 = flow.dispatch.workgroups[%283](%283, %1003) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1005 = flow.tensor.reshape %1004 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1006 = flow.dispatch.workgroups[%264, %211, %287](%1005, %1002, %923, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %923{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1007 = flow.dispatch.workgroups[%279](%279, %1001) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1008 = flow.tensor.reshape %1007 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1009 = flow.tensor.reshape %995 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1010 = flow.dispatch.workgroups[%292](%292, %1009) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1011 = flow.tensor.reshape %1010 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1012 = flow.dispatch.workgroups[%257, %211, %287](%1011, %1008, %1006, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1006{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1013 = flow.dispatch.workgroups[%275, %265](%996, %276, %997, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1014 = flow.tensor.reshape %1013 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1015 = flow.tensor.reshape %1000 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1016 = flow.tensor.reshape %995 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1017 = flow.dispatch.workgroups[%265, %209](%265, %1014, %1015, %1016, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1018 = flow.tensor.bitcast %123 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1019 = flow.tensor.bitcast %123 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1020 = flow.dispatch.workgroups(%1019) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1021 = flow.dispatch.workgroups(%1018) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1022 = flow.tensor.bitcast %1021 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1023 = flow.tensor.bitcast %1020 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1024 = flow.tensor.reshape %1017 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1025 = flow.dispatch.workgroups[%223](%1023, %1022, %223, %1024, %965) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1026 = flow.tensor.reshape %1025 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1027 = flow.dispatch.workgroups[%226](%226, %1026) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1028 = flow.dispatch.workgroups[%223](%223, %1025) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1029 = flow.tensor.reshape %1027 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1030 = flow.dispatch.workgroups[%223](%223, %1029, %1028) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1031 = flow.dispatch.workgroups[%223](%223, %122, %1030) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1032 = flow.tensor.bitcast %121 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1033 = flow.tensor.bitcast %121 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1034 = flow.dispatch.workgroups(%1033) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1035 = flow.dispatch.workgroups(%1032) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1036 = flow.tensor.bitcast %1035 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1037 = flow.tensor.bitcast %1034 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1038 = flow.tensor.bitcast %120 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1039 = flow.dispatch.workgroups(%1038) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1040 = flow.tensor.bitcast %1039 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1041 = flow.tensor.bitcast %120 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1042 = flow.dispatch.workgroups(%1041) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1043 = flow.tensor.bitcast %1042 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1044 = flow.tensor.reshape %1031 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1045 = flow.dispatch.workgroups[%223](%1040, %1043, %223, %1044) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1046 = flow.dispatch.workgroups[%223](%1037, %1036, %223, %1044, %1045) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1047 = flow.tensor.bitcast %119 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1048 = flow.tensor.bitcast %119 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1049 = flow.dispatch.workgroups(%1048) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1050 = flow.dispatch.workgroups(%1047) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1051 = flow.tensor.bitcast %1050 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1052 = flow.tensor.bitcast %1049 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1053 = flow.tensor.reshape %1046 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1054 = flow.dispatch.workgroups[%223](%1052, %1051, %223, %1053, %1025) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1055 = flow.tensor.reshape %1054 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1056 = flow.dispatch.workgroups[%226](%226, %1055) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1057 = flow.dispatch.workgroups[%223](%223, %1054) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1058 = flow.tensor.reshape %1056 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1059 = flow.dispatch.workgroups[%223](%223, %1058, %1057) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1060 = flow.dispatch.workgroups[%223](%223, %118, %1059) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1061 = flow.tensor.bitcast %117 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1062 = flow.tensor.bitcast %117 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1063 = flow.dispatch.workgroups(%1062) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1064 = flow.dispatch.workgroups(%1061) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1065 = flow.tensor.bitcast %1064 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1066 = flow.tensor.bitcast %1063 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1067 = flow.tensor.reshape %1060 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1068 = flow.dispatch.workgroups[%223](%1066, %1065, %223, %1067) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1069 = flow.tensor.reshape %1068 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1070 = flow.tensor.bitcast %116 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1071 = flow.tensor.bitcast %116 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1072 = flow.dispatch.workgroups(%1071) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1073 = flow.dispatch.workgroups(%1070) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1074 = flow.tensor.bitcast %1073 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1075 = flow.tensor.bitcast %1072 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1076 = flow.dispatch.workgroups[%223](%1075, %1074, %223, %1067) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1077 = flow.tensor.reshape %1076 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1078 = flow.tensor.bitcast %115 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1079 = flow.tensor.bitcast %115 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1080 = flow.dispatch.workgroups(%1079) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1081 = flow.dispatch.workgroups(%1078) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1082 = flow.tensor.bitcast %1081 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1083 = flow.tensor.bitcast %1080 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1084 = flow.dispatch.workgroups[%223](%1083, %1082, %223, %1067) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1085 = flow.dispatch.workgroups[%209](%1069, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1086 = flow.dispatch.workgroups[%209](%1069, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1087 = flow.dispatch.workgroups[%209](%1077, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1088 = flow.dispatch.workgroups[%209](%1077, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1089 = flow.dispatch.workgroups[%275, %265](%1087, %276, %1088, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1090 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c9_i64 = arith.constant 9 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c9_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1091 = flow.tensor.reshape %1090 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1092 = flow.tensor.reshape %1089 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1093 = flow.dispatch.workgroups[%283](%283, %1092) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1094 = flow.tensor.reshape %1093 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1095 = flow.dispatch.workgroups[%264, %211, %287](%1094, %1091, %1012, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1012{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1096 = flow.dispatch.workgroups[%279](%279, %1090) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1097 = flow.tensor.reshape %1096 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1098 = flow.tensor.reshape %1084 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1099 = flow.dispatch.workgroups[%292](%292, %1098) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1100 = flow.tensor.reshape %1099 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1101 = flow.dispatch.workgroups[%257, %211, %287](%1100, %1097, %1095, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1095{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1102 = flow.dispatch.workgroups[%275, %265](%1085, %276, %1086, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1103 = flow.tensor.reshape %1102 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1104 = flow.tensor.reshape %1089 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1105 = flow.tensor.reshape %1084 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1106 = flow.dispatch.workgroups[%265, %209](%265, %1103, %1104, %1105, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1107 = flow.tensor.bitcast %114 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1108 = flow.tensor.bitcast %114 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1109 = flow.dispatch.workgroups(%1108) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1110 = flow.dispatch.workgroups(%1107) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1111 = flow.tensor.bitcast %1110 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1112 = flow.tensor.bitcast %1109 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1113 = flow.tensor.reshape %1106 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1114 = flow.dispatch.workgroups[%223](%1112, %1111, %223, %1113, %1054) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1115 = flow.tensor.reshape %1114 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1116 = flow.dispatch.workgroups[%226](%226, %1115) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1117 = flow.dispatch.workgroups[%223](%223, %1114) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1118 = flow.tensor.reshape %1116 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1119 = flow.dispatch.workgroups[%223](%223, %1118, %1117) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1120 = flow.dispatch.workgroups[%223](%223, %113, %1119) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1121 = flow.tensor.bitcast %112 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1122 = flow.tensor.bitcast %112 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1123 = flow.dispatch.workgroups(%1122) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1124 = flow.dispatch.workgroups(%1121) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1125 = flow.tensor.bitcast %1124 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1126 = flow.tensor.bitcast %1123 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1127 = flow.tensor.bitcast %111 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1128 = flow.dispatch.workgroups(%1127) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1129 = flow.tensor.bitcast %1128 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1130 = flow.tensor.bitcast %111 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1131 = flow.dispatch.workgroups(%1130) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1132 = flow.tensor.bitcast %1131 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1133 = flow.tensor.reshape %1120 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1134 = flow.dispatch.workgroups[%223](%1129, %1132, %223, %1133) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1135 = flow.dispatch.workgroups[%223](%1126, %1125, %223, %1133, %1134) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1136 = flow.tensor.bitcast %110 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1137 = flow.tensor.bitcast %110 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1138 = flow.dispatch.workgroups(%1137) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1139 = flow.dispatch.workgroups(%1136) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1140 = flow.tensor.bitcast %1139 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1141 = flow.tensor.bitcast %1138 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1142 = flow.tensor.reshape %1135 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1143 = flow.dispatch.workgroups[%223](%1141, %1140, %223, %1142, %1114) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1144 = flow.tensor.reshape %1143 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1145 = flow.dispatch.workgroups[%226](%226, %1144) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1146 = flow.dispatch.workgroups[%223](%223, %1143) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1147 = flow.tensor.reshape %1145 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1148 = flow.dispatch.workgroups[%223](%223, %1147, %1146) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1149 = flow.dispatch.workgroups[%223](%223, %109, %1148) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1150 = flow.tensor.bitcast %108 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1151 = flow.tensor.bitcast %108 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1152 = flow.dispatch.workgroups(%1151) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1153 = flow.dispatch.workgroups(%1150) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1154 = flow.tensor.bitcast %1153 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1155 = flow.tensor.bitcast %1152 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1156 = flow.tensor.reshape %1149 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1157 = flow.dispatch.workgroups[%223](%1155, %1154, %223, %1156) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1158 = flow.tensor.reshape %1157 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1159 = flow.tensor.bitcast %107 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1160 = flow.tensor.bitcast %107 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1161 = flow.dispatch.workgroups(%1160) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1162 = flow.dispatch.workgroups(%1159) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1163 = flow.tensor.bitcast %1162 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1164 = flow.tensor.bitcast %1161 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1165 = flow.dispatch.workgroups[%223](%1164, %1163, %223, %1156) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1166 = flow.tensor.reshape %1165 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1167 = flow.tensor.bitcast %106 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1168 = flow.tensor.bitcast %106 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1169 = flow.dispatch.workgroups(%1168) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1170 = flow.dispatch.workgroups(%1167) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1171 = flow.tensor.bitcast %1170 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1172 = flow.tensor.bitcast %1169 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1173 = flow.dispatch.workgroups[%223](%1172, %1171, %223, %1156) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1174 = flow.dispatch.workgroups[%209](%1158, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1175 = flow.dispatch.workgroups[%209](%1158, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1176 = flow.dispatch.workgroups[%209](%1166, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1177 = flow.dispatch.workgroups[%209](%1166, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1178 = flow.dispatch.workgroups[%275, %265](%1176, %276, %1177, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1179 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c10_i64 = arith.constant 10 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c10_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1180 = flow.tensor.reshape %1179 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1181 = flow.tensor.reshape %1178 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1182 = flow.dispatch.workgroups[%283](%283, %1181) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1183 = flow.tensor.reshape %1182 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1184 = flow.dispatch.workgroups[%264, %211, %287](%1183, %1180, %1101, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1101{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1185 = flow.dispatch.workgroups[%279](%279, %1179) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1186 = flow.tensor.reshape %1185 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1187 = flow.tensor.reshape %1173 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1188 = flow.dispatch.workgroups[%292](%292, %1187) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1189 = flow.tensor.reshape %1188 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1190 = flow.dispatch.workgroups[%257, %211, %287](%1189, %1186, %1184, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1184{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1191 = flow.dispatch.workgroups[%275, %265](%1174, %276, %1175, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1192 = flow.tensor.reshape %1191 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1193 = flow.tensor.reshape %1178 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1194 = flow.tensor.reshape %1173 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1195 = flow.dispatch.workgroups[%265, %209](%265, %1192, %1193, %1194, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1196 = flow.tensor.bitcast %105 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1197 = flow.tensor.bitcast %105 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1198 = flow.dispatch.workgroups(%1197) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1199 = flow.dispatch.workgroups(%1196) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1200 = flow.tensor.bitcast %1199 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1201 = flow.tensor.bitcast %1198 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1202 = flow.tensor.reshape %1195 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1203 = flow.dispatch.workgroups[%223](%1201, %1200, %223, %1202, %1143) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1204 = flow.tensor.reshape %1203 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1205 = flow.dispatch.workgroups[%226](%226, %1204) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1206 = flow.dispatch.workgroups[%223](%223, %1203) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1207 = flow.tensor.reshape %1205 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1208 = flow.dispatch.workgroups[%223](%223, %1207, %1206) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1209 = flow.dispatch.workgroups[%223](%223, %104, %1208) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1210 = flow.tensor.bitcast %103 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1211 = flow.tensor.bitcast %103 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1212 = flow.dispatch.workgroups(%1211) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1213 = flow.dispatch.workgroups(%1210) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1214 = flow.tensor.bitcast %1213 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1215 = flow.tensor.bitcast %1212 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1216 = flow.tensor.bitcast %102 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1217 = flow.dispatch.workgroups(%1216) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1218 = flow.tensor.bitcast %1217 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1219 = flow.tensor.bitcast %102 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1220 = flow.dispatch.workgroups(%1219) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1221 = flow.tensor.bitcast %1220 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1222 = flow.tensor.reshape %1209 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1223 = flow.dispatch.workgroups[%223](%1218, %1221, %223, %1222) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1224 = flow.dispatch.workgroups[%223](%1215, %1214, %223, %1222, %1223) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1225 = flow.tensor.bitcast %101 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1226 = flow.tensor.bitcast %101 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1227 = flow.dispatch.workgroups(%1226) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1228 = flow.dispatch.workgroups(%1225) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1229 = flow.tensor.bitcast %1228 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1230 = flow.tensor.bitcast %1227 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1231 = flow.tensor.reshape %1224 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1232 = flow.dispatch.workgroups[%223](%1230, %1229, %223, %1231, %1203) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1233 = flow.tensor.reshape %1232 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1234 = flow.dispatch.workgroups[%226](%226, %1233) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1235 = flow.dispatch.workgroups[%223](%223, %1232) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1236 = flow.tensor.reshape %1234 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1237 = flow.dispatch.workgroups[%223](%223, %1236, %1235) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1238 = flow.dispatch.workgroups[%223](%223, %100, %1237) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1239 = flow.tensor.bitcast %99 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1240 = flow.tensor.bitcast %99 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1241 = flow.dispatch.workgroups(%1240) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1242 = flow.dispatch.workgroups(%1239) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1243 = flow.tensor.bitcast %1242 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1244 = flow.tensor.bitcast %1241 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1245 = flow.tensor.reshape %1238 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1246 = flow.dispatch.workgroups[%223](%1244, %1243, %223, %1245) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1247 = flow.tensor.reshape %1246 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1248 = flow.tensor.bitcast %98 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1249 = flow.tensor.bitcast %98 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1250 = flow.dispatch.workgroups(%1249) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1251 = flow.dispatch.workgroups(%1248) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1252 = flow.tensor.bitcast %1251 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1253 = flow.tensor.bitcast %1250 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1254 = flow.dispatch.workgroups[%223](%1253, %1252, %223, %1245) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1255 = flow.tensor.reshape %1254 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1256 = flow.tensor.bitcast %97 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1257 = flow.tensor.bitcast %97 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1258 = flow.dispatch.workgroups(%1257) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1259 = flow.dispatch.workgroups(%1256) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1260 = flow.tensor.bitcast %1259 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1261 = flow.tensor.bitcast %1258 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1262 = flow.dispatch.workgroups[%223](%1261, %1260, %223, %1245) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1263 = flow.dispatch.workgroups[%209](%1247, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1264 = flow.dispatch.workgroups[%209](%1247, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1265 = flow.dispatch.workgroups[%209](%1255, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1266 = flow.dispatch.workgroups[%209](%1255, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1267 = flow.dispatch.workgroups[%275, %265](%1265, %276, %1266, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1268 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c11_i64 = arith.constant 11 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c11_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1269 = flow.tensor.reshape %1268 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1270 = flow.tensor.reshape %1267 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1271 = flow.dispatch.workgroups[%283](%283, %1270) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1272 = flow.tensor.reshape %1271 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1273 = flow.dispatch.workgroups[%264, %211, %287](%1272, %1269, %1190, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1190{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1274 = flow.dispatch.workgroups[%279](%279, %1268) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1275 = flow.tensor.reshape %1274 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1276 = flow.tensor.reshape %1262 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1277 = flow.dispatch.workgroups[%292](%292, %1276) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1278 = flow.tensor.reshape %1277 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1279 = flow.dispatch.workgroups[%257, %211, %287](%1278, %1275, %1273, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1273{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1280 = flow.dispatch.workgroups[%275, %265](%1263, %276, %1264, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1281 = flow.tensor.reshape %1280 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1282 = flow.tensor.reshape %1267 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1283 = flow.tensor.reshape %1262 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1284 = flow.dispatch.workgroups[%265, %209](%265, %1281, %1282, %1283, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1285 = flow.tensor.bitcast %96 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1286 = flow.tensor.bitcast %96 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1287 = flow.dispatch.workgroups(%1286) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1288 = flow.dispatch.workgroups(%1285) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1289 = flow.tensor.bitcast %1288 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1290 = flow.tensor.bitcast %1287 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1291 = flow.tensor.reshape %1284 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1292 = flow.dispatch.workgroups[%223](%1290, %1289, %223, %1291, %1232) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1293 = flow.tensor.reshape %1292 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1294 = flow.dispatch.workgroups[%226](%226, %1293) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1295 = flow.dispatch.workgroups[%223](%223, %1292) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1296 = flow.tensor.reshape %1294 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1297 = flow.dispatch.workgroups[%223](%223, %1296, %1295) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1298 = flow.dispatch.workgroups[%223](%223, %95, %1297) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1299 = flow.tensor.bitcast %94 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1300 = flow.tensor.bitcast %94 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1301 = flow.dispatch.workgroups(%1300) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1302 = flow.dispatch.workgroups(%1299) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1303 = flow.tensor.bitcast %1302 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1304 = flow.tensor.bitcast %1301 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1305 = flow.tensor.bitcast %93 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1306 = flow.dispatch.workgroups(%1305) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1307 = flow.tensor.bitcast %1306 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1308 = flow.tensor.bitcast %93 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1309 = flow.dispatch.workgroups(%1308) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1310 = flow.tensor.bitcast %1309 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1311 = flow.tensor.reshape %1298 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1312 = flow.dispatch.workgroups[%223](%1307, %1310, %223, %1311) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1313 = flow.dispatch.workgroups[%223](%1304, %1303, %223, %1311, %1312) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1314 = flow.tensor.bitcast %92 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1315 = flow.tensor.bitcast %92 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1316 = flow.dispatch.workgroups(%1315) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1317 = flow.dispatch.workgroups(%1314) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1318 = flow.tensor.bitcast %1317 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1319 = flow.tensor.bitcast %1316 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1320 = flow.tensor.reshape %1313 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1321 = flow.dispatch.workgroups[%223](%1319, %1318, %223, %1320, %1292) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1322 = flow.tensor.reshape %1321 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1323 = flow.dispatch.workgroups[%226](%226, %1322) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1324 = flow.dispatch.workgroups[%223](%223, %1321) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1325 = flow.tensor.reshape %1323 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1326 = flow.dispatch.workgroups[%223](%223, %1325, %1324) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1327 = flow.dispatch.workgroups[%223](%223, %91, %1326) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1328 = flow.tensor.bitcast %90 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1329 = flow.tensor.bitcast %90 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1330 = flow.dispatch.workgroups(%1329) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1331 = flow.dispatch.workgroups(%1328) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1332 = flow.tensor.bitcast %1331 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1333 = flow.tensor.bitcast %1330 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1334 = flow.tensor.reshape %1327 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1335 = flow.dispatch.workgroups[%223](%1333, %1332, %223, %1334) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1336 = flow.tensor.reshape %1335 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1337 = flow.tensor.bitcast %89 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1338 = flow.tensor.bitcast %89 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1339 = flow.dispatch.workgroups(%1338) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1340 = flow.dispatch.workgroups(%1337) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1341 = flow.tensor.bitcast %1340 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1342 = flow.tensor.bitcast %1339 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1343 = flow.dispatch.workgroups[%223](%1342, %1341, %223, %1334) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1344 = flow.tensor.reshape %1343 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1345 = flow.tensor.bitcast %88 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1346 = flow.tensor.bitcast %88 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1347 = flow.dispatch.workgroups(%1346) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1348 = flow.dispatch.workgroups(%1345) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1349 = flow.tensor.bitcast %1348 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1350 = flow.tensor.bitcast %1347 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1351 = flow.dispatch.workgroups[%223](%1350, %1349, %223, %1334) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1352 = flow.dispatch.workgroups[%209](%1336, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1353 = flow.dispatch.workgroups[%209](%1336, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1354 = flow.dispatch.workgroups[%209](%1344, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1355 = flow.dispatch.workgroups[%209](%1344, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1356 = flow.dispatch.workgroups[%275, %265](%1354, %276, %1355, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1357 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c12_i64 = arith.constant 12 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c12_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1358 = flow.tensor.reshape %1357 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1359 = flow.tensor.reshape %1356 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1360 = flow.dispatch.workgroups[%283](%283, %1359) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1361 = flow.tensor.reshape %1360 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1362 = flow.dispatch.workgroups[%264, %211, %287](%1361, %1358, %1279, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1279{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1363 = flow.dispatch.workgroups[%279](%279, %1357) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1364 = flow.tensor.reshape %1363 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1365 = flow.tensor.reshape %1351 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1366 = flow.dispatch.workgroups[%292](%292, %1365) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1367 = flow.tensor.reshape %1366 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1368 = flow.dispatch.workgroups[%257, %211, %287](%1367, %1364, %1362, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1362{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1369 = flow.dispatch.workgroups[%275, %265](%1352, %276, %1353, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1370 = flow.tensor.reshape %1369 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1371 = flow.tensor.reshape %1356 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1372 = flow.tensor.reshape %1351 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1373 = flow.dispatch.workgroups[%265, %209](%265, %1370, %1371, %1372, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1374 = flow.tensor.bitcast %87 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1375 = flow.tensor.bitcast %87 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1376 = flow.dispatch.workgroups(%1375) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1377 = flow.dispatch.workgroups(%1374) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1378 = flow.tensor.bitcast %1377 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1379 = flow.tensor.bitcast %1376 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1380 = flow.tensor.reshape %1373 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1381 = flow.dispatch.workgroups[%223](%1379, %1378, %223, %1380, %1321) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1382 = flow.tensor.reshape %1381 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1383 = flow.dispatch.workgroups[%226](%226, %1382) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1384 = flow.dispatch.workgroups[%223](%223, %1381) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1385 = flow.tensor.reshape %1383 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1386 = flow.dispatch.workgroups[%223](%223, %1385, %1384) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1387 = flow.dispatch.workgroups[%223](%223, %86, %1386) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1388 = flow.tensor.bitcast %85 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1389 = flow.tensor.bitcast %85 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1390 = flow.dispatch.workgroups(%1389) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1391 = flow.dispatch.workgroups(%1388) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1392 = flow.tensor.bitcast %1391 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1393 = flow.tensor.bitcast %1390 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1394 = flow.tensor.bitcast %84 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1395 = flow.dispatch.workgroups(%1394) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1396 = flow.tensor.bitcast %1395 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1397 = flow.tensor.bitcast %84 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1398 = flow.dispatch.workgroups(%1397) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1399 = flow.tensor.bitcast %1398 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1400 = flow.tensor.reshape %1387 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1401 = flow.dispatch.workgroups[%223](%1396, %1399, %223, %1400) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1402 = flow.dispatch.workgroups[%223](%1393, %1392, %223, %1400, %1401) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1403 = flow.tensor.bitcast %83 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1404 = flow.tensor.bitcast %83 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1405 = flow.dispatch.workgroups(%1404) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1406 = flow.dispatch.workgroups(%1403) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1407 = flow.tensor.bitcast %1406 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1408 = flow.tensor.bitcast %1405 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1409 = flow.tensor.reshape %1402 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1410 = flow.dispatch.workgroups[%223](%1408, %1407, %223, %1409, %1381) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1411 = flow.tensor.reshape %1410 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1412 = flow.dispatch.workgroups[%226](%226, %1411) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1413 = flow.dispatch.workgroups[%223](%223, %1410) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1414 = flow.tensor.reshape %1412 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1415 = flow.dispatch.workgroups[%223](%223, %1414, %1413) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1416 = flow.dispatch.workgroups[%223](%223, %82, %1415) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1417 = flow.tensor.bitcast %81 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1418 = flow.tensor.bitcast %81 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1419 = flow.dispatch.workgroups(%1418) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1420 = flow.dispatch.workgroups(%1417) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1421 = flow.tensor.bitcast %1420 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1422 = flow.tensor.bitcast %1419 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1423 = flow.tensor.reshape %1416 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1424 = flow.dispatch.workgroups[%223](%1422, %1421, %223, %1423) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1425 = flow.tensor.reshape %1424 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1426 = flow.tensor.bitcast %80 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1427 = flow.tensor.bitcast %80 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1428 = flow.dispatch.workgroups(%1427) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1429 = flow.dispatch.workgroups(%1426) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1430 = flow.tensor.bitcast %1429 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1431 = flow.tensor.bitcast %1428 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1432 = flow.dispatch.workgroups[%223](%1431, %1430, %223, %1423) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1433 = flow.tensor.reshape %1432 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1434 = flow.tensor.bitcast %79 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1435 = flow.tensor.bitcast %79 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1436 = flow.dispatch.workgroups(%1435) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1437 = flow.dispatch.workgroups(%1434) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1438 = flow.tensor.bitcast %1437 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1439 = flow.tensor.bitcast %1436 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1440 = flow.dispatch.workgroups[%223](%1439, %1438, %223, %1423) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1441 = flow.dispatch.workgroups[%209](%1425, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1442 = flow.dispatch.workgroups[%209](%1425, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1443 = flow.dispatch.workgroups[%209](%1433, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1444 = flow.dispatch.workgroups[%209](%1433, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1445 = flow.dispatch.workgroups[%275, %265](%1443, %276, %1444, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1446 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c13_i64 = arith.constant 13 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c13_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1447 = flow.tensor.reshape %1446 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1448 = flow.tensor.reshape %1445 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1449 = flow.dispatch.workgroups[%283](%283, %1448) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1450 = flow.tensor.reshape %1449 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1451 = flow.dispatch.workgroups[%264, %211, %287](%1450, %1447, %1368, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1368{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1452 = flow.dispatch.workgroups[%279](%279, %1446) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1453 = flow.tensor.reshape %1452 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1454 = flow.tensor.reshape %1440 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1455 = flow.dispatch.workgroups[%292](%292, %1454) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1456 = flow.tensor.reshape %1455 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1457 = flow.dispatch.workgroups[%257, %211, %287](%1456, %1453, %1451, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1451{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1458 = flow.dispatch.workgroups[%275, %265](%1441, %276, %1442, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1459 = flow.tensor.reshape %1458 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1460 = flow.tensor.reshape %1445 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1461 = flow.tensor.reshape %1440 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1462 = flow.dispatch.workgroups[%265, %209](%265, %1459, %1460, %1461, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1463 = flow.tensor.bitcast %78 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1464 = flow.tensor.bitcast %78 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1465 = flow.dispatch.workgroups(%1464) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1466 = flow.dispatch.workgroups(%1463) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1467 = flow.tensor.bitcast %1466 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1468 = flow.tensor.bitcast %1465 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1469 = flow.tensor.reshape %1462 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1470 = flow.dispatch.workgroups[%223](%1468, %1467, %223, %1469, %1410) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1471 = flow.tensor.reshape %1470 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1472 = flow.dispatch.workgroups[%226](%226, %1471) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1473 = flow.dispatch.workgroups[%223](%223, %1470) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1474 = flow.tensor.reshape %1472 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1475 = flow.dispatch.workgroups[%223](%223, %1474, %1473) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1476 = flow.dispatch.workgroups[%223](%223, %77, %1475) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1477 = flow.tensor.bitcast %76 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1478 = flow.tensor.bitcast %76 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1479 = flow.dispatch.workgroups(%1478) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1480 = flow.dispatch.workgroups(%1477) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1481 = flow.tensor.bitcast %1480 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1482 = flow.tensor.bitcast %1479 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1483 = flow.tensor.bitcast %75 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1484 = flow.dispatch.workgroups(%1483) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1485 = flow.tensor.bitcast %1484 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1486 = flow.tensor.bitcast %75 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1487 = flow.dispatch.workgroups(%1486) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1488 = flow.tensor.bitcast %1487 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1489 = flow.tensor.reshape %1476 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1490 = flow.dispatch.workgroups[%223](%1485, %1488, %223, %1489) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1491 = flow.dispatch.workgroups[%223](%1482, %1481, %223, %1489, %1490) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1492 = flow.tensor.bitcast %74 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1493 = flow.tensor.bitcast %74 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1494 = flow.dispatch.workgroups(%1493) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1495 = flow.dispatch.workgroups(%1492) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1496 = flow.tensor.bitcast %1495 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1497 = flow.tensor.bitcast %1494 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1498 = flow.tensor.reshape %1491 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1499 = flow.dispatch.workgroups[%223](%1497, %1496, %223, %1498, %1470) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1500 = flow.tensor.reshape %1499 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1501 = flow.dispatch.workgroups[%226](%226, %1500) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1502 = flow.dispatch.workgroups[%223](%223, %1499) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1503 = flow.tensor.reshape %1501 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1504 = flow.dispatch.workgroups[%223](%223, %1503, %1502) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1505 = flow.dispatch.workgroups[%223](%223, %73, %1504) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1506 = flow.tensor.bitcast %72 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1507 = flow.tensor.bitcast %72 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1508 = flow.dispatch.workgroups(%1507) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1509 = flow.dispatch.workgroups(%1506) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1510 = flow.tensor.bitcast %1509 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1511 = flow.tensor.bitcast %1508 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1512 = flow.tensor.reshape %1505 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1513 = flow.dispatch.workgroups[%223](%1511, %1510, %223, %1512) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1514 = flow.tensor.reshape %1513 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1515 = flow.tensor.bitcast %71 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1516 = flow.tensor.bitcast %71 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1517 = flow.dispatch.workgroups(%1516) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1518 = flow.dispatch.workgroups(%1515) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1519 = flow.tensor.bitcast %1518 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1520 = flow.tensor.bitcast %1517 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1521 = flow.dispatch.workgroups[%223](%1520, %1519, %223, %1512) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1522 = flow.tensor.reshape %1521 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1523 = flow.tensor.bitcast %70 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1524 = flow.tensor.bitcast %70 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1525 = flow.dispatch.workgroups(%1524) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1526 = flow.dispatch.workgroups(%1523) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1527 = flow.tensor.bitcast %1526 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1528 = flow.tensor.bitcast %1525 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1529 = flow.dispatch.workgroups[%223](%1528, %1527, %223, %1512) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1530 = flow.dispatch.workgroups[%209](%1514, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1531 = flow.dispatch.workgroups[%209](%1514, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1532 = flow.dispatch.workgroups[%209](%1522, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1533 = flow.dispatch.workgroups[%209](%1522, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1534 = flow.dispatch.workgroups[%275, %265](%1532, %276, %1533, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1535 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c14_i64 = arith.constant 14 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c14_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1536 = flow.tensor.reshape %1535 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1537 = flow.tensor.reshape %1534 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1538 = flow.dispatch.workgroups[%283](%283, %1537) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1539 = flow.tensor.reshape %1538 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1540 = flow.dispatch.workgroups[%264, %211, %287](%1539, %1536, %1457, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1457{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1541 = flow.dispatch.workgroups[%279](%279, %1535) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1542 = flow.tensor.reshape %1541 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1543 = flow.tensor.reshape %1529 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1544 = flow.dispatch.workgroups[%292](%292, %1543) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1545 = flow.tensor.reshape %1544 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1546 = flow.dispatch.workgroups[%257, %211, %287](%1545, %1542, %1540, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1540{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1547 = flow.dispatch.workgroups[%275, %265](%1530, %276, %1531, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1548 = flow.tensor.reshape %1547 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1549 = flow.tensor.reshape %1534 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1550 = flow.tensor.reshape %1529 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1551 = flow.dispatch.workgroups[%265, %209](%265, %1548, %1549, %1550, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1552 = flow.tensor.bitcast %69 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1553 = flow.tensor.bitcast %69 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1554 = flow.dispatch.workgroups(%1553) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1555 = flow.dispatch.workgroups(%1552) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1556 = flow.tensor.bitcast %1555 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1557 = flow.tensor.bitcast %1554 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1558 = flow.tensor.reshape %1551 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1559 = flow.dispatch.workgroups[%223](%1557, %1556, %223, %1558, %1499) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1560 = flow.tensor.reshape %1559 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1561 = flow.dispatch.workgroups[%226](%226, %1560) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1562 = flow.dispatch.workgroups[%223](%223, %1559) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1563 = flow.tensor.reshape %1561 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1564 = flow.dispatch.workgroups[%223](%223, %1563, %1562) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1565 = flow.dispatch.workgroups[%223](%223, %68, %1564) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1566 = flow.tensor.bitcast %67 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1567 = flow.tensor.bitcast %67 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1568 = flow.dispatch.workgroups(%1567) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1569 = flow.dispatch.workgroups(%1566) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1570 = flow.tensor.bitcast %1569 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1571 = flow.tensor.bitcast %1568 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1572 = flow.tensor.bitcast %66 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1573 = flow.dispatch.workgroups(%1572) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1574 = flow.tensor.bitcast %1573 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1575 = flow.tensor.bitcast %66 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1576 = flow.dispatch.workgroups(%1575) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1577 = flow.tensor.bitcast %1576 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1578 = flow.tensor.reshape %1565 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1579 = flow.dispatch.workgroups[%223](%1574, %1577, %223, %1578) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1580 = flow.dispatch.workgroups[%223](%1571, %1570, %223, %1578, %1579) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1581 = flow.tensor.bitcast %65 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1582 = flow.tensor.bitcast %65 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1583 = flow.dispatch.workgroups(%1582) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1584 = flow.dispatch.workgroups(%1581) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1585 = flow.tensor.bitcast %1584 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1586 = flow.tensor.bitcast %1583 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1587 = flow.tensor.reshape %1580 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1588 = flow.dispatch.workgroups[%223](%1586, %1585, %223, %1587, %1559) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1589 = flow.tensor.reshape %1588 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1590 = flow.dispatch.workgroups[%226](%226, %1589) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1591 = flow.dispatch.workgroups[%223](%223, %1588) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1592 = flow.tensor.reshape %1590 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1593 = flow.dispatch.workgroups[%223](%223, %1592, %1591) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1594 = flow.dispatch.workgroups[%223](%223, %64, %1593) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1595 = flow.tensor.bitcast %63 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1596 = flow.tensor.bitcast %63 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1597 = flow.dispatch.workgroups(%1596) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1598 = flow.dispatch.workgroups(%1595) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1599 = flow.tensor.bitcast %1598 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1600 = flow.tensor.bitcast %1597 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1601 = flow.tensor.reshape %1594 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1602 = flow.dispatch.workgroups[%223](%1600, %1599, %223, %1601) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1603 = flow.tensor.reshape %1602 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1604 = flow.tensor.bitcast %62 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1605 = flow.tensor.bitcast %62 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1606 = flow.dispatch.workgroups(%1605) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1607 = flow.dispatch.workgroups(%1604) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1608 = flow.tensor.bitcast %1607 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1609 = flow.tensor.bitcast %1606 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1610 = flow.dispatch.workgroups[%223](%1609, %1608, %223, %1601) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1611 = flow.tensor.reshape %1610 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1612 = flow.tensor.bitcast %61 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1613 = flow.tensor.bitcast %61 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1614 = flow.dispatch.workgroups(%1613) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1615 = flow.dispatch.workgroups(%1612) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1616 = flow.tensor.bitcast %1615 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1617 = flow.tensor.bitcast %1614 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1618 = flow.dispatch.workgroups[%223](%1617, %1616, %223, %1601) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1619 = flow.dispatch.workgroups[%209](%1603, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1620 = flow.dispatch.workgroups[%209](%1603, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1621 = flow.dispatch.workgroups[%209](%1611, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1622 = flow.dispatch.workgroups[%209](%1611, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1623 = flow.dispatch.workgroups[%275, %265](%1621, %276, %1622, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1624 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c15_i64 = arith.constant 15 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c15_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1625 = flow.tensor.reshape %1624 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1626 = flow.tensor.reshape %1623 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1627 = flow.dispatch.workgroups[%283](%283, %1626) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1628 = flow.tensor.reshape %1627 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1629 = flow.dispatch.workgroups[%264, %211, %287](%1628, %1625, %1546, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1546{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1630 = flow.dispatch.workgroups[%279](%279, %1624) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1631 = flow.tensor.reshape %1630 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1632 = flow.tensor.reshape %1618 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1633 = flow.dispatch.workgroups[%292](%292, %1632) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1634 = flow.tensor.reshape %1633 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1635 = flow.dispatch.workgroups[%257, %211, %287](%1634, %1631, %1629, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1629{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1636 = flow.dispatch.workgroups[%275, %265](%1619, %276, %1620, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1637 = flow.tensor.reshape %1636 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1638 = flow.tensor.reshape %1623 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1639 = flow.tensor.reshape %1618 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1640 = flow.dispatch.workgroups[%265, %209](%265, %1637, %1638, %1639, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1641 = flow.tensor.bitcast %60 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1642 = flow.tensor.bitcast %60 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1643 = flow.dispatch.workgroups(%1642) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1644 = flow.dispatch.workgroups(%1641) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1645 = flow.tensor.bitcast %1644 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1646 = flow.tensor.bitcast %1643 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1647 = flow.tensor.reshape %1640 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1648 = flow.dispatch.workgroups[%223](%1646, %1645, %223, %1647, %1588) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1649 = flow.tensor.reshape %1648 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1650 = flow.dispatch.workgroups[%226](%226, %1649) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1651 = flow.dispatch.workgroups[%223](%223, %1648) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1652 = flow.tensor.reshape %1650 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1653 = flow.dispatch.workgroups[%223](%223, %1652, %1651) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1654 = flow.dispatch.workgroups[%223](%223, %59, %1653) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1655 = flow.tensor.bitcast %58 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1656 = flow.tensor.bitcast %58 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1657 = flow.dispatch.workgroups(%1656) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1658 = flow.dispatch.workgroups(%1655) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1659 = flow.tensor.bitcast %1658 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1660 = flow.tensor.bitcast %1657 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1661 = flow.tensor.bitcast %57 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1662 = flow.dispatch.workgroups(%1661) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1663 = flow.tensor.bitcast %1662 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1664 = flow.tensor.bitcast %57 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1665 = flow.dispatch.workgroups(%1664) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1666 = flow.tensor.bitcast %1665 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1667 = flow.tensor.reshape %1654 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1668 = flow.dispatch.workgroups[%223](%1663, %1666, %223, %1667) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1669 = flow.dispatch.workgroups[%223](%1660, %1659, %223, %1667, %1668) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1670 = flow.tensor.bitcast %56 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1671 = flow.tensor.bitcast %56 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1672 = flow.dispatch.workgroups(%1671) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1673 = flow.dispatch.workgroups(%1670) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1674 = flow.tensor.bitcast %1673 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1675 = flow.tensor.bitcast %1672 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1676 = flow.tensor.reshape %1669 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1677 = flow.dispatch.workgroups[%223](%1675, %1674, %223, %1676, %1648) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1678 = flow.tensor.reshape %1677 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1679 = flow.dispatch.workgroups[%226](%226, %1678) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1680 = flow.dispatch.workgroups[%223](%223, %1677) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1681 = flow.tensor.reshape %1679 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1682 = flow.dispatch.workgroups[%223](%223, %1681, %1680) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1683 = flow.dispatch.workgroups[%223](%223, %55, %1682) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1684 = flow.tensor.bitcast %54 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1685 = flow.tensor.bitcast %54 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1686 = flow.dispatch.workgroups(%1685) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1687 = flow.dispatch.workgroups(%1684) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1688 = flow.tensor.bitcast %1687 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1689 = flow.tensor.bitcast %1686 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1690 = flow.tensor.reshape %1683 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1691 = flow.dispatch.workgroups[%223](%1689, %1688, %223, %1690) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1692 = flow.tensor.reshape %1691 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1693 = flow.tensor.bitcast %53 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1694 = flow.tensor.bitcast %53 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1695 = flow.dispatch.workgroups(%1694) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1696 = flow.dispatch.workgroups(%1693) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1697 = flow.tensor.bitcast %1696 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1698 = flow.tensor.bitcast %1695 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1699 = flow.dispatch.workgroups[%223](%1698, %1697, %223, %1690) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1700 = flow.tensor.reshape %1699 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1701 = flow.tensor.bitcast %52 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1702 = flow.tensor.bitcast %52 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1703 = flow.dispatch.workgroups(%1702) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1704 = flow.dispatch.workgroups(%1701) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1705 = flow.tensor.bitcast %1704 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1706 = flow.tensor.bitcast %1703 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1707 = flow.dispatch.workgroups[%223](%1706, %1705, %223, %1690) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1708 = flow.dispatch.workgroups[%209](%1692, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1709 = flow.dispatch.workgroups[%209](%1692, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1710 = flow.dispatch.workgroups[%209](%1700, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1711 = flow.dispatch.workgroups[%209](%1700, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1712 = flow.dispatch.workgroups[%275, %265](%1710, %276, %1711, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1713 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c16_i64 = arith.constant 16 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c16_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1714 = flow.tensor.reshape %1713 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1715 = flow.tensor.reshape %1712 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1716 = flow.dispatch.workgroups[%283](%283, %1715) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1717 = flow.tensor.reshape %1716 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1718 = flow.dispatch.workgroups[%264, %211, %287](%1717, %1714, %1635, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1635{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1719 = flow.dispatch.workgroups[%279](%279, %1713) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1720 = flow.tensor.reshape %1719 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1721 = flow.tensor.reshape %1707 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1722 = flow.dispatch.workgroups[%292](%292, %1721) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1723 = flow.tensor.reshape %1722 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1724 = flow.dispatch.workgroups[%257, %211, %287](%1723, %1720, %1718, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1718{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1725 = flow.dispatch.workgroups[%275, %265](%1708, %276, %1709, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1726 = flow.tensor.reshape %1725 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1727 = flow.tensor.reshape %1712 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1728 = flow.tensor.reshape %1707 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1729 = flow.dispatch.workgroups[%265, %209](%265, %1726, %1727, %1728, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1730 = flow.tensor.bitcast %51 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1731 = flow.tensor.bitcast %51 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1732 = flow.dispatch.workgroups(%1731) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1733 = flow.dispatch.workgroups(%1730) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1734 = flow.tensor.bitcast %1733 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1735 = flow.tensor.bitcast %1732 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1736 = flow.tensor.reshape %1729 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1737 = flow.dispatch.workgroups[%223](%1735, %1734, %223, %1736, %1677) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1738 = flow.tensor.reshape %1737 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1739 = flow.dispatch.workgroups[%226](%226, %1738) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1740 = flow.dispatch.workgroups[%223](%223, %1737) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1741 = flow.tensor.reshape %1739 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1742 = flow.dispatch.workgroups[%223](%223, %1741, %1740) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1743 = flow.dispatch.workgroups[%223](%223, %50, %1742) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1744 = flow.tensor.bitcast %49 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1745 = flow.tensor.bitcast %49 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1746 = flow.dispatch.workgroups(%1745) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1747 = flow.dispatch.workgroups(%1744) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1748 = flow.tensor.bitcast %1747 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1749 = flow.tensor.bitcast %1746 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1750 = flow.tensor.bitcast %48 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1751 = flow.dispatch.workgroups(%1750) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1752 = flow.tensor.bitcast %1751 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1753 = flow.tensor.bitcast %48 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1754 = flow.dispatch.workgroups(%1753) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1755 = flow.tensor.bitcast %1754 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1756 = flow.tensor.reshape %1743 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1757 = flow.dispatch.workgroups[%223](%1752, %1755, %223, %1756) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1758 = flow.dispatch.workgroups[%223](%1749, %1748, %223, %1756, %1757) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1759 = flow.tensor.bitcast %47 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1760 = flow.tensor.bitcast %47 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1761 = flow.dispatch.workgroups(%1760) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1762 = flow.dispatch.workgroups(%1759) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1763 = flow.tensor.bitcast %1762 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1764 = flow.tensor.bitcast %1761 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1765 = flow.tensor.reshape %1758 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1766 = flow.dispatch.workgroups[%223](%1764, %1763, %223, %1765, %1737) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1767 = flow.tensor.reshape %1766 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1768 = flow.dispatch.workgroups[%226](%226, %1767) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1769 = flow.dispatch.workgroups[%223](%223, %1766) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1770 = flow.tensor.reshape %1768 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1771 = flow.dispatch.workgroups[%223](%223, %1770, %1769) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1772 = flow.dispatch.workgroups[%223](%223, %46, %1771) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1773 = flow.tensor.bitcast %45 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1774 = flow.tensor.bitcast %45 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1775 = flow.dispatch.workgroups(%1774) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1776 = flow.dispatch.workgroups(%1773) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1777 = flow.tensor.bitcast %1776 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1778 = flow.tensor.bitcast %1775 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1779 = flow.tensor.reshape %1772 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1780 = flow.dispatch.workgroups[%223](%1778, %1777, %223, %1779) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1781 = flow.tensor.reshape %1780 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1782 = flow.tensor.bitcast %44 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1783 = flow.tensor.bitcast %44 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1784 = flow.dispatch.workgroups(%1783) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1785 = flow.dispatch.workgroups(%1782) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1786 = flow.tensor.bitcast %1785 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1787 = flow.tensor.bitcast %1784 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1788 = flow.dispatch.workgroups[%223](%1787, %1786, %223, %1779) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1789 = flow.tensor.reshape %1788 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1790 = flow.tensor.bitcast %43 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1791 = flow.tensor.bitcast %43 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1792 = flow.dispatch.workgroups(%1791) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1793 = flow.dispatch.workgroups(%1790) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1794 = flow.tensor.bitcast %1793 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1795 = flow.tensor.bitcast %1792 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1796 = flow.dispatch.workgroups[%223](%1795, %1794, %223, %1779) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1797 = flow.dispatch.workgroups[%209](%1781, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1798 = flow.dispatch.workgroups[%209](%1781, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1799 = flow.dispatch.workgroups[%209](%1789, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1800 = flow.dispatch.workgroups[%209](%1789, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1801 = flow.dispatch.workgroups[%275, %265](%1799, %276, %1800, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1802 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c17_i64 = arith.constant 17 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c17_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1803 = flow.tensor.reshape %1802 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1804 = flow.tensor.reshape %1801 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1805 = flow.dispatch.workgroups[%283](%283, %1804) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1806 = flow.tensor.reshape %1805 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1807 = flow.dispatch.workgroups[%264, %211, %287](%1806, %1803, %1724, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1724{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1808 = flow.dispatch.workgroups[%279](%279, %1802) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1809 = flow.tensor.reshape %1808 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1810 = flow.tensor.reshape %1796 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1811 = flow.dispatch.workgroups[%292](%292, %1810) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1812 = flow.tensor.reshape %1811 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1813 = flow.dispatch.workgroups[%257, %211, %287](%1812, %1809, %1807, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1807{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1814 = flow.dispatch.workgroups[%275, %265](%1797, %276, %1798, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1815 = flow.tensor.reshape %1814 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1816 = flow.tensor.reshape %1801 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1817 = flow.tensor.reshape %1796 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1818 = flow.dispatch.workgroups[%265, %209](%265, %1815, %1816, %1817, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1819 = flow.tensor.bitcast %42 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1820 = flow.tensor.bitcast %42 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1821 = flow.dispatch.workgroups(%1820) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1822 = flow.dispatch.workgroups(%1819) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1823 = flow.tensor.bitcast %1822 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1824 = flow.tensor.bitcast %1821 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1825 = flow.tensor.reshape %1818 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1826 = flow.dispatch.workgroups[%223](%1824, %1823, %223, %1825, %1766) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1827 = flow.tensor.reshape %1826 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1828 = flow.dispatch.workgroups[%226](%226, %1827) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1829 = flow.dispatch.workgroups[%223](%223, %1826) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1830 = flow.tensor.reshape %1828 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1831 = flow.dispatch.workgroups[%223](%223, %1830, %1829) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1832 = flow.dispatch.workgroups[%223](%223, %41, %1831) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1833 = flow.tensor.bitcast %40 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1834 = flow.tensor.bitcast %40 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1835 = flow.dispatch.workgroups(%1834) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1836 = flow.dispatch.workgroups(%1833) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1837 = flow.tensor.bitcast %1836 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1838 = flow.tensor.bitcast %1835 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1839 = flow.tensor.bitcast %39 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1840 = flow.dispatch.workgroups(%1839) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1841 = flow.tensor.bitcast %1840 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1842 = flow.tensor.bitcast %39 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1843 = flow.dispatch.workgroups(%1842) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1844 = flow.tensor.bitcast %1843 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1845 = flow.tensor.reshape %1832 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1846 = flow.dispatch.workgroups[%223](%1841, %1844, %223, %1845) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1847 = flow.dispatch.workgroups[%223](%1838, %1837, %223, %1845, %1846) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1848 = flow.tensor.bitcast %38 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1849 = flow.tensor.bitcast %38 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1850 = flow.dispatch.workgroups(%1849) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1851 = flow.dispatch.workgroups(%1848) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1852 = flow.tensor.bitcast %1851 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1853 = flow.tensor.bitcast %1850 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1854 = flow.tensor.reshape %1847 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1855 = flow.dispatch.workgroups[%223](%1853, %1852, %223, %1854, %1826) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1856 = flow.tensor.reshape %1855 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1857 = flow.dispatch.workgroups[%226](%226, %1856) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1858 = flow.dispatch.workgroups[%223](%223, %1855) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1859 = flow.tensor.reshape %1857 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1860 = flow.dispatch.workgroups[%223](%223, %1859, %1858) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1861 = flow.dispatch.workgroups[%223](%223, %37, %1860) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1862 = flow.tensor.bitcast %36 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1863 = flow.tensor.bitcast %36 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1864 = flow.dispatch.workgroups(%1863) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1865 = flow.dispatch.workgroups(%1862) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1866 = flow.tensor.bitcast %1865 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1867 = flow.tensor.bitcast %1864 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1868 = flow.tensor.reshape %1861 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1869 = flow.dispatch.workgroups[%223](%1867, %1866, %223, %1868) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1870 = flow.tensor.reshape %1869 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1871 = flow.tensor.bitcast %35 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1872 = flow.tensor.bitcast %35 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1873 = flow.dispatch.workgroups(%1872) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1874 = flow.dispatch.workgroups(%1871) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1875 = flow.tensor.bitcast %1874 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1876 = flow.tensor.bitcast %1873 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1877 = flow.dispatch.workgroups[%223](%1876, %1875, %223, %1868) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1878 = flow.tensor.reshape %1877 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1879 = flow.tensor.bitcast %34 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1880 = flow.tensor.bitcast %34 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1881 = flow.dispatch.workgroups(%1880) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1882 = flow.dispatch.workgroups(%1879) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1883 = flow.tensor.bitcast %1882 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1884 = flow.tensor.bitcast %1881 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1885 = flow.dispatch.workgroups[%223](%1884, %1883, %223, %1868) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1886 = flow.dispatch.workgroups[%209](%1870, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1887 = flow.dispatch.workgroups[%209](%1870, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1888 = flow.dispatch.workgroups[%209](%1878, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1889 = flow.dispatch.workgroups[%209](%1878, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1890 = flow.dispatch.workgroups[%275, %265](%1888, %276, %1889, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1891 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c18_i64 = arith.constant 18 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c18_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1892 = flow.tensor.reshape %1891 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1893 = flow.tensor.reshape %1890 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1894 = flow.dispatch.workgroups[%283](%283, %1893) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1895 = flow.tensor.reshape %1894 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1896 = flow.dispatch.workgroups[%264, %211, %287](%1895, %1892, %1813, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1813{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1897 = flow.dispatch.workgroups[%279](%279, %1891) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1898 = flow.tensor.reshape %1897 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1899 = flow.tensor.reshape %1885 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1900 = flow.dispatch.workgroups[%292](%292, %1899) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1901 = flow.tensor.reshape %1900 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1902 = flow.dispatch.workgroups[%257, %211, %287](%1901, %1898, %1896, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1896{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1903 = flow.dispatch.workgroups[%275, %265](%1886, %276, %1887, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1904 = flow.tensor.reshape %1903 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1905 = flow.tensor.reshape %1890 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1906 = flow.tensor.reshape %1885 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1907 = flow.dispatch.workgroups[%265, %209](%265, %1904, %1905, %1906, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1908 = flow.tensor.bitcast %33 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1909 = flow.tensor.bitcast %33 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1910 = flow.dispatch.workgroups(%1909) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1911 = flow.dispatch.workgroups(%1908) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1912 = flow.tensor.bitcast %1911 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1913 = flow.tensor.bitcast %1910 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1914 = flow.tensor.reshape %1907 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %1915 = flow.dispatch.workgroups[%223](%1913, %1912, %223, %1914, %1855) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1916 = flow.tensor.reshape %1915 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1917 = flow.dispatch.workgroups[%226](%226, %1916) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1918 = flow.dispatch.workgroups[%223](%223, %1915) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1919 = flow.tensor.reshape %1917 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1920 = flow.dispatch.workgroups[%223](%223, %1919, %1918) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1921 = flow.dispatch.workgroups[%223](%223, %32, %1920) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1922 = flow.tensor.bitcast %31 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1923 = flow.tensor.bitcast %31 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1924 = flow.dispatch.workgroups(%1923) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1925 = flow.dispatch.workgroups(%1922) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1926 = flow.tensor.bitcast %1925 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1927 = flow.tensor.bitcast %1924 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1928 = flow.tensor.bitcast %30 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1929 = flow.dispatch.workgroups(%1928) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1930 = flow.tensor.bitcast %1929 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1931 = flow.tensor.bitcast %30 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1932 = flow.dispatch.workgroups(%1931) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1933 = flow.tensor.bitcast %1932 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1934 = flow.tensor.reshape %1921 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1935 = flow.dispatch.workgroups[%223](%1930, %1933, %223, %1934) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1936 = flow.dispatch.workgroups[%223](%1927, %1926, %223, %1934, %1935) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1937 = flow.tensor.bitcast %29 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1938 = flow.tensor.bitcast %29 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1939 = flow.dispatch.workgroups(%1938) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1940 = flow.dispatch.workgroups(%1937) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1941 = flow.tensor.bitcast %1940 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1942 = flow.tensor.bitcast %1939 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1943 = flow.tensor.reshape %1936 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %1944 = flow.dispatch.workgroups[%223](%1942, %1941, %223, %1943, %1915) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1945 = flow.tensor.reshape %1944 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %1946 = flow.dispatch.workgroups[%226](%226, %1945) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1947 = flow.dispatch.workgroups[%223](%223, %1944) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1948 = flow.tensor.reshape %1946 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %1949 = flow.dispatch.workgroups[%223](%223, %1948, %1947) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1950 = flow.dispatch.workgroups[%223](%223, %28, %1949) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1951 = flow.tensor.bitcast %27 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1952 = flow.tensor.bitcast %27 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1953 = flow.dispatch.workgroups(%1952) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1954 = flow.dispatch.workgroups(%1951) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1955 = flow.tensor.bitcast %1954 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1956 = flow.tensor.bitcast %1953 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1957 = flow.tensor.reshape %1950 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %1958 = flow.dispatch.workgroups[%223](%1956, %1955, %223, %1957) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1959 = flow.tensor.reshape %1958 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %1960 = flow.tensor.bitcast %26 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1961 = flow.tensor.bitcast %26 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1962 = flow.dispatch.workgroups(%1961) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1963 = flow.dispatch.workgroups(%1960) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1964 = flow.tensor.bitcast %1963 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1965 = flow.tensor.bitcast %1962 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1966 = flow.dispatch.workgroups[%223](%1965, %1964, %223, %1957) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1967 = flow.tensor.reshape %1966 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1968 = flow.tensor.bitcast %25 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1969 = flow.tensor.bitcast %25 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1970 = flow.dispatch.workgroups(%1969) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1971 = flow.dispatch.workgroups(%1968) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1972 = flow.tensor.bitcast %1971 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1973 = flow.tensor.bitcast %1970 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1974 = flow.dispatch.workgroups[%223](%1973, %1972, %223, %1957) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1975 = flow.dispatch.workgroups[%209](%1959, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1976 = flow.dispatch.workgroups[%209](%1959, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1977 = flow.dispatch.workgroups[%209](%1967, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1978 = flow.dispatch.workgroups[%209](%1967, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1979 = flow.dispatch.workgroups[%275, %265](%1977, %276, %1978, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1980 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c19_i64 = arith.constant 19 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c19_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1981 = flow.tensor.reshape %1980 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1982 = flow.tensor.reshape %1979 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %1983 = flow.dispatch.workgroups[%283](%283, %1982) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1984 = flow.tensor.reshape %1983 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %1985 = flow.dispatch.workgroups[%264, %211, %287](%1984, %1981, %1902, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1902{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1986 = flow.dispatch.workgroups[%279](%279, %1980) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1987 = flow.tensor.reshape %1986 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %1988 = flow.tensor.reshape %1974 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %1989 = flow.dispatch.workgroups[%292](%292, %1988) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %1990 = flow.tensor.reshape %1989 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %1991 = flow.dispatch.workgroups[%257, %211, %287](%1990, %1987, %1985, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1985{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1992 = flow.dispatch.workgroups[%275, %265](%1975, %276, %1976, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1993 = flow.tensor.reshape %1992 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %1994 = flow.tensor.reshape %1979 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %1995 = flow.tensor.reshape %1974 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %1996 = flow.dispatch.workgroups[%265, %209](%265, %1993, %1994, %1995, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1997 = flow.tensor.bitcast %24 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1998 = flow.tensor.bitcast %24 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1999 = flow.dispatch.workgroups(%1998) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2000 = flow.dispatch.workgroups(%1997) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2001 = flow.tensor.bitcast %2000 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2002 = flow.tensor.bitcast %1999 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2003 = flow.tensor.reshape %1996 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %2004 = flow.dispatch.workgroups[%223](%2002, %2001, %223, %2003, %1944) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2005 = flow.tensor.reshape %2004 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %2006 = flow.dispatch.workgroups[%226](%226, %2005) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2007 = flow.dispatch.workgroups[%223](%223, %2004) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2008 = flow.tensor.reshape %2006 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %2009 = flow.dispatch.workgroups[%223](%223, %2008, %2007) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2010 = flow.dispatch.workgroups[%223](%223, %23, %2009) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2011 = flow.tensor.bitcast %22 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2012 = flow.tensor.bitcast %22 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2013 = flow.dispatch.workgroups(%2012) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2014 = flow.dispatch.workgroups(%2011) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2015 = flow.tensor.bitcast %2014 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2016 = flow.tensor.bitcast %2013 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2017 = flow.tensor.bitcast %21 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2018 = flow.dispatch.workgroups(%2017) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2019 = flow.tensor.bitcast %2018 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2020 = flow.tensor.bitcast %21 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2021 = flow.dispatch.workgroups(%2020) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2022 = flow.tensor.bitcast %2021 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2023 = flow.tensor.reshape %2010 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %2024 = flow.dispatch.workgroups[%223](%2019, %2022, %223, %2023) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2025 = flow.dispatch.workgroups[%223](%2016, %2015, %223, %2023, %2024) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2026 = flow.tensor.bitcast %20 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %2027 = flow.tensor.bitcast %20 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %2028 = flow.dispatch.workgroups(%2027) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2029 = flow.dispatch.workgroups(%2026) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2030 = flow.tensor.bitcast %2029 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2031 = flow.tensor.bitcast %2028 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %2032 = flow.tensor.reshape %2025 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %2033 = flow.dispatch.workgroups[%223](%2031, %2030, %223, %2032, %2004) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2034 = flow.tensor.reshape %2033 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %2035 = flow.dispatch.workgroups[%226](%226, %2034) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2036 = flow.dispatch.workgroups[%223](%223, %2033) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2037 = flow.tensor.reshape %2035 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %2038 = flow.dispatch.workgroups[%223](%223, %2037, %2036) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2039 = flow.dispatch.workgroups[%223](%223, %19, %2038) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2040 = flow.tensor.bitcast %18 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %2041 = flow.tensor.bitcast %18 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %2042 = flow.dispatch.workgroups(%2041) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2043 = flow.dispatch.workgroups(%2040) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2044 = flow.tensor.bitcast %2043 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2045 = flow.tensor.bitcast %2042 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2046 = flow.tensor.reshape %2039 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %2047 = flow.dispatch.workgroups[%223](%2045, %2044, %223, %2046) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2048 = flow.tensor.reshape %2047 : tensor<?x2048xf16>{%223} -> tensor<4x?x32x64xf16>{%209}
    %2049 = flow.tensor.bitcast %17 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %2050 = flow.tensor.bitcast %17 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %2051 = flow.dispatch.workgroups(%2050) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2052 = flow.dispatch.workgroups(%2049) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2053 = flow.tensor.bitcast %2052 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2054 = flow.tensor.bitcast %2051 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2055 = flow.dispatch.workgroups[%223](%2054, %2053, %223, %2046) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2056 = flow.tensor.reshape %2055 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %2057 = flow.tensor.bitcast %16 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %2058 = flow.tensor.bitcast %16 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %2059 = flow.dispatch.workgroups(%2058) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2060 = flow.dispatch.workgroups(%2057) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2061 = flow.tensor.bitcast %2060 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2062 = flow.tensor.bitcast %2059 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2063 = flow.dispatch.workgroups[%223](%2062, %2061, %223, %2046) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2064 = flow.dispatch.workgroups[%209](%2048, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2065 = flow.dispatch.workgroups[%209](%2048, %209) : (tensor<4x?x32x64xf16>{%209}, index) -> tensor<4x?x32x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x64xf16>>{%2233} -> tensor<4x?x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : tensor<4x?x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x32x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2066 = flow.dispatch.workgroups[%209](%2056, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2067 = flow.dispatch.workgroups[%209](%2056, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2068 = flow.dispatch.workgroups[%275, %265](%2066, %276, %2067, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2069 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c20_i64 = arith.constant 20 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c20_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2070 = flow.tensor.reshape %2069 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %2071 = flow.tensor.reshape %2068 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %2072 = flow.dispatch.workgroups[%283](%283, %2071) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2073 = flow.tensor.reshape %2072 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %2074 = flow.dispatch.workgroups[%264, %211, %287](%2073, %2070, %1991, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %1991{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2075 = flow.dispatch.workgroups[%279](%279, %2069) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2076 = flow.tensor.reshape %2075 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %2077 = flow.tensor.reshape %2063 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %2078 = flow.dispatch.workgroups[%292](%292, %2077) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2079 = flow.tensor.reshape %2078 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %2080 = flow.dispatch.workgroups[%257, %211, %287](%2079, %2076, %2074, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %2074{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2081 = flow.dispatch.workgroups[%275, %265](%2064, %276, %2065, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2082 = flow.tensor.reshape %2081 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %2083 = flow.tensor.reshape %2068 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %2084 = flow.tensor.reshape %2063 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %2085 = flow.dispatch.workgroups[%265, %209](%265, %2082, %2083, %2084, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2086 = flow.tensor.bitcast %15 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %2087 = flow.tensor.bitcast %15 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %2088 = flow.dispatch.workgroups(%2087) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2089 = flow.dispatch.workgroups(%2086) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2090 = flow.tensor.bitcast %2089 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2091 = flow.tensor.bitcast %2088 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2092 = flow.tensor.reshape %2085 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %2093 = flow.dispatch.workgroups[%223](%2091, %2090, %223, %2092, %2033) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2094 = flow.tensor.reshape %2093 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %2095 = flow.dispatch.workgroups[%226](%226, %2094) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2096 = flow.dispatch.workgroups[%223](%223, %2093) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2097 = flow.tensor.reshape %2095 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %2098 = flow.dispatch.workgroups[%223](%223, %2097, %2096) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2099 = flow.dispatch.workgroups[%223](%223, %14, %2098) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2100 = flow.tensor.bitcast %13 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2101 = flow.tensor.bitcast %13 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2102 = flow.dispatch.workgroups(%2101) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2103 = flow.dispatch.workgroups(%2100) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2104 = flow.tensor.bitcast %2103 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2105 = flow.tensor.bitcast %2102 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2106 = flow.tensor.bitcast %12 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2107 = flow.dispatch.workgroups(%2106) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2108 = flow.tensor.bitcast %2107 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2109 = flow.tensor.bitcast %12 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2110 = flow.dispatch.workgroups(%2109) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2111 = flow.tensor.bitcast %2110 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2112 = flow.tensor.reshape %2099 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %2113 = flow.dispatch.workgroups[%223](%2108, %2111, %223, %2112) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2114 = flow.dispatch.workgroups[%223](%2105, %2104, %223, %2112, %2113) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2115 = flow.tensor.bitcast %11 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %2116 = flow.tensor.bitcast %11 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %2117 = flow.dispatch.workgroups(%2116) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2118 = flow.dispatch.workgroups(%2115) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2119 = flow.tensor.bitcast %2118 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2120 = flow.tensor.bitcast %2117 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %2121 = flow.tensor.reshape %2114 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %2122 = flow.dispatch.workgroups[%223](%2120, %2119, %223, %2121, %2093) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2123 = flow.tensor.reshape %2122 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %2124 = flow.dispatch.workgroups[%226](%226, %2123) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2125 = flow.dispatch.workgroups[%223](%223, %2122) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2126 = flow.tensor.reshape %2124 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %2127 = flow.dispatch.workgroups[%223](%223, %2126, %2125) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2128 = flow.dispatch.workgroups[%223](%223, %10, %2127) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2129 = flow.tensor.bitcast %9 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %2130 = flow.tensor.bitcast %9 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %2131 = flow.dispatch.workgroups(%2130) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2132 = flow.dispatch.workgroups(%2129) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2133 = flow.tensor.bitcast %2132 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2134 = flow.tensor.bitcast %2131 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2135 = flow.tensor.reshape %2128 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %2136 = flow.dispatch.workgroups[%223](%2134, %2133, %223, %2135) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<2048x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<2048x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x2048xf32>
      %2242 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x2048xf32>) outs(%2242 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2137 = flow.tensor.reshape %2136 : tensor<?x2048xf16>{%223} -> tensor<4x?x4x8x64xf16>{%209}
    %2138 = flow.tensor.bitcast %8 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %2139 = flow.tensor.bitcast %8 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %2140 = flow.dispatch.workgroups(%2139) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2141 = flow.dispatch.workgroups(%2138) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2142 = flow.tensor.bitcast %2141 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2143 = flow.tensor.bitcast %2140 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2144 = flow.dispatch.workgroups[%223](%2143, %2142, %223, %2135) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2145 = flow.tensor.reshape %2144 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %2146 = flow.tensor.bitcast %7 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %2147 = flow.tensor.bitcast %7 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %2148 = flow.dispatch.workgroups(%2147) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2149 = flow.dispatch.workgroups(%2146) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2150 = flow.tensor.bitcast %2149 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2151 = flow.tensor.bitcast %2148 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2152 = flow.dispatch.workgroups[%223](%2151, %2150, %223, %2135) : (tensor<256x64xf16>, tensor<256x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x256xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<256x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2237 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<256x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x256xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x256xf32>) -> tensor<?x256xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<256x64x32xf16>) outs(%2240 : tensor<?x256xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x256xf32>
      %2242 = tensor.empty(%2233) : tensor<?x256xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x256xf32>) outs(%2242 : tensor<?x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 256], strides = [1, 1] : tensor<?x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x256xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2153 = flow.dispatch.workgroups[%209](%2145, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2154 = flow.dispatch.workgroups[%209](%2145, %209) : (tensor<4x?x4x64xf16>{%209}, index) -> tensor<4x?x4x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 1], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : tensor<4x?x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2155 = flow.dispatch.workgroups[%275, %265](%2153, %276, %2154, %277, %275, %265) : (tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x4x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x?x4x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32xf16>>{%2233} -> tensor<4x?x4x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x?x4x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map9, #map10, #map9, #map10, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x4x32xf16>, tensor<?x32xf16>, tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x?x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x?x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2234, 4, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2156 = flow.dispatch.workgroups[%279](%279, %281#0) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c21_i64 = arith.constant 21 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c21_i64 : i64
        %2238 = arith.muli %2237, %c2_i64 : i64
        linalg.yield %2238 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2157 = flow.tensor.reshape %2156 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %2158 = flow.tensor.reshape %2155 : tensor<4x?x4x2x32xf16>{%265} -> tensor<?x32x4x64xf16>{%283}
    %2159 = flow.dispatch.workgroups[%283](%283, %2158) : (index, tensor<?x32x4x64xf16>{%283}) -> tensor<?x4x32x64xf16>{%283} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2160 = flow.tensor.reshape %2159 : tensor<?x4x32x64xf16>{%283} -> tensor<4x?x4x32x2x1x32xf16>{%264}
    %2161 = flow.dispatch.workgroups[%264, %211, %287](%2160, %2157, %2080, %264, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%264}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %2080{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2162 = flow.dispatch.workgroups[%279](%279, %2156) : (index, tensor<?xi64>{%279}) -> tensor<?xi64>{%279} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xi64>>{%2233} -> tensor<?xi64>
      %2235 = tensor.empty(%2233) : tensor<?xi64>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xi64>) outs(%2235 : tensor<?xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2237 = arith.addi %in, %c1_i64 : i64
        linalg.yield %2237 : i64
      } -> tensor<?xi64>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xi64>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2163 = flow.tensor.reshape %2162 : tensor<?xi64>{%279} -> tensor<4x?xi64>{%211}
    %2164 = flow.tensor.reshape %2152 : tensor<?x256xf16>{%223} -> tensor<?x32x4x64xf16>{%292}
    %2165 = flow.dispatch.workgroups[%292](%292, %2164) : (index, tensor<?x32x4x64xf16>{%292}) -> tensor<?x4x32x64xf16>{%292} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [%2233, 32, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32x4x64xf16>>{%2233} -> tensor<?x32x4x64xf16>
      %2235 = tensor.empty(%2233) : tensor<?x4x32x64xf16>
      %2236 = linalg.generic {indexing_maps = [#map12, #map13], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2234 : tensor<?x32x4x64xf16>) outs(%2235 : tensor<?x4x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<?x4x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0, 0, 0, 0], sizes = [%2233, 4, 32, 64], strides = [1, 1, 1, 1] : tensor<?x4x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x4x32x64xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2166 = flow.tensor.reshape %2165 : tensor<?x4x32x64xf16>{%292} -> tensor<4x?x4x32x2x1x32xf16>{%257}
    %2167 = flow.dispatch.workgroups[%257, %211, %287](%2166, %2163, %2161, %257, %211, %287) : (tensor<4x?x4x32x2x1x32xf16>{%257}, tensor<4x?xi64>{%211}, tensor<?x4x32x2x1x32xf16>{%287}, index, index, index) -> %2161{%287} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>, %arg9: index, %arg10: index, %arg11: index) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2235 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 2 : index
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0, 0, 0], sizes = [4, %2233, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x32x2x1x32xf16>>{%2233} -> tensor<4x?x4x32x2x1x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2234], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2234} -> tensor<4x?xi64>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235} -> tensor<?x4x32x2x1x32xf16>
      %2239 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2236, %2237 : tensor<4x?x4x32x2x1x32xf16>, tensor<4x?xi64>) outs(%2238 : tensor<?x4x32x2x1x32xf16>) {
      ^bb0(%arg12: f16, %arg13: f16):
        iree_linalg_ext.yield %arg12 : f16
      } -> tensor<?x4x32x2x1x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2235, 4, 32, 2, 1, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<?x4x32x2x1x32xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x4x32x2x1x32xf16>>{%2235}
      flow.return
    } count(%arg6: index, %arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2168 = flow.tensor.reshape %2167 : tensor<?x4x32x2x1x32xf16>{%287} -> tensor<?x360448xf16>{%213}
    %2169 = flow.dispatch.workgroups[%209](%2137, %209) : (tensor<4x?x4x8x64xf16>{%209}, index) -> tensor<4x?x4x8x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x8x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 32], strides = [1, 1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x8x64xf16>>{%2233} -> tensor<4x?x4x8x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2170 = flow.dispatch.workgroups[%209](%2137, %209) : (tensor<4x?x4x8x64xf16>{%209}, index) -> tensor<4x?x4x8x32xf16>{%209} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x8x64xf16>>, %arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x32xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0, 1], sizes = [4, %2233, 4, 8, 32], strides = [1, 1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x8x64xf16>>{%2233} -> tensor<4x?x4x8x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2234, %arg8, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 32], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x32xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2171 = flow.tensor.reshape %2169 : tensor<4x?x4x8x32xf16>{%209} -> tensor<4x?x32x32xf16>{%275}
    %2172 = flow.tensor.reshape %2170 : tensor<4x?x4x8x32xf16>{%209} -> tensor<4x?x32x32xf16>{%275}
    %2173 = flow.dispatch.workgroups[%275, %265](%2171, %276, %2172, %277, %275, %265) : (tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, tensor<4x?x32x32xf16>{%275}, tensor<?x32xf16>{%265}, index, index) -> tensor<4x32x?x2x32xf16>{%265} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>, %arg10: index, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 32, 32], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x32x32xf16>>{%2233} -> tensor<4x?x32x32xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [%2234, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x32xf16>>{%2234} -> tensor<?x32xf16>
      %2239 = tensor.empty(%2234) : tensor<4x32x?x2x32xf16>
      %2240 = linalg.generic {indexing_maps = [#map14, #map15, #map14, #map15, #map11], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2235, %2236, %2237, %2238 : tensor<4x?x32x32xf16>, tensor<?x32xf16>, tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%2239 : tensor<4x32x?x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2241 = linalg.index 3 : index
        %2242 = arith.mulf %in, %in_2 : f16
        %2243 = arith.mulf %in_1, %in_0 : f16
        %2244 = arith.mulf %in_1, %in_2 : f16
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.addf %2243, %2242 : f16
        %2247 = arith.subf %2245, %2244 : f16
        %2248 = arith.cmpi eq, %2241, %c0 : index
        %2249 = arith.select %2248, %2247, %2246 : f16
        linalg.yield %2249 : f16
      } -> tensor<4x32x?x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2240, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, 32, %2234, 2, 32], strides = [1, 1, 1, 1, 1] : tensor<4x32x?x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x?x2x32xf16>>{%2234}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2174 = flow.tensor.reshape %2173 : tensor<4x32x?x2x32xf16>{%265} -> tensor<4x4x8x?x64xf16>{%265}
    %2175 = flow.tensor.reshape %2155 : tensor<4x?x4x2x32xf16>{%265} -> tensor<4x?x4x64xf16>{%265}
    %2176 = flow.tensor.reshape %2152 : tensor<?x256xf16>{%223} -> tensor<4x?x4x64xf16>{%209}
    %2177 = flow.dispatch.workgroups[%265, %209](%265, %2174, %2175, %2176, %304, %209) : (index, tensor<4x4x8x?x64xf16>{%265}, tensor<4x?x4x64xf16>{%265}, tensor<4x?x4x64xf16>{%209}, tensor<4x4x8x?x?xf16>{%265, %265}, index) -> tensor<4x?x4x8x64xf16>{%265} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>, %arg11: index, %arg12: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>) {
      %cst = arith.constant 1.250000e-01 : f16
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 1 : index
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, 64], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x64xf16>>{%2233} -> tensor<4x4x8x?x64xf16>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0], sizes = [4, %2233, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2233} -> tensor<4x?x4x64xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [4, %2234, 4, 64], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?x4x64xf16>>{%2234} -> tensor<4x?x4x64xf16>
      %2238 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 8, %2233, %2233], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x8x?x?xf16>>{%2233, %2233} -> tensor<4x4x8x?x?xf16>
      %2239 = tensor.empty(%2233) : tensor<4x4x8x?x64xf16>
      %2240 = iree_linalg_ext.attention {indexing_maps = [#map16, #map17, #map18, #map19, #map20, #map21]} ins(%2235, %2236, %2237, %cst, %2238 : tensor<4x4x8x?x64xf16>, tensor<4x?x4x64xf16>, tensor<4x?x4x64xf16>, f16, tensor<4x4x8x?x?xf16>) outs(%2239 : tensor<4x4x8x?x64xf16>) {
      ^bb0(%arg13: f32):
        iree_linalg_ext.yield %arg13 : f32
      } -> tensor<4x4x8x?x64xf16>
      %2241 = tensor.empty(%2233) : tensor<4x?x4x8x64xf16>
      %2242 = linalg.generic {indexing_maps = [#map11, #map22], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x4x8x?x64xf16>) outs(%2241 : tensor<4x?x4x8x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x?x4x8x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2242, %arg12, offsets = [0, 0, 0, 0, 0], sizes = [4, %2233, 4, 8, 64], strides = [1, 1, 1, 1, 1] : tensor<4x?x4x8x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?x4x8x64xf16>>{%2233}
      flow.return
    } count(%arg6: index, %arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6, %arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2178 = flow.tensor.bitcast %6 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %2179 = flow.tensor.bitcast %6 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %2180 = flow.dispatch.workgroups(%2179) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2181 = flow.dispatch.workgroups(%2178) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2182 = flow.tensor.bitcast %2181 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2183 = flow.tensor.bitcast %2180 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2184 = flow.tensor.reshape %2177 : tensor<4x?x4x8x64xf16>{%265} -> tensor<?x64x32xf16>{%223}
    %2185 = flow.dispatch.workgroups[%223](%2183, %2182, %223, %2184, %2122) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2186 = flow.tensor.reshape %2185 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %2187 = flow.dispatch.workgroups[%226](%226, %2186) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2188 = flow.dispatch.workgroups[%223](%223, %2185) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2189 = flow.tensor.reshape %2187 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %2190 = flow.dispatch.workgroups[%223](%223, %2189, %2188) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2191 = flow.dispatch.workgroups[%223](%223, %5, %2190) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2192 = flow.tensor.bitcast %4 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2193 = flow.tensor.bitcast %4 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2194 = flow.dispatch.workgroups(%2193) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2195 = flow.dispatch.workgroups(%2192) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2196 = flow.tensor.bitcast %2195 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2197 = flow.tensor.bitcast %2194 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2198 = flow.tensor.bitcast %3 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2199 = flow.dispatch.workgroups(%2198) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2200 = flow.tensor.bitcast %2199 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2201 = flow.tensor.bitcast %3 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2202 = flow.dispatch.workgroups(%2201) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2203 = flow.tensor.bitcast %2202 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2204 = flow.tensor.reshape %2191 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %2205 = flow.dispatch.workgroups[%223](%2200, %2203, %223, %2204) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<5632x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2237 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<5632x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2240 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x5632xf32>
      %2242 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x5632xf32>) outs(%2242 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2206 = flow.dispatch.workgroups[%223](%2197, %2196, %223, %2204, %2205) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, index, tensor<?x64x32xf16>{%223}, tensor<?x5632xf16>{%223}) -> tensor<?x5632xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>) {
      %cst = arith.constant 1.000000e+00 : f16
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x5632xf16>>{%2233} -> tensor<?x5632xf16>
      %2238 = tensor.empty() : tensor<5632x64x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2238 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2245 = arith.extsi %in_1 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<5632x64x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x5632xf32>
      %2241 = linalg.fill ins(%cst_0 : f32) outs(%2240 : tensor<?x5632xf32>) -> tensor<?x5632xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2241 : tensor<?x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2245 = arith.mulf %in, %in_1 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x5632xf32>
      %2243 = tensor.empty(%2233) : tensor<?x5632xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2242, %2237 : tensor<?x5632xf32>, tensor<?x5632xf16>) outs(%2243 : tensor<?x5632xf16>) {
      ^bb0(%in: f32, %in_1: f16, %out: f16):
        %2245 = arith.truncf %in : f32 to f16
        %2246 = arith.negf %2245 : f16
        %2247 = math.exp %2246 : f16
        %2248 = arith.addf %2247, %cst : f16
        %2249 = arith.divf %cst, %2248 : f16
        %2250 = arith.mulf %2249, %2245 : f16
        %2251 = arith.mulf %2250, %in_1 : f16
        linalg.yield %2251 : f16
      } -> tensor<?x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 5632], strides = [1, 1] : tensor<?x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x5632xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2207 = flow.tensor.bitcast %2 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %2208 = flow.tensor.bitcast %2 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %2209 = flow.dispatch.workgroups(%2208) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2210 = flow.dispatch.workgroups(%2207) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2211 = flow.tensor.bitcast %2210 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2212 = flow.tensor.bitcast %2209 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %2213 = flow.tensor.reshape %2206 : tensor<?x5632xf16>{%223} -> tensor<?x176x32xf16>{%223}
    %2214 = flow.dispatch.workgroups[%223](%2212, %2211, %223, %2213, %2185) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, index, tensor<?x176x32xf16>{%223}, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x176x32xf16>>{%2233} -> tensor<?x176x32xf16>
      %2237 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2238 = tensor.empty() : tensor<2048x176x32xf16>
      %2239 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2238 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2245 = arith.extsi %in_0 : i8 to i32
        %2246 = arith.sitofp %2245 : i32 to f16
        %2247 = arith.mulf %2246, %in : f16
        linalg.yield %2247 : f16
      } -> tensor<2048x176x32xf16>
      %2240 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2241 = linalg.fill ins(%cst : f32) outs(%2240 : tensor<?x2048xf32>) -> tensor<?x2048xf32>
      %2242 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2239 : tensor<?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2241 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2245 = arith.mulf %in, %in_0 : f16
        %2246 = arith.extf %2245 : f16 to f32
        %2247 = arith.addf %2246, %out : f32
        linalg.yield %2247 : f32
      } -> tensor<?x2048xf32>
      %2243 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2244 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<?x2048xf16>, tensor<?x2048xf32>) outs(%2243 : tensor<?x2048xf16>) {
      ^bb0(%in: f16, %in_0: f32, %out: f16):
        %2245 = arith.truncf %in_0 : f32 to f16
        %2246 = arith.addf %in, %2245 : f16
        linalg.yield %2246 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2244, %arg11, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2215 = flow.tensor.reshape %2214 : tensor<?x2048xf16>{%223} -> tensor<?xf16>{%226}
    %2216 = flow.dispatch.workgroups[%226](%226, %2215) : (index, tensor<?xf16>{%226}) -> tensor<?xf32>{%226} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf16>>{%2233} -> tensor<?xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2234 : tensor<?xf16>) outs(%2235 : tensor<?xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2237 = arith.extf %in : f16 to f32
        linalg.yield %2237 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2236, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2217 = flow.dispatch.workgroups[%223](%223, %2214) : (index, tensor<?x2048xf16>{%223}) -> tensor<?xf32>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>) {
      %c2_i64 = arith.constant 2 : i64
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2235 = tensor.empty(%2233) : tensor<?xf32>
      %2236 = linalg.fill ins(%cst : f32) outs(%2235 : tensor<?xf32>) -> tensor<?xf32>
      %2237 = tensor.empty(%2233) : tensor<?x2048xf32>
      %2238 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<?x2048xf16>) outs(%2237 : tensor<?x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2240 = arith.extf %in : f16 to f32
        linalg.yield %2240 : f32
      } -> tensor<?x2048xf32>
      %2239 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<?x2048xf32>) outs(%2236 : tensor<?xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2240 = math.fpowi %in, %c2_i64 : f32, i64
        %2241 = arith.addf %2240, %out : f32
        linalg.yield %2241 : f32
      } -> tensor<?xf32>
      iree_tensor_ext.dispatch.tensor.store %2239, %arg8, offsets = [0], sizes = [%2233], strides = [1] : tensor<?xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?xf32>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2218 = flow.tensor.reshape %2216 : tensor<?xf32>{%226} -> tensor<?x2048xf32>{%223}
    %2219 = flow.dispatch.workgroups[%223](%223, %2218, %2217) : (index, tensor<?x2048xf32>{%223}, tensor<?xf32>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %cst = arith.constant 9.99999974E-6 : f32
      %cst_0 = arith.constant 2.048000e+03 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf32>>{%2233} -> tensor<?x2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [%2233], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?xf32>>{%2233} -> tensor<?xf32>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<?x2048xf32>, tensor<?xf32>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_1: f32, %out: f16):
        %2238 = arith.divf %in_1, %cst_0 : f32
        %2239 = arith.addf %2238, %cst : f32
        %2240 = math.rsqrt %2239 : f32
        %2241 = arith.mulf %in, %2240 : f32
        %2242 = arith.truncf %2241 : f32 to f16
        linalg.yield %2242 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2220 = flow.dispatch.workgroups[%223](%223, %1, %2219) : (index, tensor<2048xf32>, tensor<?x2048xf16>{%223}) -> tensor<?x2048xf16>{%223} =
        (%arg6: index, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>) {
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg6, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x2048xf16>>{%2233} -> tensor<?x2048xf16>
      %2236 = tensor.empty(%2233) : tensor<?x2048xf16>
      %2237 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2234, %2235 : tensor<2048xf32>, tensor<?x2048xf16>) outs(%2236 : tensor<?x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2238 = arith.extf %in_0 : f16 to f32
        %2239 = arith.mulf %in, %2238 : f32
        %2240 = arith.truncf %2239 : f32 to f16
        linalg.yield %2240 : f16
      } -> tensor<?x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2237, %arg9, offsets = [0, 0], sizes = [%2233, 2048], strides = [1, 1] : tensor<?x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x2048xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2221 = flow.tensor.bitcast %0 : tensor<32000x2176xi8> -> tensor<32000x64x17xi16>
    %2222 = flow.tensor.bitcast %0 : tensor<32000x2176xi8> -> tensor<32000x64x1x17xi16>
    %2223 = flow.dispatch.workgroups(%2222) : (tensor<32000x64x1x17xi16>) -> tensor<32000x64x1xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 0, 0], sizes = [32000, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>> -> tensor<32000x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [32000, 64, 1], strides = [1, 1, 1] : tensor<32000x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2224 = flow.dispatch.workgroups(%2221) : (tensor<32000x64x17xi16>) -> tensor<32000x64x16xi16> =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>>, %arg7: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>) {
      %2233 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0, 1], sizes = [32000, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>> -> tensor<32000x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2233, %arg7, offsets = [0, 0, 0], sizes = [32000, 64, 16], strides = [1, 1, 1] : tensor<32000x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2225 = flow.tensor.bitcast %2224 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %2226 = flow.tensor.bitcast %2223 : tensor<32000x64x1xi16> -> tensor<32000x64xf16>
    %2227 = flow.tensor.reshape %2220 : tensor<?x2048xf16>{%223} -> tensor<?x64x32xf16>{%223}
    %2228 = flow.dispatch.workgroups[%223](%2226, %2225, %223, %2227) : (tensor<32000x64xf16>, tensor<32000x64x32xi8>, index, tensor<?x64x32xf16>{%223}) -> tensor<?x32000xf16>{%223} =
        (%arg6: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64xf16>>, %arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x32xi8>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x32000xf16>>) {
      %cst = arith.constant 0.000000e+00 : f32
      %2233 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2234 = iree_tensor_ext.dispatch.tensor.load %arg6, offsets = [0, 0], sizes = [32000, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64xf16>> -> tensor<32000x64xf16>
      %2235 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [32000, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x32xi8>> -> tensor<32000x64x32xi8>
      %2236 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [%2233, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x64x32xf16>>{%2233} -> tensor<?x64x32xf16>
      %2237 = tensor.empty() : tensor<32000x64x32xf16>
      %2238 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<32000x64xf16>, tensor<32000x64x32xi8>) outs(%2237 : tensor<32000x64x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2244 = arith.extsi %in_0 : i8 to i32
        %2245 = arith.sitofp %2244 : i32 to f16
        %2246 = arith.mulf %2245, %in : f16
        linalg.yield %2246 : f16
      } -> tensor<32000x64x32xf16>
      %2239 = tensor.empty(%2233) : tensor<?x32000xf32>
      %2240 = linalg.fill ins(%cst : f32) outs(%2239 : tensor<?x32000xf32>) -> tensor<?x32000xf32>
      %2241 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2236, %2238 : tensor<?x64x32xf16>, tensor<32000x64x32xf16>) outs(%2240 : tensor<?x32000xf32>) {
      ^bb0(%in: f16, %in_0: f16, %out: f32):
        %2244 = arith.mulf %in, %in_0 : f16
        %2245 = arith.extf %2244 : f16 to f32
        %2246 = arith.addf %2245, %out : f32
        linalg.yield %2246 : f32
      } -> tensor<?x32000xf32>
      %2242 = tensor.empty(%2233) : tensor<?x32000xf16>
      %2243 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2241 : tensor<?x32000xf32>) outs(%2242 : tensor<?x32000xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2244 = arith.truncf %in : f32 to f16
        linalg.yield %2244 : f16
      } -> tensor<?x32000xf16>
      iree_tensor_ext.dispatch.tensor.store %2243, %arg10, offsets = [0, 0], sizes = [%2233, 32000], strides = [1, 1] : tensor<?x32000xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<?x32000xf16>>{%2233}
      flow.return
    } count(%arg6: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg6)
      flow.return %x, %y, %z : index, index, index
    }
    %2229 = flow.tensor.reshape %2228 : tensor<?x32000xf16>{%223} -> tensor<4x?x32000xf16>{%209}
    %2230 = hal.tensor.alias on(#hal.device.affinity<@__device_0>) wait(%arg4) => %2168 : tensor<?x360448xf16>{%213} to %arg3 : !hal.buffer_view
    %2231:2 = hal.tensor.barrier join(%2230, %2229 : tensor<?x360448xf16>, tensor<4x?x32000xf16>) => %arg5 : !hal.fence
    %2232 = hal.tensor.export %2231#1 : tensor<4x?x32000xf16>{%209} -> !hal.buffer_view
    util.return %2232 : !hal.buffer_view
  }
  util.func public @prefill_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @prefill_bs4$async(%arg0, %arg1, %arg2, %arg3, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
  util.func public @decode_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view, %arg5: !hal.fence, %arg6: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %c1024 = arith.constant 1024 : index
    %c5632 = arith.constant 5632 : index
    %0 = flow.tensor.constant #flow.parameter.named<"model"::"output.weight"> : tensor<32000x2176xi8>
    %1 = flow.tensor.constant #flow.parameter.named<"model"::"output_norm.weight"> : tensor<2048xf32>
    %2 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_down.weight"> : tensor<2048x5984xi8>
    %3 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_up.weight"> : tensor<5632x2176xi8>
    %4 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_gate.weight"> : tensor<5632x2176xi8>
    %5 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_norm.weight"> : tensor<2048xf32>
    %6 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_output.weight"> : tensor<2048x2176xi8>
    %7 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_v.weight"> : tensor<256x2176xi8>
    %8 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_k.weight"> : tensor<256x2176xi8>
    %9 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_q.weight"> : tensor<2048x2176xi8>
    %10 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_norm.weight"> : tensor<2048xf32>
    %11 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_down.weight"> : tensor<2048x5984xi8>
    %12 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_up.weight"> : tensor<5632x2176xi8>
    %13 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_gate.weight"> : tensor<5632x2176xi8>
    %14 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_norm.weight"> : tensor<2048xf32>
    %15 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_output.weight"> : tensor<2048x2176xi8>
    %16 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_v.weight"> : tensor<256x2176xi8>
    %17 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_k.weight"> : tensor<256x2176xi8>
    %18 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_q.weight"> : tensor<2048x2176xi8>
    %19 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_norm.weight"> : tensor<2048xf32>
    %20 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_down.weight"> : tensor<2048x5984xi8>
    %21 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_up.weight"> : tensor<5632x2176xi8>
    %22 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_gate.weight"> : tensor<5632x2176xi8>
    %23 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_norm.weight"> : tensor<2048xf32>
    %24 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_output.weight"> : tensor<2048x2176xi8>
    %25 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_v.weight"> : tensor<256x2176xi8>
    %26 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_k.weight"> : tensor<256x2176xi8>
    %27 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_q.weight"> : tensor<2048x2176xi8>
    %28 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_norm.weight"> : tensor<2048xf32>
    %29 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_down.weight"> : tensor<2048x5984xi8>
    %30 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_up.weight"> : tensor<5632x2176xi8>
    %31 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_gate.weight"> : tensor<5632x2176xi8>
    %32 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_norm.weight"> : tensor<2048xf32>
    %33 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_output.weight"> : tensor<2048x2176xi8>
    %34 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_v.weight"> : tensor<256x2176xi8>
    %35 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_k.weight"> : tensor<256x2176xi8>
    %36 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_q.weight"> : tensor<2048x2176xi8>
    %37 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_norm.weight"> : tensor<2048xf32>
    %38 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_down.weight"> : tensor<2048x5984xi8>
    %39 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_up.weight"> : tensor<5632x2176xi8>
    %40 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_gate.weight"> : tensor<5632x2176xi8>
    %41 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_norm.weight"> : tensor<2048xf32>
    %42 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_output.weight"> : tensor<2048x2176xi8>
    %43 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_v.weight"> : tensor<256x2176xi8>
    %44 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_k.weight"> : tensor<256x2176xi8>
    %45 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_q.weight"> : tensor<2048x2176xi8>
    %46 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_norm.weight"> : tensor<2048xf32>
    %47 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_down.weight"> : tensor<2048x5984xi8>
    %48 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_up.weight"> : tensor<5632x2176xi8>
    %49 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_gate.weight"> : tensor<5632x2176xi8>
    %50 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_norm.weight"> : tensor<2048xf32>
    %51 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_output.weight"> : tensor<2048x2176xi8>
    %52 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_v.weight"> : tensor<256x2176xi8>
    %53 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_k.weight"> : tensor<256x2176xi8>
    %54 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_q.weight"> : tensor<2048x2176xi8>
    %55 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_norm.weight"> : tensor<2048xf32>
    %56 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_down.weight"> : tensor<2048x5984xi8>
    %57 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_up.weight"> : tensor<5632x2176xi8>
    %58 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_gate.weight"> : tensor<5632x2176xi8>
    %59 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_norm.weight"> : tensor<2048xf32>
    %60 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_output.weight"> : tensor<2048x2176xi8>
    %61 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_v.weight"> : tensor<256x2176xi8>
    %62 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_k.weight"> : tensor<256x2176xi8>
    %63 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_q.weight"> : tensor<2048x2176xi8>
    %64 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_norm.weight"> : tensor<2048xf32>
    %65 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_down.weight"> : tensor<2048x5984xi8>
    %66 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_up.weight"> : tensor<5632x2176xi8>
    %67 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_gate.weight"> : tensor<5632x2176xi8>
    %68 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_norm.weight"> : tensor<2048xf32>
    %69 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_output.weight"> : tensor<2048x2176xi8>
    %70 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_v.weight"> : tensor<256x2176xi8>
    %71 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_k.weight"> : tensor<256x2176xi8>
    %72 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_q.weight"> : tensor<2048x2176xi8>
    %73 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_norm.weight"> : tensor<2048xf32>
    %74 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_down.weight"> : tensor<2048x5984xi8>
    %75 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_up.weight"> : tensor<5632x2176xi8>
    %76 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_gate.weight"> : tensor<5632x2176xi8>
    %77 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_norm.weight"> : tensor<2048xf32>
    %78 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_output.weight"> : tensor<2048x2176xi8>
    %79 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_v.weight"> : tensor<256x2176xi8>
    %80 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_k.weight"> : tensor<256x2176xi8>
    %81 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_q.weight"> : tensor<2048x2176xi8>
    %82 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_norm.weight"> : tensor<2048xf32>
    %83 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_down.weight"> : tensor<2048x5984xi8>
    %84 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_up.weight"> : tensor<5632x2176xi8>
    %85 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_gate.weight"> : tensor<5632x2176xi8>
    %86 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_norm.weight"> : tensor<2048xf32>
    %87 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_output.weight"> : tensor<2048x2176xi8>
    %88 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_v.weight"> : tensor<256x2176xi8>
    %89 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_k.weight"> : tensor<256x2176xi8>
    %90 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_q.weight"> : tensor<2048x2176xi8>
    %91 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_norm.weight"> : tensor<2048xf32>
    %92 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_down.weight"> : tensor<2048x5984xi8>
    %93 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_up.weight"> : tensor<5632x2176xi8>
    %94 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_gate.weight"> : tensor<5632x2176xi8>
    %95 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_norm.weight"> : tensor<2048xf32>
    %96 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_output.weight"> : tensor<2048x2176xi8>
    %97 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_v.weight"> : tensor<256x2176xi8>
    %98 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_k.weight"> : tensor<256x2176xi8>
    %99 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_q.weight"> : tensor<2048x2176xi8>
    %100 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_norm.weight"> : tensor<2048xf32>
    %101 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_down.weight"> : tensor<2048x5984xi8>
    %102 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_up.weight"> : tensor<5632x2176xi8>
    %103 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_gate.weight"> : tensor<5632x2176xi8>
    %104 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_norm.weight"> : tensor<2048xf32>
    %105 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_output.weight"> : tensor<2048x2176xi8>
    %106 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_v.weight"> : tensor<256x2176xi8>
    %107 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_k.weight"> : tensor<256x2176xi8>
    %108 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_q.weight"> : tensor<2048x2176xi8>
    %109 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_norm.weight"> : tensor<2048xf32>
    %110 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_down.weight"> : tensor<2048x5984xi8>
    %111 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_up.weight"> : tensor<5632x2176xi8>
    %112 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_gate.weight"> : tensor<5632x2176xi8>
    %113 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_norm.weight"> : tensor<2048xf32>
    %114 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_output.weight"> : tensor<2048x2176xi8>
    %115 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_v.weight"> : tensor<256x2176xi8>
    %116 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_k.weight"> : tensor<256x2176xi8>
    %117 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_q.weight"> : tensor<2048x2176xi8>
    %118 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_norm.weight"> : tensor<2048xf32>
    %119 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_down.weight"> : tensor<2048x5984xi8>
    %120 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_up.weight"> : tensor<5632x2176xi8>
    %121 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_gate.weight"> : tensor<5632x2176xi8>
    %122 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_norm.weight"> : tensor<2048xf32>
    %123 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_output.weight"> : tensor<2048x2176xi8>
    %124 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_v.weight"> : tensor<256x2176xi8>
    %125 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_k.weight"> : tensor<256x2176xi8>
    %126 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_q.weight"> : tensor<2048x2176xi8>
    %127 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_norm.weight"> : tensor<2048xf32>
    %128 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_down.weight"> : tensor<2048x5984xi8>
    %129 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_up.weight"> : tensor<5632x2176xi8>
    %130 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_gate.weight"> : tensor<5632x2176xi8>
    %131 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_norm.weight"> : tensor<2048xf32>
    %132 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_output.weight"> : tensor<2048x2176xi8>
    %133 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_v.weight"> : tensor<256x2176xi8>
    %134 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_k.weight"> : tensor<256x2176xi8>
    %135 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_q.weight"> : tensor<2048x2176xi8>
    %136 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_norm.weight"> : tensor<2048xf32>
    %137 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_down.weight"> : tensor<2048x5984xi8>
    %138 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_up.weight"> : tensor<5632x2176xi8>
    %139 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_gate.weight"> : tensor<5632x2176xi8>
    %140 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_norm.weight"> : tensor<2048xf32>
    %141 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_output.weight"> : tensor<2048x2176xi8>
    %142 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_v.weight"> : tensor<256x2176xi8>
    %143 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_k.weight"> : tensor<256x2176xi8>
    %144 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_q.weight"> : tensor<2048x2176xi8>
    %145 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_norm.weight"> : tensor<2048xf32>
    %146 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_down.weight"> : tensor<2048x5984xi8>
    %147 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_up.weight"> : tensor<5632x2176xi8>
    %148 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_gate.weight"> : tensor<5632x2176xi8>
    %149 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_norm.weight"> : tensor<2048xf32>
    %150 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_output.weight"> : tensor<2048x2176xi8>
    %151 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_v.weight"> : tensor<256x2176xi8>
    %152 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_k.weight"> : tensor<256x2176xi8>
    %153 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_q.weight"> : tensor<2048x2176xi8>
    %154 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_norm.weight"> : tensor<2048xf32>
    %155 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_down.weight"> : tensor<2048x5984xi8>
    %156 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_up.weight"> : tensor<5632x2176xi8>
    %157 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_gate.weight"> : tensor<5632x2176xi8>
    %158 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_norm.weight"> : tensor<2048xf32>
    %159 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_output.weight"> : tensor<2048x2176xi8>
    %160 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_v.weight"> : tensor<256x2176xi8>
    %161 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_k.weight"> : tensor<256x2176xi8>
    %162 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_q.weight"> : tensor<2048x2176xi8>
    %163 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_norm.weight"> : tensor<2048xf32>
    %164 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_down.weight"> : tensor<2048x5984xi8>
    %165 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_up.weight"> : tensor<5632x2176xi8>
    %166 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_gate.weight"> : tensor<5632x2176xi8>
    %167 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_norm.weight"> : tensor<2048xf32>
    %168 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_output.weight"> : tensor<2048x2176xi8>
    %169 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_v.weight"> : tensor<256x2176xi8>
    %170 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_k.weight"> : tensor<256x2176xi8>
    %171 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_q.weight"> : tensor<2048x2176xi8>
    %172 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_norm.weight"> : tensor<2048xf32>
    %173 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_down.weight"> : tensor<2048x5984xi8>
    %174 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_up.weight"> : tensor<5632x2176xi8>
    %175 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_gate.weight"> : tensor<5632x2176xi8>
    %176 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_norm.weight"> : tensor<2048xf32>
    %177 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_output.weight"> : tensor<2048x2176xi8>
    %178 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_v.weight"> : tensor<256x2176xi8>
    %179 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_k.weight"> : tensor<256x2176xi8>
    %180 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_q.weight"> : tensor<2048x2176xi8>
    %181 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_norm.weight"> : tensor<2048xf32>
    %182 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_down.weight"> : tensor<2048x5984xi8>
    %183 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_up.weight"> : tensor<5632x2176xi8>
    %184 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_gate.weight"> : tensor<5632x2176xi8>
    %185 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_norm.weight"> : tensor<2048xf32>
    %186 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_output.weight"> : tensor<2048x2176xi8>
    %187 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_v.weight"> : tensor<256x2176xi8>
    %188 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_k.weight"> : tensor<256x2176xi8>
    %189 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_q.weight"> : tensor<2048x2176xi8>
    %190 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_norm.weight"> : tensor<2048xf32>
    %191 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_down.weight"> : tensor<2048x5984xi8>
    %192 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_up.weight"> : tensor<5632x2176xi8>
    %193 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_gate.weight"> : tensor<5632x2176xi8>
    %194 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_norm.weight"> : tensor<2048xf32>
    %195 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_output.weight"> : tensor<2048x2176xi8>
    %196 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_v.weight"> : tensor<256x2176xi8>
    %197 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_k.weight"> : tensor<256x2176xi8>
    %198 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_q.weight"> : tensor<2048x2176xi8>
    %199 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_norm.weight"> : tensor<2048xf32>
    %200 = flow.tensor.constant #flow.parameter.named<"model"::"token_embd.weight"> : tensor<32000x2176xi8>
    %c32 = arith.constant 32 : index
    %cst = arith.constant dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
    %201 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg0 : !hal.buffer_view -> tensor<4x1xi64>
    %202 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %203 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg2 : !hal.buffer_view -> tensor<4xi64>
    %204 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[1] : index
    %205 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg3 : !hal.buffer_view -> tensor<4x?xi64>{%204}
    %206 = hal.buffer_view.dim<%arg4 : !hal.buffer_view>[0] : index
    %207 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg4 : !hal.buffer_view -> tensor<?x360448xf16>{%206}
    %208 = util.assume.int %204<umin = 1, umax = 63> : index
    %209 = flow.tensor.tie_shape %205 : tensor<4x?xi64>{%208}
    %210 = util.assume.int %206<umin = 1, umax = 9007199254740991> : index
    %211 = flow.tensor.tie_shape %207 : tensor<?x360448xf16>{%210}
    %212 = flow.tensor.bitcast %200 : tensor<32000x2176xi8> -> tensor<32000x64x17xi16>
    %213 = flow.tensor.bitcast %200 : tensor<32000x2176xi8> -> tensor<32000x64x1x17xi16>
    %214 = flow.dispatch.workgroups(%213) : (tensor<32000x64x1x17xi16>) -> tensor<32000x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [32000, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>> -> tensor<32000x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [32000, 64, 1], strides = [1, 1, 1] : tensor<32000x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %215 = flow.dispatch.workgroups(%212) : (tensor<32000x64x17xi16>) -> tensor<32000x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [32000, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>> -> tensor<32000x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [32000, 64, 16], strides = [1, 1, 1] : tensor<32000x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %216 = flow.tensor.bitcast %214 : tensor<32000x64x1xi16> -> tensor<2048000xf16>
    %217 = flow.tensor.bitcast %215 : tensor<32000x64x16xi16> -> tensor<2048000x32xi8>
    %218 = flow.dispatch.workgroups(%216, %217) : (tensor<2048000xf16>, tensor<2048000x32xi8>) -> tensor<2048000x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048000x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048000], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000xf16>> -> tensor<2048000xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [2048000, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048000x32xi8>> -> tensor<2048000x32xi8>
      %2175 = tensor.empty() : tensor<2048000x32xf16>
      %2176 = linalg.generic {indexing_maps = [#map, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048000xf16>, tensor<2048000x32xi8>) outs(%2175 : tensor<2048000x32xf16>) {
      ^bb0(%in: f16, %in_0: i8, %out: f16):
        %2177 = arith.sitofp %in_0 : i8 to f16
        %2178 = arith.mulf %in, %2177 : f16
        linalg.yield %2178 : f16
      } -> tensor<2048000x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [2048000, 32], strides = [1, 1] : tensor<2048000x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048000x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %219 = flow.tensor.reshape %218 : tensor<2048000x32xf16> -> tensor<32000x2048xf16>
    %220 = flow.tensor.reshape %201 : tensor<4x1xi64> -> tensor<4xi64>
    %221 = flow.dispatch.workgroups(%219, %220) : (tensor<32000x2048xf16>, tensor<4xi64>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %c32_0 = arith.constant 32 : index
      %c32000 = arith.constant 32000 : index
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [32000, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x2048xf16>> -> tensor<32000x2048xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2174 : tensor<4xi64>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: i64, %out: f16):
        %2177 = linalg.index 1 : index
        %2178 = arith.remsi %2177, %c32_0 : index
        %2179 = arith.divsi %2177, %c32_0 : index
        %2180 = arith.index_cast %in : i64 to index
        %2181 = arith.muli %2179, %c32_0 overflow<nsw> : index
        %2182 = arith.addi %2178, %2181 : index
        %2183 = arith.cmpi slt, %2180, %c32000 : index
        cf.assert %2183, "index must be smaller than dim size"
        %2184 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2184, "index must be larger or equal to 0"
        %extracted = tensor.extract %2173[%2180, %2182] : tensor<32000x2048xf16>
        linalg.yield %extracted : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %222 = flow.tensor.reshape %221 : tensor<4x2048xf16> -> tensor<8192xf16>
    %223 = flow.dispatch.workgroups(%222) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %224 = flow.tensor.reshape %223 : tensor<8192xf32> -> tensor<4x2048xf32>
    %225 = flow.dispatch.workgroups(%221) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %226 = flow.dispatch.workgroups(%224, %225) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %227 = flow.dispatch.workgroups(%199, %226) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %228 = flow.tensor.reshape %227 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %229 = flow.tensor.bitcast %198 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %230 = flow.tensor.bitcast %198 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %231 = flow.dispatch.workgroups(%230) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %232 = flow.dispatch.workgroups(%229) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %233 = flow.tensor.bitcast %232 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %234 = flow.tensor.bitcast %231 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %235 = flow.dispatch.workgroups(%234, %233, %228) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %236 = flow.tensor.reshape %235 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %237 = flow.tensor.bitcast %197 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %238 = flow.tensor.bitcast %197 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %239 = flow.dispatch.workgroups(%238) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %240 = flow.dispatch.workgroups(%237) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %241 = flow.tensor.bitcast %240 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %242 = flow.tensor.bitcast %239 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %243 = flow.dispatch.workgroups(%242, %241, %228) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %244 = flow.tensor.reshape %243 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %245 = flow.tensor.bitcast %196 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %246 = flow.tensor.bitcast %196 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %247 = flow.dispatch.workgroups(%246) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %248 = flow.dispatch.workgroups(%245) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %249 = flow.tensor.bitcast %248 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %250 = flow.tensor.bitcast %247 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %251 = flow.dispatch.workgroups(%250, %249, %228) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %252 = flow.tensor.reshape %251 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %253 = flow.dispatch.workgroups(%203) : (tensor<4xi64>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<4xi64>) outs(%2174 : tensor<4xf32>) {
      ^bb0(%in: i64, %out: f32):
        %2176 = arith.sitofp %in : i64 to f32
        linalg.yield %2176 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %254 = flow.tensor.reshape %253 : tensor<4xf32> -> tensor<4x1x1x1x1xf32>
    %255 = flow.dispatch.workgroups(%254, %cst) : (tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) -> tensor<4x1x4x1x8xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x1x1x1xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x1x8x1xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x1x4x1x8xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 1, 1, 1, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x1x1x1xf32>> -> tensor<4x1x1x1x1xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 1, 8, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x1x8x1xf32>> -> tensor<4x4x1x8x1xf32>
      %2175 = tensor.empty() : tensor<4x1x4x1x8xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2175 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
      %2177 = linalg.batch_mmt4d ins(%2173, %2174 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%2176 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0, 0], sizes = [4, 1, 4, 1, 8], strides = [1, 1, 1, 1, 1] : tensor<4x1x4x1x8xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x1x4x1x8xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %256 = flow.dispatch.workgroups(%255) : (tensor<4x1x4x1x8xf32>) -> tensor<4x32x1xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x1x8xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x1xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 1, 4, 1, 8], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x1x8xf32>> -> tensor<4x1x4x1x8xf32>
      %2174 = tensor.empty() : tensor<4x32x1xf32>
      %unpack = linalg.unpack %2173 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %2174 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
      iree_tensor_ext.dispatch.tensor.store %unpack, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 1], strides = [1, 1, 1] : tensor<4x32x1xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x1xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %257 = flow.tensor.reshape %256 : tensor<4x32x1xf32> -> tensor<128xf32>
    %258 = flow.dispatch.workgroups(%257) : (tensor<128xf32>) -> tensor<128xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [128], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128xf32>> -> tensor<128xf32>
      %2174 = tensor.empty() : tensor<128xf16>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<128xf32>) outs(%2174 : tensor<128xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2176 = math.cos %in : f32
        %2177 = arith.truncf %2176 : f32 to f16
        linalg.yield %2177 : f16
      } -> tensor<128xf16>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [128], strides = [1] : tensor<128xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %259 = flow.dispatch.workgroups(%257) : (tensor<128xf32>) -> tensor<128xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [128], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128xf32>> -> tensor<128xf32>
      %2174 = tensor.empty() : tensor<128xf16>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<128xf32>) outs(%2174 : tensor<128xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2176 = math.sin %in : f32
        %2177 = arith.truncf %2176 : f32 to f16
        linalg.yield %2177 : f16
      } -> tensor<128xf16>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [128], strides = [1] : tensor<128xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %260 = flow.dispatch.workgroups(%236) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %261 = flow.dispatch.workgroups(%236) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %262 = flow.tensor.reshape %258 : tensor<128xf16> -> tensor<4x32xf16>
    %263 = flow.tensor.reshape %259 : tensor<128xf16> -> tensor<4x32xf16>
    %264 = flow.dispatch.workgroups(%260, %262, %261, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %265 = flow.dispatch.workgroups(%244) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %266 = flow.dispatch.workgroups(%244) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %267 = flow.dispatch.workgroups(%265, %262, %266, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %268 = flow.tensor.reshape %267 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %269 = flow.dispatch.workgroups[%208](%208, %203) : (index, tensor<4xi64>) -> tensor<4xi64> =
        (%arg7: index, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c0_i64 = arith.constant 0 : i64
      %cst_0 = arith.constant 3.200000e+01 : f32
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4xi64>
      %2176 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2174 : tensor<4xi64>) outs(%2175 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2177 = arith.sitofp %in : i64 to f32
        %2178 = arith.divf %2177, %cst_0 : f32
        %2179 = math.floor %2178 : f32
        %2180 = arith.fptosi %2179 : f32 to i64
        %2181 = arith.index_cast %2180 : i64 to index
        %2182 = arith.cmpi slt, %2181, %2173 : index
        cf.assert %2182, "index must be smaller than dim size"
        %2183 = arith.cmpi sge, %2180, %c0_i64 : i64
        cf.assert %2183, "index must be larger or equal to 0"
        cf.assert %2182, "index must be smaller than dim size"
        cf.assert %2183, "index must be larger or equal to 0"
        linalg.yield %2180 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %270 = flow.dispatch.workgroups(%203) : (tensor<4xi64>) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c32_i64 = arith.constant 32 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = tensor.empty() : tensor<4xi64>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<4xi64>) outs(%2174 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2176 = arith.remsi %in, %c32_i64 : i64
        %2177 = arith.cmpi ne, %2176, %c0_i64 : i64
        %2178 = arith.cmpi slt, %2176, %c0_i64 : i64
        %2179 = arith.andi %2177, %2178 : i1
        %2180 = arith.addi %2176, %c32_i64 : i64
        %2181 = arith.select %2179, %2180, %2176 : i64
        linalg.yield %2181 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %271 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c44_i64 = arith.constant 44 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c44_i64 : i64
        linalg.yield %2182 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %272 = flow.dispatch.workgroups(%271, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %273 = arith.muli %210, %c5632 overflow<nsw> : index
    %274 = flow.tensor.reshape %211 : tensor<?x360448xf16>{%210} -> tensor<?x2x32x1xf16>{%273}
    %275 = flow.dispatch.workgroups[%273](%268, %272, %274, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %274{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %276 = flow.dispatch.workgroups(%271, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %277 = flow.dispatch.workgroups[%273](%252, %276, %275, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %275{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %278 = flow.tensor.reshape %277 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %279 = arith.muli %208, %c32 : index
    %280 = flow.dispatch.workgroups[%210, %208](%278, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %281 = arith.muli %208, %c1024 : index
    %282 = flow.dispatch.workgroups[%281, %279](%281, %279, %202) : (index, index, tensor<4xi64>) -> tensor<4x?xf16>{%281} =
        (%arg7: index, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?xf16>>) {
      %cst_0 = arith.constant 0xFC00 : f16
      %cst_1 = arith.constant 0.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg7, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty(%2173) : tensor<4x?xf16>
      %2177 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4x?xf16>) {
      ^bb0(%in: i64, %out: f16):
        %2178 = linalg.index 1 : index
        %2179 = arith.remsi %2178, %2174 : index
        %2180 = arith.index_cast %2179 : index to i64
        %2181 = arith.cmpi sge, %2180, %in : i64
        %2182 = arith.select %2181, %cst_0, %cst_1 : f16
        linalg.yield %2182 : f16
      } -> tensor<4x?xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : tensor<4x?xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x?xf16>>{%2173}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %283 = arith.muli %208, %c32 overflow<nsw> : index
    %284 = flow.tensor.reshape %280 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %285 = flow.tensor.reshape %264 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %286 = flow.dispatch.workgroups[%210, %208](%278, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %287 = flow.tensor.reshape %286 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %288 = flow.tensor.reshape %282 : tensor<4x?xf16>{%281} -> tensor<128x?xf16>{%279}
    %289 = flow.dispatch.workgroups[%283, %279](%285, %284, %287, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %290 = flow.tensor.bitcast %195 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %291 = flow.tensor.bitcast %195 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %292 = flow.dispatch.workgroups(%291) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %293 = flow.dispatch.workgroups(%290) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %294 = flow.tensor.bitcast %293 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %295 = flow.tensor.bitcast %292 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %296 = flow.tensor.reshape %289 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %297 = flow.dispatch.workgroups(%295, %294, %296, %221) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %298 = flow.tensor.reshape %297 : tensor<4x2048xf16> -> tensor<8192xf16>
    %299 = flow.dispatch.workgroups(%298) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %300 = flow.tensor.reshape %299 : tensor<8192xf32> -> tensor<4x2048xf32>
    %301 = flow.dispatch.workgroups(%297) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %302 = flow.dispatch.workgroups(%300, %301) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %303 = flow.dispatch.workgroups(%194, %302) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %304 = flow.tensor.reshape %303 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %305 = flow.tensor.bitcast %193 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %306 = flow.tensor.bitcast %193 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %307 = flow.dispatch.workgroups(%306) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %308 = flow.dispatch.workgroups(%305) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %309 = flow.tensor.bitcast %308 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %310 = flow.tensor.bitcast %307 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %311 = flow.tensor.bitcast %192 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %312 = flow.dispatch.workgroups(%311) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %313 = flow.tensor.bitcast %312 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %314 = flow.tensor.bitcast %192 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %315 = flow.dispatch.workgroups(%314) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %316 = flow.tensor.bitcast %315 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %317 = flow.dispatch.workgroups(%313, %316, %304) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %318 = flow.dispatch.workgroups(%310, %309, %304, %317) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %319 = flow.tensor.reshape %318 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %320 = flow.tensor.bitcast %191 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %321 = flow.tensor.bitcast %191 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %322 = flow.dispatch.workgroups(%321) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %323 = flow.dispatch.workgroups(%320) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %324 = flow.tensor.bitcast %323 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %325 = flow.tensor.bitcast %322 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %326 = flow.dispatch.workgroups(%325, %324, %319, %297) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %327 = flow.tensor.reshape %326 : tensor<4x2048xf16> -> tensor<8192xf16>
    %328 = flow.dispatch.workgroups(%327) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %329 = flow.tensor.reshape %328 : tensor<8192xf32> -> tensor<4x2048xf32>
    %330 = flow.dispatch.workgroups(%326) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %331 = flow.dispatch.workgroups(%329, %330) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %332 = flow.dispatch.workgroups(%190, %331) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %333 = flow.tensor.reshape %332 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %334 = flow.tensor.bitcast %189 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %335 = flow.tensor.bitcast %189 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %336 = flow.dispatch.workgroups(%335) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %337 = flow.dispatch.workgroups(%334) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %338 = flow.tensor.bitcast %337 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %339 = flow.tensor.bitcast %336 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %340 = flow.dispatch.workgroups(%339, %338, %333) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %341 = flow.tensor.reshape %340 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %342 = flow.tensor.bitcast %188 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %343 = flow.tensor.bitcast %188 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %344 = flow.dispatch.workgroups(%343) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %345 = flow.dispatch.workgroups(%342) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %346 = flow.tensor.bitcast %345 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %347 = flow.tensor.bitcast %344 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %348 = flow.dispatch.workgroups(%347, %346, %333) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %349 = flow.tensor.reshape %348 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %350 = flow.tensor.bitcast %187 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %351 = flow.tensor.bitcast %187 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %352 = flow.dispatch.workgroups(%351) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %353 = flow.dispatch.workgroups(%350) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %354 = flow.tensor.bitcast %353 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %355 = flow.tensor.bitcast %352 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %356 = flow.dispatch.workgroups(%355, %354, %333) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %357 = flow.tensor.reshape %356 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %358 = flow.dispatch.workgroups(%341) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %359 = flow.dispatch.workgroups(%341) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %360 = flow.dispatch.workgroups(%358, %262, %359, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %361 = flow.dispatch.workgroups(%349) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %362 = flow.dispatch.workgroups(%349) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %363 = flow.dispatch.workgroups(%361, %262, %362, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %364 = flow.tensor.reshape %363 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %365 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c1_i64 = arith.constant 1 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c1_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %366 = flow.dispatch.workgroups(%365, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %367 = flow.dispatch.workgroups[%273](%364, %366, %277, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %277{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %368 = flow.dispatch.workgroups(%365, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %369 = flow.dispatch.workgroups[%273](%357, %368, %367, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %367{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %370 = flow.tensor.reshape %369 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %371 = flow.dispatch.workgroups[%210, %208](%370, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 1, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %372 = flow.tensor.reshape %371 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %373 = flow.tensor.reshape %360 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %374 = flow.dispatch.workgroups[%210, %208](%370, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 1, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %375 = flow.tensor.reshape %374 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %376 = flow.dispatch.workgroups[%283, %279](%373, %372, %375, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %377 = flow.tensor.bitcast %186 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %378 = flow.tensor.bitcast %186 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %379 = flow.dispatch.workgroups(%378) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %380 = flow.dispatch.workgroups(%377) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %381 = flow.tensor.bitcast %380 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %382 = flow.tensor.bitcast %379 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %383 = flow.tensor.reshape %376 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %384 = flow.dispatch.workgroups(%382, %381, %383, %326) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %385 = flow.tensor.reshape %384 : tensor<4x2048xf16> -> tensor<8192xf16>
    %386 = flow.dispatch.workgroups(%385) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %387 = flow.tensor.reshape %386 : tensor<8192xf32> -> tensor<4x2048xf32>
    %388 = flow.dispatch.workgroups(%384) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %389 = flow.dispatch.workgroups(%387, %388) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %390 = flow.dispatch.workgroups(%185, %389) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %391 = flow.tensor.reshape %390 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %392 = flow.tensor.bitcast %184 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %393 = flow.tensor.bitcast %184 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %394 = flow.dispatch.workgroups(%393) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %395 = flow.dispatch.workgroups(%392) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %396 = flow.tensor.bitcast %395 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %397 = flow.tensor.bitcast %394 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %398 = flow.tensor.bitcast %183 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %399 = flow.dispatch.workgroups(%398) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %400 = flow.tensor.bitcast %399 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %401 = flow.tensor.bitcast %183 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %402 = flow.dispatch.workgroups(%401) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %403 = flow.tensor.bitcast %402 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %404 = flow.dispatch.workgroups(%400, %403, %391) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %405 = flow.dispatch.workgroups(%397, %396, %391, %404) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %406 = flow.tensor.reshape %405 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %407 = flow.tensor.bitcast %182 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %408 = flow.tensor.bitcast %182 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %409 = flow.dispatch.workgroups(%408) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %410 = flow.dispatch.workgroups(%407) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %411 = flow.tensor.bitcast %410 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %412 = flow.tensor.bitcast %409 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %413 = flow.dispatch.workgroups(%412, %411, %406, %384) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %414 = flow.tensor.reshape %413 : tensor<4x2048xf16> -> tensor<8192xf16>
    %415 = flow.dispatch.workgroups(%414) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %416 = flow.tensor.reshape %415 : tensor<8192xf32> -> tensor<4x2048xf32>
    %417 = flow.dispatch.workgroups(%413) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %418 = flow.dispatch.workgroups(%416, %417) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %419 = flow.dispatch.workgroups(%181, %418) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %420 = flow.tensor.reshape %419 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %421 = flow.tensor.bitcast %180 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %422 = flow.tensor.bitcast %180 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %423 = flow.dispatch.workgroups(%422) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %424 = flow.dispatch.workgroups(%421) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %425 = flow.tensor.bitcast %424 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %426 = flow.tensor.bitcast %423 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %427 = flow.dispatch.workgroups(%426, %425, %420) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %428 = flow.tensor.reshape %427 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %429 = flow.tensor.bitcast %179 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %430 = flow.tensor.bitcast %179 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %431 = flow.dispatch.workgroups(%430) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %432 = flow.dispatch.workgroups(%429) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %433 = flow.tensor.bitcast %432 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %434 = flow.tensor.bitcast %431 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %435 = flow.dispatch.workgroups(%434, %433, %420) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %436 = flow.tensor.reshape %435 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %437 = flow.tensor.bitcast %178 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %438 = flow.tensor.bitcast %178 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %439 = flow.dispatch.workgroups(%438) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %440 = flow.dispatch.workgroups(%437) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %441 = flow.tensor.bitcast %440 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %442 = flow.tensor.bitcast %439 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %443 = flow.dispatch.workgroups(%442, %441, %420) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %444 = flow.tensor.reshape %443 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %445 = flow.dispatch.workgroups(%428) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %446 = flow.dispatch.workgroups(%428) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %447 = flow.dispatch.workgroups(%445, %262, %446, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %448 = flow.dispatch.workgroups(%436) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %449 = flow.dispatch.workgroups(%436) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %450 = flow.dispatch.workgroups(%448, %262, %449, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %451 = flow.tensor.reshape %450 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %452 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c2_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %453 = flow.dispatch.workgroups(%452, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %454 = flow.dispatch.workgroups[%273](%451, %453, %369, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %369{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %455 = flow.dispatch.workgroups(%452, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %456 = flow.dispatch.workgroups[%273](%444, %455, %454, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %454{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %457 = flow.tensor.reshape %456 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %458 = flow.dispatch.workgroups[%210, %208](%457, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 2, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %459 = flow.tensor.reshape %458 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %460 = flow.tensor.reshape %447 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %461 = flow.dispatch.workgroups[%210, %208](%457, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 2, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %462 = flow.tensor.reshape %461 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %463 = flow.dispatch.workgroups[%283, %279](%460, %459, %462, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %464 = flow.tensor.bitcast %177 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %465 = flow.tensor.bitcast %177 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %466 = flow.dispatch.workgroups(%465) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %467 = flow.dispatch.workgroups(%464) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %468 = flow.tensor.bitcast %467 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %469 = flow.tensor.bitcast %466 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %470 = flow.tensor.reshape %463 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %471 = flow.dispatch.workgroups(%469, %468, %470, %413) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %472 = flow.tensor.reshape %471 : tensor<4x2048xf16> -> tensor<8192xf16>
    %473 = flow.dispatch.workgroups(%472) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %474 = flow.tensor.reshape %473 : tensor<8192xf32> -> tensor<4x2048xf32>
    %475 = flow.dispatch.workgroups(%471) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %476 = flow.dispatch.workgroups(%474, %475) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %477 = flow.dispatch.workgroups(%176, %476) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %478 = flow.tensor.reshape %477 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %479 = flow.tensor.bitcast %175 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %480 = flow.tensor.bitcast %175 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %481 = flow.dispatch.workgroups(%480) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %482 = flow.dispatch.workgroups(%479) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %483 = flow.tensor.bitcast %482 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %484 = flow.tensor.bitcast %481 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %485 = flow.tensor.bitcast %174 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %486 = flow.dispatch.workgroups(%485) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %487 = flow.tensor.bitcast %486 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %488 = flow.tensor.bitcast %174 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %489 = flow.dispatch.workgroups(%488) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %490 = flow.tensor.bitcast %489 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %491 = flow.dispatch.workgroups(%487, %490, %478) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %492 = flow.dispatch.workgroups(%484, %483, %478, %491) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %493 = flow.tensor.reshape %492 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %494 = flow.tensor.bitcast %173 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %495 = flow.tensor.bitcast %173 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %496 = flow.dispatch.workgroups(%495) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %497 = flow.dispatch.workgroups(%494) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %498 = flow.tensor.bitcast %497 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %499 = flow.tensor.bitcast %496 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %500 = flow.dispatch.workgroups(%499, %498, %493, %471) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %501 = flow.tensor.reshape %500 : tensor<4x2048xf16> -> tensor<8192xf16>
    %502 = flow.dispatch.workgroups(%501) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %503 = flow.tensor.reshape %502 : tensor<8192xf32> -> tensor<4x2048xf32>
    %504 = flow.dispatch.workgroups(%500) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %505 = flow.dispatch.workgroups(%503, %504) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %506 = flow.dispatch.workgroups(%172, %505) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %507 = flow.tensor.reshape %506 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %508 = flow.tensor.bitcast %171 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %509 = flow.tensor.bitcast %171 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %510 = flow.dispatch.workgroups(%509) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %511 = flow.dispatch.workgroups(%508) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %512 = flow.tensor.bitcast %511 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %513 = flow.tensor.bitcast %510 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %514 = flow.dispatch.workgroups(%513, %512, %507) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %515 = flow.tensor.reshape %514 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %516 = flow.tensor.bitcast %170 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %517 = flow.tensor.bitcast %170 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %518 = flow.dispatch.workgroups(%517) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %519 = flow.dispatch.workgroups(%516) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %520 = flow.tensor.bitcast %519 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %521 = flow.tensor.bitcast %518 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %522 = flow.dispatch.workgroups(%521, %520, %507) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %523 = flow.tensor.reshape %522 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %524 = flow.tensor.bitcast %169 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %525 = flow.tensor.bitcast %169 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %526 = flow.dispatch.workgroups(%525) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %527 = flow.dispatch.workgroups(%524) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %528 = flow.tensor.bitcast %527 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %529 = flow.tensor.bitcast %526 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %530 = flow.dispatch.workgroups(%529, %528, %507) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %531 = flow.tensor.reshape %530 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %532 = flow.dispatch.workgroups(%515) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %533 = flow.dispatch.workgroups(%515) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %534 = flow.dispatch.workgroups(%532, %262, %533, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %535 = flow.dispatch.workgroups(%523) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %536 = flow.dispatch.workgroups(%523) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %537 = flow.dispatch.workgroups(%535, %262, %536, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %538 = flow.tensor.reshape %537 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %539 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c3_i64 = arith.constant 3 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c3_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %540 = flow.dispatch.workgroups(%539, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %541 = flow.dispatch.workgroups[%273](%538, %540, %456, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %456{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %542 = flow.dispatch.workgroups(%539, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %543 = flow.dispatch.workgroups[%273](%531, %542, %541, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %541{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %544 = flow.tensor.reshape %543 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %545 = flow.dispatch.workgroups[%210, %208](%544, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 3, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %546 = flow.tensor.reshape %545 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %547 = flow.tensor.reshape %534 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %548 = flow.dispatch.workgroups[%210, %208](%544, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 3, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %549 = flow.tensor.reshape %548 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %550 = flow.dispatch.workgroups[%283, %279](%547, %546, %549, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %551 = flow.tensor.bitcast %168 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %552 = flow.tensor.bitcast %168 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %553 = flow.dispatch.workgroups(%552) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %554 = flow.dispatch.workgroups(%551) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %555 = flow.tensor.bitcast %554 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %556 = flow.tensor.bitcast %553 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %557 = flow.tensor.reshape %550 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %558 = flow.dispatch.workgroups(%556, %555, %557, %500) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %559 = flow.tensor.reshape %558 : tensor<4x2048xf16> -> tensor<8192xf16>
    %560 = flow.dispatch.workgroups(%559) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %561 = flow.tensor.reshape %560 : tensor<8192xf32> -> tensor<4x2048xf32>
    %562 = flow.dispatch.workgroups(%558) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %563 = flow.dispatch.workgroups(%561, %562) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %564 = flow.dispatch.workgroups(%167, %563) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %565 = flow.tensor.reshape %564 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %566 = flow.tensor.bitcast %166 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %567 = flow.tensor.bitcast %166 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %568 = flow.dispatch.workgroups(%567) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %569 = flow.dispatch.workgroups(%566) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %570 = flow.tensor.bitcast %569 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %571 = flow.tensor.bitcast %568 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %572 = flow.tensor.bitcast %165 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %573 = flow.dispatch.workgroups(%572) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %574 = flow.tensor.bitcast %573 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %575 = flow.tensor.bitcast %165 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %576 = flow.dispatch.workgroups(%575) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %577 = flow.tensor.bitcast %576 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %578 = flow.dispatch.workgroups(%574, %577, %565) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %579 = flow.dispatch.workgroups(%571, %570, %565, %578) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %580 = flow.tensor.reshape %579 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %581 = flow.tensor.bitcast %164 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %582 = flow.tensor.bitcast %164 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %583 = flow.dispatch.workgroups(%582) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %584 = flow.dispatch.workgroups(%581) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %585 = flow.tensor.bitcast %584 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %586 = flow.tensor.bitcast %583 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %587 = flow.dispatch.workgroups(%586, %585, %580, %558) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %588 = flow.tensor.reshape %587 : tensor<4x2048xf16> -> tensor<8192xf16>
    %589 = flow.dispatch.workgroups(%588) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %590 = flow.tensor.reshape %589 : tensor<8192xf32> -> tensor<4x2048xf32>
    %591 = flow.dispatch.workgroups(%587) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %592 = flow.dispatch.workgroups(%590, %591) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %593 = flow.dispatch.workgroups(%163, %592) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %594 = flow.tensor.reshape %593 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %595 = flow.tensor.bitcast %162 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %596 = flow.tensor.bitcast %162 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %597 = flow.dispatch.workgroups(%596) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %598 = flow.dispatch.workgroups(%595) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %599 = flow.tensor.bitcast %598 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %600 = flow.tensor.bitcast %597 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %601 = flow.dispatch.workgroups(%600, %599, %594) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %602 = flow.tensor.reshape %601 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %603 = flow.tensor.bitcast %161 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %604 = flow.tensor.bitcast %161 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %605 = flow.dispatch.workgroups(%604) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %606 = flow.dispatch.workgroups(%603) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %607 = flow.tensor.bitcast %606 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %608 = flow.tensor.bitcast %605 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %609 = flow.dispatch.workgroups(%608, %607, %594) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %610 = flow.tensor.reshape %609 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %611 = flow.tensor.bitcast %160 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %612 = flow.tensor.bitcast %160 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %613 = flow.dispatch.workgroups(%612) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %614 = flow.dispatch.workgroups(%611) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %615 = flow.tensor.bitcast %614 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %616 = flow.tensor.bitcast %613 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %617 = flow.dispatch.workgroups(%616, %615, %594) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %618 = flow.tensor.reshape %617 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %619 = flow.dispatch.workgroups(%602) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %620 = flow.dispatch.workgroups(%602) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %621 = flow.dispatch.workgroups(%619, %262, %620, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %622 = flow.dispatch.workgroups(%610) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %623 = flow.dispatch.workgroups(%610) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %624 = flow.dispatch.workgroups(%622, %262, %623, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %625 = flow.tensor.reshape %624 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %626 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c4_i64 = arith.constant 4 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c4_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %627 = flow.dispatch.workgroups(%626, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %628 = flow.dispatch.workgroups[%273](%625, %627, %543, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %543{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %629 = flow.dispatch.workgroups(%626, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %630 = flow.dispatch.workgroups[%273](%618, %629, %628, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %628{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %631 = flow.tensor.reshape %630 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %632 = flow.dispatch.workgroups[%210, %208](%631, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 4, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %633 = flow.tensor.reshape %632 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %634 = flow.tensor.reshape %621 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %635 = flow.dispatch.workgroups[%210, %208](%631, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 4, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %636 = flow.tensor.reshape %635 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %637 = flow.dispatch.workgroups[%283, %279](%634, %633, %636, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %638 = flow.tensor.bitcast %159 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %639 = flow.tensor.bitcast %159 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %640 = flow.dispatch.workgroups(%639) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %641 = flow.dispatch.workgroups(%638) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %642 = flow.tensor.bitcast %641 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %643 = flow.tensor.bitcast %640 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %644 = flow.tensor.reshape %637 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %645 = flow.dispatch.workgroups(%643, %642, %644, %587) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %646 = flow.tensor.reshape %645 : tensor<4x2048xf16> -> tensor<8192xf16>
    %647 = flow.dispatch.workgroups(%646) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %648 = flow.tensor.reshape %647 : tensor<8192xf32> -> tensor<4x2048xf32>
    %649 = flow.dispatch.workgroups(%645) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %650 = flow.dispatch.workgroups(%648, %649) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %651 = flow.dispatch.workgroups(%158, %650) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %652 = flow.tensor.reshape %651 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %653 = flow.tensor.bitcast %157 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %654 = flow.tensor.bitcast %157 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %655 = flow.dispatch.workgroups(%654) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %656 = flow.dispatch.workgroups(%653) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %657 = flow.tensor.bitcast %656 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %658 = flow.tensor.bitcast %655 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %659 = flow.tensor.bitcast %156 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %660 = flow.dispatch.workgroups(%659) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %661 = flow.tensor.bitcast %660 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %662 = flow.tensor.bitcast %156 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %663 = flow.dispatch.workgroups(%662) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %664 = flow.tensor.bitcast %663 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %665 = flow.dispatch.workgroups(%661, %664, %652) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %666 = flow.dispatch.workgroups(%658, %657, %652, %665) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %667 = flow.tensor.reshape %666 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %668 = flow.tensor.bitcast %155 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %669 = flow.tensor.bitcast %155 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %670 = flow.dispatch.workgroups(%669) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %671 = flow.dispatch.workgroups(%668) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %672 = flow.tensor.bitcast %671 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %673 = flow.tensor.bitcast %670 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %674 = flow.dispatch.workgroups(%673, %672, %667, %645) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %675 = flow.tensor.reshape %674 : tensor<4x2048xf16> -> tensor<8192xf16>
    %676 = flow.dispatch.workgroups(%675) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %677 = flow.tensor.reshape %676 : tensor<8192xf32> -> tensor<4x2048xf32>
    %678 = flow.dispatch.workgroups(%674) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %679 = flow.dispatch.workgroups(%677, %678) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %680 = flow.dispatch.workgroups(%154, %679) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %681 = flow.tensor.reshape %680 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %682 = flow.tensor.bitcast %153 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %683 = flow.tensor.bitcast %153 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %684 = flow.dispatch.workgroups(%683) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %685 = flow.dispatch.workgroups(%682) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %686 = flow.tensor.bitcast %685 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %687 = flow.tensor.bitcast %684 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %688 = flow.dispatch.workgroups(%687, %686, %681) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %689 = flow.tensor.reshape %688 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %690 = flow.tensor.bitcast %152 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %691 = flow.tensor.bitcast %152 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %692 = flow.dispatch.workgroups(%691) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %693 = flow.dispatch.workgroups(%690) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %694 = flow.tensor.bitcast %693 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %695 = flow.tensor.bitcast %692 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %696 = flow.dispatch.workgroups(%695, %694, %681) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %697 = flow.tensor.reshape %696 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %698 = flow.tensor.bitcast %151 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %699 = flow.tensor.bitcast %151 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %700 = flow.dispatch.workgroups(%699) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %701 = flow.dispatch.workgroups(%698) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %702 = flow.tensor.bitcast %701 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %703 = flow.tensor.bitcast %700 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %704 = flow.dispatch.workgroups(%703, %702, %681) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %705 = flow.tensor.reshape %704 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %706 = flow.dispatch.workgroups(%689) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %707 = flow.dispatch.workgroups(%689) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %708 = flow.dispatch.workgroups(%706, %262, %707, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %709 = flow.dispatch.workgroups(%697) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %710 = flow.dispatch.workgroups(%697) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %711 = flow.dispatch.workgroups(%709, %262, %710, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %712 = flow.tensor.reshape %711 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %713 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c5_i64 = arith.constant 5 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c5_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %714 = flow.dispatch.workgroups(%713, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %715 = flow.dispatch.workgroups[%273](%712, %714, %630, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %630{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %716 = flow.dispatch.workgroups(%713, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %717 = flow.dispatch.workgroups[%273](%705, %716, %715, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %715{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %718 = flow.tensor.reshape %717 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %719 = flow.dispatch.workgroups[%210, %208](%718, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 5, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %720 = flow.tensor.reshape %719 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %721 = flow.tensor.reshape %708 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %722 = flow.dispatch.workgroups[%210, %208](%718, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 5, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %723 = flow.tensor.reshape %722 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %724 = flow.dispatch.workgroups[%283, %279](%721, %720, %723, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %725 = flow.tensor.bitcast %150 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %726 = flow.tensor.bitcast %150 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %727 = flow.dispatch.workgroups(%726) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %728 = flow.dispatch.workgroups(%725) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %729 = flow.tensor.bitcast %728 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %730 = flow.tensor.bitcast %727 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %731 = flow.tensor.reshape %724 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %732 = flow.dispatch.workgroups(%730, %729, %731, %674) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %733 = flow.tensor.reshape %732 : tensor<4x2048xf16> -> tensor<8192xf16>
    %734 = flow.dispatch.workgroups(%733) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %735 = flow.tensor.reshape %734 : tensor<8192xf32> -> tensor<4x2048xf32>
    %736 = flow.dispatch.workgroups(%732) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %737 = flow.dispatch.workgroups(%735, %736) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %738 = flow.dispatch.workgroups(%149, %737) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %739 = flow.tensor.reshape %738 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %740 = flow.tensor.bitcast %148 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %741 = flow.tensor.bitcast %148 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %742 = flow.dispatch.workgroups(%741) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %743 = flow.dispatch.workgroups(%740) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %744 = flow.tensor.bitcast %743 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %745 = flow.tensor.bitcast %742 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %746 = flow.tensor.bitcast %147 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %747 = flow.dispatch.workgroups(%746) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %748 = flow.tensor.bitcast %747 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %749 = flow.tensor.bitcast %147 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %750 = flow.dispatch.workgroups(%749) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %751 = flow.tensor.bitcast %750 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %752 = flow.dispatch.workgroups(%748, %751, %739) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %753 = flow.dispatch.workgroups(%745, %744, %739, %752) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %754 = flow.tensor.reshape %753 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %755 = flow.tensor.bitcast %146 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %756 = flow.tensor.bitcast %146 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %757 = flow.dispatch.workgroups(%756) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %758 = flow.dispatch.workgroups(%755) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %759 = flow.tensor.bitcast %758 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %760 = flow.tensor.bitcast %757 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %761 = flow.dispatch.workgroups(%760, %759, %754, %732) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %762 = flow.tensor.reshape %761 : tensor<4x2048xf16> -> tensor<8192xf16>
    %763 = flow.dispatch.workgroups(%762) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %764 = flow.tensor.reshape %763 : tensor<8192xf32> -> tensor<4x2048xf32>
    %765 = flow.dispatch.workgroups(%761) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %766 = flow.dispatch.workgroups(%764, %765) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %767 = flow.dispatch.workgroups(%145, %766) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %768 = flow.tensor.reshape %767 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %769 = flow.tensor.bitcast %144 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %770 = flow.tensor.bitcast %144 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %771 = flow.dispatch.workgroups(%770) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %772 = flow.dispatch.workgroups(%769) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %773 = flow.tensor.bitcast %772 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %774 = flow.tensor.bitcast %771 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %775 = flow.dispatch.workgroups(%774, %773, %768) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %776 = flow.tensor.reshape %775 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %777 = flow.tensor.bitcast %143 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %778 = flow.tensor.bitcast %143 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %779 = flow.dispatch.workgroups(%778) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %780 = flow.dispatch.workgroups(%777) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %781 = flow.tensor.bitcast %780 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %782 = flow.tensor.bitcast %779 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %783 = flow.dispatch.workgroups(%782, %781, %768) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %784 = flow.tensor.reshape %783 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %785 = flow.tensor.bitcast %142 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %786 = flow.tensor.bitcast %142 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %787 = flow.dispatch.workgroups(%786) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %788 = flow.dispatch.workgroups(%785) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %789 = flow.tensor.bitcast %788 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %790 = flow.tensor.bitcast %787 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %791 = flow.dispatch.workgroups(%790, %789, %768) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %792 = flow.tensor.reshape %791 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %793 = flow.dispatch.workgroups(%776) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %794 = flow.dispatch.workgroups(%776) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %795 = flow.dispatch.workgroups(%793, %262, %794, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %796 = flow.dispatch.workgroups(%784) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %797 = flow.dispatch.workgroups(%784) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %798 = flow.dispatch.workgroups(%796, %262, %797, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %799 = flow.tensor.reshape %798 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %800 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c6_i64 = arith.constant 6 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c6_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %801 = flow.dispatch.workgroups(%800, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %802 = flow.dispatch.workgroups[%273](%799, %801, %717, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %717{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %803 = flow.dispatch.workgroups(%800, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %804 = flow.dispatch.workgroups[%273](%792, %803, %802, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %802{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %805 = flow.tensor.reshape %804 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %806 = flow.dispatch.workgroups[%210, %208](%805, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 6, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %807 = flow.tensor.reshape %806 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %808 = flow.tensor.reshape %795 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %809 = flow.dispatch.workgroups[%210, %208](%805, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 6, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %810 = flow.tensor.reshape %809 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %811 = flow.dispatch.workgroups[%283, %279](%808, %807, %810, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %812 = flow.tensor.bitcast %141 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %813 = flow.tensor.bitcast %141 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %814 = flow.dispatch.workgroups(%813) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %815 = flow.dispatch.workgroups(%812) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %816 = flow.tensor.bitcast %815 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %817 = flow.tensor.bitcast %814 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %818 = flow.tensor.reshape %811 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %819 = flow.dispatch.workgroups(%817, %816, %818, %761) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %820 = flow.tensor.reshape %819 : tensor<4x2048xf16> -> tensor<8192xf16>
    %821 = flow.dispatch.workgroups(%820) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %822 = flow.tensor.reshape %821 : tensor<8192xf32> -> tensor<4x2048xf32>
    %823 = flow.dispatch.workgroups(%819) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %824 = flow.dispatch.workgroups(%822, %823) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %825 = flow.dispatch.workgroups(%140, %824) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %826 = flow.tensor.reshape %825 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %827 = flow.tensor.bitcast %139 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %828 = flow.tensor.bitcast %139 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %829 = flow.dispatch.workgroups(%828) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %830 = flow.dispatch.workgroups(%827) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %831 = flow.tensor.bitcast %830 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %832 = flow.tensor.bitcast %829 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %833 = flow.tensor.bitcast %138 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %834 = flow.dispatch.workgroups(%833) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %835 = flow.tensor.bitcast %834 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %836 = flow.tensor.bitcast %138 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %837 = flow.dispatch.workgroups(%836) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %838 = flow.tensor.bitcast %837 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %839 = flow.dispatch.workgroups(%835, %838, %826) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %840 = flow.dispatch.workgroups(%832, %831, %826, %839) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %841 = flow.tensor.reshape %840 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %842 = flow.tensor.bitcast %137 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %843 = flow.tensor.bitcast %137 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %844 = flow.dispatch.workgroups(%843) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %845 = flow.dispatch.workgroups(%842) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %846 = flow.tensor.bitcast %845 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %847 = flow.tensor.bitcast %844 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %848 = flow.dispatch.workgroups(%847, %846, %841, %819) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %849 = flow.tensor.reshape %848 : tensor<4x2048xf16> -> tensor<8192xf16>
    %850 = flow.dispatch.workgroups(%849) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %851 = flow.tensor.reshape %850 : tensor<8192xf32> -> tensor<4x2048xf32>
    %852 = flow.dispatch.workgroups(%848) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %853 = flow.dispatch.workgroups(%851, %852) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %854 = flow.dispatch.workgroups(%136, %853) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %855 = flow.tensor.reshape %854 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %856 = flow.tensor.bitcast %135 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %857 = flow.tensor.bitcast %135 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %858 = flow.dispatch.workgroups(%857) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %859 = flow.dispatch.workgroups(%856) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %860 = flow.tensor.bitcast %859 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %861 = flow.tensor.bitcast %858 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %862 = flow.dispatch.workgroups(%861, %860, %855) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %863 = flow.tensor.reshape %862 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %864 = flow.tensor.bitcast %134 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %865 = flow.tensor.bitcast %134 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %866 = flow.dispatch.workgroups(%865) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %867 = flow.dispatch.workgroups(%864) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %868 = flow.tensor.bitcast %867 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %869 = flow.tensor.bitcast %866 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %870 = flow.dispatch.workgroups(%869, %868, %855) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %871 = flow.tensor.reshape %870 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %872 = flow.tensor.bitcast %133 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %873 = flow.tensor.bitcast %133 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %874 = flow.dispatch.workgroups(%873) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %875 = flow.dispatch.workgroups(%872) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %876 = flow.tensor.bitcast %875 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %877 = flow.tensor.bitcast %874 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %878 = flow.dispatch.workgroups(%877, %876, %855) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %879 = flow.tensor.reshape %878 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %880 = flow.dispatch.workgroups(%863) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %881 = flow.dispatch.workgroups(%863) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %882 = flow.dispatch.workgroups(%880, %262, %881, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %883 = flow.dispatch.workgroups(%871) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %884 = flow.dispatch.workgroups(%871) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %885 = flow.dispatch.workgroups(%883, %262, %884, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %886 = flow.tensor.reshape %885 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %887 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c7_i64 = arith.constant 7 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c7_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %888 = flow.dispatch.workgroups(%887, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %889 = flow.dispatch.workgroups[%273](%886, %888, %804, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %804{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %890 = flow.dispatch.workgroups(%887, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %891 = flow.dispatch.workgroups[%273](%879, %890, %889, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %889{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %892 = flow.tensor.reshape %891 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %893 = flow.dispatch.workgroups[%210, %208](%892, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 7, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %894 = flow.tensor.reshape %893 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %895 = flow.tensor.reshape %882 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %896 = flow.dispatch.workgroups[%210, %208](%892, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 7, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %897 = flow.tensor.reshape %896 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %898 = flow.dispatch.workgroups[%283, %279](%895, %894, %897, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %899 = flow.tensor.bitcast %132 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %900 = flow.tensor.bitcast %132 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %901 = flow.dispatch.workgroups(%900) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %902 = flow.dispatch.workgroups(%899) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %903 = flow.tensor.bitcast %902 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %904 = flow.tensor.bitcast %901 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %905 = flow.tensor.reshape %898 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %906 = flow.dispatch.workgroups(%904, %903, %905, %848) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %907 = flow.tensor.reshape %906 : tensor<4x2048xf16> -> tensor<8192xf16>
    %908 = flow.dispatch.workgroups(%907) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %909 = flow.tensor.reshape %908 : tensor<8192xf32> -> tensor<4x2048xf32>
    %910 = flow.dispatch.workgroups(%906) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %911 = flow.dispatch.workgroups(%909, %910) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %912 = flow.dispatch.workgroups(%131, %911) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %913 = flow.tensor.reshape %912 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %914 = flow.tensor.bitcast %130 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %915 = flow.tensor.bitcast %130 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %916 = flow.dispatch.workgroups(%915) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %917 = flow.dispatch.workgroups(%914) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %918 = flow.tensor.bitcast %917 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %919 = flow.tensor.bitcast %916 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %920 = flow.tensor.bitcast %129 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %921 = flow.dispatch.workgroups(%920) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %922 = flow.tensor.bitcast %921 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %923 = flow.tensor.bitcast %129 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %924 = flow.dispatch.workgroups(%923) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %925 = flow.tensor.bitcast %924 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %926 = flow.dispatch.workgroups(%922, %925, %913) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %927 = flow.dispatch.workgroups(%919, %918, %913, %926) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %928 = flow.tensor.reshape %927 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %929 = flow.tensor.bitcast %128 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %930 = flow.tensor.bitcast %128 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %931 = flow.dispatch.workgroups(%930) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %932 = flow.dispatch.workgroups(%929) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %933 = flow.tensor.bitcast %932 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %934 = flow.tensor.bitcast %931 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %935 = flow.dispatch.workgroups(%934, %933, %928, %906) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %936 = flow.tensor.reshape %935 : tensor<4x2048xf16> -> tensor<8192xf16>
    %937 = flow.dispatch.workgroups(%936) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %938 = flow.tensor.reshape %937 : tensor<8192xf32> -> tensor<4x2048xf32>
    %939 = flow.dispatch.workgroups(%935) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %940 = flow.dispatch.workgroups(%938, %939) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %941 = flow.dispatch.workgroups(%127, %940) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %942 = flow.tensor.reshape %941 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %943 = flow.tensor.bitcast %126 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %944 = flow.tensor.bitcast %126 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %945 = flow.dispatch.workgroups(%944) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %946 = flow.dispatch.workgroups(%943) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %947 = flow.tensor.bitcast %946 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %948 = flow.tensor.bitcast %945 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %949 = flow.dispatch.workgroups(%948, %947, %942) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %950 = flow.tensor.reshape %949 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %951 = flow.tensor.bitcast %125 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %952 = flow.tensor.bitcast %125 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %953 = flow.dispatch.workgroups(%952) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %954 = flow.dispatch.workgroups(%951) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %955 = flow.tensor.bitcast %954 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %956 = flow.tensor.bitcast %953 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %957 = flow.dispatch.workgroups(%956, %955, %942) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %958 = flow.tensor.reshape %957 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %959 = flow.tensor.bitcast %124 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %960 = flow.tensor.bitcast %124 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %961 = flow.dispatch.workgroups(%960) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %962 = flow.dispatch.workgroups(%959) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %963 = flow.tensor.bitcast %962 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %964 = flow.tensor.bitcast %961 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %965 = flow.dispatch.workgroups(%964, %963, %942) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %966 = flow.tensor.reshape %965 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %967 = flow.dispatch.workgroups(%950) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %968 = flow.dispatch.workgroups(%950) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %969 = flow.dispatch.workgroups(%967, %262, %968, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %970 = flow.dispatch.workgroups(%958) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %971 = flow.dispatch.workgroups(%958) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %972 = flow.dispatch.workgroups(%970, %262, %971, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %973 = flow.tensor.reshape %972 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %974 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c8_i64 = arith.constant 8 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c8_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %975 = flow.dispatch.workgroups(%974, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %976 = flow.dispatch.workgroups[%273](%973, %975, %891, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %891{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %977 = flow.dispatch.workgroups(%974, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %978 = flow.dispatch.workgroups[%273](%966, %977, %976, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %976{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %979 = flow.tensor.reshape %978 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %980 = flow.dispatch.workgroups[%210, %208](%979, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 8, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %981 = flow.tensor.reshape %980 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %982 = flow.tensor.reshape %969 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %983 = flow.dispatch.workgroups[%210, %208](%979, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 8, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %984 = flow.tensor.reshape %983 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %985 = flow.dispatch.workgroups[%283, %279](%982, %981, %984, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %986 = flow.tensor.bitcast %123 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %987 = flow.tensor.bitcast %123 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %988 = flow.dispatch.workgroups(%987) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %989 = flow.dispatch.workgroups(%986) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %990 = flow.tensor.bitcast %989 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %991 = flow.tensor.bitcast %988 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %992 = flow.tensor.reshape %985 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %993 = flow.dispatch.workgroups(%991, %990, %992, %935) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %994 = flow.tensor.reshape %993 : tensor<4x2048xf16> -> tensor<8192xf16>
    %995 = flow.dispatch.workgroups(%994) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %996 = flow.tensor.reshape %995 : tensor<8192xf32> -> tensor<4x2048xf32>
    %997 = flow.dispatch.workgroups(%993) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %998 = flow.dispatch.workgroups(%996, %997) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %999 = flow.dispatch.workgroups(%122, %998) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1000 = flow.tensor.reshape %999 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1001 = flow.tensor.bitcast %121 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1002 = flow.tensor.bitcast %121 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1003 = flow.dispatch.workgroups(%1002) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1004 = flow.dispatch.workgroups(%1001) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1005 = flow.tensor.bitcast %1004 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1006 = flow.tensor.bitcast %1003 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1007 = flow.tensor.bitcast %120 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1008 = flow.dispatch.workgroups(%1007) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1009 = flow.tensor.bitcast %1008 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1010 = flow.tensor.bitcast %120 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1011 = flow.dispatch.workgroups(%1010) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1012 = flow.tensor.bitcast %1011 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1013 = flow.dispatch.workgroups(%1009, %1012, %1000) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1014 = flow.dispatch.workgroups(%1006, %1005, %1000, %1013) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1015 = flow.tensor.reshape %1014 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1016 = flow.tensor.bitcast %119 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1017 = flow.tensor.bitcast %119 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1018 = flow.dispatch.workgroups(%1017) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1019 = flow.dispatch.workgroups(%1016) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1020 = flow.tensor.bitcast %1019 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1021 = flow.tensor.bitcast %1018 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1022 = flow.dispatch.workgroups(%1021, %1020, %1015, %993) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1023 = flow.tensor.reshape %1022 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1024 = flow.dispatch.workgroups(%1023) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1025 = flow.tensor.reshape %1024 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1026 = flow.dispatch.workgroups(%1022) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1027 = flow.dispatch.workgroups(%1025, %1026) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1028 = flow.dispatch.workgroups(%118, %1027) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1029 = flow.tensor.reshape %1028 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1030 = flow.tensor.bitcast %117 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1031 = flow.tensor.bitcast %117 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1032 = flow.dispatch.workgroups(%1031) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1033 = flow.dispatch.workgroups(%1030) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1034 = flow.tensor.bitcast %1033 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1035 = flow.tensor.bitcast %1032 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1036 = flow.dispatch.workgroups(%1035, %1034, %1029) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1037 = flow.tensor.reshape %1036 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1038 = flow.tensor.bitcast %116 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1039 = flow.tensor.bitcast %116 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1040 = flow.dispatch.workgroups(%1039) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1041 = flow.dispatch.workgroups(%1038) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1042 = flow.tensor.bitcast %1041 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1043 = flow.tensor.bitcast %1040 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1044 = flow.dispatch.workgroups(%1043, %1042, %1029) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1045 = flow.tensor.reshape %1044 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1046 = flow.tensor.bitcast %115 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1047 = flow.tensor.bitcast %115 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1048 = flow.dispatch.workgroups(%1047) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1049 = flow.dispatch.workgroups(%1046) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1050 = flow.tensor.bitcast %1049 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1051 = flow.tensor.bitcast %1048 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1052 = flow.dispatch.workgroups(%1051, %1050, %1029) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1053 = flow.tensor.reshape %1052 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1054 = flow.dispatch.workgroups(%1037) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1055 = flow.dispatch.workgroups(%1037) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1056 = flow.dispatch.workgroups(%1054, %262, %1055, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1057 = flow.dispatch.workgroups(%1045) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1058 = flow.dispatch.workgroups(%1045) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1059 = flow.dispatch.workgroups(%1057, %262, %1058, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1060 = flow.tensor.reshape %1059 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1061 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c9_i64 = arith.constant 9 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c9_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1062 = flow.dispatch.workgroups(%1061, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1063 = flow.dispatch.workgroups[%273](%1060, %1062, %978, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %978{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1064 = flow.dispatch.workgroups(%1061, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1065 = flow.dispatch.workgroups[%273](%1053, %1064, %1063, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1063{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1066 = flow.tensor.reshape %1065 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1067 = flow.dispatch.workgroups[%210, %208](%1066, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 9, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1068 = flow.tensor.reshape %1067 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1069 = flow.tensor.reshape %1056 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1070 = flow.dispatch.workgroups[%210, %208](%1066, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 9, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1071 = flow.tensor.reshape %1070 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1072 = flow.dispatch.workgroups[%283, %279](%1069, %1068, %1071, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1073 = flow.tensor.bitcast %114 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1074 = flow.tensor.bitcast %114 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1075 = flow.dispatch.workgroups(%1074) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1076 = flow.dispatch.workgroups(%1073) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1077 = flow.tensor.bitcast %1076 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1078 = flow.tensor.bitcast %1075 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1079 = flow.tensor.reshape %1072 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1080 = flow.dispatch.workgroups(%1078, %1077, %1079, %1022) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1081 = flow.tensor.reshape %1080 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1082 = flow.dispatch.workgroups(%1081) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1083 = flow.tensor.reshape %1082 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1084 = flow.dispatch.workgroups(%1080) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1085 = flow.dispatch.workgroups(%1083, %1084) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1086 = flow.dispatch.workgroups(%113, %1085) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1087 = flow.tensor.reshape %1086 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1088 = flow.tensor.bitcast %112 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1089 = flow.tensor.bitcast %112 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1090 = flow.dispatch.workgroups(%1089) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1091 = flow.dispatch.workgroups(%1088) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1092 = flow.tensor.bitcast %1091 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1093 = flow.tensor.bitcast %1090 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1094 = flow.tensor.bitcast %111 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1095 = flow.dispatch.workgroups(%1094) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1096 = flow.tensor.bitcast %1095 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1097 = flow.tensor.bitcast %111 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1098 = flow.dispatch.workgroups(%1097) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1099 = flow.tensor.bitcast %1098 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1100 = flow.dispatch.workgroups(%1096, %1099, %1087) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1101 = flow.dispatch.workgroups(%1093, %1092, %1087, %1100) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1102 = flow.tensor.reshape %1101 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1103 = flow.tensor.bitcast %110 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1104 = flow.tensor.bitcast %110 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1105 = flow.dispatch.workgroups(%1104) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1106 = flow.dispatch.workgroups(%1103) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1107 = flow.tensor.bitcast %1106 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1108 = flow.tensor.bitcast %1105 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1109 = flow.dispatch.workgroups(%1108, %1107, %1102, %1080) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1110 = flow.tensor.reshape %1109 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1111 = flow.dispatch.workgroups(%1110) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1112 = flow.tensor.reshape %1111 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1113 = flow.dispatch.workgroups(%1109) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1114 = flow.dispatch.workgroups(%1112, %1113) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1115 = flow.dispatch.workgroups(%109, %1114) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1116 = flow.tensor.reshape %1115 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1117 = flow.tensor.bitcast %108 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1118 = flow.tensor.bitcast %108 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1119 = flow.dispatch.workgroups(%1118) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1120 = flow.dispatch.workgroups(%1117) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1121 = flow.tensor.bitcast %1120 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1122 = flow.tensor.bitcast %1119 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1123 = flow.dispatch.workgroups(%1122, %1121, %1116) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1124 = flow.tensor.reshape %1123 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1125 = flow.tensor.bitcast %107 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1126 = flow.tensor.bitcast %107 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1127 = flow.dispatch.workgroups(%1126) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1128 = flow.dispatch.workgroups(%1125) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1129 = flow.tensor.bitcast %1128 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1130 = flow.tensor.bitcast %1127 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1131 = flow.dispatch.workgroups(%1130, %1129, %1116) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1132 = flow.tensor.reshape %1131 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1133 = flow.tensor.bitcast %106 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1134 = flow.tensor.bitcast %106 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1135 = flow.dispatch.workgroups(%1134) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1136 = flow.dispatch.workgroups(%1133) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1137 = flow.tensor.bitcast %1136 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1138 = flow.tensor.bitcast %1135 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1139 = flow.dispatch.workgroups(%1138, %1137, %1116) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1140 = flow.tensor.reshape %1139 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1141 = flow.dispatch.workgroups(%1124) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1142 = flow.dispatch.workgroups(%1124) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1143 = flow.dispatch.workgroups(%1141, %262, %1142, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1144 = flow.dispatch.workgroups(%1132) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1145 = flow.dispatch.workgroups(%1132) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1146 = flow.dispatch.workgroups(%1144, %262, %1145, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1147 = flow.tensor.reshape %1146 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1148 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c10_i64 = arith.constant 10 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c10_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1149 = flow.dispatch.workgroups(%1148, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1150 = flow.dispatch.workgroups[%273](%1147, %1149, %1065, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1065{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1151 = flow.dispatch.workgroups(%1148, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1152 = flow.dispatch.workgroups[%273](%1140, %1151, %1150, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1150{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1153 = flow.tensor.reshape %1152 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1154 = flow.dispatch.workgroups[%210, %208](%1153, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 10, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1155 = flow.tensor.reshape %1154 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1156 = flow.tensor.reshape %1143 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1157 = flow.dispatch.workgroups[%210, %208](%1153, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 10, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1158 = flow.tensor.reshape %1157 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1159 = flow.dispatch.workgroups[%283, %279](%1156, %1155, %1158, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1160 = flow.tensor.bitcast %105 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1161 = flow.tensor.bitcast %105 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1162 = flow.dispatch.workgroups(%1161) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1163 = flow.dispatch.workgroups(%1160) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1164 = flow.tensor.bitcast %1163 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1165 = flow.tensor.bitcast %1162 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1166 = flow.tensor.reshape %1159 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1167 = flow.dispatch.workgroups(%1165, %1164, %1166, %1109) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1168 = flow.tensor.reshape %1167 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1169 = flow.dispatch.workgroups(%1168) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1170 = flow.tensor.reshape %1169 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1171 = flow.dispatch.workgroups(%1167) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1172 = flow.dispatch.workgroups(%1170, %1171) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1173 = flow.dispatch.workgroups(%104, %1172) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1174 = flow.tensor.reshape %1173 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1175 = flow.tensor.bitcast %103 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1176 = flow.tensor.bitcast %103 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1177 = flow.dispatch.workgroups(%1176) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1178 = flow.dispatch.workgroups(%1175) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1179 = flow.tensor.bitcast %1178 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1180 = flow.tensor.bitcast %1177 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1181 = flow.tensor.bitcast %102 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1182 = flow.dispatch.workgroups(%1181) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1183 = flow.tensor.bitcast %1182 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1184 = flow.tensor.bitcast %102 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1185 = flow.dispatch.workgroups(%1184) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1186 = flow.tensor.bitcast %1185 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1187 = flow.dispatch.workgroups(%1183, %1186, %1174) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1188 = flow.dispatch.workgroups(%1180, %1179, %1174, %1187) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1189 = flow.tensor.reshape %1188 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1190 = flow.tensor.bitcast %101 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1191 = flow.tensor.bitcast %101 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1192 = flow.dispatch.workgroups(%1191) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1193 = flow.dispatch.workgroups(%1190) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1194 = flow.tensor.bitcast %1193 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1195 = flow.tensor.bitcast %1192 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1196 = flow.dispatch.workgroups(%1195, %1194, %1189, %1167) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1197 = flow.tensor.reshape %1196 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1198 = flow.dispatch.workgroups(%1197) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1199 = flow.tensor.reshape %1198 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1200 = flow.dispatch.workgroups(%1196) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1201 = flow.dispatch.workgroups(%1199, %1200) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1202 = flow.dispatch.workgroups(%100, %1201) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1203 = flow.tensor.reshape %1202 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1204 = flow.tensor.bitcast %99 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1205 = flow.tensor.bitcast %99 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1206 = flow.dispatch.workgroups(%1205) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1207 = flow.dispatch.workgroups(%1204) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1208 = flow.tensor.bitcast %1207 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1209 = flow.tensor.bitcast %1206 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1210 = flow.dispatch.workgroups(%1209, %1208, %1203) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1211 = flow.tensor.reshape %1210 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1212 = flow.tensor.bitcast %98 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1213 = flow.tensor.bitcast %98 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1214 = flow.dispatch.workgroups(%1213) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1215 = flow.dispatch.workgroups(%1212) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1216 = flow.tensor.bitcast %1215 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1217 = flow.tensor.bitcast %1214 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1218 = flow.dispatch.workgroups(%1217, %1216, %1203) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1219 = flow.tensor.reshape %1218 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1220 = flow.tensor.bitcast %97 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1221 = flow.tensor.bitcast %97 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1222 = flow.dispatch.workgroups(%1221) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1223 = flow.dispatch.workgroups(%1220) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1224 = flow.tensor.bitcast %1223 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1225 = flow.tensor.bitcast %1222 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1226 = flow.dispatch.workgroups(%1225, %1224, %1203) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1227 = flow.tensor.reshape %1226 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1228 = flow.dispatch.workgroups(%1211) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1229 = flow.dispatch.workgroups(%1211) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1230 = flow.dispatch.workgroups(%1228, %262, %1229, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1231 = flow.dispatch.workgroups(%1219) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1232 = flow.dispatch.workgroups(%1219) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1233 = flow.dispatch.workgroups(%1231, %262, %1232, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1234 = flow.tensor.reshape %1233 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1235 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c11_i64 = arith.constant 11 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c11_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1236 = flow.dispatch.workgroups(%1235, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1237 = flow.dispatch.workgroups[%273](%1234, %1236, %1152, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1152{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1238 = flow.dispatch.workgroups(%1235, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1239 = flow.dispatch.workgroups[%273](%1227, %1238, %1237, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1237{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1240 = flow.tensor.reshape %1239 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1241 = flow.dispatch.workgroups[%210, %208](%1240, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 11, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1242 = flow.tensor.reshape %1241 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1243 = flow.tensor.reshape %1230 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1244 = flow.dispatch.workgroups[%210, %208](%1240, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 11, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1245 = flow.tensor.reshape %1244 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1246 = flow.dispatch.workgroups[%283, %279](%1243, %1242, %1245, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1247 = flow.tensor.bitcast %96 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1248 = flow.tensor.bitcast %96 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1249 = flow.dispatch.workgroups(%1248) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1250 = flow.dispatch.workgroups(%1247) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1251 = flow.tensor.bitcast %1250 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1252 = flow.tensor.bitcast %1249 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1253 = flow.tensor.reshape %1246 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1254 = flow.dispatch.workgroups(%1252, %1251, %1253, %1196) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1255 = flow.tensor.reshape %1254 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1256 = flow.dispatch.workgroups(%1255) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1257 = flow.tensor.reshape %1256 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1258 = flow.dispatch.workgroups(%1254) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1259 = flow.dispatch.workgroups(%1257, %1258) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1260 = flow.dispatch.workgroups(%95, %1259) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1261 = flow.tensor.reshape %1260 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1262 = flow.tensor.bitcast %94 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1263 = flow.tensor.bitcast %94 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1264 = flow.dispatch.workgroups(%1263) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1265 = flow.dispatch.workgroups(%1262) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1266 = flow.tensor.bitcast %1265 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1267 = flow.tensor.bitcast %1264 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1268 = flow.tensor.bitcast %93 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1269 = flow.dispatch.workgroups(%1268) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1270 = flow.tensor.bitcast %1269 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1271 = flow.tensor.bitcast %93 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1272 = flow.dispatch.workgroups(%1271) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1273 = flow.tensor.bitcast %1272 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1274 = flow.dispatch.workgroups(%1270, %1273, %1261) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1275 = flow.dispatch.workgroups(%1267, %1266, %1261, %1274) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1276 = flow.tensor.reshape %1275 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1277 = flow.tensor.bitcast %92 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1278 = flow.tensor.bitcast %92 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1279 = flow.dispatch.workgroups(%1278) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1280 = flow.dispatch.workgroups(%1277) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1281 = flow.tensor.bitcast %1280 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1282 = flow.tensor.bitcast %1279 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1283 = flow.dispatch.workgroups(%1282, %1281, %1276, %1254) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1284 = flow.tensor.reshape %1283 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1285 = flow.dispatch.workgroups(%1284) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1286 = flow.tensor.reshape %1285 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1287 = flow.dispatch.workgroups(%1283) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1288 = flow.dispatch.workgroups(%1286, %1287) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1289 = flow.dispatch.workgroups(%91, %1288) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1290 = flow.tensor.reshape %1289 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1291 = flow.tensor.bitcast %90 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1292 = flow.tensor.bitcast %90 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1293 = flow.dispatch.workgroups(%1292) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1294 = flow.dispatch.workgroups(%1291) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1295 = flow.tensor.bitcast %1294 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1296 = flow.tensor.bitcast %1293 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1297 = flow.dispatch.workgroups(%1296, %1295, %1290) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1298 = flow.tensor.reshape %1297 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1299 = flow.tensor.bitcast %89 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1300 = flow.tensor.bitcast %89 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1301 = flow.dispatch.workgroups(%1300) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1302 = flow.dispatch.workgroups(%1299) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1303 = flow.tensor.bitcast %1302 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1304 = flow.tensor.bitcast %1301 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1305 = flow.dispatch.workgroups(%1304, %1303, %1290) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1306 = flow.tensor.reshape %1305 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1307 = flow.tensor.bitcast %88 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1308 = flow.tensor.bitcast %88 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1309 = flow.dispatch.workgroups(%1308) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1310 = flow.dispatch.workgroups(%1307) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1311 = flow.tensor.bitcast %1310 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1312 = flow.tensor.bitcast %1309 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1313 = flow.dispatch.workgroups(%1312, %1311, %1290) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1314 = flow.tensor.reshape %1313 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1315 = flow.dispatch.workgroups(%1298) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1316 = flow.dispatch.workgroups(%1298) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1317 = flow.dispatch.workgroups(%1315, %262, %1316, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1318 = flow.dispatch.workgroups(%1306) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1319 = flow.dispatch.workgroups(%1306) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1320 = flow.dispatch.workgroups(%1318, %262, %1319, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1321 = flow.tensor.reshape %1320 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1322 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c12_i64 = arith.constant 12 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c12_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1323 = flow.dispatch.workgroups(%1322, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1324 = flow.dispatch.workgroups[%273](%1321, %1323, %1239, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1239{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1325 = flow.dispatch.workgroups(%1322, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1326 = flow.dispatch.workgroups[%273](%1314, %1325, %1324, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1324{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1327 = flow.tensor.reshape %1326 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1328 = flow.dispatch.workgroups[%210, %208](%1327, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 12, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1329 = flow.tensor.reshape %1328 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1330 = flow.tensor.reshape %1317 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1331 = flow.dispatch.workgroups[%210, %208](%1327, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 12, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1332 = flow.tensor.reshape %1331 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1333 = flow.dispatch.workgroups[%283, %279](%1330, %1329, %1332, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1334 = flow.tensor.bitcast %87 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1335 = flow.tensor.bitcast %87 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1336 = flow.dispatch.workgroups(%1335) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1337 = flow.dispatch.workgroups(%1334) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1338 = flow.tensor.bitcast %1337 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1339 = flow.tensor.bitcast %1336 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1340 = flow.tensor.reshape %1333 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1341 = flow.dispatch.workgroups(%1339, %1338, %1340, %1283) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1342 = flow.tensor.reshape %1341 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1343 = flow.dispatch.workgroups(%1342) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1344 = flow.tensor.reshape %1343 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1345 = flow.dispatch.workgroups(%1341) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1346 = flow.dispatch.workgroups(%1344, %1345) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1347 = flow.dispatch.workgroups(%86, %1346) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1348 = flow.tensor.reshape %1347 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1349 = flow.tensor.bitcast %85 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1350 = flow.tensor.bitcast %85 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1351 = flow.dispatch.workgroups(%1350) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1352 = flow.dispatch.workgroups(%1349) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1353 = flow.tensor.bitcast %1352 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1354 = flow.tensor.bitcast %1351 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1355 = flow.tensor.bitcast %84 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1356 = flow.dispatch.workgroups(%1355) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1357 = flow.tensor.bitcast %1356 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1358 = flow.tensor.bitcast %84 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1359 = flow.dispatch.workgroups(%1358) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1360 = flow.tensor.bitcast %1359 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1361 = flow.dispatch.workgroups(%1357, %1360, %1348) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1362 = flow.dispatch.workgroups(%1354, %1353, %1348, %1361) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1363 = flow.tensor.reshape %1362 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1364 = flow.tensor.bitcast %83 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1365 = flow.tensor.bitcast %83 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1366 = flow.dispatch.workgroups(%1365) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1367 = flow.dispatch.workgroups(%1364) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1368 = flow.tensor.bitcast %1367 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1369 = flow.tensor.bitcast %1366 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1370 = flow.dispatch.workgroups(%1369, %1368, %1363, %1341) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1371 = flow.tensor.reshape %1370 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1372 = flow.dispatch.workgroups(%1371) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1373 = flow.tensor.reshape %1372 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1374 = flow.dispatch.workgroups(%1370) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1375 = flow.dispatch.workgroups(%1373, %1374) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1376 = flow.dispatch.workgroups(%82, %1375) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1377 = flow.tensor.reshape %1376 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1378 = flow.tensor.bitcast %81 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1379 = flow.tensor.bitcast %81 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1380 = flow.dispatch.workgroups(%1379) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1381 = flow.dispatch.workgroups(%1378) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1382 = flow.tensor.bitcast %1381 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1383 = flow.tensor.bitcast %1380 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1384 = flow.dispatch.workgroups(%1383, %1382, %1377) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1385 = flow.tensor.reshape %1384 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1386 = flow.tensor.bitcast %80 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1387 = flow.tensor.bitcast %80 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1388 = flow.dispatch.workgroups(%1387) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1389 = flow.dispatch.workgroups(%1386) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1390 = flow.tensor.bitcast %1389 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1391 = flow.tensor.bitcast %1388 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1392 = flow.dispatch.workgroups(%1391, %1390, %1377) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1393 = flow.tensor.reshape %1392 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1394 = flow.tensor.bitcast %79 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1395 = flow.tensor.bitcast %79 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1396 = flow.dispatch.workgroups(%1395) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1397 = flow.dispatch.workgroups(%1394) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1398 = flow.tensor.bitcast %1397 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1399 = flow.tensor.bitcast %1396 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1400 = flow.dispatch.workgroups(%1399, %1398, %1377) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1401 = flow.tensor.reshape %1400 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1402 = flow.dispatch.workgroups(%1385) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1403 = flow.dispatch.workgroups(%1385) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1404 = flow.dispatch.workgroups(%1402, %262, %1403, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1405 = flow.dispatch.workgroups(%1393) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1406 = flow.dispatch.workgroups(%1393) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1407 = flow.dispatch.workgroups(%1405, %262, %1406, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1408 = flow.tensor.reshape %1407 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1409 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c13_i64 = arith.constant 13 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c13_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1410 = flow.dispatch.workgroups(%1409, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1411 = flow.dispatch.workgroups[%273](%1408, %1410, %1326, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1326{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1412 = flow.dispatch.workgroups(%1409, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1413 = flow.dispatch.workgroups[%273](%1401, %1412, %1411, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1411{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1414 = flow.tensor.reshape %1413 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1415 = flow.dispatch.workgroups[%210, %208](%1414, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 13, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1416 = flow.tensor.reshape %1415 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1417 = flow.tensor.reshape %1404 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1418 = flow.dispatch.workgroups[%210, %208](%1414, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 13, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1419 = flow.tensor.reshape %1418 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1420 = flow.dispatch.workgroups[%283, %279](%1417, %1416, %1419, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1421 = flow.tensor.bitcast %78 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1422 = flow.tensor.bitcast %78 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1423 = flow.dispatch.workgroups(%1422) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1424 = flow.dispatch.workgroups(%1421) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1425 = flow.tensor.bitcast %1424 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1426 = flow.tensor.bitcast %1423 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1427 = flow.tensor.reshape %1420 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1428 = flow.dispatch.workgroups(%1426, %1425, %1427, %1370) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1429 = flow.tensor.reshape %1428 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1430 = flow.dispatch.workgroups(%1429) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1431 = flow.tensor.reshape %1430 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1432 = flow.dispatch.workgroups(%1428) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1433 = flow.dispatch.workgroups(%1431, %1432) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1434 = flow.dispatch.workgroups(%77, %1433) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1435 = flow.tensor.reshape %1434 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1436 = flow.tensor.bitcast %76 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1437 = flow.tensor.bitcast %76 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1438 = flow.dispatch.workgroups(%1437) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1439 = flow.dispatch.workgroups(%1436) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1440 = flow.tensor.bitcast %1439 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1441 = flow.tensor.bitcast %1438 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1442 = flow.tensor.bitcast %75 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1443 = flow.dispatch.workgroups(%1442) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1444 = flow.tensor.bitcast %1443 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1445 = flow.tensor.bitcast %75 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1446 = flow.dispatch.workgroups(%1445) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1447 = flow.tensor.bitcast %1446 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1448 = flow.dispatch.workgroups(%1444, %1447, %1435) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1449 = flow.dispatch.workgroups(%1441, %1440, %1435, %1448) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1450 = flow.tensor.reshape %1449 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1451 = flow.tensor.bitcast %74 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1452 = flow.tensor.bitcast %74 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1453 = flow.dispatch.workgroups(%1452) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1454 = flow.dispatch.workgroups(%1451) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1455 = flow.tensor.bitcast %1454 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1456 = flow.tensor.bitcast %1453 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1457 = flow.dispatch.workgroups(%1456, %1455, %1450, %1428) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1458 = flow.tensor.reshape %1457 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1459 = flow.dispatch.workgroups(%1458) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1460 = flow.tensor.reshape %1459 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1461 = flow.dispatch.workgroups(%1457) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1462 = flow.dispatch.workgroups(%1460, %1461) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1463 = flow.dispatch.workgroups(%73, %1462) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1464 = flow.tensor.reshape %1463 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1465 = flow.tensor.bitcast %72 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1466 = flow.tensor.bitcast %72 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1467 = flow.dispatch.workgroups(%1466) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1468 = flow.dispatch.workgroups(%1465) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1469 = flow.tensor.bitcast %1468 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1470 = flow.tensor.bitcast %1467 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1471 = flow.dispatch.workgroups(%1470, %1469, %1464) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1472 = flow.tensor.reshape %1471 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1473 = flow.tensor.bitcast %71 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1474 = flow.tensor.bitcast %71 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1475 = flow.dispatch.workgroups(%1474) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1476 = flow.dispatch.workgroups(%1473) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1477 = flow.tensor.bitcast %1476 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1478 = flow.tensor.bitcast %1475 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1479 = flow.dispatch.workgroups(%1478, %1477, %1464) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1480 = flow.tensor.reshape %1479 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1481 = flow.tensor.bitcast %70 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1482 = flow.tensor.bitcast %70 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1483 = flow.dispatch.workgroups(%1482) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1484 = flow.dispatch.workgroups(%1481) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1485 = flow.tensor.bitcast %1484 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1486 = flow.tensor.bitcast %1483 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1487 = flow.dispatch.workgroups(%1486, %1485, %1464) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1488 = flow.tensor.reshape %1487 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1489 = flow.dispatch.workgroups(%1472) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1490 = flow.dispatch.workgroups(%1472) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1491 = flow.dispatch.workgroups(%1489, %262, %1490, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1492 = flow.dispatch.workgroups(%1480) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1493 = flow.dispatch.workgroups(%1480) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1494 = flow.dispatch.workgroups(%1492, %262, %1493, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1495 = flow.tensor.reshape %1494 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1496 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c14_i64 = arith.constant 14 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c14_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1497 = flow.dispatch.workgroups(%1496, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1498 = flow.dispatch.workgroups[%273](%1495, %1497, %1413, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1413{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1499 = flow.dispatch.workgroups(%1496, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1500 = flow.dispatch.workgroups[%273](%1488, %1499, %1498, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1498{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1501 = flow.tensor.reshape %1500 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1502 = flow.dispatch.workgroups[%210, %208](%1501, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 14, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1503 = flow.tensor.reshape %1502 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1504 = flow.tensor.reshape %1491 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1505 = flow.dispatch.workgroups[%210, %208](%1501, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 14, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1506 = flow.tensor.reshape %1505 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1507 = flow.dispatch.workgroups[%283, %279](%1504, %1503, %1506, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1508 = flow.tensor.bitcast %69 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1509 = flow.tensor.bitcast %69 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1510 = flow.dispatch.workgroups(%1509) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1511 = flow.dispatch.workgroups(%1508) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1512 = flow.tensor.bitcast %1511 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1513 = flow.tensor.bitcast %1510 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1514 = flow.tensor.reshape %1507 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1515 = flow.dispatch.workgroups(%1513, %1512, %1514, %1457) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1516 = flow.tensor.reshape %1515 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1517 = flow.dispatch.workgroups(%1516) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1518 = flow.tensor.reshape %1517 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1519 = flow.dispatch.workgroups(%1515) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1520 = flow.dispatch.workgroups(%1518, %1519) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1521 = flow.dispatch.workgroups(%68, %1520) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1522 = flow.tensor.reshape %1521 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1523 = flow.tensor.bitcast %67 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1524 = flow.tensor.bitcast %67 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1525 = flow.dispatch.workgroups(%1524) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1526 = flow.dispatch.workgroups(%1523) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1527 = flow.tensor.bitcast %1526 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1528 = flow.tensor.bitcast %1525 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1529 = flow.tensor.bitcast %66 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1530 = flow.dispatch.workgroups(%1529) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1531 = flow.tensor.bitcast %1530 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1532 = flow.tensor.bitcast %66 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1533 = flow.dispatch.workgroups(%1532) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1534 = flow.tensor.bitcast %1533 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1535 = flow.dispatch.workgroups(%1531, %1534, %1522) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1536 = flow.dispatch.workgroups(%1528, %1527, %1522, %1535) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1537 = flow.tensor.reshape %1536 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1538 = flow.tensor.bitcast %65 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1539 = flow.tensor.bitcast %65 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1540 = flow.dispatch.workgroups(%1539) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1541 = flow.dispatch.workgroups(%1538) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1542 = flow.tensor.bitcast %1541 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1543 = flow.tensor.bitcast %1540 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1544 = flow.dispatch.workgroups(%1543, %1542, %1537, %1515) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1545 = flow.tensor.reshape %1544 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1546 = flow.dispatch.workgroups(%1545) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1547 = flow.tensor.reshape %1546 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1548 = flow.dispatch.workgroups(%1544) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1549 = flow.dispatch.workgroups(%1547, %1548) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1550 = flow.dispatch.workgroups(%64, %1549) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1551 = flow.tensor.reshape %1550 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1552 = flow.tensor.bitcast %63 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1553 = flow.tensor.bitcast %63 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1554 = flow.dispatch.workgroups(%1553) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1555 = flow.dispatch.workgroups(%1552) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1556 = flow.tensor.bitcast %1555 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1557 = flow.tensor.bitcast %1554 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1558 = flow.dispatch.workgroups(%1557, %1556, %1551) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1559 = flow.tensor.reshape %1558 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1560 = flow.tensor.bitcast %62 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1561 = flow.tensor.bitcast %62 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1562 = flow.dispatch.workgroups(%1561) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1563 = flow.dispatch.workgroups(%1560) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1564 = flow.tensor.bitcast %1563 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1565 = flow.tensor.bitcast %1562 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1566 = flow.dispatch.workgroups(%1565, %1564, %1551) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1567 = flow.tensor.reshape %1566 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1568 = flow.tensor.bitcast %61 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1569 = flow.tensor.bitcast %61 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1570 = flow.dispatch.workgroups(%1569) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1571 = flow.dispatch.workgroups(%1568) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1572 = flow.tensor.bitcast %1571 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1573 = flow.tensor.bitcast %1570 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1574 = flow.dispatch.workgroups(%1573, %1572, %1551) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1575 = flow.tensor.reshape %1574 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1576 = flow.dispatch.workgroups(%1559) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1577 = flow.dispatch.workgroups(%1559) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1578 = flow.dispatch.workgroups(%1576, %262, %1577, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1579 = flow.dispatch.workgroups(%1567) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1580 = flow.dispatch.workgroups(%1567) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1581 = flow.dispatch.workgroups(%1579, %262, %1580, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1582 = flow.tensor.reshape %1581 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1583 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c15_i64 = arith.constant 15 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c15_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1584 = flow.dispatch.workgroups(%1583, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1585 = flow.dispatch.workgroups[%273](%1582, %1584, %1500, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1500{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1586 = flow.dispatch.workgroups(%1583, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1587 = flow.dispatch.workgroups[%273](%1575, %1586, %1585, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1585{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1588 = flow.tensor.reshape %1587 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1589 = flow.dispatch.workgroups[%210, %208](%1588, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 15, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1590 = flow.tensor.reshape %1589 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1591 = flow.tensor.reshape %1578 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1592 = flow.dispatch.workgroups[%210, %208](%1588, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 15, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1593 = flow.tensor.reshape %1592 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1594 = flow.dispatch.workgroups[%283, %279](%1591, %1590, %1593, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1595 = flow.tensor.bitcast %60 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1596 = flow.tensor.bitcast %60 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1597 = flow.dispatch.workgroups(%1596) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1598 = flow.dispatch.workgroups(%1595) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1599 = flow.tensor.bitcast %1598 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1600 = flow.tensor.bitcast %1597 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1601 = flow.tensor.reshape %1594 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1602 = flow.dispatch.workgroups(%1600, %1599, %1601, %1544) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1603 = flow.tensor.reshape %1602 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1604 = flow.dispatch.workgroups(%1603) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1605 = flow.tensor.reshape %1604 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1606 = flow.dispatch.workgroups(%1602) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1607 = flow.dispatch.workgroups(%1605, %1606) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1608 = flow.dispatch.workgroups(%59, %1607) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1609 = flow.tensor.reshape %1608 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1610 = flow.tensor.bitcast %58 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1611 = flow.tensor.bitcast %58 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1612 = flow.dispatch.workgroups(%1611) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1613 = flow.dispatch.workgroups(%1610) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1614 = flow.tensor.bitcast %1613 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1615 = flow.tensor.bitcast %1612 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1616 = flow.tensor.bitcast %57 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1617 = flow.dispatch.workgroups(%1616) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1618 = flow.tensor.bitcast %1617 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1619 = flow.tensor.bitcast %57 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1620 = flow.dispatch.workgroups(%1619) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1621 = flow.tensor.bitcast %1620 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1622 = flow.dispatch.workgroups(%1618, %1621, %1609) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1623 = flow.dispatch.workgroups(%1615, %1614, %1609, %1622) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1624 = flow.tensor.reshape %1623 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1625 = flow.tensor.bitcast %56 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1626 = flow.tensor.bitcast %56 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1627 = flow.dispatch.workgroups(%1626) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1628 = flow.dispatch.workgroups(%1625) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1629 = flow.tensor.bitcast %1628 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1630 = flow.tensor.bitcast %1627 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1631 = flow.dispatch.workgroups(%1630, %1629, %1624, %1602) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1632 = flow.tensor.reshape %1631 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1633 = flow.dispatch.workgroups(%1632) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1634 = flow.tensor.reshape %1633 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1635 = flow.dispatch.workgroups(%1631) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1636 = flow.dispatch.workgroups(%1634, %1635) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1637 = flow.dispatch.workgroups(%55, %1636) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1638 = flow.tensor.reshape %1637 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1639 = flow.tensor.bitcast %54 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1640 = flow.tensor.bitcast %54 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1641 = flow.dispatch.workgroups(%1640) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1642 = flow.dispatch.workgroups(%1639) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1643 = flow.tensor.bitcast %1642 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1644 = flow.tensor.bitcast %1641 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1645 = flow.dispatch.workgroups(%1644, %1643, %1638) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1646 = flow.tensor.reshape %1645 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1647 = flow.tensor.bitcast %53 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1648 = flow.tensor.bitcast %53 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1649 = flow.dispatch.workgroups(%1648) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1650 = flow.dispatch.workgroups(%1647) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1651 = flow.tensor.bitcast %1650 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1652 = flow.tensor.bitcast %1649 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1653 = flow.dispatch.workgroups(%1652, %1651, %1638) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1654 = flow.tensor.reshape %1653 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1655 = flow.tensor.bitcast %52 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1656 = flow.tensor.bitcast %52 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1657 = flow.dispatch.workgroups(%1656) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1658 = flow.dispatch.workgroups(%1655) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1659 = flow.tensor.bitcast %1658 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1660 = flow.tensor.bitcast %1657 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1661 = flow.dispatch.workgroups(%1660, %1659, %1638) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1662 = flow.tensor.reshape %1661 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1663 = flow.dispatch.workgroups(%1646) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1664 = flow.dispatch.workgroups(%1646) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1665 = flow.dispatch.workgroups(%1663, %262, %1664, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1666 = flow.dispatch.workgroups(%1654) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1667 = flow.dispatch.workgroups(%1654) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1668 = flow.dispatch.workgroups(%1666, %262, %1667, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1669 = flow.tensor.reshape %1668 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1670 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c16_i64 = arith.constant 16 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c16_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1671 = flow.dispatch.workgroups(%1670, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1672 = flow.dispatch.workgroups[%273](%1669, %1671, %1587, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1587{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1673 = flow.dispatch.workgroups(%1670, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1674 = flow.dispatch.workgroups[%273](%1662, %1673, %1672, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1672{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1675 = flow.tensor.reshape %1674 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1676 = flow.dispatch.workgroups[%210, %208](%1675, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 16, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1677 = flow.tensor.reshape %1676 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1678 = flow.tensor.reshape %1665 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1679 = flow.dispatch.workgroups[%210, %208](%1675, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 16, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1680 = flow.tensor.reshape %1679 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1681 = flow.dispatch.workgroups[%283, %279](%1678, %1677, %1680, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1682 = flow.tensor.bitcast %51 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1683 = flow.tensor.bitcast %51 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1684 = flow.dispatch.workgroups(%1683) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1685 = flow.dispatch.workgroups(%1682) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1686 = flow.tensor.bitcast %1685 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1687 = flow.tensor.bitcast %1684 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1688 = flow.tensor.reshape %1681 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1689 = flow.dispatch.workgroups(%1687, %1686, %1688, %1631) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1690 = flow.tensor.reshape %1689 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1691 = flow.dispatch.workgroups(%1690) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1692 = flow.tensor.reshape %1691 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1693 = flow.dispatch.workgroups(%1689) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1694 = flow.dispatch.workgroups(%1692, %1693) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1695 = flow.dispatch.workgroups(%50, %1694) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1696 = flow.tensor.reshape %1695 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1697 = flow.tensor.bitcast %49 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1698 = flow.tensor.bitcast %49 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1699 = flow.dispatch.workgroups(%1698) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1700 = flow.dispatch.workgroups(%1697) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1701 = flow.tensor.bitcast %1700 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1702 = flow.tensor.bitcast %1699 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1703 = flow.tensor.bitcast %48 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1704 = flow.dispatch.workgroups(%1703) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1705 = flow.tensor.bitcast %1704 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1706 = flow.tensor.bitcast %48 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1707 = flow.dispatch.workgroups(%1706) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1708 = flow.tensor.bitcast %1707 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1709 = flow.dispatch.workgroups(%1705, %1708, %1696) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1710 = flow.dispatch.workgroups(%1702, %1701, %1696, %1709) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1711 = flow.tensor.reshape %1710 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1712 = flow.tensor.bitcast %47 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1713 = flow.tensor.bitcast %47 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1714 = flow.dispatch.workgroups(%1713) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1715 = flow.dispatch.workgroups(%1712) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1716 = flow.tensor.bitcast %1715 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1717 = flow.tensor.bitcast %1714 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1718 = flow.dispatch.workgroups(%1717, %1716, %1711, %1689) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1719 = flow.tensor.reshape %1718 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1720 = flow.dispatch.workgroups(%1719) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1721 = flow.tensor.reshape %1720 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1722 = flow.dispatch.workgroups(%1718) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1723 = flow.dispatch.workgroups(%1721, %1722) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1724 = flow.dispatch.workgroups(%46, %1723) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1725 = flow.tensor.reshape %1724 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1726 = flow.tensor.bitcast %45 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1727 = flow.tensor.bitcast %45 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1728 = flow.dispatch.workgroups(%1727) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1729 = flow.dispatch.workgroups(%1726) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1730 = flow.tensor.bitcast %1729 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1731 = flow.tensor.bitcast %1728 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1732 = flow.dispatch.workgroups(%1731, %1730, %1725) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1733 = flow.tensor.reshape %1732 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1734 = flow.tensor.bitcast %44 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1735 = flow.tensor.bitcast %44 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1736 = flow.dispatch.workgroups(%1735) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1737 = flow.dispatch.workgroups(%1734) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1738 = flow.tensor.bitcast %1737 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1739 = flow.tensor.bitcast %1736 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1740 = flow.dispatch.workgroups(%1739, %1738, %1725) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1741 = flow.tensor.reshape %1740 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1742 = flow.tensor.bitcast %43 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1743 = flow.tensor.bitcast %43 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1744 = flow.dispatch.workgroups(%1743) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1745 = flow.dispatch.workgroups(%1742) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1746 = flow.tensor.bitcast %1745 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1747 = flow.tensor.bitcast %1744 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1748 = flow.dispatch.workgroups(%1747, %1746, %1725) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1749 = flow.tensor.reshape %1748 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1750 = flow.dispatch.workgroups(%1733) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1751 = flow.dispatch.workgroups(%1733) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1752 = flow.dispatch.workgroups(%1750, %262, %1751, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1753 = flow.dispatch.workgroups(%1741) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1754 = flow.dispatch.workgroups(%1741) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1755 = flow.dispatch.workgroups(%1753, %262, %1754, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1756 = flow.tensor.reshape %1755 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1757 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c17_i64 = arith.constant 17 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c17_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1758 = flow.dispatch.workgroups(%1757, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1759 = flow.dispatch.workgroups[%273](%1756, %1758, %1674, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1674{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1760 = flow.dispatch.workgroups(%1757, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1761 = flow.dispatch.workgroups[%273](%1749, %1760, %1759, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1759{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1762 = flow.tensor.reshape %1761 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1763 = flow.dispatch.workgroups[%210, %208](%1762, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 17, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1764 = flow.tensor.reshape %1763 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1765 = flow.tensor.reshape %1752 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1766 = flow.dispatch.workgroups[%210, %208](%1762, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 17, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1767 = flow.tensor.reshape %1766 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1768 = flow.dispatch.workgroups[%283, %279](%1765, %1764, %1767, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1769 = flow.tensor.bitcast %42 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1770 = flow.tensor.bitcast %42 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1771 = flow.dispatch.workgroups(%1770) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1772 = flow.dispatch.workgroups(%1769) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1773 = flow.tensor.bitcast %1772 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1774 = flow.tensor.bitcast %1771 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1775 = flow.tensor.reshape %1768 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1776 = flow.dispatch.workgroups(%1774, %1773, %1775, %1718) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1777 = flow.tensor.reshape %1776 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1778 = flow.dispatch.workgroups(%1777) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1779 = flow.tensor.reshape %1778 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1780 = flow.dispatch.workgroups(%1776) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1781 = flow.dispatch.workgroups(%1779, %1780) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1782 = flow.dispatch.workgroups(%41, %1781) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1783 = flow.tensor.reshape %1782 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1784 = flow.tensor.bitcast %40 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1785 = flow.tensor.bitcast %40 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1786 = flow.dispatch.workgroups(%1785) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1787 = flow.dispatch.workgroups(%1784) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1788 = flow.tensor.bitcast %1787 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1789 = flow.tensor.bitcast %1786 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1790 = flow.tensor.bitcast %39 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1791 = flow.dispatch.workgroups(%1790) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1792 = flow.tensor.bitcast %1791 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1793 = flow.tensor.bitcast %39 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1794 = flow.dispatch.workgroups(%1793) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1795 = flow.tensor.bitcast %1794 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1796 = flow.dispatch.workgroups(%1792, %1795, %1783) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1797 = flow.dispatch.workgroups(%1789, %1788, %1783, %1796) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1798 = flow.tensor.reshape %1797 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1799 = flow.tensor.bitcast %38 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1800 = flow.tensor.bitcast %38 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1801 = flow.dispatch.workgroups(%1800) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1802 = flow.dispatch.workgroups(%1799) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1803 = flow.tensor.bitcast %1802 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1804 = flow.tensor.bitcast %1801 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1805 = flow.dispatch.workgroups(%1804, %1803, %1798, %1776) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1806 = flow.tensor.reshape %1805 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1807 = flow.dispatch.workgroups(%1806) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1808 = flow.tensor.reshape %1807 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1809 = flow.dispatch.workgroups(%1805) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1810 = flow.dispatch.workgroups(%1808, %1809) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1811 = flow.dispatch.workgroups(%37, %1810) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1812 = flow.tensor.reshape %1811 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1813 = flow.tensor.bitcast %36 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1814 = flow.tensor.bitcast %36 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1815 = flow.dispatch.workgroups(%1814) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1816 = flow.dispatch.workgroups(%1813) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1817 = flow.tensor.bitcast %1816 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1818 = flow.tensor.bitcast %1815 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1819 = flow.dispatch.workgroups(%1818, %1817, %1812) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1820 = flow.tensor.reshape %1819 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1821 = flow.tensor.bitcast %35 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1822 = flow.tensor.bitcast %35 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1823 = flow.dispatch.workgroups(%1822) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1824 = flow.dispatch.workgroups(%1821) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1825 = flow.tensor.bitcast %1824 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1826 = flow.tensor.bitcast %1823 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1827 = flow.dispatch.workgroups(%1826, %1825, %1812) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1828 = flow.tensor.reshape %1827 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1829 = flow.tensor.bitcast %34 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1830 = flow.tensor.bitcast %34 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1831 = flow.dispatch.workgroups(%1830) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1832 = flow.dispatch.workgroups(%1829) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1833 = flow.tensor.bitcast %1832 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1834 = flow.tensor.bitcast %1831 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1835 = flow.dispatch.workgroups(%1834, %1833, %1812) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1836 = flow.tensor.reshape %1835 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1837 = flow.dispatch.workgroups(%1820) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1838 = flow.dispatch.workgroups(%1820) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1839 = flow.dispatch.workgroups(%1837, %262, %1838, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1840 = flow.dispatch.workgroups(%1828) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1841 = flow.dispatch.workgroups(%1828) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1842 = flow.dispatch.workgroups(%1840, %262, %1841, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1843 = flow.tensor.reshape %1842 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1844 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c18_i64 = arith.constant 18 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c18_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1845 = flow.dispatch.workgroups(%1844, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1846 = flow.dispatch.workgroups[%273](%1843, %1845, %1761, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1761{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1847 = flow.dispatch.workgroups(%1844, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1848 = flow.dispatch.workgroups[%273](%1836, %1847, %1846, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1846{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1849 = flow.tensor.reshape %1848 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1850 = flow.dispatch.workgroups[%210, %208](%1849, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 18, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1851 = flow.tensor.reshape %1850 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1852 = flow.tensor.reshape %1839 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1853 = flow.dispatch.workgroups[%210, %208](%1849, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 18, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1854 = flow.tensor.reshape %1853 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1855 = flow.dispatch.workgroups[%283, %279](%1852, %1851, %1854, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1856 = flow.tensor.bitcast %33 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1857 = flow.tensor.bitcast %33 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1858 = flow.dispatch.workgroups(%1857) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1859 = flow.dispatch.workgroups(%1856) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1860 = flow.tensor.bitcast %1859 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1861 = flow.tensor.bitcast %1858 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1862 = flow.tensor.reshape %1855 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1863 = flow.dispatch.workgroups(%1861, %1860, %1862, %1805) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1864 = flow.tensor.reshape %1863 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1865 = flow.dispatch.workgroups(%1864) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1866 = flow.tensor.reshape %1865 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1867 = flow.dispatch.workgroups(%1863) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1868 = flow.dispatch.workgroups(%1866, %1867) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1869 = flow.dispatch.workgroups(%32, %1868) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1870 = flow.tensor.reshape %1869 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1871 = flow.tensor.bitcast %31 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1872 = flow.tensor.bitcast %31 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1873 = flow.dispatch.workgroups(%1872) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1874 = flow.dispatch.workgroups(%1871) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1875 = flow.tensor.bitcast %1874 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1876 = flow.tensor.bitcast %1873 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1877 = flow.tensor.bitcast %30 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1878 = flow.dispatch.workgroups(%1877) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1879 = flow.tensor.bitcast %1878 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1880 = flow.tensor.bitcast %30 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1881 = flow.dispatch.workgroups(%1880) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1882 = flow.tensor.bitcast %1881 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1883 = flow.dispatch.workgroups(%1879, %1882, %1870) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1884 = flow.dispatch.workgroups(%1876, %1875, %1870, %1883) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1885 = flow.tensor.reshape %1884 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1886 = flow.tensor.bitcast %29 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1887 = flow.tensor.bitcast %29 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1888 = flow.dispatch.workgroups(%1887) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1889 = flow.dispatch.workgroups(%1886) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1890 = flow.tensor.bitcast %1889 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1891 = flow.tensor.bitcast %1888 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1892 = flow.dispatch.workgroups(%1891, %1890, %1885, %1863) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1893 = flow.tensor.reshape %1892 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1894 = flow.dispatch.workgroups(%1893) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1895 = flow.tensor.reshape %1894 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1896 = flow.dispatch.workgroups(%1892) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1897 = flow.dispatch.workgroups(%1895, %1896) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1898 = flow.dispatch.workgroups(%28, %1897) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1899 = flow.tensor.reshape %1898 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1900 = flow.tensor.bitcast %27 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1901 = flow.tensor.bitcast %27 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1902 = flow.dispatch.workgroups(%1901) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1903 = flow.dispatch.workgroups(%1900) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1904 = flow.tensor.bitcast %1903 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1905 = flow.tensor.bitcast %1902 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1906 = flow.dispatch.workgroups(%1905, %1904, %1899) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1907 = flow.tensor.reshape %1906 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1908 = flow.tensor.bitcast %26 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1909 = flow.tensor.bitcast %26 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1910 = flow.dispatch.workgroups(%1909) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1911 = flow.dispatch.workgroups(%1908) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1912 = flow.tensor.bitcast %1911 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1913 = flow.tensor.bitcast %1910 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1914 = flow.dispatch.workgroups(%1913, %1912, %1899) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1915 = flow.tensor.reshape %1914 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %1916 = flow.tensor.bitcast %25 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1917 = flow.tensor.bitcast %25 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1918 = flow.dispatch.workgroups(%1917) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1919 = flow.dispatch.workgroups(%1916) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1920 = flow.tensor.bitcast %1919 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1921 = flow.tensor.bitcast %1918 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %1922 = flow.dispatch.workgroups(%1921, %1920, %1899) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1923 = flow.tensor.reshape %1922 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %1924 = flow.dispatch.workgroups(%1907) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1925 = flow.dispatch.workgroups(%1907) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1926 = flow.dispatch.workgroups(%1924, %262, %1925, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1927 = flow.dispatch.workgroups(%1915) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1928 = flow.dispatch.workgroups(%1915) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1929 = flow.dispatch.workgroups(%1927, %262, %1928, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1930 = flow.tensor.reshape %1929 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %1931 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c19_i64 = arith.constant 19 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c19_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1932 = flow.dispatch.workgroups(%1931, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1933 = flow.dispatch.workgroups[%273](%1930, %1932, %1848, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1848{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1934 = flow.dispatch.workgroups(%1931, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1935 = flow.dispatch.workgroups[%273](%1923, %1934, %1933, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1933{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %1936 = flow.tensor.reshape %1935 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %1937 = flow.dispatch.workgroups[%210, %208](%1936, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 19, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1938 = flow.tensor.reshape %1937 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %1939 = flow.tensor.reshape %1926 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %1940 = flow.dispatch.workgroups[%210, %208](%1936, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 19, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1941 = flow.tensor.reshape %1940 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %1942 = flow.dispatch.workgroups[%283, %279](%1939, %1938, %1941, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %1943 = flow.tensor.bitcast %24 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1944 = flow.tensor.bitcast %24 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1945 = flow.dispatch.workgroups(%1944) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1946 = flow.dispatch.workgroups(%1943) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1947 = flow.tensor.bitcast %1946 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1948 = flow.tensor.bitcast %1945 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1949 = flow.tensor.reshape %1942 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %1950 = flow.dispatch.workgroups(%1948, %1947, %1949, %1892) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1951 = flow.tensor.reshape %1950 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1952 = flow.dispatch.workgroups(%1951) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1953 = flow.tensor.reshape %1952 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1954 = flow.dispatch.workgroups(%1950) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1955 = flow.dispatch.workgroups(%1953, %1954) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1956 = flow.dispatch.workgroups(%23, %1955) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1957 = flow.tensor.reshape %1956 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1958 = flow.tensor.bitcast %22 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1959 = flow.tensor.bitcast %22 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1960 = flow.dispatch.workgroups(%1959) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1961 = flow.dispatch.workgroups(%1958) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1962 = flow.tensor.bitcast %1961 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1963 = flow.tensor.bitcast %1960 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1964 = flow.tensor.bitcast %21 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %1965 = flow.dispatch.workgroups(%1964) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1966 = flow.tensor.bitcast %1965 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %1967 = flow.tensor.bitcast %21 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %1968 = flow.dispatch.workgroups(%1967) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1969 = flow.tensor.bitcast %1968 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1970 = flow.dispatch.workgroups(%1966, %1969, %1957) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1971 = flow.dispatch.workgroups(%1963, %1962, %1957, %1970) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1972 = flow.tensor.reshape %1971 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %1973 = flow.tensor.bitcast %20 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %1974 = flow.tensor.bitcast %20 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %1975 = flow.dispatch.workgroups(%1974) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1976 = flow.dispatch.workgroups(%1973) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1977 = flow.tensor.bitcast %1976 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1978 = flow.tensor.bitcast %1975 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %1979 = flow.dispatch.workgroups(%1978, %1977, %1972, %1950) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1980 = flow.tensor.reshape %1979 : tensor<4x2048xf16> -> tensor<8192xf16>
    %1981 = flow.dispatch.workgroups(%1980) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1982 = flow.tensor.reshape %1981 : tensor<8192xf32> -> tensor<4x2048xf32>
    %1983 = flow.dispatch.workgroups(%1979) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1984 = flow.dispatch.workgroups(%1982, %1983) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1985 = flow.dispatch.workgroups(%19, %1984) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1986 = flow.tensor.reshape %1985 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %1987 = flow.tensor.bitcast %18 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %1988 = flow.tensor.bitcast %18 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %1989 = flow.dispatch.workgroups(%1988) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1990 = flow.dispatch.workgroups(%1987) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1991 = flow.tensor.bitcast %1990 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1992 = flow.tensor.bitcast %1989 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %1993 = flow.dispatch.workgroups(%1992, %1991, %1986) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1994 = flow.tensor.reshape %1993 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %1995 = flow.tensor.bitcast %17 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %1996 = flow.tensor.bitcast %17 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %1997 = flow.dispatch.workgroups(%1996) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1998 = flow.dispatch.workgroups(%1995) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %1999 = flow.tensor.bitcast %1998 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2000 = flow.tensor.bitcast %1997 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2001 = flow.dispatch.workgroups(%2000, %1999, %1986) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2002 = flow.tensor.reshape %2001 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %2003 = flow.tensor.bitcast %16 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %2004 = flow.tensor.bitcast %16 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %2005 = flow.dispatch.workgroups(%2004) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2006 = flow.dispatch.workgroups(%2003) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2007 = flow.tensor.bitcast %2006 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2008 = flow.tensor.bitcast %2005 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2009 = flow.dispatch.workgroups(%2008, %2007, %1986) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2010 = flow.tensor.reshape %2009 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %2011 = flow.dispatch.workgroups(%1994) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2012 = flow.dispatch.workgroups(%1994) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2013 = flow.dispatch.workgroups(%2011, %262, %2012, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2014 = flow.dispatch.workgroups(%2002) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2015 = flow.dispatch.workgroups(%2002) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2016 = flow.dispatch.workgroups(%2014, %262, %2015, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2017 = flow.tensor.reshape %2016 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %2018 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c20_i64 = arith.constant 20 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c20_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2019 = flow.dispatch.workgroups(%2018, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2020 = flow.dispatch.workgroups[%273](%2017, %2019, %1935, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %1935{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2021 = flow.dispatch.workgroups(%2018, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2022 = flow.dispatch.workgroups[%273](%2010, %2021, %2020, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %2020{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2023 = flow.tensor.reshape %2022 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %2024 = flow.dispatch.workgroups[%210, %208](%2023, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 20, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2025 = flow.tensor.reshape %2024 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %2026 = flow.tensor.reshape %2013 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %2027 = flow.dispatch.workgroups[%210, %208](%2023, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 20, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2028 = flow.tensor.reshape %2027 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %2029 = flow.dispatch.workgroups[%283, %279](%2026, %2025, %2028, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2030 = flow.tensor.bitcast %15 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %2031 = flow.tensor.bitcast %15 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %2032 = flow.dispatch.workgroups(%2031) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2033 = flow.dispatch.workgroups(%2030) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2034 = flow.tensor.bitcast %2033 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2035 = flow.tensor.bitcast %2032 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2036 = flow.tensor.reshape %2029 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %2037 = flow.dispatch.workgroups(%2035, %2034, %2036, %1979) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2038 = flow.tensor.reshape %2037 : tensor<4x2048xf16> -> tensor<8192xf16>
    %2039 = flow.dispatch.workgroups(%2038) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2040 = flow.tensor.reshape %2039 : tensor<8192xf32> -> tensor<4x2048xf32>
    %2041 = flow.dispatch.workgroups(%2037) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2042 = flow.dispatch.workgroups(%2040, %2041) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2043 = flow.dispatch.workgroups(%14, %2042) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2044 = flow.tensor.reshape %2043 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %2045 = flow.tensor.bitcast %13 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2046 = flow.tensor.bitcast %13 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2047 = flow.dispatch.workgroups(%2046) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2048 = flow.dispatch.workgroups(%2045) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2049 = flow.tensor.bitcast %2048 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2050 = flow.tensor.bitcast %2047 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2051 = flow.tensor.bitcast %12 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2052 = flow.dispatch.workgroups(%2051) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2053 = flow.tensor.bitcast %2052 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2054 = flow.tensor.bitcast %12 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2055 = flow.dispatch.workgroups(%2054) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2056 = flow.tensor.bitcast %2055 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2057 = flow.dispatch.workgroups(%2053, %2056, %2044) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2058 = flow.dispatch.workgroups(%2050, %2049, %2044, %2057) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2059 = flow.tensor.reshape %2058 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %2060 = flow.tensor.bitcast %11 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %2061 = flow.tensor.bitcast %11 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %2062 = flow.dispatch.workgroups(%2061) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2063 = flow.dispatch.workgroups(%2060) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2064 = flow.tensor.bitcast %2063 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2065 = flow.tensor.bitcast %2062 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %2066 = flow.dispatch.workgroups(%2065, %2064, %2059, %2037) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2067 = flow.tensor.reshape %2066 : tensor<4x2048xf16> -> tensor<8192xf16>
    %2068 = flow.dispatch.workgroups(%2067) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2069 = flow.tensor.reshape %2068 : tensor<8192xf32> -> tensor<4x2048xf32>
    %2070 = flow.dispatch.workgroups(%2066) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2071 = flow.dispatch.workgroups(%2069, %2070) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2072 = flow.dispatch.workgroups(%10, %2071) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2073 = flow.tensor.reshape %2072 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %2074 = flow.tensor.bitcast %9 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %2075 = flow.tensor.bitcast %9 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %2076 = flow.dispatch.workgroups(%2075) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2077 = flow.dispatch.workgroups(%2074) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2078 = flow.tensor.bitcast %2077 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2079 = flow.tensor.bitcast %2076 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2080 = flow.dispatch.workgroups(%2079, %2078, %2073) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf32>
      %2178 = tensor.empty() : tensor<2048x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2178 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<2048x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2180 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x2048xf32>) outs(%2176 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2081 = flow.tensor.reshape %2080 : tensor<4x2048xf16> -> tensor<4x1x32x64xf16>
    %2082 = flow.tensor.bitcast %8 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %2083 = flow.tensor.bitcast %8 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %2084 = flow.dispatch.workgroups(%2083) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2085 = flow.dispatch.workgroups(%2082) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2086 = flow.tensor.bitcast %2085 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2087 = flow.tensor.bitcast %2084 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2088 = flow.dispatch.workgroups(%2087, %2086, %2073) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2089 = flow.tensor.reshape %2088 : tensor<4x256xf16> -> tensor<4x1x4x64xf16>
    %2090 = flow.tensor.bitcast %7 : tensor<256x2176xi8> -> tensor<256x64x17xi16>
    %2091 = flow.tensor.bitcast %7 : tensor<256x2176xi8> -> tensor<256x64x1x17xi16>
    %2092 = flow.dispatch.workgroups(%2091) : (tensor<256x64x1x17xi16>) -> tensor<256x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [256, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x1x17xi16>> -> tensor<256x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 1], strides = [1, 1, 1] : tensor<256x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2093 = flow.dispatch.workgroups(%2090) : (tensor<256x64x17xi16>) -> tensor<256x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [256, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x17xi16>> -> tensor<256x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [256, 64, 16], strides = [1, 1, 1] : tensor<256x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<256x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2094 = flow.tensor.bitcast %2093 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2095 = flow.tensor.bitcast %2092 : tensor<256x64x1xi16> -> tensor<256x64xf16>
    %2096 = flow.dispatch.workgroups(%2095, %2094, %2073) : (tensor<256x64xf16>, tensor<256x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x256xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [256, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64xf16>> -> tensor<256x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [256, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<256x64x32xi8>> -> tensor<256x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x256xf16>
      %2177 = tensor.empty() : tensor<4x256xf32>
      %2178 = tensor.empty() : tensor<256x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%2178 : tensor<256x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<256x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x256xf32>) -> tensor<4x256xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%2180 : tensor<4x256xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x256xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x256xf32>) outs(%2176 : tensor<4x256xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x256xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 256], strides = [1, 1] : tensor<4x256xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x256xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2097 = flow.tensor.reshape %2096 : tensor<4x256xf16> -> tensor<4x4x2x32x1xf16>
    %2098 = flow.dispatch.workgroups(%2081) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2099 = flow.dispatch.workgroups(%2081) : (tensor<4x1x32x64xf16>) -> tensor<4x32x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 32, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x32x64xf16>> -> tensor<4x32x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : tensor<4x32x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2100 = flow.dispatch.workgroups(%2098, %262, %2099, %263) : (tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) -> tensor<4x32x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 32, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32x32xf16>> -> tensor<4x32x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x32x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x32x32xf16>, tensor<4x32xf16>, tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x32x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x32x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 32, 2, 32], strides = [1, 1, 1, 1] : tensor<4x32x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2101 = flow.dispatch.workgroups(%2089) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2102 = flow.dispatch.workgroups(%2089) : (tensor<4x1x4x64xf16>) -> tensor<4x4x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 1], sizes = [4, 1, 4, 32], strides = [1, 1, 1, 2] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x1x4x64xf16>> -> tensor<4x4x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : tensor<4x4x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2103 = flow.dispatch.workgroups(%2101, %262, %2102, %263) : (tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) -> tensor<4x4x2x32xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>) {
      %c0 = arith.constant 0 : index
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 4, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x32xf16>> -> tensor<4x4x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 32], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x32xf16>> -> tensor<4x32xf16>
      %2177 = tensor.empty() : tensor<4x4x2x32xf16>
      %2178 = linalg.generic {indexing_maps = [#map23, #map24, #map23, #map24, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174, %2175, %2176 : tensor<4x4x32xf16>, tensor<4x32xf16>, tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%2177 : tensor<4x4x2x32xf16>) {
      ^bb0(%in: f16, %in_0: f16, %in_1: f16, %in_2: f16, %out: f16):
        %2179 = linalg.index 2 : index
        %2180 = arith.mulf %in, %in_2 : f16
        %2181 = arith.mulf %in_1, %in_0 : f16
        %2182 = arith.mulf %in_1, %in_2 : f16
        %2183 = arith.mulf %in, %in_0 : f16
        %2184 = arith.addf %2181, %2180 : f16
        %2185 = arith.subf %2183, %2182 : f16
        %2186 = arith.cmpi eq, %2179, %c0 : index
        %2187 = arith.select %2186, %2185, %2184 : f16
        linalg.yield %2187 : f16
      } -> tensor<4x4x2x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg11, offsets = [0, 0, 0, 0], sizes = [4, 4, 2, 32], strides = [1, 1, 1, 1] : tensor<4x4x2x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x2x32xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2104 = flow.tensor.reshape %2103 : tensor<4x4x2x32xf16> -> tensor<4x4x2x32x1xf16>
    %2105 = flow.dispatch.workgroups[%208](%209, %269, %208) : (tensor<4x?xi64>{%208}, tensor<4xi64>, index) -> tensor<4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: index, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>) {
      %c2_i64 = arith.constant 2 : i64
      %c21_i64 = arith.constant 21 : i64
      %c22_i64 = arith.constant 22 : i64
      %c0_i64 = arith.constant 0 : i64
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg9, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, %2173], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2173} -> tensor<4x?xi64>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2176 = tensor.empty() : tensor<4xi64>
      %2177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2175 : tensor<4xi64>) outs(%2176 : tensor<4xi64>) {
      ^bb0(%in: i64, %out: i64):
        %2178 = linalg.index 0 : index
        %2179 = arith.index_cast %in : i64 to index
        %2180 = arith.cmpi slt, %2179, %2173 : index
        cf.assert %2180, "index must be smaller than dim size"
        %2181 = arith.cmpi sge, %in, %c0_i64 : i64
        cf.assert %2181, "index must be larger or equal to 0"
        %extracted = tensor.extract %2174[%2178, %2179] : tensor<4x?xi64>
        %2182 = arith.muli %extracted, %c22_i64 : i64
        %2183 = arith.addi %2182, %c21_i64 : i64
        %2184 = arith.muli %2183, %c2_i64 : i64
        linalg.yield %2184 : i64
      } -> tensor<4xi64>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg10, offsets = [0], sizes = [4], strides = [1] : tensor<4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xi64>>
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2106 = flow.dispatch.workgroups(%2105, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = linalg.index 1 : index
        %2178 = arith.index_cast %2177 : index to i64
        %2179 = arith.muli %in, %c4_i64 : i64
        %2180 = arith.addi %2179, %2178 : i64
        %2181 = arith.muli %2180, %c32_i64 : i64
        %2182 = arith.addi %2181, %in_0 : i64
        linalg.yield %2182 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2107 = flow.dispatch.workgroups[%273](%2104, %2106, %2022, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %2022{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2108 = flow.dispatch.workgroups(%2105, %270) : (tensor<4xi64>, tensor<4xi64>) -> tensor<4x4xi64> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>) {
      %c1_i64 = arith.constant 1 : i64
      %c4_i64 = arith.constant 4 : i64
      %c32_i64 = arith.constant 32 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xi64>> -> tensor<4xi64>
      %2175 = tensor.empty() : tensor<4x4xi64>
      %2176 = linalg.generic {indexing_maps = [#map, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4xi64>, tensor<4xi64>) outs(%2175 : tensor<4x4xi64>) {
      ^bb0(%in: i64, %in_0: i64, %out: i64):
        %2177 = arith.addi %in, %c1_i64 : i64
        %2178 = linalg.index 1 : index
        %2179 = arith.index_cast %2178 : index to i64
        %2180 = arith.muli %2177, %c4_i64 : i64
        %2181 = arith.addi %2180, %2179 : i64
        %2182 = arith.muli %2181, %c32_i64 : i64
        %2183 = arith.addi %2182, %in_0 : i64
        linalg.yield %2183 : i64
      } -> tensor<4x4xi64>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : tensor<4x4xi64> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4xi64>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2109 = flow.dispatch.workgroups[%273](%2097, %2108, %2107, %273) : (tensor<4x4x2x32x1xf16>, tensor<4x4xi64>, tensor<?x2x32x1xf16>{%273}, index) -> %2107{%273} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>>, %arg9: !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>, %arg10: index) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 0 : index
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0, 0], sizes = [4, 4, 2, 32, 1], strides = [1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4x2x32x1xf16>> -> tensor<4x4x2x32x1xf16>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 4], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x4xi64>> -> tensor<4x4xi64>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173} -> tensor<?x2x32x1xf16>
      %2177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%2174, %2175 : tensor<4x4x2x32x1xf16>, tensor<4x4xi64>) outs(%2176 : tensor<?x2x32x1xf16>) {
      ^bb0(%arg11: f16, %arg12: f16):
        iree_linalg_ext.yield %arg11 : f16
      } -> tensor<?x2x32x1xf16>
      iree_tensor_ext.dispatch.tensor.store %2177, %arg9, offsets = [0, 0, 0, 0], sizes = [%2173, 2, 32, 1], strides = [1, 1, 1, 1] : tensor<?x2x32x1xf16> -> !iree_tensor_ext.dispatch.tensor<readwrite:tensor<?x2x32x1xf16>>{%2173}
      flow.return
    } count(%arg7: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7)
      flow.return %x, %y, %z : index, index, index
    }
    %2110 = flow.tensor.reshape %2109 : tensor<?x2x32x1xf16>{%273} -> tensor<?x22x2x4x32x64xf16>{%210}
    %2111 = flow.tensor.reshape %2109 : tensor<?x2x32x1xf16>{%273} -> tensor<?x360448xf16>{%210}
    %2112 = flow.dispatch.workgroups[%210, %208](%2110, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x?x32x64xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x?x32x64xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 21, 0, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map25, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x?x32x64xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x?x32x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, %2174, 32, 64], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x?x32x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x?x32x64xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2113 = flow.tensor.reshape %2112 : tensor<4x4x8x?x32x64xf16>{%208} -> tensor<128x?x64xf16>{%283}
    %2114 = flow.tensor.reshape %2100 : tensor<4x32x2x32xf16> -> tensor<128x64xf16>
    %2115 = flow.dispatch.workgroups[%210, %208](%2110, %210, %209, %208) : (tensor<?x22x2x4x32x64xf16>{%210}, index, tensor<4x?xi64>{%208}, index) -> tensor<4x4x8x64x?x32xf16>{%208} =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>, %arg8: index, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>, %arg10: index, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>) {
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg8, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg10, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0], sizes = [4, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x?xi64>>{%2174} -> tensor<4x?xi64>
      %2176 = tensor.empty(%2174) : tensor<4x4x8x64x?x32xf16>
      %2177 = tensor.empty(%2174) : tensor<4x?x4x32x64xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 21, 1, 0, 0, 0], sizes = [%2173, 1, 1, 4, 32, 64], strides = [1, 1, 1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<?x22x2x4x32x64xf16>>{%2173} -> tensor<?x4x32x64xf16>
      %2179 = iree_linalg_ext.gather dimension_map = [0] ins(%2178, %2175 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
      %2180 = linalg.generic {indexing_maps = [#map27, #map26], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x4x32x64xf16>) outs(%2176 : tensor<4x4x8x64x?x32xf16>) {
      ^bb0(%in: f16, %out: f16):
        linalg.yield %in : f16
      } -> tensor<4x4x8x64x?x32xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg11, offsets = [0, 0, 0, 0, 0, 0], sizes = [4, 4, 8, 64, %2174, 32], strides = [1, 1, 1, 1, 1, 1] : tensor<4x4x8x64x?x32xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x4x8x64x?x32xf16>>{%2174}
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2116 = flow.tensor.reshape %2115 : tensor<4x4x8x64x?x32xf16>{%208} -> tensor<128x64x?xf16>{%283}
    %2117 = flow.dispatch.workgroups[%283, %279](%2114, %2113, %2116, %288, %283, %279) : (tensor<128x64xf16>, tensor<128x?x64xf16>{%283}, tensor<128x64x?xf16>{%283}, tensor<128x?xf16>{%279}, index, index) -> tensor<128x64xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>, %arg11: index, %arg12: index, %arg13: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>) {
      %cst_0 = arith.constant 1.250000e-01 : f16
      %2173 = iree_tensor_ext.dispatch.workload.ordinal %arg11, 0 : index
      %2174 = iree_tensor_ext.dispatch.workload.ordinal %arg12, 1 : index
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64xf16>> -> tensor<128x64xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [128, %2173, 64], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?x64xf16>>{%2173} -> tensor<128x?x64xf16>
      %2177 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [128, 64, %2173], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x64x?xf16>>{%2173} -> tensor<128x64x?xf16>
      %2178 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [128, %2174], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<128x?xf16>>{%2174} -> tensor<128x?xf16>
      %2179 = tensor.empty() : tensor<128x64xf16>
      %2180 = iree_linalg_ext.attention {indexing_maps = [#map28, #map29, #map23, #map30, #map24, #map8]} ins(%2175, %2176, %2177, %cst_0, %2178 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%2179 : tensor<128x64xf16>) {
      ^bb0(%arg14: f32):
        iree_linalg_ext.yield %arg14 : f32
      } -> tensor<128x64xf16>
      iree_tensor_ext.dispatch.tensor.store %2180, %arg13, offsets = [0, 0], sizes = [128, 64], strides = [1, 1] : tensor<128x64xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<128x64xf16>>
      flow.return
    } count(%arg7: index, %arg8: index) -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice(%arg7, %arg8)
      flow.return %x, %y, %z : index, index, index
    }
    %2118 = flow.tensor.bitcast %6 : tensor<2048x2176xi8> -> tensor<2048x64x17xi16>
    %2119 = flow.tensor.bitcast %6 : tensor<2048x2176xi8> -> tensor<2048x64x1x17xi16>
    %2120 = flow.dispatch.workgroups(%2119) : (tensor<2048x64x1x17xi16>) -> tensor<2048x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x1x17xi16>> -> tensor<2048x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 1], strides = [1, 1, 1] : tensor<2048x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2121 = flow.dispatch.workgroups(%2118) : (tensor<2048x64x17xi16>) -> tensor<2048x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x17xi16>> -> tensor<2048x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 16], strides = [1, 1, 1] : tensor<2048x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2122 = flow.tensor.bitcast %2121 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2123 = flow.tensor.bitcast %2120 : tensor<2048x64x1xi16> -> tensor<2048x64xf16>
    %2124 = flow.tensor.reshape %2117 : tensor<128x64xf16> -> tensor<4x64x32xf16>
    %2125 = flow.dispatch.workgroups(%2123, %2122, %2124, %2066) : (tensor<2048x64xf16>, tensor<2048x64x32xi8>, tensor<4x64x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64xf16>> -> tensor<2048x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x64x32xi8>> -> tensor<2048x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%2179 : tensor<2048x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2126 = flow.tensor.reshape %2125 : tensor<4x2048xf16> -> tensor<8192xf16>
    %2127 = flow.dispatch.workgroups(%2126) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2128 = flow.tensor.reshape %2127 : tensor<8192xf32> -> tensor<4x2048xf32>
    %2129 = flow.dispatch.workgroups(%2125) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2130 = flow.dispatch.workgroups(%2128, %2129) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2131 = flow.dispatch.workgroups(%5, %2130) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2132 = flow.tensor.reshape %2131 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %2133 = flow.tensor.bitcast %4 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2134 = flow.tensor.bitcast %4 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2135 = flow.dispatch.workgroups(%2134) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2136 = flow.dispatch.workgroups(%2133) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2137 = flow.tensor.bitcast %2136 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2138 = flow.tensor.bitcast %2135 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2139 = flow.tensor.bitcast %3 : tensor<5632x2176xi8> -> tensor<5632x64x1x17xi16>
    %2140 = flow.dispatch.workgroups(%2139) : (tensor<5632x64x1x17xi16>) -> tensor<5632x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [5632, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x1x17xi16>> -> tensor<5632x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 1], strides = [1, 1, 1] : tensor<5632x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2141 = flow.tensor.bitcast %2140 : tensor<5632x64x1xi16> -> tensor<5632x64xf16>
    %2142 = flow.tensor.bitcast %3 : tensor<5632x2176xi8> -> tensor<5632x64x17xi16>
    %2143 = flow.dispatch.workgroups(%2142) : (tensor<5632x64x17xi16>) -> tensor<5632x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [5632, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x17xi16>> -> tensor<5632x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 16], strides = [1, 1, 1] : tensor<5632x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<5632x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2144 = flow.tensor.bitcast %2143 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2145 = flow.dispatch.workgroups(%2141, %2144, %2132) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf32>
      %2178 = tensor.empty() : tensor<5632x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2178 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<5632x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2180 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x5632xf32>) outs(%2176 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2146 = flow.dispatch.workgroups(%2138, %2137, %2132, %2145) : (tensor<5632x64xf16>, tensor<5632x64x32xi8>, tensor<4x64x32xf16>, tensor<4x5632xf16>) -> tensor<4x5632xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %cst_1 = arith.constant 1.000000e+00 : f16
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [5632, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64xf16>> -> tensor<5632x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [5632, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<5632x64x32xi8>> -> tensor<5632x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x5632xf16>> -> tensor<4x5632xf16>
      %2177 = tensor.empty() : tensor<4x5632xf16>
      %2178 = tensor.empty() : tensor<4x5632xf32>
      %2179 = tensor.empty() : tensor<5632x64x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%2179 : tensor<5632x64x32xf16>) {
      ^bb0(%in: f16, %in_2: i8, %out: f16):
        %2184 = arith.extsi %in_2 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<5632x64x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%2181 : tensor<4x5632xf32>) {
      ^bb0(%in: f16, %in_2: f16, %out: f32):
        %2184 = arith.mulf %in, %in_2 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x5632xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2182, %2176 : tensor<4x5632xf32>, tensor<4x5632xf16>) outs(%2177 : tensor<4x5632xf16>) {
      ^bb0(%in: f32, %in_2: f16, %out: f16):
        %2184 = arith.truncf %in : f32 to f16
        %2185 = arith.negf %2184 : f16
        %2186 = math.exp %2185 : f16
        %2187 = arith.addf %2186, %cst_1 : f16
        %2188 = arith.divf %cst_1, %2187 : f16
        %2189 = arith.mulf %2188, %2184 : f16
        %2190 = arith.mulf %2189, %in_2 : f16
        linalg.yield %2190 : f16
      } -> tensor<4x5632xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 5632], strides = [1, 1] : tensor<4x5632xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x5632xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2147 = flow.tensor.reshape %2146 : tensor<4x5632xf16> -> tensor<4x176x32xf16>
    %2148 = flow.tensor.bitcast %2 : tensor<2048x5984xi8> -> tensor<2048x176x17xi16>
    %2149 = flow.tensor.bitcast %2 : tensor<2048x5984xi8> -> tensor<2048x176x1x17xi16>
    %2150 = flow.dispatch.workgroups(%2149) : (tensor<2048x176x1x17xi16>) -> tensor<2048x176x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [2048, 176, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x1x17xi16>> -> tensor<2048x176x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 1], strides = [1, 1, 1] : tensor<2048x176x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2151 = flow.dispatch.workgroups(%2148) : (tensor<2048x176x17xi16>) -> tensor<2048x176x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [2048, 176, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x17xi16>> -> tensor<2048x176x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 16], strides = [1, 1, 1] : tensor<2048x176x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<2048x176x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2152 = flow.tensor.bitcast %2151 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2153 = flow.tensor.bitcast %2150 : tensor<2048x176x1xi16> -> tensor<2048x176xf16>
    %2154 = flow.dispatch.workgroups(%2153, %2152, %2147, %2125) : (tensor<2048x176xf16>, tensor<2048x176x32xi8>, tensor<4x176x32xf16>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg11: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [2048, 176], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176xf16>> -> tensor<2048x176xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [2048, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048x176x32xi8>> -> tensor<2048x176x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 176, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x176x32xf16>> -> tensor<4x176x32xf16>
      %2176 = iree_tensor_ext.dispatch.tensor.load %arg10, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2177 = tensor.empty() : tensor<4x2048xf16>
      %2178 = tensor.empty() : tensor<4x2048xf32>
      %2179 = tensor.empty() : tensor<2048x176x32xf16>
      %2180 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%2179 : tensor<2048x176x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2184 = arith.extsi %in_1 : i8 to i32
        %2185 = arith.sitofp %2184 : i32 to f16
        %2186 = arith.mulf %2185, %in : f16
        linalg.yield %2186 : f16
      } -> tensor<2048x176x32xf16>
      %2181 = linalg.fill ins(%cst_0 : f32) outs(%2178 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
      %2182 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2180 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%2181 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2184 = arith.mulf %in, %in_1 : f16
        %2185 = arith.extf %2184 : f16 to f32
        %2186 = arith.addf %2185, %out : f32
        linalg.yield %2186 : f32
      } -> tensor<4x2048xf32>
      %2183 = linalg.generic {indexing_maps = [#map1, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2176, %2182 : tensor<4x2048xf16>, tensor<4x2048xf32>) outs(%2177 : tensor<4x2048xf16>) {
      ^bb0(%in: f16, %in_1: f32, %out: f16):
        %2184 = arith.truncf %in_1 : f32 to f16
        %2185 = arith.addf %in, %2184 : f16
        linalg.yield %2185 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2183, %arg11, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2155 = flow.tensor.reshape %2154 : tensor<4x2048xf16> -> tensor<8192xf16>
    %2156 = flow.dispatch.workgroups(%2155) : (tensor<8192xf16>) -> tensor<8192xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [8192], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<8192xf16>> -> tensor<8192xf16>
      %2174 = tensor.empty() : tensor<8192xf32>
      %2175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel"]} ins(%2173 : tensor<8192xf16>) outs(%2174 : tensor<8192xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2176 = arith.extf %in : f16 to f32
        linalg.yield %2176 : f32
      } -> tensor<8192xf32>
      iree_tensor_ext.dispatch.tensor.store %2175, %arg8, offsets = [0], sizes = [8192], strides = [1] : tensor<8192xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<8192xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2157 = flow.tensor.reshape %2156 : tensor<8192xf32> -> tensor<4x2048xf32>
    %2158 = flow.dispatch.workgroups(%2154) : (tensor<4x2048xf16>) -> tensor<4xf32> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %c2_i64 = arith.constant 2 : i64
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2174 = tensor.empty() : tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf32>
      %2176 = linalg.fill ins(%cst_0 : f32) outs(%2174 : tensor<4xf32>) -> tensor<4xf32>
      %2177 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173 : tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf32>) {
      ^bb0(%in: f16, %out: f32):
        %2179 = arith.extf %in : f16 to f32
        linalg.yield %2179 : f32
      } -> tensor<4x2048xf32>
      %2178 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "reduction"]} ins(%2177 : tensor<4x2048xf32>) outs(%2176 : tensor<4xf32>) {
      ^bb0(%in: f32, %out: f32):
        %2179 = math.fpowi %in, %c2_i64 : f32, i64
        %2180 = arith.addf %2179, %out : f32
        linalg.yield %2180 : f32
      } -> tensor<4xf32>
      iree_tensor_ext.dispatch.tensor.store %2178, %arg8, offsets = [0], sizes = [4], strides = [1] : tensor<4xf32> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4xf32>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2159 = flow.dispatch.workgroups(%2157, %2158) : (tensor<4x2048xf32>, tensor<4xf32>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %cst_0 = arith.constant 2.048000e+03 : f32
      %cst_1 = arith.constant 9.99999974E-6 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf32>> -> tensor<4x2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0], sizes = [4], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4xf32>> -> tensor<4xf32>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map1, #map, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<4x2048xf32>, tensor<4xf32>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_2: f32, %out: f16):
        %2177 = arith.divf %in_2, %cst_0 : f32
        %2178 = arith.addf %2177, %cst_1 : f32
        %2179 = math.rsqrt %2178 : f32
        %2180 = arith.mulf %in, %2179 : f32
        %2181 = arith.truncf %2180 : f32 to f16
        linalg.yield %2181 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2160 = flow.dispatch.workgroups(%1, %2159) : (tensor<2048xf32>, tensor<4x2048xf16>) -> tensor<4x2048xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>>, %arg9: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0], sizes = [2048], strides = [1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<2048xf32>> -> tensor<2048xf32>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x2048xf16>> -> tensor<4x2048xf16>
      %2175 = tensor.empty() : tensor<4x2048xf16>
      %2176 = linalg.generic {indexing_maps = [#map3, #map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2173, %2174 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%2175 : tensor<4x2048xf16>) {
      ^bb0(%in: f32, %in_0: f16, %out: f16):
        %2177 = arith.extf %in_0 : f16 to f32
        %2178 = arith.mulf %in, %2177 : f32
        %2179 = arith.truncf %2178 : f32 to f16
        linalg.yield %2179 : f16
      } -> tensor<4x2048xf16>
      iree_tensor_ext.dispatch.tensor.store %2176, %arg9, offsets = [0, 0], sizes = [4, 2048], strides = [1, 1] : tensor<4x2048xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x2048xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2161 = flow.tensor.reshape %2160 : tensor<4x2048xf16> -> tensor<4x64x32xf16>
    %2162 = flow.tensor.bitcast %0 : tensor<32000x2176xi8> -> tensor<32000x64x17xi16>
    %2163 = flow.tensor.bitcast %0 : tensor<32000x2176xi8> -> tensor<32000x64x1x17xi16>
    %2164 = flow.dispatch.workgroups(%2163) : (tensor<32000x64x1x17xi16>) -> tensor<32000x64x1xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 0, 0], sizes = [32000, 64, 1, 1], strides = [1, 1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x1x17xi16>> -> tensor<32000x64x1xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [32000, 64, 1], strides = [1, 1, 1] : tensor<32000x64x1xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x1xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2165 = flow.dispatch.workgroups(%2162) : (tensor<32000x64x17xi16>) -> tensor<32000x64x16xi16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>>, %arg8: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>) {
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0, 1], sizes = [32000, 64, 16], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x17xi16>> -> tensor<32000x64x16xi16>
      iree_tensor_ext.dispatch.tensor.store %2173, %arg8, offsets = [0, 0, 0], sizes = [32000, 64, 16], strides = [1, 1, 1] : tensor<32000x64x16xi16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<32000x64x16xi16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2166 = flow.tensor.bitcast %2165 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %2167 = flow.tensor.bitcast %2164 : tensor<32000x64x1xi16> -> tensor<32000x64xf16>
    %2168 = flow.dispatch.workgroups(%2167, %2166, %2161) : (tensor<32000x64xf16>, tensor<32000x64x32xi8>, tensor<4x64x32xf16>) -> tensor<4x32000xf16> =
        (%arg7: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64xf16>>, %arg8: !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x32xi8>>, %arg9: !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>>, %arg10: !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32000xf16>>) {
      %cst_0 = arith.constant 0.000000e+00 : f32
      %2173 = iree_tensor_ext.dispatch.tensor.load %arg7, offsets = [0, 0], sizes = [32000, 64], strides = [1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64xf16>> -> tensor<32000x64xf16>
      %2174 = iree_tensor_ext.dispatch.tensor.load %arg8, offsets = [0, 0, 0], sizes = [32000, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<32000x64x32xi8>> -> tensor<32000x64x32xi8>
      %2175 = iree_tensor_ext.dispatch.tensor.load %arg9, offsets = [0, 0, 0], sizes = [4, 64, 32], strides = [1, 1, 1] : !iree_tensor_ext.dispatch.tensor<readonly:tensor<4x64x32xf16>> -> tensor<4x64x32xf16>
      %2176 = tensor.empty() : tensor<4x32000xf16>
      %2177 = tensor.empty() : tensor<4x32000xf32>
      %2178 = tensor.empty() : tensor<32000x64x32xf16>
      %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map5], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<32000x64xf16>, tensor<32000x64x32xi8>) outs(%2178 : tensor<32000x64x32xf16>) {
      ^bb0(%in: f16, %in_1: i8, %out: f16):
        %2183 = arith.extsi %in_1 : i8 to i32
        %2184 = arith.sitofp %2183 : i32 to f16
        %2185 = arith.mulf %2184, %in : f16
        linalg.yield %2185 : f16
      } -> tensor<32000x64x32xf16>
      %2180 = linalg.fill ins(%cst_0 : f32) outs(%2177 : tensor<4x32000xf32>) -> tensor<4x32000xf32>
      %2181 = linalg.generic {indexing_maps = [#map6, #map7, #map8], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%2175, %2179 : tensor<4x64x32xf16>, tensor<32000x64x32xf16>) outs(%2180 : tensor<4x32000xf32>) {
      ^bb0(%in: f16, %in_1: f16, %out: f32):
        %2183 = arith.mulf %in, %in_1 : f16
        %2184 = arith.extf %2183 : f16 to f32
        %2185 = arith.addf %2184, %out : f32
        linalg.yield %2185 : f32
      } -> tensor<4x32000xf32>
      %2182 = linalg.generic {indexing_maps = [#map1, #map1], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x32000xf32>) outs(%2176 : tensor<4x32000xf16>) {
      ^bb0(%in: f32, %out: f16):
        %2183 = arith.truncf %in : f32 to f16
        linalg.yield %2183 : f16
      } -> tensor<4x32000xf16>
      iree_tensor_ext.dispatch.tensor.store %2182, %arg10, offsets = [0, 0], sizes = [4, 32000], strides = [1, 1] : tensor<4x32000xf16> -> !iree_tensor_ext.dispatch.tensor<writeonly:tensor<4x32000xf16>>
      flow.return
    } count() -> (index, index, index) {
      %x, %y, %z = iree_tensor_ext.dispatch.workgroup_count_from_slice()
      flow.return %x, %y, %z : index, index, index
    }
    %2169 = flow.tensor.reshape %2168 : tensor<4x32000xf16> -> tensor<4x1x32000xf16>
    %2170 = hal.tensor.alias on(#hal.device.affinity<@__device_0>) wait(%arg5) => %2111 : tensor<?x360448xf16>{%210} to %arg4 : !hal.buffer_view
    %2171:2 = hal.tensor.barrier join(%2170, %2169 : tensor<?x360448xf16>, tensor<4x1x32000xf16>) => %arg6 : !hal.fence
    %2172 = hal.tensor.export %2171#1 : tensor<4x1x32000xf16> -> !hal.buffer_view
    util.return %2172 : !hal.buffer_view
  }
  util.func public @decode_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @decode_bs4$async(%arg0, %arg1, %arg2, %arg3, %arg4, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
}
