#map = affine_map<(d0, d1, d2) -> (d0, d1, d2)>
#map1 = affine_map<(d0, d1, d2) -> (d0, d1, 0)>
#map2 = affine_map<(d0, d1, d2) -> (d0, d1)>
#map3 = affine_map<(d0, d1, d2) -> (d2)>
#map4 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d3, d4)>
#map5 = affine_map<(d0, d1, d2, d3, d4) -> (d2, d3, d4)>
#map6 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2)>
#map7 = affine_map<(d0) -> (d0)>
#map8 = affine_map<(d0, d1, d2) -> ()>
#map9 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, d3)>
#map10 = affine_map<(d0, d1, d2, d3) -> (0, d1, 0, d3)>
#map11 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d4)>
#map12 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d3, d4)>
#map13 = affine_map<(d0, d1) -> (d0, d1)>
#map14 = affine_map<()[s0] -> (s0 * 4)>
#map15 = affine_map<(d0, d1) -> (d1)>
#map16 = affine_map<(d0, d1) -> (d0, 0)>
#map17 = affine_map<(d0, d1, d2, d3) -> (d0, d1, 0, d3)>
#map18 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, 0)>
#map19 = affine_map<(d0, d1, d2, d3) -> (0, d1, d2, d3)>
#map20 = affine_map<() -> ()>
#map21 = affine_map<(d0, d1, d2, d3) -> ()>
#map22 = affine_map<(d0, d1, d2, d3) -> (d0, 0, d2, d3)>
#map23 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d3)>
#map24 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d4, d3)>
#map25 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d4, d2)>
#map26 = affine_map<(d0, d1, d2, d3, d4) -> ()>
#map27 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d4)>
#map28 = affine_map<(d0, d1) -> (0, d1)>
#map29 = affine_map<(d0, d1, d2) -> (d1, d2)>
#map30 = affine_map<(d0, d1, d2) -> (0, d1, d2)>
#map31 = affine_map<(d0, d1) -> ()>
#map32 = affine_map<()[s0] -> (s0 * 32)>
module @module {
  util.global private @__auto.token_embd.weight = #flow.parameter.named<"model"::"token_embd.weight"> : tensor<32000x2176xi8>
  util.global private @__auto.blk.0.attn_norm.weight = #flow.parameter.named<"model"::"blk.0.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.0.attn_q.weight = #flow.parameter.named<"model"::"blk.0.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.0.attn_k.weight = #flow.parameter.named<"model"::"blk.0.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.0.attn_v.weight = #flow.parameter.named<"model"::"blk.0.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.0.attn_output.weight = #flow.parameter.named<"model"::"blk.0.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.0.ffn_norm.weight = #flow.parameter.named<"model"::"blk.0.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.0.ffn_gate.weight = #flow.parameter.named<"model"::"blk.0.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.0.ffn_up.weight = #flow.parameter.named<"model"::"blk.0.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.0.ffn_down.weight = #flow.parameter.named<"model"::"blk.0.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.1.attn_norm.weight = #flow.parameter.named<"model"::"blk.1.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.1.attn_q.weight = #flow.parameter.named<"model"::"blk.1.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.1.attn_k.weight = #flow.parameter.named<"model"::"blk.1.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.1.attn_v.weight = #flow.parameter.named<"model"::"blk.1.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.1.attn_output.weight = #flow.parameter.named<"model"::"blk.1.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.1.ffn_norm.weight = #flow.parameter.named<"model"::"blk.1.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.1.ffn_gate.weight = #flow.parameter.named<"model"::"blk.1.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.1.ffn_up.weight = #flow.parameter.named<"model"::"blk.1.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.1.ffn_down.weight = #flow.parameter.named<"model"::"blk.1.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.2.attn_norm.weight = #flow.parameter.named<"model"::"blk.2.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.2.attn_q.weight = #flow.parameter.named<"model"::"blk.2.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.2.attn_k.weight = #flow.parameter.named<"model"::"blk.2.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.2.attn_v.weight = #flow.parameter.named<"model"::"blk.2.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.2.attn_output.weight = #flow.parameter.named<"model"::"blk.2.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.2.ffn_norm.weight = #flow.parameter.named<"model"::"blk.2.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.2.ffn_gate.weight = #flow.parameter.named<"model"::"blk.2.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.2.ffn_up.weight = #flow.parameter.named<"model"::"blk.2.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.2.ffn_down.weight = #flow.parameter.named<"model"::"blk.2.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.3.attn_norm.weight = #flow.parameter.named<"model"::"blk.3.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.3.attn_q.weight = #flow.parameter.named<"model"::"blk.3.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.3.attn_k.weight = #flow.parameter.named<"model"::"blk.3.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.3.attn_v.weight = #flow.parameter.named<"model"::"blk.3.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.3.attn_output.weight = #flow.parameter.named<"model"::"blk.3.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.3.ffn_norm.weight = #flow.parameter.named<"model"::"blk.3.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.3.ffn_gate.weight = #flow.parameter.named<"model"::"blk.3.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.3.ffn_up.weight = #flow.parameter.named<"model"::"blk.3.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.3.ffn_down.weight = #flow.parameter.named<"model"::"blk.3.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.4.attn_norm.weight = #flow.parameter.named<"model"::"blk.4.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.4.attn_q.weight = #flow.parameter.named<"model"::"blk.4.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.4.attn_k.weight = #flow.parameter.named<"model"::"blk.4.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.4.attn_v.weight = #flow.parameter.named<"model"::"blk.4.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.4.attn_output.weight = #flow.parameter.named<"model"::"blk.4.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.4.ffn_norm.weight = #flow.parameter.named<"model"::"blk.4.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.4.ffn_gate.weight = #flow.parameter.named<"model"::"blk.4.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.4.ffn_up.weight = #flow.parameter.named<"model"::"blk.4.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.4.ffn_down.weight = #flow.parameter.named<"model"::"blk.4.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.5.attn_norm.weight = #flow.parameter.named<"model"::"blk.5.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.5.attn_q.weight = #flow.parameter.named<"model"::"blk.5.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.5.attn_k.weight = #flow.parameter.named<"model"::"blk.5.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.5.attn_v.weight = #flow.parameter.named<"model"::"blk.5.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.5.attn_output.weight = #flow.parameter.named<"model"::"blk.5.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.5.ffn_norm.weight = #flow.parameter.named<"model"::"blk.5.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.5.ffn_gate.weight = #flow.parameter.named<"model"::"blk.5.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.5.ffn_up.weight = #flow.parameter.named<"model"::"blk.5.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.5.ffn_down.weight = #flow.parameter.named<"model"::"blk.5.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.6.attn_norm.weight = #flow.parameter.named<"model"::"blk.6.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.6.attn_q.weight = #flow.parameter.named<"model"::"blk.6.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.6.attn_k.weight = #flow.parameter.named<"model"::"blk.6.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.6.attn_v.weight = #flow.parameter.named<"model"::"blk.6.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.6.attn_output.weight = #flow.parameter.named<"model"::"blk.6.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.6.ffn_norm.weight = #flow.parameter.named<"model"::"blk.6.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.6.ffn_gate.weight = #flow.parameter.named<"model"::"blk.6.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.6.ffn_up.weight = #flow.parameter.named<"model"::"blk.6.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.6.ffn_down.weight = #flow.parameter.named<"model"::"blk.6.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.7.attn_norm.weight = #flow.parameter.named<"model"::"blk.7.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.7.attn_q.weight = #flow.parameter.named<"model"::"blk.7.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.7.attn_k.weight = #flow.parameter.named<"model"::"blk.7.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.7.attn_v.weight = #flow.parameter.named<"model"::"blk.7.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.7.attn_output.weight = #flow.parameter.named<"model"::"blk.7.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.7.ffn_norm.weight = #flow.parameter.named<"model"::"blk.7.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.7.ffn_gate.weight = #flow.parameter.named<"model"::"blk.7.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.7.ffn_up.weight = #flow.parameter.named<"model"::"blk.7.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.7.ffn_down.weight = #flow.parameter.named<"model"::"blk.7.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.8.attn_norm.weight = #flow.parameter.named<"model"::"blk.8.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.8.attn_q.weight = #flow.parameter.named<"model"::"blk.8.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.8.attn_k.weight = #flow.parameter.named<"model"::"blk.8.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.8.attn_v.weight = #flow.parameter.named<"model"::"blk.8.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.8.attn_output.weight = #flow.parameter.named<"model"::"blk.8.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.8.ffn_norm.weight = #flow.parameter.named<"model"::"blk.8.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.8.ffn_gate.weight = #flow.parameter.named<"model"::"blk.8.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.8.ffn_up.weight = #flow.parameter.named<"model"::"blk.8.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.8.ffn_down.weight = #flow.parameter.named<"model"::"blk.8.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.9.attn_norm.weight = #flow.parameter.named<"model"::"blk.9.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.9.attn_q.weight = #flow.parameter.named<"model"::"blk.9.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.9.attn_k.weight = #flow.parameter.named<"model"::"blk.9.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.9.attn_v.weight = #flow.parameter.named<"model"::"blk.9.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.9.attn_output.weight = #flow.parameter.named<"model"::"blk.9.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.9.ffn_norm.weight = #flow.parameter.named<"model"::"blk.9.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.9.ffn_gate.weight = #flow.parameter.named<"model"::"blk.9.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.9.ffn_up.weight = #flow.parameter.named<"model"::"blk.9.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.9.ffn_down.weight = #flow.parameter.named<"model"::"blk.9.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.10.attn_norm.weight = #flow.parameter.named<"model"::"blk.10.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.10.attn_q.weight = #flow.parameter.named<"model"::"blk.10.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.10.attn_k.weight = #flow.parameter.named<"model"::"blk.10.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.10.attn_v.weight = #flow.parameter.named<"model"::"blk.10.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.10.attn_output.weight = #flow.parameter.named<"model"::"blk.10.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.10.ffn_norm.weight = #flow.parameter.named<"model"::"blk.10.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.10.ffn_gate.weight = #flow.parameter.named<"model"::"blk.10.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.10.ffn_up.weight = #flow.parameter.named<"model"::"blk.10.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.10.ffn_down.weight = #flow.parameter.named<"model"::"blk.10.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.11.attn_norm.weight = #flow.parameter.named<"model"::"blk.11.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.11.attn_q.weight = #flow.parameter.named<"model"::"blk.11.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.11.attn_k.weight = #flow.parameter.named<"model"::"blk.11.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.11.attn_v.weight = #flow.parameter.named<"model"::"blk.11.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.11.attn_output.weight = #flow.parameter.named<"model"::"blk.11.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.11.ffn_norm.weight = #flow.parameter.named<"model"::"blk.11.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.11.ffn_gate.weight = #flow.parameter.named<"model"::"blk.11.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.11.ffn_up.weight = #flow.parameter.named<"model"::"blk.11.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.11.ffn_down.weight = #flow.parameter.named<"model"::"blk.11.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.12.attn_norm.weight = #flow.parameter.named<"model"::"blk.12.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.12.attn_q.weight = #flow.parameter.named<"model"::"blk.12.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.12.attn_k.weight = #flow.parameter.named<"model"::"blk.12.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.12.attn_v.weight = #flow.parameter.named<"model"::"blk.12.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.12.attn_output.weight = #flow.parameter.named<"model"::"blk.12.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.12.ffn_norm.weight = #flow.parameter.named<"model"::"blk.12.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.12.ffn_gate.weight = #flow.parameter.named<"model"::"blk.12.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.12.ffn_up.weight = #flow.parameter.named<"model"::"blk.12.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.12.ffn_down.weight = #flow.parameter.named<"model"::"blk.12.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.13.attn_norm.weight = #flow.parameter.named<"model"::"blk.13.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.13.attn_q.weight = #flow.parameter.named<"model"::"blk.13.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.13.attn_k.weight = #flow.parameter.named<"model"::"blk.13.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.13.attn_v.weight = #flow.parameter.named<"model"::"blk.13.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.13.attn_output.weight = #flow.parameter.named<"model"::"blk.13.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.13.ffn_norm.weight = #flow.parameter.named<"model"::"blk.13.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.13.ffn_gate.weight = #flow.parameter.named<"model"::"blk.13.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.13.ffn_up.weight = #flow.parameter.named<"model"::"blk.13.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.13.ffn_down.weight = #flow.parameter.named<"model"::"blk.13.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.14.attn_norm.weight = #flow.parameter.named<"model"::"blk.14.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.14.attn_q.weight = #flow.parameter.named<"model"::"blk.14.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.14.attn_k.weight = #flow.parameter.named<"model"::"blk.14.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.14.attn_v.weight = #flow.parameter.named<"model"::"blk.14.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.14.attn_output.weight = #flow.parameter.named<"model"::"blk.14.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.14.ffn_norm.weight = #flow.parameter.named<"model"::"blk.14.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.14.ffn_gate.weight = #flow.parameter.named<"model"::"blk.14.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.14.ffn_up.weight = #flow.parameter.named<"model"::"blk.14.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.14.ffn_down.weight = #flow.parameter.named<"model"::"blk.14.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.15.attn_norm.weight = #flow.parameter.named<"model"::"blk.15.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.15.attn_q.weight = #flow.parameter.named<"model"::"blk.15.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.15.attn_k.weight = #flow.parameter.named<"model"::"blk.15.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.15.attn_v.weight = #flow.parameter.named<"model"::"blk.15.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.15.attn_output.weight = #flow.parameter.named<"model"::"blk.15.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.15.ffn_norm.weight = #flow.parameter.named<"model"::"blk.15.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.15.ffn_gate.weight = #flow.parameter.named<"model"::"blk.15.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.15.ffn_up.weight = #flow.parameter.named<"model"::"blk.15.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.15.ffn_down.weight = #flow.parameter.named<"model"::"blk.15.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.16.attn_norm.weight = #flow.parameter.named<"model"::"blk.16.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.16.attn_q.weight = #flow.parameter.named<"model"::"blk.16.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.16.attn_k.weight = #flow.parameter.named<"model"::"blk.16.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.16.attn_v.weight = #flow.parameter.named<"model"::"blk.16.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.16.attn_output.weight = #flow.parameter.named<"model"::"blk.16.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.16.ffn_norm.weight = #flow.parameter.named<"model"::"blk.16.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.16.ffn_gate.weight = #flow.parameter.named<"model"::"blk.16.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.16.ffn_up.weight = #flow.parameter.named<"model"::"blk.16.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.16.ffn_down.weight = #flow.parameter.named<"model"::"blk.16.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.17.attn_norm.weight = #flow.parameter.named<"model"::"blk.17.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.17.attn_q.weight = #flow.parameter.named<"model"::"blk.17.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.17.attn_k.weight = #flow.parameter.named<"model"::"blk.17.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.17.attn_v.weight = #flow.parameter.named<"model"::"blk.17.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.17.attn_output.weight = #flow.parameter.named<"model"::"blk.17.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.17.ffn_norm.weight = #flow.parameter.named<"model"::"blk.17.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.17.ffn_gate.weight = #flow.parameter.named<"model"::"blk.17.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.17.ffn_up.weight = #flow.parameter.named<"model"::"blk.17.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.17.ffn_down.weight = #flow.parameter.named<"model"::"blk.17.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.18.attn_norm.weight = #flow.parameter.named<"model"::"blk.18.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.18.attn_q.weight = #flow.parameter.named<"model"::"blk.18.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.18.attn_k.weight = #flow.parameter.named<"model"::"blk.18.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.18.attn_v.weight = #flow.parameter.named<"model"::"blk.18.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.18.attn_output.weight = #flow.parameter.named<"model"::"blk.18.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.18.ffn_norm.weight = #flow.parameter.named<"model"::"blk.18.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.18.ffn_gate.weight = #flow.parameter.named<"model"::"blk.18.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.18.ffn_up.weight = #flow.parameter.named<"model"::"blk.18.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.18.ffn_down.weight = #flow.parameter.named<"model"::"blk.18.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.19.attn_norm.weight = #flow.parameter.named<"model"::"blk.19.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.19.attn_q.weight = #flow.parameter.named<"model"::"blk.19.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.19.attn_k.weight = #flow.parameter.named<"model"::"blk.19.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.19.attn_v.weight = #flow.parameter.named<"model"::"blk.19.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.19.attn_output.weight = #flow.parameter.named<"model"::"blk.19.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.19.ffn_norm.weight = #flow.parameter.named<"model"::"blk.19.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.19.ffn_gate.weight = #flow.parameter.named<"model"::"blk.19.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.19.ffn_up.weight = #flow.parameter.named<"model"::"blk.19.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.19.ffn_down.weight = #flow.parameter.named<"model"::"blk.19.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.20.attn_norm.weight = #flow.parameter.named<"model"::"blk.20.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.20.attn_q.weight = #flow.parameter.named<"model"::"blk.20.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.20.attn_k.weight = #flow.parameter.named<"model"::"blk.20.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.20.attn_v.weight = #flow.parameter.named<"model"::"blk.20.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.20.attn_output.weight = #flow.parameter.named<"model"::"blk.20.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.20.ffn_norm.weight = #flow.parameter.named<"model"::"blk.20.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.20.ffn_gate.weight = #flow.parameter.named<"model"::"blk.20.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.20.ffn_up.weight = #flow.parameter.named<"model"::"blk.20.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.20.ffn_down.weight = #flow.parameter.named<"model"::"blk.20.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.21.attn_norm.weight = #flow.parameter.named<"model"::"blk.21.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.21.attn_q.weight = #flow.parameter.named<"model"::"blk.21.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.21.attn_k.weight = #flow.parameter.named<"model"::"blk.21.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.21.attn_v.weight = #flow.parameter.named<"model"::"blk.21.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.21.attn_output.weight = #flow.parameter.named<"model"::"blk.21.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.21.ffn_norm.weight = #flow.parameter.named<"model"::"blk.21.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.21.ffn_gate.weight = #flow.parameter.named<"model"::"blk.21.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.21.ffn_up.weight = #flow.parameter.named<"model"::"blk.21.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.21.ffn_down.weight = #flow.parameter.named<"model"::"blk.21.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.output_norm.weight = #flow.parameter.named<"model"::"output_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.output.weight = #flow.parameter.named<"model"::"output.weight"> : tensor<32000x2176xi8>
  util.func public @prefill_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.fence, %arg5: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %cst = arith.constant 1.250000e-01 : f16
    %c3 = arith.constant 3 : index
    %c2 = arith.constant 2 : index
    %cst_0 = arith.constant dense<0> : tensor<i64>
    %c21_i64 = arith.constant 21 : i64
    %c20_i64 = arith.constant 20 : i64
    %c19_i64 = arith.constant 19 : i64
    %c18_i64 = arith.constant 18 : i64
    %c16_i64 = arith.constant 16 : i64
    %c15_i64 = arith.constant 15 : i64
    %c14_i64 = arith.constant 14 : i64
    %c13_i64 = arith.constant 13 : i64
    %c12_i64 = arith.constant 12 : i64
    %c11_i64 = arith.constant 11 : i64
    %c10_i64 = arith.constant 10 : i64
    %c9_i64 = arith.constant 9 : i64
    %c7_i64 = arith.constant 7 : i64
    %c8_i64 = arith.constant 8 : i64
    %c22_i64 = arith.constant 22 : i64
    %c3_i64 = arith.constant 3 : i64
    %c4_i64 = arith.constant 4 : i64
    %c6_i64 = arith.constant 6 : i64
    %c5_i64 = arith.constant 5 : i64
    %c17_i64 = arith.constant 17 : i64
    %c2_i64 = arith.constant 2 : i64
    %c0_i64 = arith.constant 0 : i64
    %c1_i64 = arith.constant 1 : i64
    %c32 = arith.constant 32 : index
    %c0 = arith.constant 0 : index
    %cst_1 = arith.constant dense<0xFC00> : tensor<f16>
    %cst_2 = arith.constant dense<1.000000e+00> : tensor<f32>
    %c1 = arith.constant 1 : index
    %c32000 = arith.constant 32000 : index
    %cst_3 = arith.constant 0.000000e+00 : f32
    %cst_4 = arith.constant 1.000000e+00 : f32
    %c44 = arith.constant 44 : index
    %cst_5 = arith.constant 1.000000e+00 : f16
    %cst_6 = arith.constant 2.048000e+03 : f32
    %cst_7 = arith.constant 9.99999974E-6 : f32
    %cst_8 = arith.constant 6.400000e+01 : f32
    %cst_9 = arith.constant 1.000000e+04 : f32
    %0 = hal.buffer_view.dim<%arg0 : !hal.buffer_view>[1] : index
    %1 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg0 : !hal.buffer_view -> tensor<4x?xi64>{%0}
    %2 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %3 = hal.buffer_view.dim<%arg2 : !hal.buffer_view>[1] : index
    %4 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg2 : !hal.buffer_view -> tensor<4x?xi64>{%3}
    %dim = tensor.dim %4, %c1 : tensor<4x?xi64>
    %__auto.token_embd.weight = util.global.load @__auto.token_embd.weight : tensor<32000x2176xi8>
    %__auto.blk.0.attn_norm.weight = util.global.load @__auto.blk.0.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.attn_q.weight = util.global.load @__auto.blk.0.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.0.attn_k.weight = util.global.load @__auto.blk.0.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_v.weight = util.global.load @__auto.blk.0.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_output.weight = util.global.load @__auto.blk.0.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.0.ffn_norm.weight = util.global.load @__auto.blk.0.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.ffn_gate.weight = util.global.load @__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_up.weight = util.global.load @__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_down.weight = util.global.load @__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.1.attn_norm.weight = util.global.load @__auto.blk.1.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.attn_q.weight = util.global.load @__auto.blk.1.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.1.attn_k.weight = util.global.load @__auto.blk.1.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_v.weight = util.global.load @__auto.blk.1.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_output.weight = util.global.load @__auto.blk.1.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.1.ffn_norm.weight = util.global.load @__auto.blk.1.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.ffn_gate.weight = util.global.load @__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_up.weight = util.global.load @__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_down.weight = util.global.load @__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.2.attn_norm.weight = util.global.load @__auto.blk.2.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.attn_q.weight = util.global.load @__auto.blk.2.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.2.attn_k.weight = util.global.load @__auto.blk.2.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_v.weight = util.global.load @__auto.blk.2.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_output.weight = util.global.load @__auto.blk.2.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.2.ffn_norm.weight = util.global.load @__auto.blk.2.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.ffn_gate.weight = util.global.load @__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_up.weight = util.global.load @__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_down.weight = util.global.load @__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.3.attn_norm.weight = util.global.load @__auto.blk.3.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.attn_q.weight = util.global.load @__auto.blk.3.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.3.attn_k.weight = util.global.load @__auto.blk.3.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_v.weight = util.global.load @__auto.blk.3.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_output.weight = util.global.load @__auto.blk.3.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.3.ffn_norm.weight = util.global.load @__auto.blk.3.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.ffn_gate.weight = util.global.load @__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_up.weight = util.global.load @__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_down.weight = util.global.load @__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.4.attn_norm.weight = util.global.load @__auto.blk.4.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.attn_q.weight = util.global.load @__auto.blk.4.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.4.attn_k.weight = util.global.load @__auto.blk.4.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_v.weight = util.global.load @__auto.blk.4.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_output.weight = util.global.load @__auto.blk.4.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.4.ffn_norm.weight = util.global.load @__auto.blk.4.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.ffn_gate.weight = util.global.load @__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_up.weight = util.global.load @__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_down.weight = util.global.load @__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.5.attn_norm.weight = util.global.load @__auto.blk.5.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.attn_q.weight = util.global.load @__auto.blk.5.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.5.attn_k.weight = util.global.load @__auto.blk.5.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_v.weight = util.global.load @__auto.blk.5.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_output.weight = util.global.load @__auto.blk.5.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.5.ffn_norm.weight = util.global.load @__auto.blk.5.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.ffn_gate.weight = util.global.load @__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_up.weight = util.global.load @__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_down.weight = util.global.load @__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.6.attn_norm.weight = util.global.load @__auto.blk.6.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.attn_q.weight = util.global.load @__auto.blk.6.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.6.attn_k.weight = util.global.load @__auto.blk.6.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_v.weight = util.global.load @__auto.blk.6.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_output.weight = util.global.load @__auto.blk.6.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.6.ffn_norm.weight = util.global.load @__auto.blk.6.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.ffn_gate.weight = util.global.load @__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_up.weight = util.global.load @__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_down.weight = util.global.load @__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.7.attn_norm.weight = util.global.load @__auto.blk.7.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.attn_q.weight = util.global.load @__auto.blk.7.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.7.attn_k.weight = util.global.load @__auto.blk.7.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_v.weight = util.global.load @__auto.blk.7.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_output.weight = util.global.load @__auto.blk.7.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.7.ffn_norm.weight = util.global.load @__auto.blk.7.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.ffn_gate.weight = util.global.load @__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_up.weight = util.global.load @__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_down.weight = util.global.load @__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.8.attn_norm.weight = util.global.load @__auto.blk.8.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.attn_q.weight = util.global.load @__auto.blk.8.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.8.attn_k.weight = util.global.load @__auto.blk.8.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_v.weight = util.global.load @__auto.blk.8.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_output.weight = util.global.load @__auto.blk.8.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.8.ffn_norm.weight = util.global.load @__auto.blk.8.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.ffn_gate.weight = util.global.load @__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_up.weight = util.global.load @__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_down.weight = util.global.load @__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.9.attn_norm.weight = util.global.load @__auto.blk.9.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.attn_q.weight = util.global.load @__auto.blk.9.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.9.attn_k.weight = util.global.load @__auto.blk.9.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_v.weight = util.global.load @__auto.blk.9.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_output.weight = util.global.load @__auto.blk.9.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.9.ffn_norm.weight = util.global.load @__auto.blk.9.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.ffn_gate.weight = util.global.load @__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_up.weight = util.global.load @__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_down.weight = util.global.load @__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.10.attn_norm.weight = util.global.load @__auto.blk.10.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.attn_q.weight = util.global.load @__auto.blk.10.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.10.attn_k.weight = util.global.load @__auto.blk.10.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_v.weight = util.global.load @__auto.blk.10.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_output.weight = util.global.load @__auto.blk.10.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.10.ffn_norm.weight = util.global.load @__auto.blk.10.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.ffn_gate.weight = util.global.load @__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_up.weight = util.global.load @__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_down.weight = util.global.load @__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.11.attn_norm.weight = util.global.load @__auto.blk.11.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.attn_q.weight = util.global.load @__auto.blk.11.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.11.attn_k.weight = util.global.load @__auto.blk.11.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_v.weight = util.global.load @__auto.blk.11.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_output.weight = util.global.load @__auto.blk.11.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.11.ffn_norm.weight = util.global.load @__auto.blk.11.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.ffn_gate.weight = util.global.load @__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_up.weight = util.global.load @__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_down.weight = util.global.load @__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.12.attn_norm.weight = util.global.load @__auto.blk.12.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.attn_q.weight = util.global.load @__auto.blk.12.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.12.attn_k.weight = util.global.load @__auto.blk.12.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_v.weight = util.global.load @__auto.blk.12.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_output.weight = util.global.load @__auto.blk.12.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.12.ffn_norm.weight = util.global.load @__auto.blk.12.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.ffn_gate.weight = util.global.load @__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_up.weight = util.global.load @__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_down.weight = util.global.load @__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.13.attn_norm.weight = util.global.load @__auto.blk.13.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.attn_q.weight = util.global.load @__auto.blk.13.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.13.attn_k.weight = util.global.load @__auto.blk.13.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_v.weight = util.global.load @__auto.blk.13.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_output.weight = util.global.load @__auto.blk.13.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.13.ffn_norm.weight = util.global.load @__auto.blk.13.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.ffn_gate.weight = util.global.load @__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_up.weight = util.global.load @__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_down.weight = util.global.load @__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.14.attn_norm.weight = util.global.load @__auto.blk.14.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.attn_q.weight = util.global.load @__auto.blk.14.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.14.attn_k.weight = util.global.load @__auto.blk.14.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_v.weight = util.global.load @__auto.blk.14.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_output.weight = util.global.load @__auto.blk.14.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.14.ffn_norm.weight = util.global.load @__auto.blk.14.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.ffn_gate.weight = util.global.load @__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_up.weight = util.global.load @__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_down.weight = util.global.load @__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.15.attn_norm.weight = util.global.load @__auto.blk.15.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.attn_q.weight = util.global.load @__auto.blk.15.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.15.attn_k.weight = util.global.load @__auto.blk.15.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_v.weight = util.global.load @__auto.blk.15.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_output.weight = util.global.load @__auto.blk.15.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.15.ffn_norm.weight = util.global.load @__auto.blk.15.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.ffn_gate.weight = util.global.load @__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_up.weight = util.global.load @__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_down.weight = util.global.load @__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.16.attn_norm.weight = util.global.load @__auto.blk.16.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.attn_q.weight = util.global.load @__auto.blk.16.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.16.attn_k.weight = util.global.load @__auto.blk.16.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_v.weight = util.global.load @__auto.blk.16.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_output.weight = util.global.load @__auto.blk.16.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.16.ffn_norm.weight = util.global.load @__auto.blk.16.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.ffn_gate.weight = util.global.load @__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_up.weight = util.global.load @__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_down.weight = util.global.load @__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.17.attn_norm.weight = util.global.load @__auto.blk.17.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.attn_q.weight = util.global.load @__auto.blk.17.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.17.attn_k.weight = util.global.load @__auto.blk.17.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_v.weight = util.global.load @__auto.blk.17.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_output.weight = util.global.load @__auto.blk.17.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.17.ffn_norm.weight = util.global.load @__auto.blk.17.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.ffn_gate.weight = util.global.load @__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_up.weight = util.global.load @__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_down.weight = util.global.load @__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.18.attn_norm.weight = util.global.load @__auto.blk.18.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.attn_q.weight = util.global.load @__auto.blk.18.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.18.attn_k.weight = util.global.load @__auto.blk.18.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_v.weight = util.global.load @__auto.blk.18.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_output.weight = util.global.load @__auto.blk.18.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.18.ffn_norm.weight = util.global.load @__auto.blk.18.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.ffn_gate.weight = util.global.load @__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_up.weight = util.global.load @__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_down.weight = util.global.load @__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.19.attn_norm.weight = util.global.load @__auto.blk.19.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.attn_q.weight = util.global.load @__auto.blk.19.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.19.attn_k.weight = util.global.load @__auto.blk.19.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_v.weight = util.global.load @__auto.blk.19.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_output.weight = util.global.load @__auto.blk.19.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.19.ffn_norm.weight = util.global.load @__auto.blk.19.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.ffn_gate.weight = util.global.load @__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_up.weight = util.global.load @__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_down.weight = util.global.load @__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.20.attn_norm.weight = util.global.load @__auto.blk.20.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.attn_q.weight = util.global.load @__auto.blk.20.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.20.attn_k.weight = util.global.load @__auto.blk.20.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_v.weight = util.global.load @__auto.blk.20.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_output.weight = util.global.load @__auto.blk.20.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.20.ffn_norm.weight = util.global.load @__auto.blk.20.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.ffn_gate.weight = util.global.load @__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_up.weight = util.global.load @__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_down.weight = util.global.load @__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.21.attn_norm.weight = util.global.load @__auto.blk.21.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.attn_q.weight = util.global.load @__auto.blk.21.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.21.attn_k.weight = util.global.load @__auto.blk.21.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_v.weight = util.global.load @__auto.blk.21.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_output.weight = util.global.load @__auto.blk.21.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.21.ffn_norm.weight = util.global.load @__auto.blk.21.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.ffn_gate.weight = util.global.load @__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_up.weight = util.global.load @__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_down.weight = util.global.load @__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.output_norm.weight = util.global.load @__auto.output_norm.weight : tensor<2048xf32>
    %__auto.output.weight = util.global.load @__auto.output.weight : tensor<32000x2176xi8>
    %5 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[0] : index
    %6 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg3 : !hal.buffer_view -> tensor<?x360448xf16>{%5}
    %dim_10 = tensor.dim %6, %c0 : tensor<?x360448xf16>
    %7 = arith.muli %dim, %c32 : index
    %8 = util.assume.int %7<umin = 32, umax = 2016, udiv = 32> : index
    %9 = flow.tensor.tie_shape %1 : tensor<4x?xi64>{%8}
    %10 = util.assume.int %dim<umin = 1, umax = 63> : index
    %11 = flow.tensor.tie_shape %4 : tensor<4x?xi64>{%10}
    %12 = util.assume.int %dim_10<umin = 1, umax = 9007199254740991> : index
    %13 = flow.tensor.tie_shape %6 : tensor<?x360448xf16>{%12}
    %dim_11 = tensor.dim %9, %c1 : tensor<4x?xi64>
    %14 = arith.index_cast %dim_11 : index to i64
    %15 = iree_tensor_ext.bitcast %__auto.token_embd.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded = tensor.expand_shape %15 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice = tensor.extract_slice %expanded[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %16 = iree_tensor_ext.bitcast %extracted_slice : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_12 = tensor.extract_slice %expanded[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %17 = iree_tensor_ext.bitcast %extracted_slice_12 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %18 = tensor.empty() : tensor<32000x64x32xf16>
    %19 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%17 : tensor<32000x64x32xi8>) outs(%18 : tensor<32000x64x32xf16>) {
    ^bb0(%in: i8, %out: f16):
      %3358 = arith.sitofp %in : i8 to f16
      linalg.yield %3358 : f16
    } -> tensor<32000x64x32xf16>
    %20 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%16, %19 : tensor<32000x64x1xf16>, tensor<32000x64x32xf16>) outs(%18 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed = tensor.collapse_shape %20 [[0], [1, 2]] : tensor<32000x64x32xf16> into tensor<32000x2048xf16>
    %21 = tensor.empty(%dim_11) : tensor<4x?x2048xf16>
    %22 = linalg.generic {indexing_maps = [#map2, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%9 : tensor<4x?xi64>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: i64, %out: f16):
      %3358 = arith.index_cast %in : i64 to index
      %3359 = linalg.index 2 : index
      %3360 = arith.cmpi slt, %3358, %c32000 : index
      cf.assert %3360, "index must be smaller than dim size"
      %3361 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3361, "index must be larger or equal to 0"
      %extracted = tensor.extract %collapsed[%3358, %3359] : tensor<32000x2048xf16>
      linalg.yield %extracted : f16
    } -> tensor<4x?x2048xf16>
    %23 = tensor.empty(%dim_11) : tensor<4x?x2048xf32>
    %24 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%22 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %25 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%24 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %26 = tensor.empty(%dim_11) : tensor<4x?x1xf32>
    %27 = linalg.fill ins(%cst_3 : f32) outs(%26 : tensor<4x?x1xf32>) -> tensor<4x?x1xf32>
    %28 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%25 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %29 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%28 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %30 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%29 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %31 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%30 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %32 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%24, %31 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %33 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%32 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %34 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.attn_norm.weight, %33 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %35 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%34 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %36 = iree_tensor_ext.bitcast %__auto.blk.0.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_13 = tensor.expand_shape %36 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_14 = tensor.extract_slice %expanded_13[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %37 = iree_tensor_ext.bitcast %extracted_slice_14 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_15 = tensor.extract_slice %expanded_13[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %38 = iree_tensor_ext.bitcast %extracted_slice_15 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_16 = tensor.dim %35, %c1 : tensor<4x?x2048xf16>
    %39 = tensor.empty() : tensor<2048x64x32xf16>
    %40 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%37, %38 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%39 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_17 = tensor.expand_shape %35 [[0], [1], [2, 3]] output_shape [4, %dim_16, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %41 = tensor.empty(%dim_16) : tensor<4x?x2048xf32>
    %42 = linalg.fill ins(%cst_3 : f32) outs(%41 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %43 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_17, %40 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%42 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %44 = tensor.empty(%dim_16) : tensor<4x?x2048xf16>
    %45 = linalg.copy ins(%43 : tensor<4x?x2048xf32>) outs(%44 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %46 = iree_tensor_ext.bitcast %__auto.blk.0.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_18 = tensor.expand_shape %46 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_19 = tensor.extract_slice %expanded_18[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %47 = iree_tensor_ext.bitcast %extracted_slice_19 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_20 = tensor.extract_slice %expanded_18[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %48 = iree_tensor_ext.bitcast %extracted_slice_20 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_21 = tensor.dim %35, %c1 : tensor<4x?x2048xf16>
    %49 = tensor.empty() : tensor<256x64x32xf16>
    %50 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%47, %48 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%49 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_22 = tensor.expand_shape %35 [[0], [1], [2, 3]] output_shape [4, %dim_21, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %51 = tensor.empty(%dim_21) : tensor<4x?x256xf32>
    %52 = linalg.fill ins(%cst_3 : f32) outs(%51 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %53 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_22, %50 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%52 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %54 = tensor.empty(%dim_21) : tensor<4x?x256xf16>
    %55 = linalg.copy ins(%53 : tensor<4x?x256xf32>) outs(%54 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %56 = iree_tensor_ext.bitcast %__auto.blk.0.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_23 = tensor.expand_shape %56 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_24 = tensor.extract_slice %expanded_23[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %57 = iree_tensor_ext.bitcast %extracted_slice_24 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_25 = tensor.extract_slice %expanded_23[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %58 = iree_tensor_ext.bitcast %extracted_slice_25 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_26 = tensor.dim %35, %c1 : tensor<4x?x2048xf16>
    %59 = tensor.empty() : tensor<256x64x32xf16>
    %60 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%57, %58 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%59 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_27 = tensor.expand_shape %35 [[0], [1], [2, 3]] output_shape [4, %dim_26, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %61 = tensor.empty(%dim_26) : tensor<4x?x256xf32>
    %62 = linalg.fill ins(%cst_3 : f32) outs(%61 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %63 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_27, %60 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%62 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %64 = tensor.empty(%dim_26) : tensor<4x?x256xf16>
    %65 = linalg.copy ins(%63 : tensor<4x?x256xf32>) outs(%64 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_28 = tensor.dim %45, %c1 : tensor<4x?x2048xf16>
    %expanded_29 = tensor.expand_shape %45 [[0], [1], [2, 3]] output_shape [4, %dim_28, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_30 = tensor.dim %55, %c1 : tensor<4x?x256xf16>
    %expanded_31 = tensor.expand_shape %55 [[0], [1], [2, 3]] output_shape [4, %dim_30, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_32 = tensor.dim %65, %c1 : tensor<4x?x256xf16>
    %expanded_33 = tensor.expand_shape %65 [[0], [1], [2, 3]] output_shape [4, %dim_32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %66 = tensor.empty(%dim_11) : tensor<?xi64>
    %67 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%66 : tensor<?xi64>) {
    ^bb0(%out: i64):
      %3358 = linalg.index 0 : index
      %3359 = arith.index_cast %3358 : index to i64
      linalg.yield %3359 : i64
    } -> tensor<?xi64>
    %68 = tensor.empty() : tensor<32xi64>
    %69 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%68 : tensor<32xi64>) {
    ^bb0(%out: i64):
      %3358 = linalg.index 0 : index
      %3359 = arith.index_cast %3358 : index to i64
      %3360 = arith.muli %3359, %c2_i64 : i64
      linalg.yield %3360 : i64
    } -> tensor<32xi64>
    %70 = tensor.empty() : tensor<32xf32>
    %71 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%69 : tensor<32xi64>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: i64, %out: f32):
      %3358 = arith.sitofp %in : i64 to f32
      linalg.yield %3358 : f32
    } -> tensor<32xf32>
    %72 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%71 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_8 : f32
      linalg.yield %3358 : f32
    } -> tensor<32xf32>
    %73 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.powf %cst_9, %in : f32
      linalg.yield %3358 : f32
    } -> tensor<32xf32>
    %74 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_34 = tensor.expand_shape %74 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %expanded_35 = tensor.expand_shape %67 [[0, 1, 2]] output_shape [1, 1, %dim_11] : tensor<?xi64> into tensor<1x1x?xi64>
    %75 = tensor.empty(%dim_11) : tensor<1x1x?xf32>
    %76 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_35 : tensor<1x1x?xi64>) outs(%75 : tensor<1x1x?xf32>) {
    ^bb0(%in: i64, %out: f32):
      %3358 = arith.sitofp %in : i64 to f32
      linalg.yield %3358 : f32
    } -> tensor<1x1x?xf32>
    %77 = tensor.empty(%dim_11) : tensor<1x32x?xf32>
    %78 = linalg.fill ins(%cst_3 : f32) outs(%77 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %79 = linalg.batch_matmul ins(%expanded_34, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %80 = tensor.empty(%dim_11) : tensor<1x?x32xf32>
    %transposed = linalg.transpose ins(%79 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %81 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %82 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%81, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %83 = tensor.empty(%dim_11) : tensor<1x?x32xf16>
    %84 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%82 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %85 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %86 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%85, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %87 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%86 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_36 = tensor.expand_shape %84 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_37 = tensor.expand_shape %87 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_38 = tensor.extract_slice %expanded_29[0, 0, 0, 0] [4, %dim_28, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_39 = tensor.extract_slice %expanded_29[0, 0, 0, 1] [4, %dim_28, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %88 = tensor.empty(%dim_28) : tensor<4x?x32x32xf16>
    %89 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %expanded_36 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%88 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %90 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_39, %expanded_37 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%88 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %91 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%89, %90 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %92 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_39, %expanded_36 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%88 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %93 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %expanded_37 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%88 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %94 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%92, %93 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_40 = tensor.dim %91, %c1 : tensor<4x?x32x32xf16>
    %95 = tensor.empty(%dim_40) : tensor<4x?x32x2x32xf16>
    %96 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%91, %94 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%95 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_41 = tensor.collapse_shape %96 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %97 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_42 = tensor.expand_shape %97 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %98 = linalg.batch_matmul ins(%expanded_42, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_43 = linalg.transpose ins(%98 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %99 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_43 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %100 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%99, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %101 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%100 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_43 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %103 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%102, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %104 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%103 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_44 = tensor.expand_shape %101 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_45 = tensor.expand_shape %104 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_46 = tensor.extract_slice %expanded_31[0, 0, 0, 0] [4, %dim_30, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_47 = tensor.extract_slice %expanded_31[0, 0, 0, 1] [4, %dim_30, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %105 = tensor.empty(%dim_30) : tensor<4x?x4x32xf16>
    %106 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_46, %expanded_44 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%105 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %107 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_47, %expanded_45 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%105 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %108 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%106, %107 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %109 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_47, %expanded_44 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%105 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %110 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_46, %expanded_45 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%105 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %111 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%109, %110 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_48 = tensor.dim %108, %c1 : tensor<4x?x4x32xf16>
    %112 = tensor.empty(%dim_48) : tensor<4x?x4x2x32xf16>
    %113 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%108, %111 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%112 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_49 = tensor.collapse_shape %113 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %dim_50 = tensor.dim %13, %c0 : tensor<?x360448xf16>
    %expanded_51 = tensor.expand_shape %13 [[0], [1, 2, 3, 4, 5]] output_shape [%dim_50, 22, 2, 4, 32, 64] : tensor<?x360448xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_52 = tensor.collapse_shape %expanded_51 [[0, 1, 2], [3], [4], [5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x4x32x64xf16>
    %dim_53 = tensor.dim %11, %c1 : tensor<4x?xi64>
    %114 = tensor.empty(%dim_53) : tensor<4x?xi64>
    %115 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%11 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %116 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_54 = tensor.collapse_shape %116 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_55 = tensor.dim %113, %c1 : tensor<4x?x4x2x32xf16>
    %117 = arith.divsi %dim_55, %c32 : index
    %expanded_56 = tensor.expand_shape %collapsed_49 [[0], [1, 2], [3], [4]] output_shape [4, %117, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_57 = tensor.collapse_shape %expanded_56 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %118 = affine.apply #map14()[%117]
    %119 = tensor.empty(%118) : tensor<?x4x32x64xf16>
    %transposed_58 = linalg.transpose ins(%collapsed_57 : tensor<?x32x4x64xf16>) outs(%119 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %120 = affine.apply #map14()[%dim_53]
    %expanded_59 = tensor.expand_shape %collapsed_54 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %121 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_58, %expanded_59 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%collapsed_52 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %122 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%116 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_60 = tensor.collapse_shape %122 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %123 = arith.divsi %dim_32, %c32 : index
    %expanded_61 = tensor.expand_shape %65 [[0], [1, 2], [3, 4]] output_shape [4, %123, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_62 = tensor.collapse_shape %expanded_61 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %124 = affine.apply #map14()[%123]
    %125 = tensor.empty(%124) : tensor<?x4x32x64xf16>
    %transposed_63 = linalg.transpose ins(%collapsed_62 : tensor<?x32x4x64xf16>) outs(%125 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_64 = tensor.expand_shape %collapsed_60 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %126 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_63, %expanded_64 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%121 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %expanded_65 = tensor.expand_shape %2 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %127 = tensor.empty(%dim_11) : tensor<4x?xi1>
    %128 = linalg.generic {indexing_maps = [#map15, #map16, #map13], iterator_types = ["parallel", "parallel"]} ins(%67, %expanded_65 : tensor<?xi64>, tensor<4x1xi64>) outs(%127 : tensor<4x?xi1>) {
    ^bb0(%in: i64, %in_1860: i64, %out: i1):
      %3358 = arith.cmpi sge, %in, %in_1860 : i64
      linalg.yield %3358 : i1
    } -> tensor<4x?xi1>
    %expanded_66 = tensor.expand_shape %67 [[0, 1, 2, 3]] output_shape [1, 1, 1, %dim_11] : tensor<?xi64> into tensor<1x1x1x?xi64>
    %expanded_67 = tensor.expand_shape %67 [[0, 1, 2, 3]] output_shape [1, 1, %dim_11, 1] : tensor<?xi64> into tensor<1x1x?x1xi64>
    %129 = tensor.empty(%dim_11, %dim_11) : tensor<1x1x?x?xi1>
    %130 = linalg.generic {indexing_maps = [#map17, #map18, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_66, %expanded_67 : tensor<1x1x1x?xi64>, tensor<1x1x?x1xi64>) outs(%129 : tensor<1x1x?x?xi1>) {
    ^bb0(%in: i64, %in_1860: i64, %out: i1):
      %3358 = arith.cmpi sgt, %in, %in_1860 : i64
      linalg.yield %3358 : i1
    } -> tensor<1x1x?x?xi1>
    %expanded_68 = tensor.expand_shape %128 [[0], [1, 2, 3]] output_shape [4, 1, 1, %dim_11] : tensor<4x?xi1> into tensor<4x1x1x?xi1>
    %131 = tensor.empty(%dim_11, %dim_11) : tensor<4x1x?x?xi1>
    %132 = linalg.generic {indexing_maps = [#map19, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%130, %expanded_68 : tensor<1x1x?x?xi1>, tensor<4x1x1x?xi1>) outs(%131 : tensor<4x1x?x?xi1>) {
    ^bb0(%in: i1, %in_1860: i1, %out: i1):
      %3358 = arith.ori %in, %in_1860 : i1
      linalg.yield %3358 : i1
    } -> tensor<4x1x?x?xi1>
    %133 = tensor.empty() : tensor<f16>
    %134 = linalg.generic {indexing_maps = [#map20, #map20], iterator_types = []} ins(%cst_0 : tensor<i64>) outs(%133 : tensor<f16>) {
    ^bb0(%in: i64, %out: f16):
      %3358 = arith.sitofp %in : i64 to f16
      linalg.yield %3358 : f16
    } -> tensor<f16>
    %135 = tensor.empty(%dim_11, %dim_11) : tensor<4x1x?x?xf16>
    %136 = linalg.generic {indexing_maps = [#map9, #map21, #map21, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%132, %cst_1, %134 : tensor<4x1x?x?xi1>, tensor<f16>, tensor<f16>) outs(%135 : tensor<4x1x?x?xf16>) {
    ^bb0(%in: i1, %in_1860: f16, %in_1861: f16, %out: f16):
      %3358 = arith.select %in, %in_1860, %in_1861 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x1x?x?xf16>
    %137 = arith.index_cast %14 : i64 to index
    %138 = tensor.empty(%137) : tensor<4x?x4x8x64xf16>
    %139 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_49 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_69 = tensor.collapse_shape %139 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %140 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_33 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_70 = tensor.collapse_shape %140 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_71 = tensor.dim %96, %c1 : tensor<4x?x32x2x32xf16>
    %141 = tensor.empty(%dim_71) : tensor<4x32x?x64xf16>
    %transposed_72 = linalg.transpose ins(%collapsed_41 : tensor<4x?x32x64xf16>) outs(%141 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %142 = tensor.empty(%dim_55) : tensor<4x32x?x64xf16>
    %transposed_73 = linalg.transpose ins(%collapsed_69 : tensor<4x?x32x64xf16>) outs(%142 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %143 = tensor.empty(%dim_32) : tensor<4x32x?x64xf16>
    %transposed_74 = linalg.transpose ins(%collapsed_70 : tensor<4x?x32x64xf16>) outs(%143 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %dim_75 = tensor.dim %136, %c2 : tensor<4x1x?x?xf16>
    %dim_76 = tensor.dim %136, %c3 : tensor<4x1x?x?xf16>
    %144 = tensor.empty(%dim_75, %dim_76) : tensor<4x32x?x?xf16>
    %145 = linalg.generic {indexing_maps = [#map22, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%136 : tensor<4x1x?x?xf16>) outs(%144 : tensor<4x32x?x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x32x?x?xf16>
    %collapsed_77 = tensor.collapse_shape %transposed_72 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_78 = tensor.collapse_shape %transposed_73 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_79 = tensor.collapse_shape %transposed_74 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_80 = tensor.collapse_shape %145 [[0, 1], [2], [3]] : tensor<4x32x?x?xf16> into tensor<128x?x?xf16>
    %dim_81 = tensor.dim %transposed_72, %c2 : tensor<4x32x?x64xf16>
    %146 = tensor.empty(%dim_81) : tensor<128x?x64xf16>
    %147 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_77, %collapsed_78, %collapsed_79, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%146 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_82 = tensor.expand_shape %147 [[0, 1], [2], [3]] output_shape [4, 32, %dim_81, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_83 = tensor.dim %expanded_82, %c2 : tensor<4x32x?x64xf16>
    %148 = tensor.empty(%dim_83) : tensor<4x?x32x64xf16>
    %transposed_84 = linalg.transpose ins(%expanded_82 : tensor<4x32x?x64xf16>) outs(%148 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_85 = tensor.collapse_shape %transposed_84 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %149 = iree_tensor_ext.bitcast %__auto.blk.0.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_86 = tensor.expand_shape %149 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_87 = tensor.extract_slice %expanded_86[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %150 = iree_tensor_ext.bitcast %extracted_slice_87 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_88 = tensor.extract_slice %expanded_86[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %151 = iree_tensor_ext.bitcast %extracted_slice_88 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_89 = tensor.dim %collapsed_85, %c1 : tensor<4x?x2048xf16>
    %152 = tensor.empty() : tensor<2048x64x32xf16>
    %153 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%150, %151 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%152 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_90 = tensor.expand_shape %collapsed_85 [[0], [1], [2, 3]] output_shape [4, %dim_89, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %154 = tensor.empty(%dim_89) : tensor<4x?x2048xf32>
    %155 = linalg.fill ins(%cst_3 : f32) outs(%154 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %156 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_90, %153 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%155 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %157 = tensor.empty(%dim_89) : tensor<4x?x2048xf16>
    %158 = linalg.copy ins(%156 : tensor<4x?x2048xf32>) outs(%157 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %159 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%22, %158 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %160 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%159 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %161 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%160 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %162 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%161 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %163 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%162 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %164 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%163 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %165 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%164 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %166 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%160, %165 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %167 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%166 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %168 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.ffn_norm.weight, %167 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %169 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%168 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %170 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_91 = tensor.expand_shape %170 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_92 = tensor.extract_slice %expanded_91[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %171 = iree_tensor_ext.bitcast %extracted_slice_92 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_93 = tensor.extract_slice %expanded_91[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %172 = iree_tensor_ext.bitcast %extracted_slice_93 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_94 = tensor.dim %169, %c1 : tensor<4x?x2048xf16>
    %173 = tensor.empty() : tensor<5632x64x32xf16>
    %174 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%171, %172 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%173 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_95 = tensor.expand_shape %169 [[0], [1], [2, 3]] output_shape [4, %dim_94, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %175 = tensor.empty(%dim_94) : tensor<4x?x5632xf32>
    %176 = linalg.fill ins(%cst_3 : f32) outs(%175 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %177 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_95, %174 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%176 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %178 = tensor.empty(%dim_94) : tensor<4x?x5632xf16>
    %179 = linalg.copy ins(%177 : tensor<4x?x5632xf32>) outs(%178 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_96 = tensor.dim %179, %c1 : tensor<4x?x5632xf16>
    %180 = tensor.empty(%dim_96) : tensor<4x?x5632xf16>
    %181 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%179 : tensor<4x?x5632xf16>) outs(%180 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %182 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%181, %179 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%180 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %183 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_97 = tensor.expand_shape %183 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_98 = tensor.extract_slice %expanded_97[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %184 = iree_tensor_ext.bitcast %extracted_slice_98 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_99 = tensor.extract_slice %expanded_97[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %185 = iree_tensor_ext.bitcast %extracted_slice_99 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_100 = tensor.dim %169, %c1 : tensor<4x?x2048xf16>
    %186 = tensor.empty() : tensor<5632x64x32xf16>
    %187 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%184, %185 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%186 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_101 = tensor.expand_shape %169 [[0], [1], [2, 3]] output_shape [4, %dim_100, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %188 = tensor.empty(%dim_100) : tensor<4x?x5632xf32>
    %189 = linalg.fill ins(%cst_3 : f32) outs(%188 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %190 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_101, %187 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%189 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %191 = tensor.empty(%dim_100) : tensor<4x?x5632xf16>
    %192 = linalg.copy ins(%190 : tensor<4x?x5632xf32>) outs(%191 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %193 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%182, %192 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%180 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %194 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_102 = tensor.expand_shape %194 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_103 = tensor.extract_slice %expanded_102[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %195 = iree_tensor_ext.bitcast %extracted_slice_103 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_104 = tensor.extract_slice %expanded_102[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %196 = iree_tensor_ext.bitcast %extracted_slice_104 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_105 = tensor.dim %193, %c1 : tensor<4x?x5632xf16>
    %197 = tensor.empty() : tensor<2048x176x32xf16>
    %198 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%195, %196 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%197 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_106 = tensor.expand_shape %193 [[0], [1], [2, 3]] output_shape [4, %dim_105, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %199 = tensor.empty(%dim_105) : tensor<4x?x2048xf32>
    %200 = linalg.fill ins(%cst_3 : f32) outs(%199 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %201 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_106, %198 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%200 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %202 = tensor.empty(%dim_105) : tensor<4x?x2048xf16>
    %203 = linalg.copy ins(%201 : tensor<4x?x2048xf32>) outs(%202 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %204 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%159, %203 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %205 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%204 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %206 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%205 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %207 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%206 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %208 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%207 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %209 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%208 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %210 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%209 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %211 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%205, %210 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %212 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%211 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %213 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.attn_norm.weight, %212 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %214 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%213 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %215 = iree_tensor_ext.bitcast %__auto.blk.1.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_107 = tensor.expand_shape %215 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_108 = tensor.extract_slice %expanded_107[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %216 = iree_tensor_ext.bitcast %extracted_slice_108 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_109 = tensor.extract_slice %expanded_107[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %217 = iree_tensor_ext.bitcast %extracted_slice_109 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_110 = tensor.dim %214, %c1 : tensor<4x?x2048xf16>
    %218 = tensor.empty() : tensor<2048x64x32xf16>
    %219 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%216, %217 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%218 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_111 = tensor.expand_shape %214 [[0], [1], [2, 3]] output_shape [4, %dim_110, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %220 = tensor.empty(%dim_110) : tensor<4x?x2048xf32>
    %221 = linalg.fill ins(%cst_3 : f32) outs(%220 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %222 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_111, %219 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%221 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %223 = tensor.empty(%dim_110) : tensor<4x?x2048xf16>
    %224 = linalg.copy ins(%222 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %225 = iree_tensor_ext.bitcast %__auto.blk.1.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_112 = tensor.expand_shape %225 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_113 = tensor.extract_slice %expanded_112[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %226 = iree_tensor_ext.bitcast %extracted_slice_113 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_114 = tensor.extract_slice %expanded_112[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %227 = iree_tensor_ext.bitcast %extracted_slice_114 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_115 = tensor.dim %214, %c1 : tensor<4x?x2048xf16>
    %228 = tensor.empty() : tensor<256x64x32xf16>
    %229 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%226, %227 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%228 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_116 = tensor.expand_shape %214 [[0], [1], [2, 3]] output_shape [4, %dim_115, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %230 = tensor.empty(%dim_115) : tensor<4x?x256xf32>
    %231 = linalg.fill ins(%cst_3 : f32) outs(%230 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %232 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_116, %229 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%231 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %233 = tensor.empty(%dim_115) : tensor<4x?x256xf16>
    %234 = linalg.copy ins(%232 : tensor<4x?x256xf32>) outs(%233 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %235 = iree_tensor_ext.bitcast %__auto.blk.1.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_117 = tensor.expand_shape %235 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_118 = tensor.extract_slice %expanded_117[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %236 = iree_tensor_ext.bitcast %extracted_slice_118 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_119 = tensor.extract_slice %expanded_117[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %237 = iree_tensor_ext.bitcast %extracted_slice_119 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_120 = tensor.dim %214, %c1 : tensor<4x?x2048xf16>
    %238 = tensor.empty() : tensor<256x64x32xf16>
    %239 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%236, %237 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%238 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_121 = tensor.expand_shape %214 [[0], [1], [2, 3]] output_shape [4, %dim_120, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %240 = tensor.empty(%dim_120) : tensor<4x?x256xf32>
    %241 = linalg.fill ins(%cst_3 : f32) outs(%240 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %242 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_121, %239 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%241 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %243 = tensor.empty(%dim_120) : tensor<4x?x256xf16>
    %244 = linalg.copy ins(%242 : tensor<4x?x256xf32>) outs(%243 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_122 = tensor.dim %224, %c1 : tensor<4x?x2048xf16>
    %expanded_123 = tensor.expand_shape %224 [[0], [1], [2, 3]] output_shape [4, %dim_122, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_124 = tensor.dim %234, %c1 : tensor<4x?x256xf16>
    %expanded_125 = tensor.expand_shape %234 [[0], [1], [2, 3]] output_shape [4, %dim_124, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_126 = tensor.dim %244, %c1 : tensor<4x?x256xf16>
    %expanded_127 = tensor.expand_shape %244 [[0], [1], [2, 3]] output_shape [4, %dim_126, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %245 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_128 = tensor.expand_shape %245 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %246 = linalg.batch_matmul ins(%expanded_128, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_129 = linalg.transpose ins(%246 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %247 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_129 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %248 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%247, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%248 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %250 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_129 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %251 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%250, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%251 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_130 = tensor.expand_shape %249 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_131 = tensor.expand_shape %252 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_132 = tensor.extract_slice %expanded_123[0, 0, 0, 0] [4, %dim_122, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_133 = tensor.extract_slice %expanded_123[0, 0, 0, 1] [4, %dim_122, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %253 = tensor.empty(%dim_122) : tensor<4x?x32x32xf16>
    %254 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_132, %expanded_130 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%253 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %255 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_133, %expanded_131 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%253 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %256 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%254, %255 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%253 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %257 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_133, %expanded_130 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%253 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %258 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_132, %expanded_131 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%253 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %259 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%257, %258 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%253 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_134 = tensor.dim %256, %c1 : tensor<4x?x32x32xf16>
    %260 = tensor.empty(%dim_134) : tensor<4x?x32x2x32xf16>
    %261 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%256, %259 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%260 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_135 = tensor.collapse_shape %261 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %262 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_136 = tensor.expand_shape %262 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %263 = linalg.batch_matmul ins(%expanded_136, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_137 = linalg.transpose ins(%263 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %264 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_137 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %265 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%264, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %266 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%265 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %267 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_137 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %268 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%267, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %269 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%268 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_138 = tensor.expand_shape %266 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_139 = tensor.expand_shape %269 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_140 = tensor.extract_slice %expanded_125[0, 0, 0, 0] [4, %dim_124, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_141 = tensor.extract_slice %expanded_125[0, 0, 0, 1] [4, %dim_124, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %270 = tensor.empty(%dim_124) : tensor<4x?x4x32xf16>
    %271 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_140, %expanded_138 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%270 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %272 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_141, %expanded_139 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%270 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %273 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%271, %272 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%270 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %274 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_141, %expanded_138 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%270 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %275 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_140, %expanded_139 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%270 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %276 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%274, %275 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%270 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_142 = tensor.dim %273, %c1 : tensor<4x?x4x32xf16>
    %277 = tensor.empty(%dim_142) : tensor<4x?x4x2x32xf16>
    %278 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%273, %276 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%277 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_143 = tensor.collapse_shape %278 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %279 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %280 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%279 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_144 = tensor.collapse_shape %280 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_145 = tensor.dim %278, %c1 : tensor<4x?x4x2x32xf16>
    %281 = arith.divsi %dim_145, %c32 : index
    %expanded_146 = tensor.expand_shape %collapsed_143 [[0], [1, 2], [3], [4]] output_shape [4, %281, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_147 = tensor.collapse_shape %expanded_146 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %282 = affine.apply #map14()[%281]
    %283 = tensor.empty(%282) : tensor<?x4x32x64xf16>
    %transposed_148 = linalg.transpose ins(%collapsed_147 : tensor<?x32x4x64xf16>) outs(%283 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_149 = tensor.expand_shape %collapsed_144 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %284 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_148, %expanded_149 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%126 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %285 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%280 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_150 = tensor.collapse_shape %285 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %286 = arith.divsi %dim_126, %c32 : index
    %expanded_151 = tensor.expand_shape %244 [[0], [1, 2], [3, 4]] output_shape [4, %286, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_152 = tensor.collapse_shape %expanded_151 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %287 = affine.apply #map14()[%286]
    %288 = tensor.empty(%287) : tensor<?x4x32x64xf16>
    %transposed_153 = linalg.transpose ins(%collapsed_152 : tensor<?x32x4x64xf16>) outs(%288 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_154 = tensor.expand_shape %collapsed_150 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %289 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_153, %expanded_154 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%284 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %290 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_143 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_155 = tensor.collapse_shape %290 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %291 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_127 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_156 = tensor.collapse_shape %291 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_157 = tensor.dim %261, %c1 : tensor<4x?x32x2x32xf16>
    %292 = tensor.empty(%dim_157) : tensor<4x32x?x64xf16>
    %transposed_158 = linalg.transpose ins(%collapsed_135 : tensor<4x?x32x64xf16>) outs(%292 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %293 = tensor.empty(%dim_145) : tensor<4x32x?x64xf16>
    %transposed_159 = linalg.transpose ins(%collapsed_155 : tensor<4x?x32x64xf16>) outs(%293 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %294 = tensor.empty(%dim_126) : tensor<4x32x?x64xf16>
    %transposed_160 = linalg.transpose ins(%collapsed_156 : tensor<4x?x32x64xf16>) outs(%294 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_161 = tensor.collapse_shape %transposed_158 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_162 = tensor.collapse_shape %transposed_159 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_163 = tensor.collapse_shape %transposed_160 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_164 = tensor.dim %transposed_158, %c2 : tensor<4x32x?x64xf16>
    %295 = tensor.empty(%dim_164) : tensor<128x?x64xf16>
    %296 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_161, %collapsed_162, %collapsed_163, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%295 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_165 = tensor.expand_shape %296 [[0, 1], [2], [3]] output_shape [4, 32, %dim_164, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_166 = tensor.dim %expanded_165, %c2 : tensor<4x32x?x64xf16>
    %297 = tensor.empty(%dim_166) : tensor<4x?x32x64xf16>
    %transposed_167 = linalg.transpose ins(%expanded_165 : tensor<4x32x?x64xf16>) outs(%297 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_168 = tensor.collapse_shape %transposed_167 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %298 = iree_tensor_ext.bitcast %__auto.blk.1.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_169 = tensor.expand_shape %298 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_170 = tensor.extract_slice %expanded_169[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %299 = iree_tensor_ext.bitcast %extracted_slice_170 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_171 = tensor.extract_slice %expanded_169[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %300 = iree_tensor_ext.bitcast %extracted_slice_171 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_172 = tensor.dim %collapsed_168, %c1 : tensor<4x?x2048xf16>
    %301 = tensor.empty() : tensor<2048x64x32xf16>
    %302 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%299, %300 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%301 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_173 = tensor.expand_shape %collapsed_168 [[0], [1], [2, 3]] output_shape [4, %dim_172, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %303 = tensor.empty(%dim_172) : tensor<4x?x2048xf32>
    %304 = linalg.fill ins(%cst_3 : f32) outs(%303 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %305 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_173, %302 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%304 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %306 = tensor.empty(%dim_172) : tensor<4x?x2048xf16>
    %307 = linalg.copy ins(%305 : tensor<4x?x2048xf32>) outs(%306 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %308 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%204, %307 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %309 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%308 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %310 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%309 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %311 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%310 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %312 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%311 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %313 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%312 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %314 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%313 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %315 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%309, %314 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %316 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%315 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %317 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.ffn_norm.weight, %316 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %318 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%317 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %319 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_174 = tensor.expand_shape %319 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_175 = tensor.extract_slice %expanded_174[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %320 = iree_tensor_ext.bitcast %extracted_slice_175 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_176 = tensor.extract_slice %expanded_174[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %321 = iree_tensor_ext.bitcast %extracted_slice_176 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_177 = tensor.dim %318, %c1 : tensor<4x?x2048xf16>
    %322 = tensor.empty() : tensor<5632x64x32xf16>
    %323 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%320, %321 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%322 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_178 = tensor.expand_shape %318 [[0], [1], [2, 3]] output_shape [4, %dim_177, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %324 = tensor.empty(%dim_177) : tensor<4x?x5632xf32>
    %325 = linalg.fill ins(%cst_3 : f32) outs(%324 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %326 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_178, %323 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%325 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %327 = tensor.empty(%dim_177) : tensor<4x?x5632xf16>
    %328 = linalg.copy ins(%326 : tensor<4x?x5632xf32>) outs(%327 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_179 = tensor.dim %328, %c1 : tensor<4x?x5632xf16>
    %329 = tensor.empty(%dim_179) : tensor<4x?x5632xf16>
    %330 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%328 : tensor<4x?x5632xf16>) outs(%329 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %331 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%330, %328 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%329 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %332 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_180 = tensor.expand_shape %332 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_181 = tensor.extract_slice %expanded_180[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %333 = iree_tensor_ext.bitcast %extracted_slice_181 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_182 = tensor.extract_slice %expanded_180[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %334 = iree_tensor_ext.bitcast %extracted_slice_182 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_183 = tensor.dim %318, %c1 : tensor<4x?x2048xf16>
    %335 = tensor.empty() : tensor<5632x64x32xf16>
    %336 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%333, %334 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%335 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_184 = tensor.expand_shape %318 [[0], [1], [2, 3]] output_shape [4, %dim_183, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %337 = tensor.empty(%dim_183) : tensor<4x?x5632xf32>
    %338 = linalg.fill ins(%cst_3 : f32) outs(%337 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %339 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_184, %336 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%338 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %340 = tensor.empty(%dim_183) : tensor<4x?x5632xf16>
    %341 = linalg.copy ins(%339 : tensor<4x?x5632xf32>) outs(%340 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %342 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%331, %341 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%329 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %343 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_185 = tensor.expand_shape %343 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_186 = tensor.extract_slice %expanded_185[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %344 = iree_tensor_ext.bitcast %extracted_slice_186 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_187 = tensor.extract_slice %expanded_185[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %345 = iree_tensor_ext.bitcast %extracted_slice_187 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_188 = tensor.dim %342, %c1 : tensor<4x?x5632xf16>
    %346 = tensor.empty() : tensor<2048x176x32xf16>
    %347 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%344, %345 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%346 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_189 = tensor.expand_shape %342 [[0], [1], [2, 3]] output_shape [4, %dim_188, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %348 = tensor.empty(%dim_188) : tensor<4x?x2048xf32>
    %349 = linalg.fill ins(%cst_3 : f32) outs(%348 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %350 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_189, %347 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%349 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %351 = tensor.empty(%dim_188) : tensor<4x?x2048xf16>
    %352 = linalg.copy ins(%350 : tensor<4x?x2048xf32>) outs(%351 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %353 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%308, %352 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %354 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%353 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %355 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%354 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %356 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%355 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %357 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%356 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %358 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%357 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %359 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%358 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %360 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%354, %359 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %361 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%360 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %362 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.attn_norm.weight, %361 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %363 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%362 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %364 = iree_tensor_ext.bitcast %__auto.blk.2.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_190 = tensor.expand_shape %364 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_191 = tensor.extract_slice %expanded_190[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %365 = iree_tensor_ext.bitcast %extracted_slice_191 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_192 = tensor.extract_slice %expanded_190[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %366 = iree_tensor_ext.bitcast %extracted_slice_192 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_193 = tensor.dim %363, %c1 : tensor<4x?x2048xf16>
    %367 = tensor.empty() : tensor<2048x64x32xf16>
    %368 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%365, %366 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%367 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_194 = tensor.expand_shape %363 [[0], [1], [2, 3]] output_shape [4, %dim_193, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %369 = tensor.empty(%dim_193) : tensor<4x?x2048xf32>
    %370 = linalg.fill ins(%cst_3 : f32) outs(%369 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %371 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_194, %368 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%370 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %372 = tensor.empty(%dim_193) : tensor<4x?x2048xf16>
    %373 = linalg.copy ins(%371 : tensor<4x?x2048xf32>) outs(%372 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %374 = iree_tensor_ext.bitcast %__auto.blk.2.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_195 = tensor.expand_shape %374 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_196 = tensor.extract_slice %expanded_195[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %375 = iree_tensor_ext.bitcast %extracted_slice_196 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_197 = tensor.extract_slice %expanded_195[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %376 = iree_tensor_ext.bitcast %extracted_slice_197 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_198 = tensor.dim %363, %c1 : tensor<4x?x2048xf16>
    %377 = tensor.empty() : tensor<256x64x32xf16>
    %378 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%375, %376 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%377 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_199 = tensor.expand_shape %363 [[0], [1], [2, 3]] output_shape [4, %dim_198, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %379 = tensor.empty(%dim_198) : tensor<4x?x256xf32>
    %380 = linalg.fill ins(%cst_3 : f32) outs(%379 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %381 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_199, %378 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%380 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %382 = tensor.empty(%dim_198) : tensor<4x?x256xf16>
    %383 = linalg.copy ins(%381 : tensor<4x?x256xf32>) outs(%382 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %384 = iree_tensor_ext.bitcast %__auto.blk.2.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_200 = tensor.expand_shape %384 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_201 = tensor.extract_slice %expanded_200[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %385 = iree_tensor_ext.bitcast %extracted_slice_201 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_202 = tensor.extract_slice %expanded_200[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %386 = iree_tensor_ext.bitcast %extracted_slice_202 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_203 = tensor.dim %363, %c1 : tensor<4x?x2048xf16>
    %387 = tensor.empty() : tensor<256x64x32xf16>
    %388 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%385, %386 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%387 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_204 = tensor.expand_shape %363 [[0], [1], [2, 3]] output_shape [4, %dim_203, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %389 = tensor.empty(%dim_203) : tensor<4x?x256xf32>
    %390 = linalg.fill ins(%cst_3 : f32) outs(%389 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %391 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_204, %388 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%390 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %392 = tensor.empty(%dim_203) : tensor<4x?x256xf16>
    %393 = linalg.copy ins(%391 : tensor<4x?x256xf32>) outs(%392 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_205 = tensor.dim %373, %c1 : tensor<4x?x2048xf16>
    %expanded_206 = tensor.expand_shape %373 [[0], [1], [2, 3]] output_shape [4, %dim_205, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_207 = tensor.dim %383, %c1 : tensor<4x?x256xf16>
    %expanded_208 = tensor.expand_shape %383 [[0], [1], [2, 3]] output_shape [4, %dim_207, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_209 = tensor.dim %393, %c1 : tensor<4x?x256xf16>
    %expanded_210 = tensor.expand_shape %393 [[0], [1], [2, 3]] output_shape [4, %dim_209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %394 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_211 = tensor.expand_shape %394 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %395 = linalg.batch_matmul ins(%expanded_211, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_212 = linalg.transpose ins(%395 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %396 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_212 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %397 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%396, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %398 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%397 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %399 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_212 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %400 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%399, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %401 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%400 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_213 = tensor.expand_shape %398 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_214 = tensor.expand_shape %401 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_215 = tensor.extract_slice %expanded_206[0, 0, 0, 0] [4, %dim_205, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_216 = tensor.extract_slice %expanded_206[0, 0, 0, 1] [4, %dim_205, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %402 = tensor.empty(%dim_205) : tensor<4x?x32x32xf16>
    %403 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_215, %expanded_213 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%402 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %404 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_216, %expanded_214 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%402 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %405 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%403, %404 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%402 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %406 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_216, %expanded_213 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%402 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %407 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_215, %expanded_214 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%402 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %408 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%406, %407 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%402 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_217 = tensor.dim %405, %c1 : tensor<4x?x32x32xf16>
    %409 = tensor.empty(%dim_217) : tensor<4x?x32x2x32xf16>
    %410 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%405, %408 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%409 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_218 = tensor.collapse_shape %410 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %411 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_219 = tensor.expand_shape %411 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %412 = linalg.batch_matmul ins(%expanded_219, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_220 = linalg.transpose ins(%412 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %413 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_220 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %414 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%413, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %415 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%414 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %416 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_220 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %417 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%416, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %418 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%417 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_221 = tensor.expand_shape %415 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_222 = tensor.expand_shape %418 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_223 = tensor.extract_slice %expanded_208[0, 0, 0, 0] [4, %dim_207, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_224 = tensor.extract_slice %expanded_208[0, 0, 0, 1] [4, %dim_207, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %419 = tensor.empty(%dim_207) : tensor<4x?x4x32xf16>
    %420 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_223, %expanded_221 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%419 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %421 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_224, %expanded_222 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%419 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %422 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%420, %421 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%419 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %423 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_224, %expanded_221 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%419 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %424 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_223, %expanded_222 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%419 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %425 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%423, %424 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%419 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_225 = tensor.dim %422, %c1 : tensor<4x?x4x32xf16>
    %426 = tensor.empty(%dim_225) : tensor<4x?x4x2x32xf16>
    %427 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%422, %425 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%426 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_226 = tensor.collapse_shape %427 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %428 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %429 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%428 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_227 = tensor.collapse_shape %429 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_228 = tensor.dim %427, %c1 : tensor<4x?x4x2x32xf16>
    %430 = arith.divsi %dim_228, %c32 : index
    %expanded_229 = tensor.expand_shape %collapsed_226 [[0], [1, 2], [3], [4]] output_shape [4, %430, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_230 = tensor.collapse_shape %expanded_229 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %431 = affine.apply #map14()[%430]
    %432 = tensor.empty(%431) : tensor<?x4x32x64xf16>
    %transposed_231 = linalg.transpose ins(%collapsed_230 : tensor<?x32x4x64xf16>) outs(%432 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_232 = tensor.expand_shape %collapsed_227 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %433 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_231, %expanded_232 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%289 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %434 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%429 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_233 = tensor.collapse_shape %434 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %435 = arith.divsi %dim_209, %c32 : index
    %expanded_234 = tensor.expand_shape %393 [[0], [1, 2], [3, 4]] output_shape [4, %435, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_235 = tensor.collapse_shape %expanded_234 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %436 = affine.apply #map14()[%435]
    %437 = tensor.empty(%436) : tensor<?x4x32x64xf16>
    %transposed_236 = linalg.transpose ins(%collapsed_235 : tensor<?x32x4x64xf16>) outs(%437 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_237 = tensor.expand_shape %collapsed_233 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %438 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_236, %expanded_237 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%433 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %439 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_226 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_238 = tensor.collapse_shape %439 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %440 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_210 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_239 = tensor.collapse_shape %440 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_240 = tensor.dim %410, %c1 : tensor<4x?x32x2x32xf16>
    %441 = tensor.empty(%dim_240) : tensor<4x32x?x64xf16>
    %transposed_241 = linalg.transpose ins(%collapsed_218 : tensor<4x?x32x64xf16>) outs(%441 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %442 = tensor.empty(%dim_228) : tensor<4x32x?x64xf16>
    %transposed_242 = linalg.transpose ins(%collapsed_238 : tensor<4x?x32x64xf16>) outs(%442 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %443 = tensor.empty(%dim_209) : tensor<4x32x?x64xf16>
    %transposed_243 = linalg.transpose ins(%collapsed_239 : tensor<4x?x32x64xf16>) outs(%443 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_244 = tensor.collapse_shape %transposed_241 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_245 = tensor.collapse_shape %transposed_242 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_246 = tensor.collapse_shape %transposed_243 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_247 = tensor.dim %transposed_241, %c2 : tensor<4x32x?x64xf16>
    %444 = tensor.empty(%dim_247) : tensor<128x?x64xf16>
    %445 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_244, %collapsed_245, %collapsed_246, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%444 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_248 = tensor.expand_shape %445 [[0, 1], [2], [3]] output_shape [4, 32, %dim_247, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_249 = tensor.dim %expanded_248, %c2 : tensor<4x32x?x64xf16>
    %446 = tensor.empty(%dim_249) : tensor<4x?x32x64xf16>
    %transposed_250 = linalg.transpose ins(%expanded_248 : tensor<4x32x?x64xf16>) outs(%446 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_251 = tensor.collapse_shape %transposed_250 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %447 = iree_tensor_ext.bitcast %__auto.blk.2.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_252 = tensor.expand_shape %447 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_253 = tensor.extract_slice %expanded_252[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %448 = iree_tensor_ext.bitcast %extracted_slice_253 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_254 = tensor.extract_slice %expanded_252[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %449 = iree_tensor_ext.bitcast %extracted_slice_254 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_255 = tensor.dim %collapsed_251, %c1 : tensor<4x?x2048xf16>
    %450 = tensor.empty() : tensor<2048x64x32xf16>
    %451 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%448, %449 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%450 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_256 = tensor.expand_shape %collapsed_251 [[0], [1], [2, 3]] output_shape [4, %dim_255, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %452 = tensor.empty(%dim_255) : tensor<4x?x2048xf32>
    %453 = linalg.fill ins(%cst_3 : f32) outs(%452 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %454 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_256, %451 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%453 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %455 = tensor.empty(%dim_255) : tensor<4x?x2048xf16>
    %456 = linalg.copy ins(%454 : tensor<4x?x2048xf32>) outs(%455 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %457 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%353, %456 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %458 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%457 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %459 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%458 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %460 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%459 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %461 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%460 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %462 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%461 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %463 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%462 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %464 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%458, %463 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %465 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%464 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %466 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.ffn_norm.weight, %465 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %467 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%466 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %468 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_257 = tensor.expand_shape %468 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_258 = tensor.extract_slice %expanded_257[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %469 = iree_tensor_ext.bitcast %extracted_slice_258 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_259 = tensor.extract_slice %expanded_257[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %470 = iree_tensor_ext.bitcast %extracted_slice_259 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_260 = tensor.dim %467, %c1 : tensor<4x?x2048xf16>
    %471 = tensor.empty() : tensor<5632x64x32xf16>
    %472 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%469, %470 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%471 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_261 = tensor.expand_shape %467 [[0], [1], [2, 3]] output_shape [4, %dim_260, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %473 = tensor.empty(%dim_260) : tensor<4x?x5632xf32>
    %474 = linalg.fill ins(%cst_3 : f32) outs(%473 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %475 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_261, %472 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%474 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %476 = tensor.empty(%dim_260) : tensor<4x?x5632xf16>
    %477 = linalg.copy ins(%475 : tensor<4x?x5632xf32>) outs(%476 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_262 = tensor.dim %477, %c1 : tensor<4x?x5632xf16>
    %478 = tensor.empty(%dim_262) : tensor<4x?x5632xf16>
    %479 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%477 : tensor<4x?x5632xf16>) outs(%478 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %480 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%479, %477 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%478 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %481 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_263 = tensor.expand_shape %481 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_264 = tensor.extract_slice %expanded_263[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %482 = iree_tensor_ext.bitcast %extracted_slice_264 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_265 = tensor.extract_slice %expanded_263[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %483 = iree_tensor_ext.bitcast %extracted_slice_265 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_266 = tensor.dim %467, %c1 : tensor<4x?x2048xf16>
    %484 = tensor.empty() : tensor<5632x64x32xf16>
    %485 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%482, %483 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%484 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_267 = tensor.expand_shape %467 [[0], [1], [2, 3]] output_shape [4, %dim_266, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %486 = tensor.empty(%dim_266) : tensor<4x?x5632xf32>
    %487 = linalg.fill ins(%cst_3 : f32) outs(%486 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %488 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_267, %485 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%487 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %489 = tensor.empty(%dim_266) : tensor<4x?x5632xf16>
    %490 = linalg.copy ins(%488 : tensor<4x?x5632xf32>) outs(%489 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %491 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%480, %490 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%478 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %492 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_268 = tensor.expand_shape %492 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_269 = tensor.extract_slice %expanded_268[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %493 = iree_tensor_ext.bitcast %extracted_slice_269 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_270 = tensor.extract_slice %expanded_268[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %494 = iree_tensor_ext.bitcast %extracted_slice_270 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_271 = tensor.dim %491, %c1 : tensor<4x?x5632xf16>
    %495 = tensor.empty() : tensor<2048x176x32xf16>
    %496 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%493, %494 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%495 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_272 = tensor.expand_shape %491 [[0], [1], [2, 3]] output_shape [4, %dim_271, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %497 = tensor.empty(%dim_271) : tensor<4x?x2048xf32>
    %498 = linalg.fill ins(%cst_3 : f32) outs(%497 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %499 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_272, %496 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%498 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %500 = tensor.empty(%dim_271) : tensor<4x?x2048xf16>
    %501 = linalg.copy ins(%499 : tensor<4x?x2048xf32>) outs(%500 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %502 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%457, %501 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %503 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%502 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %504 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%503 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %505 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%504 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %506 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%505 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %507 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%506 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %508 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%507 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %509 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%503, %508 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %510 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%509 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %511 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.attn_norm.weight, %510 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %512 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%511 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %513 = iree_tensor_ext.bitcast %__auto.blk.3.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_273 = tensor.expand_shape %513 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_274 = tensor.extract_slice %expanded_273[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %514 = iree_tensor_ext.bitcast %extracted_slice_274 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_275 = tensor.extract_slice %expanded_273[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %515 = iree_tensor_ext.bitcast %extracted_slice_275 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_276 = tensor.dim %512, %c1 : tensor<4x?x2048xf16>
    %516 = tensor.empty() : tensor<2048x64x32xf16>
    %517 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%514, %515 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%516 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_277 = tensor.expand_shape %512 [[0], [1], [2, 3]] output_shape [4, %dim_276, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %518 = tensor.empty(%dim_276) : tensor<4x?x2048xf32>
    %519 = linalg.fill ins(%cst_3 : f32) outs(%518 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %520 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_277, %517 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%519 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %521 = tensor.empty(%dim_276) : tensor<4x?x2048xf16>
    %522 = linalg.copy ins(%520 : tensor<4x?x2048xf32>) outs(%521 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %523 = iree_tensor_ext.bitcast %__auto.blk.3.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_278 = tensor.expand_shape %523 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_279 = tensor.extract_slice %expanded_278[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %524 = iree_tensor_ext.bitcast %extracted_slice_279 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_280 = tensor.extract_slice %expanded_278[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %525 = iree_tensor_ext.bitcast %extracted_slice_280 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_281 = tensor.dim %512, %c1 : tensor<4x?x2048xf16>
    %526 = tensor.empty() : tensor<256x64x32xf16>
    %527 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%524, %525 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%526 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_282 = tensor.expand_shape %512 [[0], [1], [2, 3]] output_shape [4, %dim_281, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %528 = tensor.empty(%dim_281) : tensor<4x?x256xf32>
    %529 = linalg.fill ins(%cst_3 : f32) outs(%528 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %530 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_282, %527 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%529 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %531 = tensor.empty(%dim_281) : tensor<4x?x256xf16>
    %532 = linalg.copy ins(%530 : tensor<4x?x256xf32>) outs(%531 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %533 = iree_tensor_ext.bitcast %__auto.blk.3.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_283 = tensor.expand_shape %533 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_284 = tensor.extract_slice %expanded_283[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %534 = iree_tensor_ext.bitcast %extracted_slice_284 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_285 = tensor.extract_slice %expanded_283[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %535 = iree_tensor_ext.bitcast %extracted_slice_285 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_286 = tensor.dim %512, %c1 : tensor<4x?x2048xf16>
    %536 = tensor.empty() : tensor<256x64x32xf16>
    %537 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%534, %535 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%536 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_287 = tensor.expand_shape %512 [[0], [1], [2, 3]] output_shape [4, %dim_286, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %538 = tensor.empty(%dim_286) : tensor<4x?x256xf32>
    %539 = linalg.fill ins(%cst_3 : f32) outs(%538 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %540 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_287, %537 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%539 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %541 = tensor.empty(%dim_286) : tensor<4x?x256xf16>
    %542 = linalg.copy ins(%540 : tensor<4x?x256xf32>) outs(%541 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_288 = tensor.dim %522, %c1 : tensor<4x?x2048xf16>
    %expanded_289 = tensor.expand_shape %522 [[0], [1], [2, 3]] output_shape [4, %dim_288, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_290 = tensor.dim %532, %c1 : tensor<4x?x256xf16>
    %expanded_291 = tensor.expand_shape %532 [[0], [1], [2, 3]] output_shape [4, %dim_290, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_292 = tensor.dim %542, %c1 : tensor<4x?x256xf16>
    %expanded_293 = tensor.expand_shape %542 [[0], [1], [2, 3]] output_shape [4, %dim_292, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %543 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_294 = tensor.expand_shape %543 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %544 = linalg.batch_matmul ins(%expanded_294, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_295 = linalg.transpose ins(%544 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %545 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_295 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %546 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%545, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %547 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%546 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %548 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_295 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %549 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%548, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %550 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%549 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_296 = tensor.expand_shape %547 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_297 = tensor.expand_shape %550 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_298 = tensor.extract_slice %expanded_289[0, 0, 0, 0] [4, %dim_288, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_299 = tensor.extract_slice %expanded_289[0, 0, 0, 1] [4, %dim_288, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %551 = tensor.empty(%dim_288) : tensor<4x?x32x32xf16>
    %552 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_298, %expanded_296 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%551 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %553 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_299, %expanded_297 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%551 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %554 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%552, %553 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%551 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %555 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_299, %expanded_296 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%551 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %556 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_298, %expanded_297 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%551 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %557 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%555, %556 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%551 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_300 = tensor.dim %554, %c1 : tensor<4x?x32x32xf16>
    %558 = tensor.empty(%dim_300) : tensor<4x?x32x2x32xf16>
    %559 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%554, %557 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%558 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_301 = tensor.collapse_shape %559 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %560 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_302 = tensor.expand_shape %560 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %561 = linalg.batch_matmul ins(%expanded_302, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_303 = linalg.transpose ins(%561 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %562 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_303 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %563 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%562, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %564 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%563 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %565 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_303 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %566 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%565, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %567 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%566 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_304 = tensor.expand_shape %564 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_305 = tensor.expand_shape %567 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_306 = tensor.extract_slice %expanded_291[0, 0, 0, 0] [4, %dim_290, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_307 = tensor.extract_slice %expanded_291[0, 0, 0, 1] [4, %dim_290, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %568 = tensor.empty(%dim_290) : tensor<4x?x4x32xf16>
    %569 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_306, %expanded_304 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%568 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %570 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_307, %expanded_305 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%568 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %571 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%569, %570 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%568 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %572 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_307, %expanded_304 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%568 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %573 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_306, %expanded_305 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%568 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %574 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%572, %573 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%568 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_308 = tensor.dim %571, %c1 : tensor<4x?x4x32xf16>
    %575 = tensor.empty(%dim_308) : tensor<4x?x4x2x32xf16>
    %576 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%571, %574 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%575 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_309 = tensor.collapse_shape %576 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %577 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c3_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %578 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%577 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_310 = tensor.collapse_shape %578 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_311 = tensor.dim %576, %c1 : tensor<4x?x4x2x32xf16>
    %579 = arith.divsi %dim_311, %c32 : index
    %expanded_312 = tensor.expand_shape %collapsed_309 [[0], [1, 2], [3], [4]] output_shape [4, %579, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_313 = tensor.collapse_shape %expanded_312 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %580 = affine.apply #map14()[%579]
    %581 = tensor.empty(%580) : tensor<?x4x32x64xf16>
    %transposed_314 = linalg.transpose ins(%collapsed_313 : tensor<?x32x4x64xf16>) outs(%581 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_315 = tensor.expand_shape %collapsed_310 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %582 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_314, %expanded_315 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%438 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %583 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%578 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_316 = tensor.collapse_shape %583 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %584 = arith.divsi %dim_292, %c32 : index
    %expanded_317 = tensor.expand_shape %542 [[0], [1, 2], [3, 4]] output_shape [4, %584, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_318 = tensor.collapse_shape %expanded_317 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %585 = affine.apply #map14()[%584]
    %586 = tensor.empty(%585) : tensor<?x4x32x64xf16>
    %transposed_319 = linalg.transpose ins(%collapsed_318 : tensor<?x32x4x64xf16>) outs(%586 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_320 = tensor.expand_shape %collapsed_316 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %587 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_319, %expanded_320 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%582 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %588 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_309 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_321 = tensor.collapse_shape %588 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %589 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_293 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_322 = tensor.collapse_shape %589 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_323 = tensor.dim %559, %c1 : tensor<4x?x32x2x32xf16>
    %590 = tensor.empty(%dim_323) : tensor<4x32x?x64xf16>
    %transposed_324 = linalg.transpose ins(%collapsed_301 : tensor<4x?x32x64xf16>) outs(%590 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %591 = tensor.empty(%dim_311) : tensor<4x32x?x64xf16>
    %transposed_325 = linalg.transpose ins(%collapsed_321 : tensor<4x?x32x64xf16>) outs(%591 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %592 = tensor.empty(%dim_292) : tensor<4x32x?x64xf16>
    %transposed_326 = linalg.transpose ins(%collapsed_322 : tensor<4x?x32x64xf16>) outs(%592 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_327 = tensor.collapse_shape %transposed_324 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_328 = tensor.collapse_shape %transposed_325 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_329 = tensor.collapse_shape %transposed_326 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_330 = tensor.dim %transposed_324, %c2 : tensor<4x32x?x64xf16>
    %593 = tensor.empty(%dim_330) : tensor<128x?x64xf16>
    %594 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_327, %collapsed_328, %collapsed_329, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%593 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_331 = tensor.expand_shape %594 [[0, 1], [2], [3]] output_shape [4, 32, %dim_330, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_332 = tensor.dim %expanded_331, %c2 : tensor<4x32x?x64xf16>
    %595 = tensor.empty(%dim_332) : tensor<4x?x32x64xf16>
    %transposed_333 = linalg.transpose ins(%expanded_331 : tensor<4x32x?x64xf16>) outs(%595 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_334 = tensor.collapse_shape %transposed_333 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %596 = iree_tensor_ext.bitcast %__auto.blk.3.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_335 = tensor.expand_shape %596 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_336 = tensor.extract_slice %expanded_335[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %597 = iree_tensor_ext.bitcast %extracted_slice_336 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_337 = tensor.extract_slice %expanded_335[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %598 = iree_tensor_ext.bitcast %extracted_slice_337 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_338 = tensor.dim %collapsed_334, %c1 : tensor<4x?x2048xf16>
    %599 = tensor.empty() : tensor<2048x64x32xf16>
    %600 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%597, %598 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%599 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_339 = tensor.expand_shape %collapsed_334 [[0], [1], [2, 3]] output_shape [4, %dim_338, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %601 = tensor.empty(%dim_338) : tensor<4x?x2048xf32>
    %602 = linalg.fill ins(%cst_3 : f32) outs(%601 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %603 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_339, %600 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%602 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %604 = tensor.empty(%dim_338) : tensor<4x?x2048xf16>
    %605 = linalg.copy ins(%603 : tensor<4x?x2048xf32>) outs(%604 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %606 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%502, %605 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %607 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%606 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %608 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%607 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %609 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%608 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %610 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%609 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %611 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%610 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %612 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%611 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %613 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%607, %612 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %614 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%613 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %615 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.ffn_norm.weight, %614 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %616 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%615 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %617 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_340 = tensor.expand_shape %617 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_341 = tensor.extract_slice %expanded_340[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %618 = iree_tensor_ext.bitcast %extracted_slice_341 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_342 = tensor.extract_slice %expanded_340[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %619 = iree_tensor_ext.bitcast %extracted_slice_342 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_343 = tensor.dim %616, %c1 : tensor<4x?x2048xf16>
    %620 = tensor.empty() : tensor<5632x64x32xf16>
    %621 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%618, %619 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%620 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_344 = tensor.expand_shape %616 [[0], [1], [2, 3]] output_shape [4, %dim_343, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %622 = tensor.empty(%dim_343) : tensor<4x?x5632xf32>
    %623 = linalg.fill ins(%cst_3 : f32) outs(%622 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %624 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_344, %621 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%623 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %625 = tensor.empty(%dim_343) : tensor<4x?x5632xf16>
    %626 = linalg.copy ins(%624 : tensor<4x?x5632xf32>) outs(%625 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_345 = tensor.dim %626, %c1 : tensor<4x?x5632xf16>
    %627 = tensor.empty(%dim_345) : tensor<4x?x5632xf16>
    %628 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%626 : tensor<4x?x5632xf16>) outs(%627 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %629 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%628, %626 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%627 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %630 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_346 = tensor.expand_shape %630 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_347 = tensor.extract_slice %expanded_346[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %631 = iree_tensor_ext.bitcast %extracted_slice_347 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_348 = tensor.extract_slice %expanded_346[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %632 = iree_tensor_ext.bitcast %extracted_slice_348 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_349 = tensor.dim %616, %c1 : tensor<4x?x2048xf16>
    %633 = tensor.empty() : tensor<5632x64x32xf16>
    %634 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%631, %632 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%633 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_350 = tensor.expand_shape %616 [[0], [1], [2, 3]] output_shape [4, %dim_349, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %635 = tensor.empty(%dim_349) : tensor<4x?x5632xf32>
    %636 = linalg.fill ins(%cst_3 : f32) outs(%635 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %637 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_350, %634 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%636 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %638 = tensor.empty(%dim_349) : tensor<4x?x5632xf16>
    %639 = linalg.copy ins(%637 : tensor<4x?x5632xf32>) outs(%638 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %640 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%629, %639 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%627 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %641 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_351 = tensor.expand_shape %641 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_352 = tensor.extract_slice %expanded_351[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %642 = iree_tensor_ext.bitcast %extracted_slice_352 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_353 = tensor.extract_slice %expanded_351[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %643 = iree_tensor_ext.bitcast %extracted_slice_353 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_354 = tensor.dim %640, %c1 : tensor<4x?x5632xf16>
    %644 = tensor.empty() : tensor<2048x176x32xf16>
    %645 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%642, %643 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%644 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_355 = tensor.expand_shape %640 [[0], [1], [2, 3]] output_shape [4, %dim_354, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %646 = tensor.empty(%dim_354) : tensor<4x?x2048xf32>
    %647 = linalg.fill ins(%cst_3 : f32) outs(%646 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %648 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_355, %645 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%647 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %649 = tensor.empty(%dim_354) : tensor<4x?x2048xf16>
    %650 = linalg.copy ins(%648 : tensor<4x?x2048xf32>) outs(%649 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %651 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%606, %650 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %652 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%651 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %653 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%652 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %654 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%653 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %655 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%654 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %656 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%655 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %657 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%656 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %658 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%652, %657 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %659 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%658 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %660 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.attn_norm.weight, %659 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %661 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%660 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %662 = iree_tensor_ext.bitcast %__auto.blk.4.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_356 = tensor.expand_shape %662 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_357 = tensor.extract_slice %expanded_356[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %663 = iree_tensor_ext.bitcast %extracted_slice_357 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_358 = tensor.extract_slice %expanded_356[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %664 = iree_tensor_ext.bitcast %extracted_slice_358 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_359 = tensor.dim %661, %c1 : tensor<4x?x2048xf16>
    %665 = tensor.empty() : tensor<2048x64x32xf16>
    %666 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%663, %664 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%665 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_360 = tensor.expand_shape %661 [[0], [1], [2, 3]] output_shape [4, %dim_359, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %667 = tensor.empty(%dim_359) : tensor<4x?x2048xf32>
    %668 = linalg.fill ins(%cst_3 : f32) outs(%667 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %669 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_360, %666 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%668 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %670 = tensor.empty(%dim_359) : tensor<4x?x2048xf16>
    %671 = linalg.copy ins(%669 : tensor<4x?x2048xf32>) outs(%670 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %672 = iree_tensor_ext.bitcast %__auto.blk.4.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_361 = tensor.expand_shape %672 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_362 = tensor.extract_slice %expanded_361[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %673 = iree_tensor_ext.bitcast %extracted_slice_362 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_363 = tensor.extract_slice %expanded_361[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %674 = iree_tensor_ext.bitcast %extracted_slice_363 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_364 = tensor.dim %661, %c1 : tensor<4x?x2048xf16>
    %675 = tensor.empty() : tensor<256x64x32xf16>
    %676 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%673, %674 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%675 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_365 = tensor.expand_shape %661 [[0], [1], [2, 3]] output_shape [4, %dim_364, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %677 = tensor.empty(%dim_364) : tensor<4x?x256xf32>
    %678 = linalg.fill ins(%cst_3 : f32) outs(%677 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %679 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_365, %676 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%678 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %680 = tensor.empty(%dim_364) : tensor<4x?x256xf16>
    %681 = linalg.copy ins(%679 : tensor<4x?x256xf32>) outs(%680 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %682 = iree_tensor_ext.bitcast %__auto.blk.4.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_366 = tensor.expand_shape %682 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_367 = tensor.extract_slice %expanded_366[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %683 = iree_tensor_ext.bitcast %extracted_slice_367 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_368 = tensor.extract_slice %expanded_366[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %684 = iree_tensor_ext.bitcast %extracted_slice_368 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_369 = tensor.dim %661, %c1 : tensor<4x?x2048xf16>
    %685 = tensor.empty() : tensor<256x64x32xf16>
    %686 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%683, %684 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%685 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_370 = tensor.expand_shape %661 [[0], [1], [2, 3]] output_shape [4, %dim_369, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %687 = tensor.empty(%dim_369) : tensor<4x?x256xf32>
    %688 = linalg.fill ins(%cst_3 : f32) outs(%687 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %689 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_370, %686 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%688 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %690 = tensor.empty(%dim_369) : tensor<4x?x256xf16>
    %691 = linalg.copy ins(%689 : tensor<4x?x256xf32>) outs(%690 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_371 = tensor.dim %671, %c1 : tensor<4x?x2048xf16>
    %expanded_372 = tensor.expand_shape %671 [[0], [1], [2, 3]] output_shape [4, %dim_371, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_373 = tensor.dim %681, %c1 : tensor<4x?x256xf16>
    %expanded_374 = tensor.expand_shape %681 [[0], [1], [2, 3]] output_shape [4, %dim_373, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_375 = tensor.dim %691, %c1 : tensor<4x?x256xf16>
    %expanded_376 = tensor.expand_shape %691 [[0], [1], [2, 3]] output_shape [4, %dim_375, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %692 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_377 = tensor.expand_shape %692 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %693 = linalg.batch_matmul ins(%expanded_377, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_378 = linalg.transpose ins(%693 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %694 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_378 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %695 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%694, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %696 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%695 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %697 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_378 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %698 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%697, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %699 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%698 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_379 = tensor.expand_shape %696 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_380 = tensor.expand_shape %699 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_381 = tensor.extract_slice %expanded_372[0, 0, 0, 0] [4, %dim_371, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_382 = tensor.extract_slice %expanded_372[0, 0, 0, 1] [4, %dim_371, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %700 = tensor.empty(%dim_371) : tensor<4x?x32x32xf16>
    %701 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_381, %expanded_379 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%700 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %702 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_382, %expanded_380 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%700 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %703 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%701, %702 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%700 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %704 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_382, %expanded_379 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%700 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %705 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_381, %expanded_380 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%700 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %706 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%704, %705 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%700 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_383 = tensor.dim %703, %c1 : tensor<4x?x32x32xf16>
    %707 = tensor.empty(%dim_383) : tensor<4x?x32x2x32xf16>
    %708 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%703, %706 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%707 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_384 = tensor.collapse_shape %708 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %709 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_385 = tensor.expand_shape %709 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %710 = linalg.batch_matmul ins(%expanded_385, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_386 = linalg.transpose ins(%710 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %711 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_386 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %712 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%711, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %713 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%712 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %714 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_386 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %715 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%714, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %716 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%715 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_387 = tensor.expand_shape %713 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_388 = tensor.expand_shape %716 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_389 = tensor.extract_slice %expanded_374[0, 0, 0, 0] [4, %dim_373, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_390 = tensor.extract_slice %expanded_374[0, 0, 0, 1] [4, %dim_373, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %717 = tensor.empty(%dim_373) : tensor<4x?x4x32xf16>
    %718 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_389, %expanded_387 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%717 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %719 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_390, %expanded_388 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%717 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %720 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%718, %719 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%717 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %721 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_390, %expanded_387 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%717 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %722 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_389, %expanded_388 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%717 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %723 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%721, %722 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%717 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_391 = tensor.dim %720, %c1 : tensor<4x?x4x32xf16>
    %724 = tensor.empty(%dim_391) : tensor<4x?x4x2x32xf16>
    %725 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%720, %723 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%724 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_392 = tensor.collapse_shape %725 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %726 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c4_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %727 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%726 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_393 = tensor.collapse_shape %727 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_394 = tensor.dim %725, %c1 : tensor<4x?x4x2x32xf16>
    %728 = arith.divsi %dim_394, %c32 : index
    %expanded_395 = tensor.expand_shape %collapsed_392 [[0], [1, 2], [3], [4]] output_shape [4, %728, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_396 = tensor.collapse_shape %expanded_395 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %729 = affine.apply #map14()[%728]
    %730 = tensor.empty(%729) : tensor<?x4x32x64xf16>
    %transposed_397 = linalg.transpose ins(%collapsed_396 : tensor<?x32x4x64xf16>) outs(%730 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_398 = tensor.expand_shape %collapsed_393 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %731 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_397, %expanded_398 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%587 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %732 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%727 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_399 = tensor.collapse_shape %732 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %733 = arith.divsi %dim_375, %c32 : index
    %expanded_400 = tensor.expand_shape %691 [[0], [1, 2], [3, 4]] output_shape [4, %733, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_401 = tensor.collapse_shape %expanded_400 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %734 = affine.apply #map14()[%733]
    %735 = tensor.empty(%734) : tensor<?x4x32x64xf16>
    %transposed_402 = linalg.transpose ins(%collapsed_401 : tensor<?x32x4x64xf16>) outs(%735 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_403 = tensor.expand_shape %collapsed_399 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %736 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_402, %expanded_403 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%731 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %737 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_392 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_404 = tensor.collapse_shape %737 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %738 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_376 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_405 = tensor.collapse_shape %738 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_406 = tensor.dim %708, %c1 : tensor<4x?x32x2x32xf16>
    %739 = tensor.empty(%dim_406) : tensor<4x32x?x64xf16>
    %transposed_407 = linalg.transpose ins(%collapsed_384 : tensor<4x?x32x64xf16>) outs(%739 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %740 = tensor.empty(%dim_394) : tensor<4x32x?x64xf16>
    %transposed_408 = linalg.transpose ins(%collapsed_404 : tensor<4x?x32x64xf16>) outs(%740 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %741 = tensor.empty(%dim_375) : tensor<4x32x?x64xf16>
    %transposed_409 = linalg.transpose ins(%collapsed_405 : tensor<4x?x32x64xf16>) outs(%741 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_410 = tensor.collapse_shape %transposed_407 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_411 = tensor.collapse_shape %transposed_408 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_412 = tensor.collapse_shape %transposed_409 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_413 = tensor.dim %transposed_407, %c2 : tensor<4x32x?x64xf16>
    %742 = tensor.empty(%dim_413) : tensor<128x?x64xf16>
    %743 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_410, %collapsed_411, %collapsed_412, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%742 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_414 = tensor.expand_shape %743 [[0, 1], [2], [3]] output_shape [4, 32, %dim_413, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_415 = tensor.dim %expanded_414, %c2 : tensor<4x32x?x64xf16>
    %744 = tensor.empty(%dim_415) : tensor<4x?x32x64xf16>
    %transposed_416 = linalg.transpose ins(%expanded_414 : tensor<4x32x?x64xf16>) outs(%744 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_417 = tensor.collapse_shape %transposed_416 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %745 = iree_tensor_ext.bitcast %__auto.blk.4.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_418 = tensor.expand_shape %745 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_419 = tensor.extract_slice %expanded_418[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %746 = iree_tensor_ext.bitcast %extracted_slice_419 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_420 = tensor.extract_slice %expanded_418[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %747 = iree_tensor_ext.bitcast %extracted_slice_420 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_421 = tensor.dim %collapsed_417, %c1 : tensor<4x?x2048xf16>
    %748 = tensor.empty() : tensor<2048x64x32xf16>
    %749 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%746, %747 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%748 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_422 = tensor.expand_shape %collapsed_417 [[0], [1], [2, 3]] output_shape [4, %dim_421, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %750 = tensor.empty(%dim_421) : tensor<4x?x2048xf32>
    %751 = linalg.fill ins(%cst_3 : f32) outs(%750 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %752 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_422, %749 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%751 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %753 = tensor.empty(%dim_421) : tensor<4x?x2048xf16>
    %754 = linalg.copy ins(%752 : tensor<4x?x2048xf32>) outs(%753 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %755 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%651, %754 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %756 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%755 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %757 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%756 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %758 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%757 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %759 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%758 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %760 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%759 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %761 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%760 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %762 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%756, %761 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %763 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%762 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %764 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.ffn_norm.weight, %763 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %765 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%764 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %766 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_423 = tensor.expand_shape %766 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_424 = tensor.extract_slice %expanded_423[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %767 = iree_tensor_ext.bitcast %extracted_slice_424 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_425 = tensor.extract_slice %expanded_423[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %768 = iree_tensor_ext.bitcast %extracted_slice_425 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_426 = tensor.dim %765, %c1 : tensor<4x?x2048xf16>
    %769 = tensor.empty() : tensor<5632x64x32xf16>
    %770 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%767, %768 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%769 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_427 = tensor.expand_shape %765 [[0], [1], [2, 3]] output_shape [4, %dim_426, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %771 = tensor.empty(%dim_426) : tensor<4x?x5632xf32>
    %772 = linalg.fill ins(%cst_3 : f32) outs(%771 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %773 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_427, %770 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%772 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %774 = tensor.empty(%dim_426) : tensor<4x?x5632xf16>
    %775 = linalg.copy ins(%773 : tensor<4x?x5632xf32>) outs(%774 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_428 = tensor.dim %775, %c1 : tensor<4x?x5632xf16>
    %776 = tensor.empty(%dim_428) : tensor<4x?x5632xf16>
    %777 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%775 : tensor<4x?x5632xf16>) outs(%776 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %778 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%777, %775 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%776 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %779 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_429 = tensor.expand_shape %779 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_430 = tensor.extract_slice %expanded_429[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %780 = iree_tensor_ext.bitcast %extracted_slice_430 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_431 = tensor.extract_slice %expanded_429[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %781 = iree_tensor_ext.bitcast %extracted_slice_431 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_432 = tensor.dim %765, %c1 : tensor<4x?x2048xf16>
    %782 = tensor.empty() : tensor<5632x64x32xf16>
    %783 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%780, %781 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%782 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_433 = tensor.expand_shape %765 [[0], [1], [2, 3]] output_shape [4, %dim_432, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %784 = tensor.empty(%dim_432) : tensor<4x?x5632xf32>
    %785 = linalg.fill ins(%cst_3 : f32) outs(%784 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %786 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_433, %783 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%785 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %787 = tensor.empty(%dim_432) : tensor<4x?x5632xf16>
    %788 = linalg.copy ins(%786 : tensor<4x?x5632xf32>) outs(%787 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %789 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%778, %788 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%776 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %790 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_434 = tensor.expand_shape %790 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_435 = tensor.extract_slice %expanded_434[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %791 = iree_tensor_ext.bitcast %extracted_slice_435 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_436 = tensor.extract_slice %expanded_434[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %792 = iree_tensor_ext.bitcast %extracted_slice_436 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_437 = tensor.dim %789, %c1 : tensor<4x?x5632xf16>
    %793 = tensor.empty() : tensor<2048x176x32xf16>
    %794 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%791, %792 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%793 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_438 = tensor.expand_shape %789 [[0], [1], [2, 3]] output_shape [4, %dim_437, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %795 = tensor.empty(%dim_437) : tensor<4x?x2048xf32>
    %796 = linalg.fill ins(%cst_3 : f32) outs(%795 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %797 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_438, %794 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%796 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %798 = tensor.empty(%dim_437) : tensor<4x?x2048xf16>
    %799 = linalg.copy ins(%797 : tensor<4x?x2048xf32>) outs(%798 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %800 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%755, %799 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %801 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%800 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %802 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%801 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %803 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%802 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %804 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%803 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %805 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%804 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %806 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%805 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %807 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%801, %806 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %808 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%807 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %809 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.attn_norm.weight, %808 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %810 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%809 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %811 = iree_tensor_ext.bitcast %__auto.blk.5.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_439 = tensor.expand_shape %811 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_440 = tensor.extract_slice %expanded_439[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %812 = iree_tensor_ext.bitcast %extracted_slice_440 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_441 = tensor.extract_slice %expanded_439[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %813 = iree_tensor_ext.bitcast %extracted_slice_441 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_442 = tensor.dim %810, %c1 : tensor<4x?x2048xf16>
    %814 = tensor.empty() : tensor<2048x64x32xf16>
    %815 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%812, %813 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%814 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_443 = tensor.expand_shape %810 [[0], [1], [2, 3]] output_shape [4, %dim_442, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %816 = tensor.empty(%dim_442) : tensor<4x?x2048xf32>
    %817 = linalg.fill ins(%cst_3 : f32) outs(%816 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %818 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_443, %815 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%817 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %819 = tensor.empty(%dim_442) : tensor<4x?x2048xf16>
    %820 = linalg.copy ins(%818 : tensor<4x?x2048xf32>) outs(%819 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %821 = iree_tensor_ext.bitcast %__auto.blk.5.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_444 = tensor.expand_shape %821 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_445 = tensor.extract_slice %expanded_444[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %822 = iree_tensor_ext.bitcast %extracted_slice_445 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_446 = tensor.extract_slice %expanded_444[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %823 = iree_tensor_ext.bitcast %extracted_slice_446 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_447 = tensor.dim %810, %c1 : tensor<4x?x2048xf16>
    %824 = tensor.empty() : tensor<256x64x32xf16>
    %825 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%822, %823 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%824 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_448 = tensor.expand_shape %810 [[0], [1], [2, 3]] output_shape [4, %dim_447, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %826 = tensor.empty(%dim_447) : tensor<4x?x256xf32>
    %827 = linalg.fill ins(%cst_3 : f32) outs(%826 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %828 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_448, %825 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%827 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %829 = tensor.empty(%dim_447) : tensor<4x?x256xf16>
    %830 = linalg.copy ins(%828 : tensor<4x?x256xf32>) outs(%829 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %831 = iree_tensor_ext.bitcast %__auto.blk.5.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_449 = tensor.expand_shape %831 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_450 = tensor.extract_slice %expanded_449[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %832 = iree_tensor_ext.bitcast %extracted_slice_450 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_451 = tensor.extract_slice %expanded_449[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %833 = iree_tensor_ext.bitcast %extracted_slice_451 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_452 = tensor.dim %810, %c1 : tensor<4x?x2048xf16>
    %834 = tensor.empty() : tensor<256x64x32xf16>
    %835 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%832, %833 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%834 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_453 = tensor.expand_shape %810 [[0], [1], [2, 3]] output_shape [4, %dim_452, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %836 = tensor.empty(%dim_452) : tensor<4x?x256xf32>
    %837 = linalg.fill ins(%cst_3 : f32) outs(%836 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %838 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_453, %835 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%837 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %839 = tensor.empty(%dim_452) : tensor<4x?x256xf16>
    %840 = linalg.copy ins(%838 : tensor<4x?x256xf32>) outs(%839 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_454 = tensor.dim %820, %c1 : tensor<4x?x2048xf16>
    %expanded_455 = tensor.expand_shape %820 [[0], [1], [2, 3]] output_shape [4, %dim_454, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_456 = tensor.dim %830, %c1 : tensor<4x?x256xf16>
    %expanded_457 = tensor.expand_shape %830 [[0], [1], [2, 3]] output_shape [4, %dim_456, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_458 = tensor.dim %840, %c1 : tensor<4x?x256xf16>
    %expanded_459 = tensor.expand_shape %840 [[0], [1], [2, 3]] output_shape [4, %dim_458, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %841 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_460 = tensor.expand_shape %841 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %842 = linalg.batch_matmul ins(%expanded_460, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_461 = linalg.transpose ins(%842 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %843 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_461 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %844 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%843, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %845 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%844 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %846 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_461 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %847 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%846, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %848 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%847 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_462 = tensor.expand_shape %845 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_463 = tensor.expand_shape %848 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_464 = tensor.extract_slice %expanded_455[0, 0, 0, 0] [4, %dim_454, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_465 = tensor.extract_slice %expanded_455[0, 0, 0, 1] [4, %dim_454, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %849 = tensor.empty(%dim_454) : tensor<4x?x32x32xf16>
    %850 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_464, %expanded_462 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%849 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %851 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_465, %expanded_463 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%849 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %852 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%850, %851 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%849 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %853 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_465, %expanded_462 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%849 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %854 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_464, %expanded_463 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%849 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %855 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%853, %854 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%849 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_466 = tensor.dim %852, %c1 : tensor<4x?x32x32xf16>
    %856 = tensor.empty(%dim_466) : tensor<4x?x32x2x32xf16>
    %857 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%852, %855 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%856 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_467 = tensor.collapse_shape %857 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %858 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_468 = tensor.expand_shape %858 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %859 = linalg.batch_matmul ins(%expanded_468, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_469 = linalg.transpose ins(%859 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %860 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_469 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %861 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%860, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %862 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%861 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %863 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_469 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %864 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%863, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %865 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%864 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_470 = tensor.expand_shape %862 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_471 = tensor.expand_shape %865 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_472 = tensor.extract_slice %expanded_457[0, 0, 0, 0] [4, %dim_456, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_473 = tensor.extract_slice %expanded_457[0, 0, 0, 1] [4, %dim_456, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %866 = tensor.empty(%dim_456) : tensor<4x?x4x32xf16>
    %867 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_472, %expanded_470 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%866 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %868 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_473, %expanded_471 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%866 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %869 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%867, %868 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%866 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %870 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_473, %expanded_470 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%866 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %871 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_472, %expanded_471 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%866 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %872 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%870, %871 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%866 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_474 = tensor.dim %869, %c1 : tensor<4x?x4x32xf16>
    %873 = tensor.empty(%dim_474) : tensor<4x?x4x2x32xf16>
    %874 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%869, %872 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%873 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_475 = tensor.collapse_shape %874 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %875 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c5_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %876 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%875 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_476 = tensor.collapse_shape %876 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_477 = tensor.dim %874, %c1 : tensor<4x?x4x2x32xf16>
    %877 = arith.divsi %dim_477, %c32 : index
    %expanded_478 = tensor.expand_shape %collapsed_475 [[0], [1, 2], [3], [4]] output_shape [4, %877, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_479 = tensor.collapse_shape %expanded_478 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %878 = affine.apply #map14()[%877]
    %879 = tensor.empty(%878) : tensor<?x4x32x64xf16>
    %transposed_480 = linalg.transpose ins(%collapsed_479 : tensor<?x32x4x64xf16>) outs(%879 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_481 = tensor.expand_shape %collapsed_476 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %880 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_480, %expanded_481 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%736 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %881 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%876 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_482 = tensor.collapse_shape %881 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %882 = arith.divsi %dim_458, %c32 : index
    %expanded_483 = tensor.expand_shape %840 [[0], [1, 2], [3, 4]] output_shape [4, %882, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_484 = tensor.collapse_shape %expanded_483 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %883 = affine.apply #map14()[%882]
    %884 = tensor.empty(%883) : tensor<?x4x32x64xf16>
    %transposed_485 = linalg.transpose ins(%collapsed_484 : tensor<?x32x4x64xf16>) outs(%884 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_486 = tensor.expand_shape %collapsed_482 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %885 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_485, %expanded_486 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%880 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %886 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_475 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_487 = tensor.collapse_shape %886 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %887 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_459 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_488 = tensor.collapse_shape %887 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_489 = tensor.dim %857, %c1 : tensor<4x?x32x2x32xf16>
    %888 = tensor.empty(%dim_489) : tensor<4x32x?x64xf16>
    %transposed_490 = linalg.transpose ins(%collapsed_467 : tensor<4x?x32x64xf16>) outs(%888 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %889 = tensor.empty(%dim_477) : tensor<4x32x?x64xf16>
    %transposed_491 = linalg.transpose ins(%collapsed_487 : tensor<4x?x32x64xf16>) outs(%889 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %890 = tensor.empty(%dim_458) : tensor<4x32x?x64xf16>
    %transposed_492 = linalg.transpose ins(%collapsed_488 : tensor<4x?x32x64xf16>) outs(%890 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_493 = tensor.collapse_shape %transposed_490 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_494 = tensor.collapse_shape %transposed_491 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_495 = tensor.collapse_shape %transposed_492 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_496 = tensor.dim %transposed_490, %c2 : tensor<4x32x?x64xf16>
    %891 = tensor.empty(%dim_496) : tensor<128x?x64xf16>
    %892 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_493, %collapsed_494, %collapsed_495, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%891 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_497 = tensor.expand_shape %892 [[0, 1], [2], [3]] output_shape [4, 32, %dim_496, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_498 = tensor.dim %expanded_497, %c2 : tensor<4x32x?x64xf16>
    %893 = tensor.empty(%dim_498) : tensor<4x?x32x64xf16>
    %transposed_499 = linalg.transpose ins(%expanded_497 : tensor<4x32x?x64xf16>) outs(%893 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_500 = tensor.collapse_shape %transposed_499 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %894 = iree_tensor_ext.bitcast %__auto.blk.5.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_501 = tensor.expand_shape %894 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_502 = tensor.extract_slice %expanded_501[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %895 = iree_tensor_ext.bitcast %extracted_slice_502 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_503 = tensor.extract_slice %expanded_501[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %896 = iree_tensor_ext.bitcast %extracted_slice_503 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_504 = tensor.dim %collapsed_500, %c1 : tensor<4x?x2048xf16>
    %897 = tensor.empty() : tensor<2048x64x32xf16>
    %898 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%895, %896 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%897 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_505 = tensor.expand_shape %collapsed_500 [[0], [1], [2, 3]] output_shape [4, %dim_504, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %899 = tensor.empty(%dim_504) : tensor<4x?x2048xf32>
    %900 = linalg.fill ins(%cst_3 : f32) outs(%899 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %901 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_505, %898 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%900 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %902 = tensor.empty(%dim_504) : tensor<4x?x2048xf16>
    %903 = linalg.copy ins(%901 : tensor<4x?x2048xf32>) outs(%902 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %904 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%800, %903 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %905 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%904 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %906 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%905 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %907 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%906 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %908 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%907 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %909 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%908 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %910 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%909 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %911 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%905, %910 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %912 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%911 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %913 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.ffn_norm.weight, %912 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %914 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%913 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %915 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_506 = tensor.expand_shape %915 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_507 = tensor.extract_slice %expanded_506[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %916 = iree_tensor_ext.bitcast %extracted_slice_507 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_508 = tensor.extract_slice %expanded_506[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %917 = iree_tensor_ext.bitcast %extracted_slice_508 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_509 = tensor.dim %914, %c1 : tensor<4x?x2048xf16>
    %918 = tensor.empty() : tensor<5632x64x32xf16>
    %919 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%916, %917 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%918 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_510 = tensor.expand_shape %914 [[0], [1], [2, 3]] output_shape [4, %dim_509, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %920 = tensor.empty(%dim_509) : tensor<4x?x5632xf32>
    %921 = linalg.fill ins(%cst_3 : f32) outs(%920 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %922 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_510, %919 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%921 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %923 = tensor.empty(%dim_509) : tensor<4x?x5632xf16>
    %924 = linalg.copy ins(%922 : tensor<4x?x5632xf32>) outs(%923 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_511 = tensor.dim %924, %c1 : tensor<4x?x5632xf16>
    %925 = tensor.empty(%dim_511) : tensor<4x?x5632xf16>
    %926 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%924 : tensor<4x?x5632xf16>) outs(%925 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %927 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%926, %924 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%925 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %928 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_512 = tensor.expand_shape %928 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_513 = tensor.extract_slice %expanded_512[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %929 = iree_tensor_ext.bitcast %extracted_slice_513 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_514 = tensor.extract_slice %expanded_512[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %930 = iree_tensor_ext.bitcast %extracted_slice_514 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_515 = tensor.dim %914, %c1 : tensor<4x?x2048xf16>
    %931 = tensor.empty() : tensor<5632x64x32xf16>
    %932 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%929, %930 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%931 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_516 = tensor.expand_shape %914 [[0], [1], [2, 3]] output_shape [4, %dim_515, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %933 = tensor.empty(%dim_515) : tensor<4x?x5632xf32>
    %934 = linalg.fill ins(%cst_3 : f32) outs(%933 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %935 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_516, %932 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%934 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %936 = tensor.empty(%dim_515) : tensor<4x?x5632xf16>
    %937 = linalg.copy ins(%935 : tensor<4x?x5632xf32>) outs(%936 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %938 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%927, %937 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%925 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %939 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_517 = tensor.expand_shape %939 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_518 = tensor.extract_slice %expanded_517[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %940 = iree_tensor_ext.bitcast %extracted_slice_518 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_519 = tensor.extract_slice %expanded_517[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %941 = iree_tensor_ext.bitcast %extracted_slice_519 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_520 = tensor.dim %938, %c1 : tensor<4x?x5632xf16>
    %942 = tensor.empty() : tensor<2048x176x32xf16>
    %943 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%940, %941 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%942 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_521 = tensor.expand_shape %938 [[0], [1], [2, 3]] output_shape [4, %dim_520, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %944 = tensor.empty(%dim_520) : tensor<4x?x2048xf32>
    %945 = linalg.fill ins(%cst_3 : f32) outs(%944 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %946 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_521, %943 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%945 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %947 = tensor.empty(%dim_520) : tensor<4x?x2048xf16>
    %948 = linalg.copy ins(%946 : tensor<4x?x2048xf32>) outs(%947 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %949 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%904, %948 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %950 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%949 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %951 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%950 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %952 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%951 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %953 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%952 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %954 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%953 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %955 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%954 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %956 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%950, %955 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %957 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%956 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %958 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.attn_norm.weight, %957 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %959 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%958 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %960 = iree_tensor_ext.bitcast %__auto.blk.6.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_522 = tensor.expand_shape %960 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_523 = tensor.extract_slice %expanded_522[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %961 = iree_tensor_ext.bitcast %extracted_slice_523 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_524 = tensor.extract_slice %expanded_522[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %962 = iree_tensor_ext.bitcast %extracted_slice_524 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_525 = tensor.dim %959, %c1 : tensor<4x?x2048xf16>
    %963 = tensor.empty() : tensor<2048x64x32xf16>
    %964 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%961, %962 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%963 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_526 = tensor.expand_shape %959 [[0], [1], [2, 3]] output_shape [4, %dim_525, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %965 = tensor.empty(%dim_525) : tensor<4x?x2048xf32>
    %966 = linalg.fill ins(%cst_3 : f32) outs(%965 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %967 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_526, %964 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%966 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %968 = tensor.empty(%dim_525) : tensor<4x?x2048xf16>
    %969 = linalg.copy ins(%967 : tensor<4x?x2048xf32>) outs(%968 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %970 = iree_tensor_ext.bitcast %__auto.blk.6.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_527 = tensor.expand_shape %970 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_528 = tensor.extract_slice %expanded_527[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %971 = iree_tensor_ext.bitcast %extracted_slice_528 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_529 = tensor.extract_slice %expanded_527[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %972 = iree_tensor_ext.bitcast %extracted_slice_529 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_530 = tensor.dim %959, %c1 : tensor<4x?x2048xf16>
    %973 = tensor.empty() : tensor<256x64x32xf16>
    %974 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%971, %972 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%973 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_531 = tensor.expand_shape %959 [[0], [1], [2, 3]] output_shape [4, %dim_530, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %975 = tensor.empty(%dim_530) : tensor<4x?x256xf32>
    %976 = linalg.fill ins(%cst_3 : f32) outs(%975 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %977 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_531, %974 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%976 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %978 = tensor.empty(%dim_530) : tensor<4x?x256xf16>
    %979 = linalg.copy ins(%977 : tensor<4x?x256xf32>) outs(%978 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %980 = iree_tensor_ext.bitcast %__auto.blk.6.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_532 = tensor.expand_shape %980 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_533 = tensor.extract_slice %expanded_532[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %981 = iree_tensor_ext.bitcast %extracted_slice_533 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_534 = tensor.extract_slice %expanded_532[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %982 = iree_tensor_ext.bitcast %extracted_slice_534 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_535 = tensor.dim %959, %c1 : tensor<4x?x2048xf16>
    %983 = tensor.empty() : tensor<256x64x32xf16>
    %984 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%981, %982 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%983 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_536 = tensor.expand_shape %959 [[0], [1], [2, 3]] output_shape [4, %dim_535, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %985 = tensor.empty(%dim_535) : tensor<4x?x256xf32>
    %986 = linalg.fill ins(%cst_3 : f32) outs(%985 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %987 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_536, %984 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%986 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %988 = tensor.empty(%dim_535) : tensor<4x?x256xf16>
    %989 = linalg.copy ins(%987 : tensor<4x?x256xf32>) outs(%988 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_537 = tensor.dim %969, %c1 : tensor<4x?x2048xf16>
    %expanded_538 = tensor.expand_shape %969 [[0], [1], [2, 3]] output_shape [4, %dim_537, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_539 = tensor.dim %979, %c1 : tensor<4x?x256xf16>
    %expanded_540 = tensor.expand_shape %979 [[0], [1], [2, 3]] output_shape [4, %dim_539, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_541 = tensor.dim %989, %c1 : tensor<4x?x256xf16>
    %expanded_542 = tensor.expand_shape %989 [[0], [1], [2, 3]] output_shape [4, %dim_541, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %990 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_543 = tensor.expand_shape %990 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %991 = linalg.batch_matmul ins(%expanded_543, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_544 = linalg.transpose ins(%991 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %992 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_544 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %993 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%992, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %994 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%993 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %995 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_544 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %996 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%995, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %997 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%996 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_545 = tensor.expand_shape %994 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_546 = tensor.expand_shape %997 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_547 = tensor.extract_slice %expanded_538[0, 0, 0, 0] [4, %dim_537, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_548 = tensor.extract_slice %expanded_538[0, 0, 0, 1] [4, %dim_537, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %998 = tensor.empty(%dim_537) : tensor<4x?x32x32xf16>
    %999 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_547, %expanded_545 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%998 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1000 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_548, %expanded_546 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%998 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1001 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%999, %1000 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%998 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1002 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_548, %expanded_545 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%998 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1003 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_547, %expanded_546 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%998 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1004 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1002, %1003 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%998 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_549 = tensor.dim %1001, %c1 : tensor<4x?x32x32xf16>
    %1005 = tensor.empty(%dim_549) : tensor<4x?x32x2x32xf16>
    %1006 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1001, %1004 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1005 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_550 = tensor.collapse_shape %1006 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1007 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_551 = tensor.expand_shape %1007 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1008 = linalg.batch_matmul ins(%expanded_551, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_552 = linalg.transpose ins(%1008 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1009 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_552 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1010 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1009, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1011 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1010 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1012 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_552 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1013 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1012, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1014 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1013 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_553 = tensor.expand_shape %1011 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_554 = tensor.expand_shape %1014 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_555 = tensor.extract_slice %expanded_540[0, 0, 0, 0] [4, %dim_539, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_556 = tensor.extract_slice %expanded_540[0, 0, 0, 1] [4, %dim_539, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1015 = tensor.empty(%dim_539) : tensor<4x?x4x32xf16>
    %1016 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_555, %expanded_553 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1015 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1017 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_556, %expanded_554 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1015 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1018 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1016, %1017 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1015 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1019 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_556, %expanded_553 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1015 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1020 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_555, %expanded_554 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1015 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1021 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1019, %1020 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1015 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_557 = tensor.dim %1018, %c1 : tensor<4x?x4x32xf16>
    %1022 = tensor.empty(%dim_557) : tensor<4x?x4x2x32xf16>
    %1023 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1018, %1021 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1022 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_558 = tensor.collapse_shape %1023 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1024 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c6_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %1025 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1024 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_559 = tensor.collapse_shape %1025 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_560 = tensor.dim %1023, %c1 : tensor<4x?x4x2x32xf16>
    %1026 = arith.divsi %dim_560, %c32 : index
    %expanded_561 = tensor.expand_shape %collapsed_558 [[0], [1, 2], [3], [4]] output_shape [4, %1026, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_562 = tensor.collapse_shape %expanded_561 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1027 = affine.apply #map14()[%1026]
    %1028 = tensor.empty(%1027) : tensor<?x4x32x64xf16>
    %transposed_563 = linalg.transpose ins(%collapsed_562 : tensor<?x32x4x64xf16>) outs(%1028 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_564 = tensor.expand_shape %collapsed_559 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1029 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_563, %expanded_564 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%885 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1030 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1025 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_565 = tensor.collapse_shape %1030 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %1031 = arith.divsi %dim_541, %c32 : index
    %expanded_566 = tensor.expand_shape %989 [[0], [1, 2], [3, 4]] output_shape [4, %1031, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_567 = tensor.collapse_shape %expanded_566 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1032 = affine.apply #map14()[%1031]
    %1033 = tensor.empty(%1032) : tensor<?x4x32x64xf16>
    %transposed_568 = linalg.transpose ins(%collapsed_567 : tensor<?x32x4x64xf16>) outs(%1033 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_569 = tensor.expand_shape %collapsed_565 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1034 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_568, %expanded_569 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1029 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1035 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_558 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_570 = tensor.collapse_shape %1035 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1036 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_542 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_571 = tensor.collapse_shape %1036 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_572 = tensor.dim %1006, %c1 : tensor<4x?x32x2x32xf16>
    %1037 = tensor.empty(%dim_572) : tensor<4x32x?x64xf16>
    %transposed_573 = linalg.transpose ins(%collapsed_550 : tensor<4x?x32x64xf16>) outs(%1037 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1038 = tensor.empty(%dim_560) : tensor<4x32x?x64xf16>
    %transposed_574 = linalg.transpose ins(%collapsed_570 : tensor<4x?x32x64xf16>) outs(%1038 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1039 = tensor.empty(%dim_541) : tensor<4x32x?x64xf16>
    %transposed_575 = linalg.transpose ins(%collapsed_571 : tensor<4x?x32x64xf16>) outs(%1039 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_576 = tensor.collapse_shape %transposed_573 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_577 = tensor.collapse_shape %transposed_574 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_578 = tensor.collapse_shape %transposed_575 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_579 = tensor.dim %transposed_573, %c2 : tensor<4x32x?x64xf16>
    %1040 = tensor.empty(%dim_579) : tensor<128x?x64xf16>
    %1041 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_576, %collapsed_577, %collapsed_578, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%1040 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_580 = tensor.expand_shape %1041 [[0, 1], [2], [3]] output_shape [4, 32, %dim_579, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_581 = tensor.dim %expanded_580, %c2 : tensor<4x32x?x64xf16>
    %1042 = tensor.empty(%dim_581) : tensor<4x?x32x64xf16>
    %transposed_582 = linalg.transpose ins(%expanded_580 : tensor<4x32x?x64xf16>) outs(%1042 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_583 = tensor.collapse_shape %transposed_582 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1043 = iree_tensor_ext.bitcast %__auto.blk.6.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_584 = tensor.expand_shape %1043 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_585 = tensor.extract_slice %expanded_584[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1044 = iree_tensor_ext.bitcast %extracted_slice_585 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_586 = tensor.extract_slice %expanded_584[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1045 = iree_tensor_ext.bitcast %extracted_slice_586 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_587 = tensor.dim %collapsed_583, %c1 : tensor<4x?x2048xf16>
    %1046 = tensor.empty() : tensor<2048x64x32xf16>
    %1047 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1044, %1045 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1046 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_588 = tensor.expand_shape %collapsed_583 [[0], [1], [2, 3]] output_shape [4, %dim_587, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1048 = tensor.empty(%dim_587) : tensor<4x?x2048xf32>
    %1049 = linalg.fill ins(%cst_3 : f32) outs(%1048 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1050 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_588, %1047 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1049 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1051 = tensor.empty(%dim_587) : tensor<4x?x2048xf16>
    %1052 = linalg.copy ins(%1050 : tensor<4x?x2048xf32>) outs(%1051 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1053 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%949, %1052 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1054 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1053 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1055 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1054 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1056 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1055 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1057 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1056 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1058 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1057 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1059 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1058 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1060 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1054, %1059 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1061 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1060 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1062 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.ffn_norm.weight, %1061 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1063 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1062 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1064 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_589 = tensor.expand_shape %1064 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_590 = tensor.extract_slice %expanded_589[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1065 = iree_tensor_ext.bitcast %extracted_slice_590 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_591 = tensor.extract_slice %expanded_589[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1066 = iree_tensor_ext.bitcast %extracted_slice_591 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_592 = tensor.dim %1063, %c1 : tensor<4x?x2048xf16>
    %1067 = tensor.empty() : tensor<5632x64x32xf16>
    %1068 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1065, %1066 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1067 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_593 = tensor.expand_shape %1063 [[0], [1], [2, 3]] output_shape [4, %dim_592, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1069 = tensor.empty(%dim_592) : tensor<4x?x5632xf32>
    %1070 = linalg.fill ins(%cst_3 : f32) outs(%1069 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1071 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_593, %1068 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1070 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1072 = tensor.empty(%dim_592) : tensor<4x?x5632xf16>
    %1073 = linalg.copy ins(%1071 : tensor<4x?x5632xf32>) outs(%1072 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_594 = tensor.dim %1073, %c1 : tensor<4x?x5632xf16>
    %1074 = tensor.empty(%dim_594) : tensor<4x?x5632xf16>
    %1075 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1073 : tensor<4x?x5632xf16>) outs(%1074 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %1076 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1075, %1073 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1074 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1077 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_595 = tensor.expand_shape %1077 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_596 = tensor.extract_slice %expanded_595[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1078 = iree_tensor_ext.bitcast %extracted_slice_596 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_597 = tensor.extract_slice %expanded_595[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1079 = iree_tensor_ext.bitcast %extracted_slice_597 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_598 = tensor.dim %1063, %c1 : tensor<4x?x2048xf16>
    %1080 = tensor.empty() : tensor<5632x64x32xf16>
    %1081 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1078, %1079 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1080 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_599 = tensor.expand_shape %1063 [[0], [1], [2, 3]] output_shape [4, %dim_598, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1082 = tensor.empty(%dim_598) : tensor<4x?x5632xf32>
    %1083 = linalg.fill ins(%cst_3 : f32) outs(%1082 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1084 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_599, %1081 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1083 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1085 = tensor.empty(%dim_598) : tensor<4x?x5632xf16>
    %1086 = linalg.copy ins(%1084 : tensor<4x?x5632xf32>) outs(%1085 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1087 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1076, %1086 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1074 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1088 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_600 = tensor.expand_shape %1088 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_601 = tensor.extract_slice %expanded_600[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1089 = iree_tensor_ext.bitcast %extracted_slice_601 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_602 = tensor.extract_slice %expanded_600[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1090 = iree_tensor_ext.bitcast %extracted_slice_602 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_603 = tensor.dim %1087, %c1 : tensor<4x?x5632xf16>
    %1091 = tensor.empty() : tensor<2048x176x32xf16>
    %1092 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1089, %1090 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1091 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_604 = tensor.expand_shape %1087 [[0], [1], [2, 3]] output_shape [4, %dim_603, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1093 = tensor.empty(%dim_603) : tensor<4x?x2048xf32>
    %1094 = linalg.fill ins(%cst_3 : f32) outs(%1093 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1095 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_604, %1092 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%1094 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1096 = tensor.empty(%dim_603) : tensor<4x?x2048xf16>
    %1097 = linalg.copy ins(%1095 : tensor<4x?x2048xf32>) outs(%1096 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1098 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1053, %1097 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1099 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1098 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1100 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1099 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1101 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1100 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1101 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1103 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1102 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1104 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1103 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1105 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1099, %1104 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1106 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1105 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1107 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.attn_norm.weight, %1106 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1108 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1107 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1109 = iree_tensor_ext.bitcast %__auto.blk.7.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_605 = tensor.expand_shape %1109 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_606 = tensor.extract_slice %expanded_605[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1110 = iree_tensor_ext.bitcast %extracted_slice_606 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_607 = tensor.extract_slice %expanded_605[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1111 = iree_tensor_ext.bitcast %extracted_slice_607 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_608 = tensor.dim %1108, %c1 : tensor<4x?x2048xf16>
    %1112 = tensor.empty() : tensor<2048x64x32xf16>
    %1113 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1110, %1111 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1112 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_609 = tensor.expand_shape %1108 [[0], [1], [2, 3]] output_shape [4, %dim_608, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1114 = tensor.empty(%dim_608) : tensor<4x?x2048xf32>
    %1115 = linalg.fill ins(%cst_3 : f32) outs(%1114 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1116 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_609, %1113 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1115 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1117 = tensor.empty(%dim_608) : tensor<4x?x2048xf16>
    %1118 = linalg.copy ins(%1116 : tensor<4x?x2048xf32>) outs(%1117 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1119 = iree_tensor_ext.bitcast %__auto.blk.7.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_610 = tensor.expand_shape %1119 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_611 = tensor.extract_slice %expanded_610[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1120 = iree_tensor_ext.bitcast %extracted_slice_611 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_612 = tensor.extract_slice %expanded_610[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1121 = iree_tensor_ext.bitcast %extracted_slice_612 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_613 = tensor.dim %1108, %c1 : tensor<4x?x2048xf16>
    %1122 = tensor.empty() : tensor<256x64x32xf16>
    %1123 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1120, %1121 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1122 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_614 = tensor.expand_shape %1108 [[0], [1], [2, 3]] output_shape [4, %dim_613, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1124 = tensor.empty(%dim_613) : tensor<4x?x256xf32>
    %1125 = linalg.fill ins(%cst_3 : f32) outs(%1124 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1126 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_614, %1123 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1125 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1127 = tensor.empty(%dim_613) : tensor<4x?x256xf16>
    %1128 = linalg.copy ins(%1126 : tensor<4x?x256xf32>) outs(%1127 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1129 = iree_tensor_ext.bitcast %__auto.blk.7.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_615 = tensor.expand_shape %1129 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_616 = tensor.extract_slice %expanded_615[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1130 = iree_tensor_ext.bitcast %extracted_slice_616 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_617 = tensor.extract_slice %expanded_615[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1131 = iree_tensor_ext.bitcast %extracted_slice_617 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_618 = tensor.dim %1108, %c1 : tensor<4x?x2048xf16>
    %1132 = tensor.empty() : tensor<256x64x32xf16>
    %1133 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1130, %1131 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1132 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_619 = tensor.expand_shape %1108 [[0], [1], [2, 3]] output_shape [4, %dim_618, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1134 = tensor.empty(%dim_618) : tensor<4x?x256xf32>
    %1135 = linalg.fill ins(%cst_3 : f32) outs(%1134 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1136 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_619, %1133 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1135 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1137 = tensor.empty(%dim_618) : tensor<4x?x256xf16>
    %1138 = linalg.copy ins(%1136 : tensor<4x?x256xf32>) outs(%1137 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_620 = tensor.dim %1118, %c1 : tensor<4x?x2048xf16>
    %expanded_621 = tensor.expand_shape %1118 [[0], [1], [2, 3]] output_shape [4, %dim_620, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_622 = tensor.dim %1128, %c1 : tensor<4x?x256xf16>
    %expanded_623 = tensor.expand_shape %1128 [[0], [1], [2, 3]] output_shape [4, %dim_622, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_624 = tensor.dim %1138, %c1 : tensor<4x?x256xf16>
    %expanded_625 = tensor.expand_shape %1138 [[0], [1], [2, 3]] output_shape [4, %dim_624, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1139 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_626 = tensor.expand_shape %1139 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1140 = linalg.batch_matmul ins(%expanded_626, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_627 = linalg.transpose ins(%1140 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1141 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_627 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1142 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1141, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1143 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1142 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1144 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_627 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1145 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1144, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1146 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1145 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_628 = tensor.expand_shape %1143 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_629 = tensor.expand_shape %1146 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_630 = tensor.extract_slice %expanded_621[0, 0, 0, 0] [4, %dim_620, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_631 = tensor.extract_slice %expanded_621[0, 0, 0, 1] [4, %dim_620, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1147 = tensor.empty(%dim_620) : tensor<4x?x32x32xf16>
    %1148 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_630, %expanded_628 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1147 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1149 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_631, %expanded_629 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1147 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1150 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1148, %1149 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1147 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1151 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_631, %expanded_628 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1147 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1152 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_630, %expanded_629 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1147 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1153 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1151, %1152 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1147 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_632 = tensor.dim %1150, %c1 : tensor<4x?x32x32xf16>
    %1154 = tensor.empty(%dim_632) : tensor<4x?x32x2x32xf16>
    %1155 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1150, %1153 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1154 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_633 = tensor.collapse_shape %1155 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1156 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_634 = tensor.expand_shape %1156 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1157 = linalg.batch_matmul ins(%expanded_634, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_635 = linalg.transpose ins(%1157 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1158 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_635 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1159 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1158, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1160 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1159 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1161 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_635 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1162 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1161, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1163 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1162 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_636 = tensor.expand_shape %1160 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_637 = tensor.expand_shape %1163 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_638 = tensor.extract_slice %expanded_623[0, 0, 0, 0] [4, %dim_622, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_639 = tensor.extract_slice %expanded_623[0, 0, 0, 1] [4, %dim_622, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1164 = tensor.empty(%dim_622) : tensor<4x?x4x32xf16>
    %1165 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_638, %expanded_636 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1164 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1166 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_639, %expanded_637 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1164 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1167 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1165, %1166 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1164 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1168 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_639, %expanded_636 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1164 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1169 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_638, %expanded_637 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1164 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1170 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1168, %1169 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1164 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_640 = tensor.dim %1167, %c1 : tensor<4x?x4x32xf16>
    %1171 = tensor.empty(%dim_640) : tensor<4x?x4x2x32xf16>
    %1172 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1167, %1170 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1171 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_641 = tensor.collapse_shape %1172 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1173 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c7_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %1174 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1173 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_642 = tensor.collapse_shape %1174 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_643 = tensor.dim %1172, %c1 : tensor<4x?x4x2x32xf16>
    %1175 = arith.divsi %dim_643, %c32 : index
    %expanded_644 = tensor.expand_shape %collapsed_641 [[0], [1, 2], [3], [4]] output_shape [4, %1175, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_645 = tensor.collapse_shape %expanded_644 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1176 = affine.apply #map14()[%1175]
    %1177 = tensor.empty(%1176) : tensor<?x4x32x64xf16>
    %transposed_646 = linalg.transpose ins(%collapsed_645 : tensor<?x32x4x64xf16>) outs(%1177 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_647 = tensor.expand_shape %collapsed_642 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1178 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_646, %expanded_647 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1034 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1179 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1174 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_648 = tensor.collapse_shape %1179 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %1180 = arith.divsi %dim_624, %c32 : index
    %expanded_649 = tensor.expand_shape %1138 [[0], [1, 2], [3, 4]] output_shape [4, %1180, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_650 = tensor.collapse_shape %expanded_649 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1181 = affine.apply #map14()[%1180]
    %1182 = tensor.empty(%1181) : tensor<?x4x32x64xf16>
    %transposed_651 = linalg.transpose ins(%collapsed_650 : tensor<?x32x4x64xf16>) outs(%1182 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_652 = tensor.expand_shape %collapsed_648 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1183 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_651, %expanded_652 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1178 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1184 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_641 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_653 = tensor.collapse_shape %1184 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1185 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_625 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_654 = tensor.collapse_shape %1185 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_655 = tensor.dim %1155, %c1 : tensor<4x?x32x2x32xf16>
    %1186 = tensor.empty(%dim_655) : tensor<4x32x?x64xf16>
    %transposed_656 = linalg.transpose ins(%collapsed_633 : tensor<4x?x32x64xf16>) outs(%1186 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1187 = tensor.empty(%dim_643) : tensor<4x32x?x64xf16>
    %transposed_657 = linalg.transpose ins(%collapsed_653 : tensor<4x?x32x64xf16>) outs(%1187 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1188 = tensor.empty(%dim_624) : tensor<4x32x?x64xf16>
    %transposed_658 = linalg.transpose ins(%collapsed_654 : tensor<4x?x32x64xf16>) outs(%1188 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_659 = tensor.collapse_shape %transposed_656 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_660 = tensor.collapse_shape %transposed_657 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_661 = tensor.collapse_shape %transposed_658 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_662 = tensor.dim %transposed_656, %c2 : tensor<4x32x?x64xf16>
    %1189 = tensor.empty(%dim_662) : tensor<128x?x64xf16>
    %1190 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_659, %collapsed_660, %collapsed_661, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%1189 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_663 = tensor.expand_shape %1190 [[0, 1], [2], [3]] output_shape [4, 32, %dim_662, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_664 = tensor.dim %expanded_663, %c2 : tensor<4x32x?x64xf16>
    %1191 = tensor.empty(%dim_664) : tensor<4x?x32x64xf16>
    %transposed_665 = linalg.transpose ins(%expanded_663 : tensor<4x32x?x64xf16>) outs(%1191 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_666 = tensor.collapse_shape %transposed_665 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1192 = iree_tensor_ext.bitcast %__auto.blk.7.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_667 = tensor.expand_shape %1192 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_668 = tensor.extract_slice %expanded_667[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1193 = iree_tensor_ext.bitcast %extracted_slice_668 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_669 = tensor.extract_slice %expanded_667[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1194 = iree_tensor_ext.bitcast %extracted_slice_669 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_670 = tensor.dim %collapsed_666, %c1 : tensor<4x?x2048xf16>
    %1195 = tensor.empty() : tensor<2048x64x32xf16>
    %1196 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1193, %1194 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1195 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_671 = tensor.expand_shape %collapsed_666 [[0], [1], [2, 3]] output_shape [4, %dim_670, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1197 = tensor.empty(%dim_670) : tensor<4x?x2048xf32>
    %1198 = linalg.fill ins(%cst_3 : f32) outs(%1197 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1199 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_671, %1196 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1198 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1200 = tensor.empty(%dim_670) : tensor<4x?x2048xf16>
    %1201 = linalg.copy ins(%1199 : tensor<4x?x2048xf32>) outs(%1200 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1202 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1098, %1201 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1203 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1202 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1204 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1203 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1205 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1204 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1206 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1205 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1207 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1206 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1208 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1207 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1209 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1203, %1208 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1210 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1209 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1211 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.ffn_norm.weight, %1210 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1212 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1211 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1213 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_672 = tensor.expand_shape %1213 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_673 = tensor.extract_slice %expanded_672[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1214 = iree_tensor_ext.bitcast %extracted_slice_673 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_674 = tensor.extract_slice %expanded_672[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1215 = iree_tensor_ext.bitcast %extracted_slice_674 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_675 = tensor.dim %1212, %c1 : tensor<4x?x2048xf16>
    %1216 = tensor.empty() : tensor<5632x64x32xf16>
    %1217 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1214, %1215 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1216 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_676 = tensor.expand_shape %1212 [[0], [1], [2, 3]] output_shape [4, %dim_675, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1218 = tensor.empty(%dim_675) : tensor<4x?x5632xf32>
    %1219 = linalg.fill ins(%cst_3 : f32) outs(%1218 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1220 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_676, %1217 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1219 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1221 = tensor.empty(%dim_675) : tensor<4x?x5632xf16>
    %1222 = linalg.copy ins(%1220 : tensor<4x?x5632xf32>) outs(%1221 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_677 = tensor.dim %1222, %c1 : tensor<4x?x5632xf16>
    %1223 = tensor.empty(%dim_677) : tensor<4x?x5632xf16>
    %1224 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1222 : tensor<4x?x5632xf16>) outs(%1223 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %1225 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1224, %1222 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1223 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1226 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_678 = tensor.expand_shape %1226 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_679 = tensor.extract_slice %expanded_678[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1227 = iree_tensor_ext.bitcast %extracted_slice_679 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_680 = tensor.extract_slice %expanded_678[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1228 = iree_tensor_ext.bitcast %extracted_slice_680 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_681 = tensor.dim %1212, %c1 : tensor<4x?x2048xf16>
    %1229 = tensor.empty() : tensor<5632x64x32xf16>
    %1230 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1227, %1228 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1229 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_682 = tensor.expand_shape %1212 [[0], [1], [2, 3]] output_shape [4, %dim_681, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1231 = tensor.empty(%dim_681) : tensor<4x?x5632xf32>
    %1232 = linalg.fill ins(%cst_3 : f32) outs(%1231 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1233 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_682, %1230 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1232 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1234 = tensor.empty(%dim_681) : tensor<4x?x5632xf16>
    %1235 = linalg.copy ins(%1233 : tensor<4x?x5632xf32>) outs(%1234 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1236 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1225, %1235 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1223 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1237 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_683 = tensor.expand_shape %1237 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_684 = tensor.extract_slice %expanded_683[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1238 = iree_tensor_ext.bitcast %extracted_slice_684 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_685 = tensor.extract_slice %expanded_683[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1239 = iree_tensor_ext.bitcast %extracted_slice_685 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_686 = tensor.dim %1236, %c1 : tensor<4x?x5632xf16>
    %1240 = tensor.empty() : tensor<2048x176x32xf16>
    %1241 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1238, %1239 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1240 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_687 = tensor.expand_shape %1236 [[0], [1], [2, 3]] output_shape [4, %dim_686, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1242 = tensor.empty(%dim_686) : tensor<4x?x2048xf32>
    %1243 = linalg.fill ins(%cst_3 : f32) outs(%1242 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1244 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_687, %1241 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%1243 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1245 = tensor.empty(%dim_686) : tensor<4x?x2048xf16>
    %1246 = linalg.copy ins(%1244 : tensor<4x?x2048xf32>) outs(%1245 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1247 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1202, %1246 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1248 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1247 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1248 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1250 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1249 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1251 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1250 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1251 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1253 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1252 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1254 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1248, %1253 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1255 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1254 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1256 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.attn_norm.weight, %1255 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1256 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1258 = iree_tensor_ext.bitcast %__auto.blk.8.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_688 = tensor.expand_shape %1258 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_689 = tensor.extract_slice %expanded_688[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1259 = iree_tensor_ext.bitcast %extracted_slice_689 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_690 = tensor.extract_slice %expanded_688[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1260 = iree_tensor_ext.bitcast %extracted_slice_690 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_691 = tensor.dim %1257, %c1 : tensor<4x?x2048xf16>
    %1261 = tensor.empty() : tensor<2048x64x32xf16>
    %1262 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1259, %1260 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1261 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_692 = tensor.expand_shape %1257 [[0], [1], [2, 3]] output_shape [4, %dim_691, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1263 = tensor.empty(%dim_691) : tensor<4x?x2048xf32>
    %1264 = linalg.fill ins(%cst_3 : f32) outs(%1263 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1265 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_692, %1262 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1264 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1266 = tensor.empty(%dim_691) : tensor<4x?x2048xf16>
    %1267 = linalg.copy ins(%1265 : tensor<4x?x2048xf32>) outs(%1266 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1268 = iree_tensor_ext.bitcast %__auto.blk.8.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_693 = tensor.expand_shape %1268 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_694 = tensor.extract_slice %expanded_693[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1269 = iree_tensor_ext.bitcast %extracted_slice_694 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_695 = tensor.extract_slice %expanded_693[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1270 = iree_tensor_ext.bitcast %extracted_slice_695 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_696 = tensor.dim %1257, %c1 : tensor<4x?x2048xf16>
    %1271 = tensor.empty() : tensor<256x64x32xf16>
    %1272 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1269, %1270 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1271 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_697 = tensor.expand_shape %1257 [[0], [1], [2, 3]] output_shape [4, %dim_696, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1273 = tensor.empty(%dim_696) : tensor<4x?x256xf32>
    %1274 = linalg.fill ins(%cst_3 : f32) outs(%1273 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1275 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_697, %1272 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1274 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1276 = tensor.empty(%dim_696) : tensor<4x?x256xf16>
    %1277 = linalg.copy ins(%1275 : tensor<4x?x256xf32>) outs(%1276 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1278 = iree_tensor_ext.bitcast %__auto.blk.8.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_698 = tensor.expand_shape %1278 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_699 = tensor.extract_slice %expanded_698[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1279 = iree_tensor_ext.bitcast %extracted_slice_699 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_700 = tensor.extract_slice %expanded_698[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1280 = iree_tensor_ext.bitcast %extracted_slice_700 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_701 = tensor.dim %1257, %c1 : tensor<4x?x2048xf16>
    %1281 = tensor.empty() : tensor<256x64x32xf16>
    %1282 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1279, %1280 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1281 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_702 = tensor.expand_shape %1257 [[0], [1], [2, 3]] output_shape [4, %dim_701, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1283 = tensor.empty(%dim_701) : tensor<4x?x256xf32>
    %1284 = linalg.fill ins(%cst_3 : f32) outs(%1283 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1285 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_702, %1282 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1284 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1286 = tensor.empty(%dim_701) : tensor<4x?x256xf16>
    %1287 = linalg.copy ins(%1285 : tensor<4x?x256xf32>) outs(%1286 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_703 = tensor.dim %1267, %c1 : tensor<4x?x2048xf16>
    %expanded_704 = tensor.expand_shape %1267 [[0], [1], [2, 3]] output_shape [4, %dim_703, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_705 = tensor.dim %1277, %c1 : tensor<4x?x256xf16>
    %expanded_706 = tensor.expand_shape %1277 [[0], [1], [2, 3]] output_shape [4, %dim_705, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_707 = tensor.dim %1287, %c1 : tensor<4x?x256xf16>
    %expanded_708 = tensor.expand_shape %1287 [[0], [1], [2, 3]] output_shape [4, %dim_707, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1288 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_709 = tensor.expand_shape %1288 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1289 = linalg.batch_matmul ins(%expanded_709, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_710 = linalg.transpose ins(%1289 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1290 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_710 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1291 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1290, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1291 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1293 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_710 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1294 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1293, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1295 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1294 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_711 = tensor.expand_shape %1292 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_712 = tensor.expand_shape %1295 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_713 = tensor.extract_slice %expanded_704[0, 0, 0, 0] [4, %dim_703, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_714 = tensor.extract_slice %expanded_704[0, 0, 0, 1] [4, %dim_703, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1296 = tensor.empty(%dim_703) : tensor<4x?x32x32xf16>
    %1297 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_713, %expanded_711 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1296 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1298 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_714, %expanded_712 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1296 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1299 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1297, %1298 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1296 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1300 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_714, %expanded_711 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1296 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1301 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_713, %expanded_712 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1296 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1302 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1300, %1301 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1296 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_715 = tensor.dim %1299, %c1 : tensor<4x?x32x32xf16>
    %1303 = tensor.empty(%dim_715) : tensor<4x?x32x2x32xf16>
    %1304 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1299, %1302 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1303 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_716 = tensor.collapse_shape %1304 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1305 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_717 = tensor.expand_shape %1305 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1306 = linalg.batch_matmul ins(%expanded_717, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_718 = linalg.transpose ins(%1306 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1307 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_718 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1308 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1307, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1309 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1308 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1310 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_718 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1311 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1310, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1312 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1311 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_719 = tensor.expand_shape %1309 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_720 = tensor.expand_shape %1312 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_721 = tensor.extract_slice %expanded_706[0, 0, 0, 0] [4, %dim_705, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_722 = tensor.extract_slice %expanded_706[0, 0, 0, 1] [4, %dim_705, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1313 = tensor.empty(%dim_705) : tensor<4x?x4x32xf16>
    %1314 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_721, %expanded_719 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1313 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1315 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_722, %expanded_720 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1313 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1316 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1314, %1315 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1313 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1317 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_722, %expanded_719 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1313 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1318 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_721, %expanded_720 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1313 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1319 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1317, %1318 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1313 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_723 = tensor.dim %1316, %c1 : tensor<4x?x4x32xf16>
    %1320 = tensor.empty(%dim_723) : tensor<4x?x4x2x32xf16>
    %1321 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1316, %1319 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1320 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_724 = tensor.collapse_shape %1321 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1322 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c8_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %1323 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1322 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_725 = tensor.collapse_shape %1323 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_726 = tensor.dim %1321, %c1 : tensor<4x?x4x2x32xf16>
    %1324 = arith.divsi %dim_726, %c32 : index
    %expanded_727 = tensor.expand_shape %collapsed_724 [[0], [1, 2], [3], [4]] output_shape [4, %1324, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_728 = tensor.collapse_shape %expanded_727 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1325 = affine.apply #map14()[%1324]
    %1326 = tensor.empty(%1325) : tensor<?x4x32x64xf16>
    %transposed_729 = linalg.transpose ins(%collapsed_728 : tensor<?x32x4x64xf16>) outs(%1326 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_730 = tensor.expand_shape %collapsed_725 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1327 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_729, %expanded_730 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1183 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1328 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1323 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_731 = tensor.collapse_shape %1328 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %1329 = arith.divsi %dim_707, %c32 : index
    %expanded_732 = tensor.expand_shape %1287 [[0], [1, 2], [3, 4]] output_shape [4, %1329, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_733 = tensor.collapse_shape %expanded_732 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1330 = affine.apply #map14()[%1329]
    %1331 = tensor.empty(%1330) : tensor<?x4x32x64xf16>
    %transposed_734 = linalg.transpose ins(%collapsed_733 : tensor<?x32x4x64xf16>) outs(%1331 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_735 = tensor.expand_shape %collapsed_731 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1332 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_734, %expanded_735 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1327 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1333 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_724 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_736 = tensor.collapse_shape %1333 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1334 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_708 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_737 = tensor.collapse_shape %1334 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_738 = tensor.dim %1304, %c1 : tensor<4x?x32x2x32xf16>
    %1335 = tensor.empty(%dim_738) : tensor<4x32x?x64xf16>
    %transposed_739 = linalg.transpose ins(%collapsed_716 : tensor<4x?x32x64xf16>) outs(%1335 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1336 = tensor.empty(%dim_726) : tensor<4x32x?x64xf16>
    %transposed_740 = linalg.transpose ins(%collapsed_736 : tensor<4x?x32x64xf16>) outs(%1336 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1337 = tensor.empty(%dim_707) : tensor<4x32x?x64xf16>
    %transposed_741 = linalg.transpose ins(%collapsed_737 : tensor<4x?x32x64xf16>) outs(%1337 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_742 = tensor.collapse_shape %transposed_739 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_743 = tensor.collapse_shape %transposed_740 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_744 = tensor.collapse_shape %transposed_741 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_745 = tensor.dim %transposed_739, %c2 : tensor<4x32x?x64xf16>
    %1338 = tensor.empty(%dim_745) : tensor<128x?x64xf16>
    %1339 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_742, %collapsed_743, %collapsed_744, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%1338 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_746 = tensor.expand_shape %1339 [[0, 1], [2], [3]] output_shape [4, 32, %dim_745, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_747 = tensor.dim %expanded_746, %c2 : tensor<4x32x?x64xf16>
    %1340 = tensor.empty(%dim_747) : tensor<4x?x32x64xf16>
    %transposed_748 = linalg.transpose ins(%expanded_746 : tensor<4x32x?x64xf16>) outs(%1340 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_749 = tensor.collapse_shape %transposed_748 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1341 = iree_tensor_ext.bitcast %__auto.blk.8.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_750 = tensor.expand_shape %1341 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_751 = tensor.extract_slice %expanded_750[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1342 = iree_tensor_ext.bitcast %extracted_slice_751 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_752 = tensor.extract_slice %expanded_750[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1343 = iree_tensor_ext.bitcast %extracted_slice_752 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_753 = tensor.dim %collapsed_749, %c1 : tensor<4x?x2048xf16>
    %1344 = tensor.empty() : tensor<2048x64x32xf16>
    %1345 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1342, %1343 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1344 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_754 = tensor.expand_shape %collapsed_749 [[0], [1], [2, 3]] output_shape [4, %dim_753, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1346 = tensor.empty(%dim_753) : tensor<4x?x2048xf32>
    %1347 = linalg.fill ins(%cst_3 : f32) outs(%1346 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1348 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_754, %1345 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1347 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1349 = tensor.empty(%dim_753) : tensor<4x?x2048xf16>
    %1350 = linalg.copy ins(%1348 : tensor<4x?x2048xf32>) outs(%1349 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1351 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1247, %1350 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1352 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1351 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1353 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1352 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1354 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1353 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1355 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1354 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1356 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1355 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1357 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1356 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1358 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1352, %1357 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1359 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1358 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1360 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.ffn_norm.weight, %1359 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1361 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1360 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1362 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_755 = tensor.expand_shape %1362 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_756 = tensor.extract_slice %expanded_755[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1363 = iree_tensor_ext.bitcast %extracted_slice_756 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_757 = tensor.extract_slice %expanded_755[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1364 = iree_tensor_ext.bitcast %extracted_slice_757 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_758 = tensor.dim %1361, %c1 : tensor<4x?x2048xf16>
    %1365 = tensor.empty() : tensor<5632x64x32xf16>
    %1366 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1363, %1364 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1365 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_759 = tensor.expand_shape %1361 [[0], [1], [2, 3]] output_shape [4, %dim_758, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1367 = tensor.empty(%dim_758) : tensor<4x?x5632xf32>
    %1368 = linalg.fill ins(%cst_3 : f32) outs(%1367 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1369 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_759, %1366 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1368 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1370 = tensor.empty(%dim_758) : tensor<4x?x5632xf16>
    %1371 = linalg.copy ins(%1369 : tensor<4x?x5632xf32>) outs(%1370 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_760 = tensor.dim %1371, %c1 : tensor<4x?x5632xf16>
    %1372 = tensor.empty(%dim_760) : tensor<4x?x5632xf16>
    %1373 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1371 : tensor<4x?x5632xf16>) outs(%1372 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %1374 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1373, %1371 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1372 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1375 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_761 = tensor.expand_shape %1375 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_762 = tensor.extract_slice %expanded_761[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1376 = iree_tensor_ext.bitcast %extracted_slice_762 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_763 = tensor.extract_slice %expanded_761[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1377 = iree_tensor_ext.bitcast %extracted_slice_763 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_764 = tensor.dim %1361, %c1 : tensor<4x?x2048xf16>
    %1378 = tensor.empty() : tensor<5632x64x32xf16>
    %1379 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1376, %1377 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1378 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_765 = tensor.expand_shape %1361 [[0], [1], [2, 3]] output_shape [4, %dim_764, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1380 = tensor.empty(%dim_764) : tensor<4x?x5632xf32>
    %1381 = linalg.fill ins(%cst_3 : f32) outs(%1380 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1382 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_765, %1379 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1381 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1383 = tensor.empty(%dim_764) : tensor<4x?x5632xf16>
    %1384 = linalg.copy ins(%1382 : tensor<4x?x5632xf32>) outs(%1383 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1385 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1374, %1384 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1372 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1386 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_766 = tensor.expand_shape %1386 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_767 = tensor.extract_slice %expanded_766[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1387 = iree_tensor_ext.bitcast %extracted_slice_767 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_768 = tensor.extract_slice %expanded_766[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1388 = iree_tensor_ext.bitcast %extracted_slice_768 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_769 = tensor.dim %1385, %c1 : tensor<4x?x5632xf16>
    %1389 = tensor.empty() : tensor<2048x176x32xf16>
    %1390 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1387, %1388 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1389 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_770 = tensor.expand_shape %1385 [[0], [1], [2, 3]] output_shape [4, %dim_769, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1391 = tensor.empty(%dim_769) : tensor<4x?x2048xf32>
    %1392 = linalg.fill ins(%cst_3 : f32) outs(%1391 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1393 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_770, %1390 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%1392 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1394 = tensor.empty(%dim_769) : tensor<4x?x2048xf16>
    %1395 = linalg.copy ins(%1393 : tensor<4x?x2048xf32>) outs(%1394 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1396 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1351, %1395 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1397 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1396 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1398 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1397 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1399 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1398 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1400 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1399 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1401 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1400 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1402 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1401 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1403 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1397, %1402 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1404 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1403 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1405 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.attn_norm.weight, %1404 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1406 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1405 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1407 = iree_tensor_ext.bitcast %__auto.blk.9.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_771 = tensor.expand_shape %1407 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_772 = tensor.extract_slice %expanded_771[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1408 = iree_tensor_ext.bitcast %extracted_slice_772 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_773 = tensor.extract_slice %expanded_771[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1409 = iree_tensor_ext.bitcast %extracted_slice_773 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_774 = tensor.dim %1406, %c1 : tensor<4x?x2048xf16>
    %1410 = tensor.empty() : tensor<2048x64x32xf16>
    %1411 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1408, %1409 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1410 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_775 = tensor.expand_shape %1406 [[0], [1], [2, 3]] output_shape [4, %dim_774, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1412 = tensor.empty(%dim_774) : tensor<4x?x2048xf32>
    %1413 = linalg.fill ins(%cst_3 : f32) outs(%1412 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1414 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_775, %1411 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1413 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1415 = tensor.empty(%dim_774) : tensor<4x?x2048xf16>
    %1416 = linalg.copy ins(%1414 : tensor<4x?x2048xf32>) outs(%1415 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1417 = iree_tensor_ext.bitcast %__auto.blk.9.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_776 = tensor.expand_shape %1417 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_777 = tensor.extract_slice %expanded_776[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1418 = iree_tensor_ext.bitcast %extracted_slice_777 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_778 = tensor.extract_slice %expanded_776[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1419 = iree_tensor_ext.bitcast %extracted_slice_778 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_779 = tensor.dim %1406, %c1 : tensor<4x?x2048xf16>
    %1420 = tensor.empty() : tensor<256x64x32xf16>
    %1421 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1418, %1419 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1420 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_780 = tensor.expand_shape %1406 [[0], [1], [2, 3]] output_shape [4, %dim_779, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1422 = tensor.empty(%dim_779) : tensor<4x?x256xf32>
    %1423 = linalg.fill ins(%cst_3 : f32) outs(%1422 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1424 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_780, %1421 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1423 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1425 = tensor.empty(%dim_779) : tensor<4x?x256xf16>
    %1426 = linalg.copy ins(%1424 : tensor<4x?x256xf32>) outs(%1425 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1427 = iree_tensor_ext.bitcast %__auto.blk.9.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_781 = tensor.expand_shape %1427 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_782 = tensor.extract_slice %expanded_781[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1428 = iree_tensor_ext.bitcast %extracted_slice_782 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_783 = tensor.extract_slice %expanded_781[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1429 = iree_tensor_ext.bitcast %extracted_slice_783 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_784 = tensor.dim %1406, %c1 : tensor<4x?x2048xf16>
    %1430 = tensor.empty() : tensor<256x64x32xf16>
    %1431 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1428, %1429 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1430 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_785 = tensor.expand_shape %1406 [[0], [1], [2, 3]] output_shape [4, %dim_784, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1432 = tensor.empty(%dim_784) : tensor<4x?x256xf32>
    %1433 = linalg.fill ins(%cst_3 : f32) outs(%1432 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1434 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_785, %1431 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1433 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1435 = tensor.empty(%dim_784) : tensor<4x?x256xf16>
    %1436 = linalg.copy ins(%1434 : tensor<4x?x256xf32>) outs(%1435 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_786 = tensor.dim %1416, %c1 : tensor<4x?x2048xf16>
    %expanded_787 = tensor.expand_shape %1416 [[0], [1], [2, 3]] output_shape [4, %dim_786, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_788 = tensor.dim %1426, %c1 : tensor<4x?x256xf16>
    %expanded_789 = tensor.expand_shape %1426 [[0], [1], [2, 3]] output_shape [4, %dim_788, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_790 = tensor.dim %1436, %c1 : tensor<4x?x256xf16>
    %expanded_791 = tensor.expand_shape %1436 [[0], [1], [2, 3]] output_shape [4, %dim_790, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1437 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_792 = tensor.expand_shape %1437 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1438 = linalg.batch_matmul ins(%expanded_792, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_793 = linalg.transpose ins(%1438 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1439 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_793 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1440 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1439, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1441 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1440 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1442 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_793 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1443 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1442, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1444 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1443 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_794 = tensor.expand_shape %1441 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_795 = tensor.expand_shape %1444 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_796 = tensor.extract_slice %expanded_787[0, 0, 0, 0] [4, %dim_786, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_797 = tensor.extract_slice %expanded_787[0, 0, 0, 1] [4, %dim_786, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1445 = tensor.empty(%dim_786) : tensor<4x?x32x32xf16>
    %1446 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_796, %expanded_794 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1445 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1447 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_797, %expanded_795 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1445 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1448 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1446, %1447 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1445 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1449 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_797, %expanded_794 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1445 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1450 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_796, %expanded_795 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1445 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1451 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1449, %1450 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1445 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_798 = tensor.dim %1448, %c1 : tensor<4x?x32x32xf16>
    %1452 = tensor.empty(%dim_798) : tensor<4x?x32x2x32xf16>
    %1453 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1448, %1451 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1452 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_799 = tensor.collapse_shape %1453 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1454 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_800 = tensor.expand_shape %1454 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1455 = linalg.batch_matmul ins(%expanded_800, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_801 = linalg.transpose ins(%1455 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1456 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_801 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1457 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1456, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1458 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1457 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1459 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_801 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1460 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1459, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1461 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1460 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_802 = tensor.expand_shape %1458 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_803 = tensor.expand_shape %1461 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_804 = tensor.extract_slice %expanded_789[0, 0, 0, 0] [4, %dim_788, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_805 = tensor.extract_slice %expanded_789[0, 0, 0, 1] [4, %dim_788, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1462 = tensor.empty(%dim_788) : tensor<4x?x4x32xf16>
    %1463 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_804, %expanded_802 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1462 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1464 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_805, %expanded_803 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1462 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1465 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1463, %1464 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1462 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1466 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_805, %expanded_802 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1462 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1467 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_804, %expanded_803 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1462 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1468 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1466, %1467 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1462 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_806 = tensor.dim %1465, %c1 : tensor<4x?x4x32xf16>
    %1469 = tensor.empty(%dim_806) : tensor<4x?x4x2x32xf16>
    %1470 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1465, %1468 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1469 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_807 = tensor.collapse_shape %1470 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1471 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c9_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %1472 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1471 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_808 = tensor.collapse_shape %1472 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_809 = tensor.dim %1470, %c1 : tensor<4x?x4x2x32xf16>
    %1473 = arith.divsi %dim_809, %c32 : index
    %expanded_810 = tensor.expand_shape %collapsed_807 [[0], [1, 2], [3], [4]] output_shape [4, %1473, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_811 = tensor.collapse_shape %expanded_810 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1474 = affine.apply #map14()[%1473]
    %1475 = tensor.empty(%1474) : tensor<?x4x32x64xf16>
    %transposed_812 = linalg.transpose ins(%collapsed_811 : tensor<?x32x4x64xf16>) outs(%1475 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_813 = tensor.expand_shape %collapsed_808 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1476 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_812, %expanded_813 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1332 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1477 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1472 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_814 = tensor.collapse_shape %1477 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %1478 = arith.divsi %dim_790, %c32 : index
    %expanded_815 = tensor.expand_shape %1436 [[0], [1, 2], [3, 4]] output_shape [4, %1478, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_816 = tensor.collapse_shape %expanded_815 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1479 = affine.apply #map14()[%1478]
    %1480 = tensor.empty(%1479) : tensor<?x4x32x64xf16>
    %transposed_817 = linalg.transpose ins(%collapsed_816 : tensor<?x32x4x64xf16>) outs(%1480 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_818 = tensor.expand_shape %collapsed_814 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1481 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_817, %expanded_818 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1476 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1482 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_807 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_819 = tensor.collapse_shape %1482 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1483 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_791 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_820 = tensor.collapse_shape %1483 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_821 = tensor.dim %1453, %c1 : tensor<4x?x32x2x32xf16>
    %1484 = tensor.empty(%dim_821) : tensor<4x32x?x64xf16>
    %transposed_822 = linalg.transpose ins(%collapsed_799 : tensor<4x?x32x64xf16>) outs(%1484 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1485 = tensor.empty(%dim_809) : tensor<4x32x?x64xf16>
    %transposed_823 = linalg.transpose ins(%collapsed_819 : tensor<4x?x32x64xf16>) outs(%1485 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1486 = tensor.empty(%dim_790) : tensor<4x32x?x64xf16>
    %transposed_824 = linalg.transpose ins(%collapsed_820 : tensor<4x?x32x64xf16>) outs(%1486 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_825 = tensor.collapse_shape %transposed_822 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_826 = tensor.collapse_shape %transposed_823 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_827 = tensor.collapse_shape %transposed_824 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_828 = tensor.dim %transposed_822, %c2 : tensor<4x32x?x64xf16>
    %1487 = tensor.empty(%dim_828) : tensor<128x?x64xf16>
    %1488 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_825, %collapsed_826, %collapsed_827, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%1487 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_829 = tensor.expand_shape %1488 [[0, 1], [2], [3]] output_shape [4, 32, %dim_828, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_830 = tensor.dim %expanded_829, %c2 : tensor<4x32x?x64xf16>
    %1489 = tensor.empty(%dim_830) : tensor<4x?x32x64xf16>
    %transposed_831 = linalg.transpose ins(%expanded_829 : tensor<4x32x?x64xf16>) outs(%1489 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_832 = tensor.collapse_shape %transposed_831 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1490 = iree_tensor_ext.bitcast %__auto.blk.9.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_833 = tensor.expand_shape %1490 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_834 = tensor.extract_slice %expanded_833[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1491 = iree_tensor_ext.bitcast %extracted_slice_834 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_835 = tensor.extract_slice %expanded_833[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1492 = iree_tensor_ext.bitcast %extracted_slice_835 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_836 = tensor.dim %collapsed_832, %c1 : tensor<4x?x2048xf16>
    %1493 = tensor.empty() : tensor<2048x64x32xf16>
    %1494 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1491, %1492 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1493 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_837 = tensor.expand_shape %collapsed_832 [[0], [1], [2, 3]] output_shape [4, %dim_836, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1495 = tensor.empty(%dim_836) : tensor<4x?x2048xf32>
    %1496 = linalg.fill ins(%cst_3 : f32) outs(%1495 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1497 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_837, %1494 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1496 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1498 = tensor.empty(%dim_836) : tensor<4x?x2048xf16>
    %1499 = linalg.copy ins(%1497 : tensor<4x?x2048xf32>) outs(%1498 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1500 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1396, %1499 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1501 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1500 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1502 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1501 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1503 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1502 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1504 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1503 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1505 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1504 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1506 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1505 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1507 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1501, %1506 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1508 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1507 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1509 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.ffn_norm.weight, %1508 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1510 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1509 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1511 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_838 = tensor.expand_shape %1511 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_839 = tensor.extract_slice %expanded_838[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1512 = iree_tensor_ext.bitcast %extracted_slice_839 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_840 = tensor.extract_slice %expanded_838[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1513 = iree_tensor_ext.bitcast %extracted_slice_840 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_841 = tensor.dim %1510, %c1 : tensor<4x?x2048xf16>
    %1514 = tensor.empty() : tensor<5632x64x32xf16>
    %1515 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1512, %1513 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1514 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_842 = tensor.expand_shape %1510 [[0], [1], [2, 3]] output_shape [4, %dim_841, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1516 = tensor.empty(%dim_841) : tensor<4x?x5632xf32>
    %1517 = linalg.fill ins(%cst_3 : f32) outs(%1516 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1518 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_842, %1515 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1517 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1519 = tensor.empty(%dim_841) : tensor<4x?x5632xf16>
    %1520 = linalg.copy ins(%1518 : tensor<4x?x5632xf32>) outs(%1519 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_843 = tensor.dim %1520, %c1 : tensor<4x?x5632xf16>
    %1521 = tensor.empty(%dim_843) : tensor<4x?x5632xf16>
    %1522 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1520 : tensor<4x?x5632xf16>) outs(%1521 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %1523 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1522, %1520 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1521 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1524 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_844 = tensor.expand_shape %1524 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_845 = tensor.extract_slice %expanded_844[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1525 = iree_tensor_ext.bitcast %extracted_slice_845 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_846 = tensor.extract_slice %expanded_844[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1526 = iree_tensor_ext.bitcast %extracted_slice_846 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_847 = tensor.dim %1510, %c1 : tensor<4x?x2048xf16>
    %1527 = tensor.empty() : tensor<5632x64x32xf16>
    %1528 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1525, %1526 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1527 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_848 = tensor.expand_shape %1510 [[0], [1], [2, 3]] output_shape [4, %dim_847, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1529 = tensor.empty(%dim_847) : tensor<4x?x5632xf32>
    %1530 = linalg.fill ins(%cst_3 : f32) outs(%1529 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1531 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_848, %1528 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1530 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1532 = tensor.empty(%dim_847) : tensor<4x?x5632xf16>
    %1533 = linalg.copy ins(%1531 : tensor<4x?x5632xf32>) outs(%1532 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1534 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1523, %1533 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1521 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1535 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_849 = tensor.expand_shape %1535 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_850 = tensor.extract_slice %expanded_849[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1536 = iree_tensor_ext.bitcast %extracted_slice_850 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_851 = tensor.extract_slice %expanded_849[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1537 = iree_tensor_ext.bitcast %extracted_slice_851 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_852 = tensor.dim %1534, %c1 : tensor<4x?x5632xf16>
    %1538 = tensor.empty() : tensor<2048x176x32xf16>
    %1539 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1536, %1537 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1538 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_853 = tensor.expand_shape %1534 [[0], [1], [2, 3]] output_shape [4, %dim_852, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1540 = tensor.empty(%dim_852) : tensor<4x?x2048xf32>
    %1541 = linalg.fill ins(%cst_3 : f32) outs(%1540 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1542 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_853, %1539 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%1541 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1543 = tensor.empty(%dim_852) : tensor<4x?x2048xf16>
    %1544 = linalg.copy ins(%1542 : tensor<4x?x2048xf32>) outs(%1543 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1545 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1500, %1544 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1546 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1545 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1547 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1546 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1548 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1547 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1549 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1548 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1550 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1549 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1551 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1550 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1552 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1546, %1551 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1553 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1552 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1554 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.attn_norm.weight, %1553 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1555 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1554 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1556 = iree_tensor_ext.bitcast %__auto.blk.10.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_854 = tensor.expand_shape %1556 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_855 = tensor.extract_slice %expanded_854[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1557 = iree_tensor_ext.bitcast %extracted_slice_855 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_856 = tensor.extract_slice %expanded_854[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1558 = iree_tensor_ext.bitcast %extracted_slice_856 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_857 = tensor.dim %1555, %c1 : tensor<4x?x2048xf16>
    %1559 = tensor.empty() : tensor<2048x64x32xf16>
    %1560 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1557, %1558 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1559 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_858 = tensor.expand_shape %1555 [[0], [1], [2, 3]] output_shape [4, %dim_857, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1561 = tensor.empty(%dim_857) : tensor<4x?x2048xf32>
    %1562 = linalg.fill ins(%cst_3 : f32) outs(%1561 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1563 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_858, %1560 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1562 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1564 = tensor.empty(%dim_857) : tensor<4x?x2048xf16>
    %1565 = linalg.copy ins(%1563 : tensor<4x?x2048xf32>) outs(%1564 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1566 = iree_tensor_ext.bitcast %__auto.blk.10.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_859 = tensor.expand_shape %1566 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_860 = tensor.extract_slice %expanded_859[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1567 = iree_tensor_ext.bitcast %extracted_slice_860 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_861 = tensor.extract_slice %expanded_859[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1568 = iree_tensor_ext.bitcast %extracted_slice_861 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_862 = tensor.dim %1555, %c1 : tensor<4x?x2048xf16>
    %1569 = tensor.empty() : tensor<256x64x32xf16>
    %1570 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1567, %1568 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1569 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_863 = tensor.expand_shape %1555 [[0], [1], [2, 3]] output_shape [4, %dim_862, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1571 = tensor.empty(%dim_862) : tensor<4x?x256xf32>
    %1572 = linalg.fill ins(%cst_3 : f32) outs(%1571 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1573 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_863, %1570 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1572 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1574 = tensor.empty(%dim_862) : tensor<4x?x256xf16>
    %1575 = linalg.copy ins(%1573 : tensor<4x?x256xf32>) outs(%1574 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1576 = iree_tensor_ext.bitcast %__auto.blk.10.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_864 = tensor.expand_shape %1576 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_865 = tensor.extract_slice %expanded_864[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1577 = iree_tensor_ext.bitcast %extracted_slice_865 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_866 = tensor.extract_slice %expanded_864[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1578 = iree_tensor_ext.bitcast %extracted_slice_866 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_867 = tensor.dim %1555, %c1 : tensor<4x?x2048xf16>
    %1579 = tensor.empty() : tensor<256x64x32xf16>
    %1580 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1577, %1578 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1579 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_868 = tensor.expand_shape %1555 [[0], [1], [2, 3]] output_shape [4, %dim_867, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1581 = tensor.empty(%dim_867) : tensor<4x?x256xf32>
    %1582 = linalg.fill ins(%cst_3 : f32) outs(%1581 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1583 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_868, %1580 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1582 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1584 = tensor.empty(%dim_867) : tensor<4x?x256xf16>
    %1585 = linalg.copy ins(%1583 : tensor<4x?x256xf32>) outs(%1584 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_869 = tensor.dim %1565, %c1 : tensor<4x?x2048xf16>
    %expanded_870 = tensor.expand_shape %1565 [[0], [1], [2, 3]] output_shape [4, %dim_869, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_871 = tensor.dim %1575, %c1 : tensor<4x?x256xf16>
    %expanded_872 = tensor.expand_shape %1575 [[0], [1], [2, 3]] output_shape [4, %dim_871, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_873 = tensor.dim %1585, %c1 : tensor<4x?x256xf16>
    %expanded_874 = tensor.expand_shape %1585 [[0], [1], [2, 3]] output_shape [4, %dim_873, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1586 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_875 = tensor.expand_shape %1586 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1587 = linalg.batch_matmul ins(%expanded_875, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_876 = linalg.transpose ins(%1587 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1588 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_876 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1589 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1588, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1590 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1589 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1591 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_876 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1592 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1591, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1593 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1592 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_877 = tensor.expand_shape %1590 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_878 = tensor.expand_shape %1593 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_879 = tensor.extract_slice %expanded_870[0, 0, 0, 0] [4, %dim_869, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_880 = tensor.extract_slice %expanded_870[0, 0, 0, 1] [4, %dim_869, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1594 = tensor.empty(%dim_869) : tensor<4x?x32x32xf16>
    %1595 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_879, %expanded_877 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1594 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1596 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_880, %expanded_878 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1594 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1597 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1595, %1596 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1594 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1598 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_880, %expanded_877 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1594 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1599 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_879, %expanded_878 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1594 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1600 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1598, %1599 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1594 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_881 = tensor.dim %1597, %c1 : tensor<4x?x32x32xf16>
    %1601 = tensor.empty(%dim_881) : tensor<4x?x32x2x32xf16>
    %1602 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1597, %1600 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1601 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_882 = tensor.collapse_shape %1602 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1603 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_883 = tensor.expand_shape %1603 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1604 = linalg.batch_matmul ins(%expanded_883, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_884 = linalg.transpose ins(%1604 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1605 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_884 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1606 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1605, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1607 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1606 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1608 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_884 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1609 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1608, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1610 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1609 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_885 = tensor.expand_shape %1607 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_886 = tensor.expand_shape %1610 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_887 = tensor.extract_slice %expanded_872[0, 0, 0, 0] [4, %dim_871, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_888 = tensor.extract_slice %expanded_872[0, 0, 0, 1] [4, %dim_871, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1611 = tensor.empty(%dim_871) : tensor<4x?x4x32xf16>
    %1612 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_887, %expanded_885 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1611 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1613 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_888, %expanded_886 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1611 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1614 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1612, %1613 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1611 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1615 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_888, %expanded_885 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1611 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1616 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_887, %expanded_886 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1611 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1617 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1615, %1616 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1611 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_889 = tensor.dim %1614, %c1 : tensor<4x?x4x32xf16>
    %1618 = tensor.empty(%dim_889) : tensor<4x?x4x2x32xf16>
    %1619 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1614, %1617 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1618 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_890 = tensor.collapse_shape %1619 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1620 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c10_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %1621 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1620 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_891 = tensor.collapse_shape %1621 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_892 = tensor.dim %1619, %c1 : tensor<4x?x4x2x32xf16>
    %1622 = arith.divsi %dim_892, %c32 : index
    %expanded_893 = tensor.expand_shape %collapsed_890 [[0], [1, 2], [3], [4]] output_shape [4, %1622, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_894 = tensor.collapse_shape %expanded_893 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1623 = affine.apply #map14()[%1622]
    %1624 = tensor.empty(%1623) : tensor<?x4x32x64xf16>
    %transposed_895 = linalg.transpose ins(%collapsed_894 : tensor<?x32x4x64xf16>) outs(%1624 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_896 = tensor.expand_shape %collapsed_891 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1625 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_895, %expanded_896 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1481 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1626 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1621 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_897 = tensor.collapse_shape %1626 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %1627 = arith.divsi %dim_873, %c32 : index
    %expanded_898 = tensor.expand_shape %1585 [[0], [1, 2], [3, 4]] output_shape [4, %1627, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_899 = tensor.collapse_shape %expanded_898 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1628 = affine.apply #map14()[%1627]
    %1629 = tensor.empty(%1628) : tensor<?x4x32x64xf16>
    %transposed_900 = linalg.transpose ins(%collapsed_899 : tensor<?x32x4x64xf16>) outs(%1629 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_901 = tensor.expand_shape %collapsed_897 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1630 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_900, %expanded_901 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1625 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1631 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_890 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_902 = tensor.collapse_shape %1631 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1632 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_874 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_903 = tensor.collapse_shape %1632 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_904 = tensor.dim %1602, %c1 : tensor<4x?x32x2x32xf16>
    %1633 = tensor.empty(%dim_904) : tensor<4x32x?x64xf16>
    %transposed_905 = linalg.transpose ins(%collapsed_882 : tensor<4x?x32x64xf16>) outs(%1633 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1634 = tensor.empty(%dim_892) : tensor<4x32x?x64xf16>
    %transposed_906 = linalg.transpose ins(%collapsed_902 : tensor<4x?x32x64xf16>) outs(%1634 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1635 = tensor.empty(%dim_873) : tensor<4x32x?x64xf16>
    %transposed_907 = linalg.transpose ins(%collapsed_903 : tensor<4x?x32x64xf16>) outs(%1635 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_908 = tensor.collapse_shape %transposed_905 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_909 = tensor.collapse_shape %transposed_906 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_910 = tensor.collapse_shape %transposed_907 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_911 = tensor.dim %transposed_905, %c2 : tensor<4x32x?x64xf16>
    %1636 = tensor.empty(%dim_911) : tensor<128x?x64xf16>
    %1637 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_908, %collapsed_909, %collapsed_910, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%1636 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_912 = tensor.expand_shape %1637 [[0, 1], [2], [3]] output_shape [4, 32, %dim_911, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_913 = tensor.dim %expanded_912, %c2 : tensor<4x32x?x64xf16>
    %1638 = tensor.empty(%dim_913) : tensor<4x?x32x64xf16>
    %transposed_914 = linalg.transpose ins(%expanded_912 : tensor<4x32x?x64xf16>) outs(%1638 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_915 = tensor.collapse_shape %transposed_914 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1639 = iree_tensor_ext.bitcast %__auto.blk.10.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_916 = tensor.expand_shape %1639 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_917 = tensor.extract_slice %expanded_916[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1640 = iree_tensor_ext.bitcast %extracted_slice_917 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_918 = tensor.extract_slice %expanded_916[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1641 = iree_tensor_ext.bitcast %extracted_slice_918 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_919 = tensor.dim %collapsed_915, %c1 : tensor<4x?x2048xf16>
    %1642 = tensor.empty() : tensor<2048x64x32xf16>
    %1643 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1640, %1641 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1642 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_920 = tensor.expand_shape %collapsed_915 [[0], [1], [2, 3]] output_shape [4, %dim_919, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1644 = tensor.empty(%dim_919) : tensor<4x?x2048xf32>
    %1645 = linalg.fill ins(%cst_3 : f32) outs(%1644 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1646 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_920, %1643 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1645 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1647 = tensor.empty(%dim_919) : tensor<4x?x2048xf16>
    %1648 = linalg.copy ins(%1646 : tensor<4x?x2048xf32>) outs(%1647 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1649 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1545, %1648 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1650 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1649 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1651 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1650 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1652 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1651 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1653 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1652 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1654 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1653 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1655 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1654 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1656 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1650, %1655 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1657 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1656 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1658 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.ffn_norm.weight, %1657 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1659 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1658 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1660 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_921 = tensor.expand_shape %1660 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_922 = tensor.extract_slice %expanded_921[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1661 = iree_tensor_ext.bitcast %extracted_slice_922 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_923 = tensor.extract_slice %expanded_921[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1662 = iree_tensor_ext.bitcast %extracted_slice_923 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_924 = tensor.dim %1659, %c1 : tensor<4x?x2048xf16>
    %1663 = tensor.empty() : tensor<5632x64x32xf16>
    %1664 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1661, %1662 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1663 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_925 = tensor.expand_shape %1659 [[0], [1], [2, 3]] output_shape [4, %dim_924, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1665 = tensor.empty(%dim_924) : tensor<4x?x5632xf32>
    %1666 = linalg.fill ins(%cst_3 : f32) outs(%1665 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1667 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_925, %1664 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1666 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1668 = tensor.empty(%dim_924) : tensor<4x?x5632xf16>
    %1669 = linalg.copy ins(%1667 : tensor<4x?x5632xf32>) outs(%1668 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_926 = tensor.dim %1669, %c1 : tensor<4x?x5632xf16>
    %1670 = tensor.empty(%dim_926) : tensor<4x?x5632xf16>
    %1671 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1669 : tensor<4x?x5632xf16>) outs(%1670 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %1672 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1671, %1669 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1670 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1673 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_927 = tensor.expand_shape %1673 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_928 = tensor.extract_slice %expanded_927[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1674 = iree_tensor_ext.bitcast %extracted_slice_928 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_929 = tensor.extract_slice %expanded_927[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1675 = iree_tensor_ext.bitcast %extracted_slice_929 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_930 = tensor.dim %1659, %c1 : tensor<4x?x2048xf16>
    %1676 = tensor.empty() : tensor<5632x64x32xf16>
    %1677 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1674, %1675 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1676 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_931 = tensor.expand_shape %1659 [[0], [1], [2, 3]] output_shape [4, %dim_930, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1678 = tensor.empty(%dim_930) : tensor<4x?x5632xf32>
    %1679 = linalg.fill ins(%cst_3 : f32) outs(%1678 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1680 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_931, %1677 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1679 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1681 = tensor.empty(%dim_930) : tensor<4x?x5632xf16>
    %1682 = linalg.copy ins(%1680 : tensor<4x?x5632xf32>) outs(%1681 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1683 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1672, %1682 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1670 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1684 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_932 = tensor.expand_shape %1684 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_933 = tensor.extract_slice %expanded_932[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1685 = iree_tensor_ext.bitcast %extracted_slice_933 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_934 = tensor.extract_slice %expanded_932[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1686 = iree_tensor_ext.bitcast %extracted_slice_934 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_935 = tensor.dim %1683, %c1 : tensor<4x?x5632xf16>
    %1687 = tensor.empty() : tensor<2048x176x32xf16>
    %1688 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1685, %1686 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1687 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_936 = tensor.expand_shape %1683 [[0], [1], [2, 3]] output_shape [4, %dim_935, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1689 = tensor.empty(%dim_935) : tensor<4x?x2048xf32>
    %1690 = linalg.fill ins(%cst_3 : f32) outs(%1689 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1691 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_936, %1688 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%1690 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1692 = tensor.empty(%dim_935) : tensor<4x?x2048xf16>
    %1693 = linalg.copy ins(%1691 : tensor<4x?x2048xf32>) outs(%1692 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1694 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1649, %1693 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1695 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1694 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1696 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1695 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1697 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1696 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1698 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1697 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1699 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1698 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1700 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1699 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1701 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1695, %1700 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1702 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1701 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1703 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.attn_norm.weight, %1702 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1704 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1703 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1705 = iree_tensor_ext.bitcast %__auto.blk.11.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_937 = tensor.expand_shape %1705 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_938 = tensor.extract_slice %expanded_937[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1706 = iree_tensor_ext.bitcast %extracted_slice_938 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_939 = tensor.extract_slice %expanded_937[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1707 = iree_tensor_ext.bitcast %extracted_slice_939 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_940 = tensor.dim %1704, %c1 : tensor<4x?x2048xf16>
    %1708 = tensor.empty() : tensor<2048x64x32xf16>
    %1709 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1706, %1707 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1708 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_941 = tensor.expand_shape %1704 [[0], [1], [2, 3]] output_shape [4, %dim_940, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1710 = tensor.empty(%dim_940) : tensor<4x?x2048xf32>
    %1711 = linalg.fill ins(%cst_3 : f32) outs(%1710 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1712 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_941, %1709 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1711 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1713 = tensor.empty(%dim_940) : tensor<4x?x2048xf16>
    %1714 = linalg.copy ins(%1712 : tensor<4x?x2048xf32>) outs(%1713 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1715 = iree_tensor_ext.bitcast %__auto.blk.11.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_942 = tensor.expand_shape %1715 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_943 = tensor.extract_slice %expanded_942[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1716 = iree_tensor_ext.bitcast %extracted_slice_943 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_944 = tensor.extract_slice %expanded_942[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1717 = iree_tensor_ext.bitcast %extracted_slice_944 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_945 = tensor.dim %1704, %c1 : tensor<4x?x2048xf16>
    %1718 = tensor.empty() : tensor<256x64x32xf16>
    %1719 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1716, %1717 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1718 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_946 = tensor.expand_shape %1704 [[0], [1], [2, 3]] output_shape [4, %dim_945, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1720 = tensor.empty(%dim_945) : tensor<4x?x256xf32>
    %1721 = linalg.fill ins(%cst_3 : f32) outs(%1720 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1722 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_946, %1719 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1721 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1723 = tensor.empty(%dim_945) : tensor<4x?x256xf16>
    %1724 = linalg.copy ins(%1722 : tensor<4x?x256xf32>) outs(%1723 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1725 = iree_tensor_ext.bitcast %__auto.blk.11.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_947 = tensor.expand_shape %1725 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_948 = tensor.extract_slice %expanded_947[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1726 = iree_tensor_ext.bitcast %extracted_slice_948 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_949 = tensor.extract_slice %expanded_947[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1727 = iree_tensor_ext.bitcast %extracted_slice_949 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_950 = tensor.dim %1704, %c1 : tensor<4x?x2048xf16>
    %1728 = tensor.empty() : tensor<256x64x32xf16>
    %1729 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1726, %1727 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1728 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_951 = tensor.expand_shape %1704 [[0], [1], [2, 3]] output_shape [4, %dim_950, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1730 = tensor.empty(%dim_950) : tensor<4x?x256xf32>
    %1731 = linalg.fill ins(%cst_3 : f32) outs(%1730 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1732 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_951, %1729 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1731 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1733 = tensor.empty(%dim_950) : tensor<4x?x256xf16>
    %1734 = linalg.copy ins(%1732 : tensor<4x?x256xf32>) outs(%1733 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_952 = tensor.dim %1714, %c1 : tensor<4x?x2048xf16>
    %expanded_953 = tensor.expand_shape %1714 [[0], [1], [2, 3]] output_shape [4, %dim_952, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_954 = tensor.dim %1724, %c1 : tensor<4x?x256xf16>
    %expanded_955 = tensor.expand_shape %1724 [[0], [1], [2, 3]] output_shape [4, %dim_954, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_956 = tensor.dim %1734, %c1 : tensor<4x?x256xf16>
    %expanded_957 = tensor.expand_shape %1734 [[0], [1], [2, 3]] output_shape [4, %dim_956, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1735 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_958 = tensor.expand_shape %1735 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1736 = linalg.batch_matmul ins(%expanded_958, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_959 = linalg.transpose ins(%1736 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1737 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_959 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1738 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1737, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1739 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1738 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1740 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_959 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1741 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1740, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1742 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1741 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_960 = tensor.expand_shape %1739 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_961 = tensor.expand_shape %1742 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_962 = tensor.extract_slice %expanded_953[0, 0, 0, 0] [4, %dim_952, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_963 = tensor.extract_slice %expanded_953[0, 0, 0, 1] [4, %dim_952, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1743 = tensor.empty(%dim_952) : tensor<4x?x32x32xf16>
    %1744 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_962, %expanded_960 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1743 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1745 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_963, %expanded_961 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1743 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1746 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1744, %1745 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1743 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1747 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_963, %expanded_960 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1743 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1748 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_962, %expanded_961 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1743 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1749 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1747, %1748 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1743 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_964 = tensor.dim %1746, %c1 : tensor<4x?x32x32xf16>
    %1750 = tensor.empty(%dim_964) : tensor<4x?x32x2x32xf16>
    %1751 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1746, %1749 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1750 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_965 = tensor.collapse_shape %1751 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1752 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_966 = tensor.expand_shape %1752 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1753 = linalg.batch_matmul ins(%expanded_966, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_967 = linalg.transpose ins(%1753 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1754 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_967 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1755 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1754, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1756 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1755 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1757 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_967 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1758 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1757, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1759 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1758 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_968 = tensor.expand_shape %1756 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_969 = tensor.expand_shape %1759 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_970 = tensor.extract_slice %expanded_955[0, 0, 0, 0] [4, %dim_954, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_971 = tensor.extract_slice %expanded_955[0, 0, 0, 1] [4, %dim_954, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1760 = tensor.empty(%dim_954) : tensor<4x?x4x32xf16>
    %1761 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_970, %expanded_968 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1760 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1762 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_971, %expanded_969 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1760 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1763 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1761, %1762 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1760 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1764 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_971, %expanded_968 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1760 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1765 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_970, %expanded_969 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1760 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1766 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1764, %1765 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1760 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_972 = tensor.dim %1763, %c1 : tensor<4x?x4x32xf16>
    %1767 = tensor.empty(%dim_972) : tensor<4x?x4x2x32xf16>
    %1768 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1763, %1766 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1767 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_973 = tensor.collapse_shape %1768 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1769 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c11_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %1770 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1769 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_974 = tensor.collapse_shape %1770 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_975 = tensor.dim %1768, %c1 : tensor<4x?x4x2x32xf16>
    %1771 = arith.divsi %dim_975, %c32 : index
    %expanded_976 = tensor.expand_shape %collapsed_973 [[0], [1, 2], [3], [4]] output_shape [4, %1771, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_977 = tensor.collapse_shape %expanded_976 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1772 = affine.apply #map14()[%1771]
    %1773 = tensor.empty(%1772) : tensor<?x4x32x64xf16>
    %transposed_978 = linalg.transpose ins(%collapsed_977 : tensor<?x32x4x64xf16>) outs(%1773 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_979 = tensor.expand_shape %collapsed_974 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1774 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_978, %expanded_979 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1630 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1775 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1770 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_980 = tensor.collapse_shape %1775 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %1776 = arith.divsi %dim_956, %c32 : index
    %expanded_981 = tensor.expand_shape %1734 [[0], [1, 2], [3, 4]] output_shape [4, %1776, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_982 = tensor.collapse_shape %expanded_981 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1777 = affine.apply #map14()[%1776]
    %1778 = tensor.empty(%1777) : tensor<?x4x32x64xf16>
    %transposed_983 = linalg.transpose ins(%collapsed_982 : tensor<?x32x4x64xf16>) outs(%1778 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_984 = tensor.expand_shape %collapsed_980 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1779 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_983, %expanded_984 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1774 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1780 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_973 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_985 = tensor.collapse_shape %1780 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1781 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_957 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_986 = tensor.collapse_shape %1781 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_987 = tensor.dim %1751, %c1 : tensor<4x?x32x2x32xf16>
    %1782 = tensor.empty(%dim_987) : tensor<4x32x?x64xf16>
    %transposed_988 = linalg.transpose ins(%collapsed_965 : tensor<4x?x32x64xf16>) outs(%1782 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1783 = tensor.empty(%dim_975) : tensor<4x32x?x64xf16>
    %transposed_989 = linalg.transpose ins(%collapsed_985 : tensor<4x?x32x64xf16>) outs(%1783 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1784 = tensor.empty(%dim_956) : tensor<4x32x?x64xf16>
    %transposed_990 = linalg.transpose ins(%collapsed_986 : tensor<4x?x32x64xf16>) outs(%1784 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_991 = tensor.collapse_shape %transposed_988 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_992 = tensor.collapse_shape %transposed_989 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_993 = tensor.collapse_shape %transposed_990 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_994 = tensor.dim %transposed_988, %c2 : tensor<4x32x?x64xf16>
    %1785 = tensor.empty(%dim_994) : tensor<128x?x64xf16>
    %1786 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_991, %collapsed_992, %collapsed_993, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%1785 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_995 = tensor.expand_shape %1786 [[0, 1], [2], [3]] output_shape [4, 32, %dim_994, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_996 = tensor.dim %expanded_995, %c2 : tensor<4x32x?x64xf16>
    %1787 = tensor.empty(%dim_996) : tensor<4x?x32x64xf16>
    %transposed_997 = linalg.transpose ins(%expanded_995 : tensor<4x32x?x64xf16>) outs(%1787 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_998 = tensor.collapse_shape %transposed_997 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1788 = iree_tensor_ext.bitcast %__auto.blk.11.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_999 = tensor.expand_shape %1788 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1000 = tensor.extract_slice %expanded_999[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1789 = iree_tensor_ext.bitcast %extracted_slice_1000 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1001 = tensor.extract_slice %expanded_999[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1790 = iree_tensor_ext.bitcast %extracted_slice_1001 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1002 = tensor.dim %collapsed_998, %c1 : tensor<4x?x2048xf16>
    %1791 = tensor.empty() : tensor<2048x64x32xf16>
    %1792 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1789, %1790 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1791 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1003 = tensor.expand_shape %collapsed_998 [[0], [1], [2, 3]] output_shape [4, %dim_1002, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1793 = tensor.empty(%dim_1002) : tensor<4x?x2048xf32>
    %1794 = linalg.fill ins(%cst_3 : f32) outs(%1793 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1795 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1003, %1792 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1794 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1796 = tensor.empty(%dim_1002) : tensor<4x?x2048xf16>
    %1797 = linalg.copy ins(%1795 : tensor<4x?x2048xf32>) outs(%1796 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1798 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1694, %1797 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1799 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1798 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1800 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1799 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1801 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1800 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1802 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1801 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1803 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1802 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1804 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1803 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1805 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1799, %1804 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1806 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1805 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1807 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.ffn_norm.weight, %1806 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1808 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1807 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1809 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1004 = tensor.expand_shape %1809 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1005 = tensor.extract_slice %expanded_1004[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1810 = iree_tensor_ext.bitcast %extracted_slice_1005 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1006 = tensor.extract_slice %expanded_1004[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1811 = iree_tensor_ext.bitcast %extracted_slice_1006 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1007 = tensor.dim %1808, %c1 : tensor<4x?x2048xf16>
    %1812 = tensor.empty() : tensor<5632x64x32xf16>
    %1813 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1810, %1811 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1812 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1008 = tensor.expand_shape %1808 [[0], [1], [2, 3]] output_shape [4, %dim_1007, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1814 = tensor.empty(%dim_1007) : tensor<4x?x5632xf32>
    %1815 = linalg.fill ins(%cst_3 : f32) outs(%1814 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1816 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1008, %1813 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1815 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1817 = tensor.empty(%dim_1007) : tensor<4x?x5632xf16>
    %1818 = linalg.copy ins(%1816 : tensor<4x?x5632xf32>) outs(%1817 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1009 = tensor.dim %1818, %c1 : tensor<4x?x5632xf16>
    %1819 = tensor.empty(%dim_1009) : tensor<4x?x5632xf16>
    %1820 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1818 : tensor<4x?x5632xf16>) outs(%1819 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %1821 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1820, %1818 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1819 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1822 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1010 = tensor.expand_shape %1822 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1011 = tensor.extract_slice %expanded_1010[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1823 = iree_tensor_ext.bitcast %extracted_slice_1011 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1012 = tensor.extract_slice %expanded_1010[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1824 = iree_tensor_ext.bitcast %extracted_slice_1012 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1013 = tensor.dim %1808, %c1 : tensor<4x?x2048xf16>
    %1825 = tensor.empty() : tensor<5632x64x32xf16>
    %1826 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1823, %1824 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1825 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1014 = tensor.expand_shape %1808 [[0], [1], [2, 3]] output_shape [4, %dim_1013, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1827 = tensor.empty(%dim_1013) : tensor<4x?x5632xf32>
    %1828 = linalg.fill ins(%cst_3 : f32) outs(%1827 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1829 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1014, %1826 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1828 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1830 = tensor.empty(%dim_1013) : tensor<4x?x5632xf16>
    %1831 = linalg.copy ins(%1829 : tensor<4x?x5632xf32>) outs(%1830 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1832 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1821, %1831 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1819 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1833 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1015 = tensor.expand_shape %1833 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1016 = tensor.extract_slice %expanded_1015[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1834 = iree_tensor_ext.bitcast %extracted_slice_1016 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1017 = tensor.extract_slice %expanded_1015[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1835 = iree_tensor_ext.bitcast %extracted_slice_1017 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1018 = tensor.dim %1832, %c1 : tensor<4x?x5632xf16>
    %1836 = tensor.empty() : tensor<2048x176x32xf16>
    %1837 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1834, %1835 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1836 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1019 = tensor.expand_shape %1832 [[0], [1], [2, 3]] output_shape [4, %dim_1018, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1838 = tensor.empty(%dim_1018) : tensor<4x?x2048xf32>
    %1839 = linalg.fill ins(%cst_3 : f32) outs(%1838 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1840 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1019, %1837 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%1839 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1841 = tensor.empty(%dim_1018) : tensor<4x?x2048xf16>
    %1842 = linalg.copy ins(%1840 : tensor<4x?x2048xf32>) outs(%1841 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1843 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1798, %1842 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1844 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1843 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1845 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1844 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1846 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1845 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1847 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1846 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1848 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1847 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1849 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1848 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1850 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1844, %1849 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1851 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1850 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1852 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.attn_norm.weight, %1851 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1853 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1852 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1854 = iree_tensor_ext.bitcast %__auto.blk.12.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1020 = tensor.expand_shape %1854 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1021 = tensor.extract_slice %expanded_1020[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1855 = iree_tensor_ext.bitcast %extracted_slice_1021 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1022 = tensor.extract_slice %expanded_1020[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1856 = iree_tensor_ext.bitcast %extracted_slice_1022 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1023 = tensor.dim %1853, %c1 : tensor<4x?x2048xf16>
    %1857 = tensor.empty() : tensor<2048x64x32xf16>
    %1858 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1855, %1856 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1857 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1024 = tensor.expand_shape %1853 [[0], [1], [2, 3]] output_shape [4, %dim_1023, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1859 = tensor.empty(%dim_1023) : tensor<4x?x2048xf32>
    %1860 = linalg.fill ins(%cst_3 : f32) outs(%1859 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1861 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1024, %1858 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1860 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1862 = tensor.empty(%dim_1023) : tensor<4x?x2048xf16>
    %1863 = linalg.copy ins(%1861 : tensor<4x?x2048xf32>) outs(%1862 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1864 = iree_tensor_ext.bitcast %__auto.blk.12.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1025 = tensor.expand_shape %1864 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1026 = tensor.extract_slice %expanded_1025[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1865 = iree_tensor_ext.bitcast %extracted_slice_1026 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1027 = tensor.extract_slice %expanded_1025[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1866 = iree_tensor_ext.bitcast %extracted_slice_1027 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1028 = tensor.dim %1853, %c1 : tensor<4x?x2048xf16>
    %1867 = tensor.empty() : tensor<256x64x32xf16>
    %1868 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1865, %1866 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1867 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1029 = tensor.expand_shape %1853 [[0], [1], [2, 3]] output_shape [4, %dim_1028, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1869 = tensor.empty(%dim_1028) : tensor<4x?x256xf32>
    %1870 = linalg.fill ins(%cst_3 : f32) outs(%1869 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1871 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1029, %1868 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1870 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1872 = tensor.empty(%dim_1028) : tensor<4x?x256xf16>
    %1873 = linalg.copy ins(%1871 : tensor<4x?x256xf32>) outs(%1872 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1874 = iree_tensor_ext.bitcast %__auto.blk.12.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1030 = tensor.expand_shape %1874 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1031 = tensor.extract_slice %expanded_1030[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1875 = iree_tensor_ext.bitcast %extracted_slice_1031 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1032 = tensor.extract_slice %expanded_1030[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1876 = iree_tensor_ext.bitcast %extracted_slice_1032 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1033 = tensor.dim %1853, %c1 : tensor<4x?x2048xf16>
    %1877 = tensor.empty() : tensor<256x64x32xf16>
    %1878 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1875, %1876 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1877 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1034 = tensor.expand_shape %1853 [[0], [1], [2, 3]] output_shape [4, %dim_1033, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1879 = tensor.empty(%dim_1033) : tensor<4x?x256xf32>
    %1880 = linalg.fill ins(%cst_3 : f32) outs(%1879 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %1881 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1034, %1878 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%1880 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %1882 = tensor.empty(%dim_1033) : tensor<4x?x256xf16>
    %1883 = linalg.copy ins(%1881 : tensor<4x?x256xf32>) outs(%1882 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1035 = tensor.dim %1863, %c1 : tensor<4x?x2048xf16>
    %expanded_1036 = tensor.expand_shape %1863 [[0], [1], [2, 3]] output_shape [4, %dim_1035, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1037 = tensor.dim %1873, %c1 : tensor<4x?x256xf16>
    %expanded_1038 = tensor.expand_shape %1873 [[0], [1], [2, 3]] output_shape [4, %dim_1037, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1039 = tensor.dim %1883, %c1 : tensor<4x?x256xf16>
    %expanded_1040 = tensor.expand_shape %1883 [[0], [1], [2, 3]] output_shape [4, %dim_1039, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1884 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1041 = tensor.expand_shape %1884 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1885 = linalg.batch_matmul ins(%expanded_1041, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1042 = linalg.transpose ins(%1885 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1886 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1042 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1887 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1886, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1888 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1887 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1889 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1042 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1890 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1889, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1891 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1890 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1043 = tensor.expand_shape %1888 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1044 = tensor.expand_shape %1891 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1045 = tensor.extract_slice %expanded_1036[0, 0, 0, 0] [4, %dim_1035, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1046 = tensor.extract_slice %expanded_1036[0, 0, 0, 1] [4, %dim_1035, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1892 = tensor.empty(%dim_1035) : tensor<4x?x32x32xf16>
    %1893 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1045, %expanded_1043 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1892 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1894 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1046, %expanded_1044 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1892 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1895 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1893, %1894 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1892 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1896 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1046, %expanded_1043 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1892 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1897 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1045, %expanded_1044 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%1892 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %1898 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1896, %1897 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1892 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1047 = tensor.dim %1895, %c1 : tensor<4x?x32x32xf16>
    %1899 = tensor.empty(%dim_1047) : tensor<4x?x32x2x32xf16>
    %1900 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1895, %1898 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%1899 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1048 = tensor.collapse_shape %1900 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1901 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1049 = tensor.expand_shape %1901 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1902 = linalg.batch_matmul ins(%expanded_1049, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1050 = linalg.transpose ins(%1902 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1903 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1050 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1904 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1903, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1905 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1904 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %1906 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1050 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1907 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1906, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %1908 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1907 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1051 = tensor.expand_shape %1905 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1052 = tensor.expand_shape %1908 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1053 = tensor.extract_slice %expanded_1038[0, 0, 0, 0] [4, %dim_1037, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1054 = tensor.extract_slice %expanded_1038[0, 0, 0, 1] [4, %dim_1037, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1909 = tensor.empty(%dim_1037) : tensor<4x?x4x32xf16>
    %1910 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1053, %expanded_1051 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1909 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1911 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1054, %expanded_1052 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1909 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1912 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1910, %1911 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1909 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1913 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1054, %expanded_1051 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1909 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1914 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1053, %expanded_1052 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%1909 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %1915 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1913, %1914 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1909 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1055 = tensor.dim %1912, %c1 : tensor<4x?x4x32xf16>
    %1916 = tensor.empty(%dim_1055) : tensor<4x?x4x2x32xf16>
    %1917 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1912, %1915 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%1916 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1056 = tensor.collapse_shape %1917 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1918 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c12_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %1919 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1918 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1057 = tensor.collapse_shape %1919 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1058 = tensor.dim %1917, %c1 : tensor<4x?x4x2x32xf16>
    %1920 = arith.divsi %dim_1058, %c32 : index
    %expanded_1059 = tensor.expand_shape %collapsed_1056 [[0], [1, 2], [3], [4]] output_shape [4, %1920, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1060 = tensor.collapse_shape %expanded_1059 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1921 = affine.apply #map14()[%1920]
    %1922 = tensor.empty(%1921) : tensor<?x4x32x64xf16>
    %transposed_1061 = linalg.transpose ins(%collapsed_1060 : tensor<?x32x4x64xf16>) outs(%1922 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1062 = tensor.expand_shape %collapsed_1057 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1923 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1061, %expanded_1062 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1779 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1924 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1919 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1063 = tensor.collapse_shape %1924 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %1925 = arith.divsi %dim_1039, %c32 : index
    %expanded_1064 = tensor.expand_shape %1883 [[0], [1, 2], [3, 4]] output_shape [4, %1925, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1065 = tensor.collapse_shape %expanded_1064 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %1926 = affine.apply #map14()[%1925]
    %1927 = tensor.empty(%1926) : tensor<?x4x32x64xf16>
    %transposed_1066 = linalg.transpose ins(%collapsed_1065 : tensor<?x32x4x64xf16>) outs(%1927 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1067 = tensor.expand_shape %collapsed_1063 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1928 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1066, %expanded_1067 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1923 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1929 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1056 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1068 = tensor.collapse_shape %1929 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1930 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1040 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1069 = tensor.collapse_shape %1930 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1070 = tensor.dim %1900, %c1 : tensor<4x?x32x2x32xf16>
    %1931 = tensor.empty(%dim_1070) : tensor<4x32x?x64xf16>
    %transposed_1071 = linalg.transpose ins(%collapsed_1048 : tensor<4x?x32x64xf16>) outs(%1931 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1932 = tensor.empty(%dim_1058) : tensor<4x32x?x64xf16>
    %transposed_1072 = linalg.transpose ins(%collapsed_1068 : tensor<4x?x32x64xf16>) outs(%1932 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1933 = tensor.empty(%dim_1039) : tensor<4x32x?x64xf16>
    %transposed_1073 = linalg.transpose ins(%collapsed_1069 : tensor<4x?x32x64xf16>) outs(%1933 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1074 = tensor.collapse_shape %transposed_1071 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1075 = tensor.collapse_shape %transposed_1072 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1076 = tensor.collapse_shape %transposed_1073 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1077 = tensor.dim %transposed_1071, %c2 : tensor<4x32x?x64xf16>
    %1934 = tensor.empty(%dim_1077) : tensor<128x?x64xf16>
    %1935 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1074, %collapsed_1075, %collapsed_1076, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%1934 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1078 = tensor.expand_shape %1935 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1077, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1079 = tensor.dim %expanded_1078, %c2 : tensor<4x32x?x64xf16>
    %1936 = tensor.empty(%dim_1079) : tensor<4x?x32x64xf16>
    %transposed_1080 = linalg.transpose ins(%expanded_1078 : tensor<4x32x?x64xf16>) outs(%1936 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1081 = tensor.collapse_shape %transposed_1080 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1937 = iree_tensor_ext.bitcast %__auto.blk.12.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1082 = tensor.expand_shape %1937 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1083 = tensor.extract_slice %expanded_1082[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1938 = iree_tensor_ext.bitcast %extracted_slice_1083 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1084 = tensor.extract_slice %expanded_1082[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1939 = iree_tensor_ext.bitcast %extracted_slice_1084 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1085 = tensor.dim %collapsed_1081, %c1 : tensor<4x?x2048xf16>
    %1940 = tensor.empty() : tensor<2048x64x32xf16>
    %1941 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1938, %1939 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1940 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1086 = tensor.expand_shape %collapsed_1081 [[0], [1], [2, 3]] output_shape [4, %dim_1085, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1942 = tensor.empty(%dim_1085) : tensor<4x?x2048xf32>
    %1943 = linalg.fill ins(%cst_3 : f32) outs(%1942 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1944 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1086, %1941 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1943 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1945 = tensor.empty(%dim_1085) : tensor<4x?x2048xf16>
    %1946 = linalg.copy ins(%1944 : tensor<4x?x2048xf32>) outs(%1945 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1947 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1843, %1946 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1948 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1947 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1949 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1948 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1950 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1949 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1951 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1950 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1952 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1951 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1953 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1952 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1954 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1948, %1953 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1955 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1954 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1956 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.ffn_norm.weight, %1955 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %1957 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1956 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1958 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1087 = tensor.expand_shape %1958 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1088 = tensor.extract_slice %expanded_1087[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1959 = iree_tensor_ext.bitcast %extracted_slice_1088 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1089 = tensor.extract_slice %expanded_1087[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1960 = iree_tensor_ext.bitcast %extracted_slice_1089 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1090 = tensor.dim %1957, %c1 : tensor<4x?x2048xf16>
    %1961 = tensor.empty() : tensor<5632x64x32xf16>
    %1962 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1959, %1960 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1961 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1091 = tensor.expand_shape %1957 [[0], [1], [2, 3]] output_shape [4, %dim_1090, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1963 = tensor.empty(%dim_1090) : tensor<4x?x5632xf32>
    %1964 = linalg.fill ins(%cst_3 : f32) outs(%1963 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1965 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1091, %1962 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1964 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1966 = tensor.empty(%dim_1090) : tensor<4x?x5632xf16>
    %1967 = linalg.copy ins(%1965 : tensor<4x?x5632xf32>) outs(%1966 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1092 = tensor.dim %1967, %c1 : tensor<4x?x5632xf16>
    %1968 = tensor.empty(%dim_1092) : tensor<4x?x5632xf16>
    %1969 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1967 : tensor<4x?x5632xf16>) outs(%1968 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %1970 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1969, %1967 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1968 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1971 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1093 = tensor.expand_shape %1971 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1094 = tensor.extract_slice %expanded_1093[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1972 = iree_tensor_ext.bitcast %extracted_slice_1094 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1095 = tensor.extract_slice %expanded_1093[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1973 = iree_tensor_ext.bitcast %extracted_slice_1095 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1096 = tensor.dim %1957, %c1 : tensor<4x?x2048xf16>
    %1974 = tensor.empty() : tensor<5632x64x32xf16>
    %1975 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1972, %1973 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1974 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1097 = tensor.expand_shape %1957 [[0], [1], [2, 3]] output_shape [4, %dim_1096, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1976 = tensor.empty(%dim_1096) : tensor<4x?x5632xf32>
    %1977 = linalg.fill ins(%cst_3 : f32) outs(%1976 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %1978 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1097, %1975 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%1977 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %1979 = tensor.empty(%dim_1096) : tensor<4x?x5632xf16>
    %1980 = linalg.copy ins(%1978 : tensor<4x?x5632xf32>) outs(%1979 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1981 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1970, %1980 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%1968 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %1982 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1098 = tensor.expand_shape %1982 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1099 = tensor.extract_slice %expanded_1098[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1983 = iree_tensor_ext.bitcast %extracted_slice_1099 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1100 = tensor.extract_slice %expanded_1098[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1984 = iree_tensor_ext.bitcast %extracted_slice_1100 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1101 = tensor.dim %1981, %c1 : tensor<4x?x5632xf16>
    %1985 = tensor.empty() : tensor<2048x176x32xf16>
    %1986 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1983, %1984 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1985 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1102 = tensor.expand_shape %1981 [[0], [1], [2, 3]] output_shape [4, %dim_1101, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1987 = tensor.empty(%dim_1101) : tensor<4x?x2048xf32>
    %1988 = linalg.fill ins(%cst_3 : f32) outs(%1987 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1989 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1102, %1986 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%1988 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %1990 = tensor.empty(%dim_1101) : tensor<4x?x2048xf16>
    %1991 = linalg.copy ins(%1989 : tensor<4x?x2048xf32>) outs(%1990 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1992 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1947, %1991 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %1993 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1992 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1994 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1993 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %1995 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1994 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1996 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1995 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1997 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1996 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1998 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1997 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %1999 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1993, %1998 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2000 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1999 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2001 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.attn_norm.weight, %2000 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2002 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2001 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2003 = iree_tensor_ext.bitcast %__auto.blk.13.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1103 = tensor.expand_shape %2003 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1104 = tensor.extract_slice %expanded_1103[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2004 = iree_tensor_ext.bitcast %extracted_slice_1104 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1105 = tensor.extract_slice %expanded_1103[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2005 = iree_tensor_ext.bitcast %extracted_slice_1105 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1106 = tensor.dim %2002, %c1 : tensor<4x?x2048xf16>
    %2006 = tensor.empty() : tensor<2048x64x32xf16>
    %2007 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2004, %2005 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2006 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1107 = tensor.expand_shape %2002 [[0], [1], [2, 3]] output_shape [4, %dim_1106, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2008 = tensor.empty(%dim_1106) : tensor<4x?x2048xf32>
    %2009 = linalg.fill ins(%cst_3 : f32) outs(%2008 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2010 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1107, %2007 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2009 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2011 = tensor.empty(%dim_1106) : tensor<4x?x2048xf16>
    %2012 = linalg.copy ins(%2010 : tensor<4x?x2048xf32>) outs(%2011 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2013 = iree_tensor_ext.bitcast %__auto.blk.13.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1108 = tensor.expand_shape %2013 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1109 = tensor.extract_slice %expanded_1108[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2014 = iree_tensor_ext.bitcast %extracted_slice_1109 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1110 = tensor.extract_slice %expanded_1108[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2015 = iree_tensor_ext.bitcast %extracted_slice_1110 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1111 = tensor.dim %2002, %c1 : tensor<4x?x2048xf16>
    %2016 = tensor.empty() : tensor<256x64x32xf16>
    %2017 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2014, %2015 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2016 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1112 = tensor.expand_shape %2002 [[0], [1], [2, 3]] output_shape [4, %dim_1111, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2018 = tensor.empty(%dim_1111) : tensor<4x?x256xf32>
    %2019 = linalg.fill ins(%cst_3 : f32) outs(%2018 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2020 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1112, %2017 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2019 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2021 = tensor.empty(%dim_1111) : tensor<4x?x256xf16>
    %2022 = linalg.copy ins(%2020 : tensor<4x?x256xf32>) outs(%2021 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2023 = iree_tensor_ext.bitcast %__auto.blk.13.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1113 = tensor.expand_shape %2023 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1114 = tensor.extract_slice %expanded_1113[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2024 = iree_tensor_ext.bitcast %extracted_slice_1114 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1115 = tensor.extract_slice %expanded_1113[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2025 = iree_tensor_ext.bitcast %extracted_slice_1115 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1116 = tensor.dim %2002, %c1 : tensor<4x?x2048xf16>
    %2026 = tensor.empty() : tensor<256x64x32xf16>
    %2027 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2024, %2025 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2026 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1117 = tensor.expand_shape %2002 [[0], [1], [2, 3]] output_shape [4, %dim_1116, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2028 = tensor.empty(%dim_1116) : tensor<4x?x256xf32>
    %2029 = linalg.fill ins(%cst_3 : f32) outs(%2028 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2030 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1117, %2027 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2029 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2031 = tensor.empty(%dim_1116) : tensor<4x?x256xf16>
    %2032 = linalg.copy ins(%2030 : tensor<4x?x256xf32>) outs(%2031 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1118 = tensor.dim %2012, %c1 : tensor<4x?x2048xf16>
    %expanded_1119 = tensor.expand_shape %2012 [[0], [1], [2, 3]] output_shape [4, %dim_1118, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1120 = tensor.dim %2022, %c1 : tensor<4x?x256xf16>
    %expanded_1121 = tensor.expand_shape %2022 [[0], [1], [2, 3]] output_shape [4, %dim_1120, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1122 = tensor.dim %2032, %c1 : tensor<4x?x256xf16>
    %expanded_1123 = tensor.expand_shape %2032 [[0], [1], [2, 3]] output_shape [4, %dim_1122, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2033 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1124 = tensor.expand_shape %2033 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2034 = linalg.batch_matmul ins(%expanded_1124, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1125 = linalg.transpose ins(%2034 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2035 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1125 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2036 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2035, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2037 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2036 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2038 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1125 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2039 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2038, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2040 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2039 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1126 = tensor.expand_shape %2037 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1127 = tensor.expand_shape %2040 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1128 = tensor.extract_slice %expanded_1119[0, 0, 0, 0] [4, %dim_1118, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1129 = tensor.extract_slice %expanded_1119[0, 0, 0, 1] [4, %dim_1118, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2041 = tensor.empty(%dim_1118) : tensor<4x?x32x32xf16>
    %2042 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1128, %expanded_1126 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2041 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2043 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1129, %expanded_1127 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2041 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2044 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2042, %2043 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2041 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2045 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1129, %expanded_1126 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2041 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2046 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1128, %expanded_1127 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2041 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2047 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2045, %2046 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2041 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1130 = tensor.dim %2044, %c1 : tensor<4x?x32x32xf16>
    %2048 = tensor.empty(%dim_1130) : tensor<4x?x32x2x32xf16>
    %2049 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2044, %2047 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2048 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1131 = tensor.collapse_shape %2049 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2050 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1132 = tensor.expand_shape %2050 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2051 = linalg.batch_matmul ins(%expanded_1132, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1133 = linalg.transpose ins(%2051 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2052 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1133 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2053 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2052, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2054 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2053 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2055 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1133 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2056 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2055, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2057 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2056 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1134 = tensor.expand_shape %2054 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1135 = tensor.expand_shape %2057 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1136 = tensor.extract_slice %expanded_1121[0, 0, 0, 0] [4, %dim_1120, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1137 = tensor.extract_slice %expanded_1121[0, 0, 0, 1] [4, %dim_1120, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2058 = tensor.empty(%dim_1120) : tensor<4x?x4x32xf16>
    %2059 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1136, %expanded_1134 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2058 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2060 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1137, %expanded_1135 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2058 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2061 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2059, %2060 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2058 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2062 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1137, %expanded_1134 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2058 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2063 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1136, %expanded_1135 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2058 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2064 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2062, %2063 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2058 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1138 = tensor.dim %2061, %c1 : tensor<4x?x4x32xf16>
    %2065 = tensor.empty(%dim_1138) : tensor<4x?x4x2x32xf16>
    %2066 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2061, %2064 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2065 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1139 = tensor.collapse_shape %2066 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2067 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c13_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %2068 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2067 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1140 = tensor.collapse_shape %2068 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1141 = tensor.dim %2066, %c1 : tensor<4x?x4x2x32xf16>
    %2069 = arith.divsi %dim_1141, %c32 : index
    %expanded_1142 = tensor.expand_shape %collapsed_1139 [[0], [1, 2], [3], [4]] output_shape [4, %2069, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1143 = tensor.collapse_shape %expanded_1142 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2070 = affine.apply #map14()[%2069]
    %2071 = tensor.empty(%2070) : tensor<?x4x32x64xf16>
    %transposed_1144 = linalg.transpose ins(%collapsed_1143 : tensor<?x32x4x64xf16>) outs(%2071 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1145 = tensor.expand_shape %collapsed_1140 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2072 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1144, %expanded_1145 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1928 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2073 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2068 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1146 = tensor.collapse_shape %2073 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %2074 = arith.divsi %dim_1122, %c32 : index
    %expanded_1147 = tensor.expand_shape %2032 [[0], [1, 2], [3, 4]] output_shape [4, %2074, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1148 = tensor.collapse_shape %expanded_1147 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2075 = affine.apply #map14()[%2074]
    %2076 = tensor.empty(%2075) : tensor<?x4x32x64xf16>
    %transposed_1149 = linalg.transpose ins(%collapsed_1148 : tensor<?x32x4x64xf16>) outs(%2076 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1150 = tensor.expand_shape %collapsed_1146 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2077 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1149, %expanded_1150 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2072 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2078 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1139 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1151 = tensor.collapse_shape %2078 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2079 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1123 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1152 = tensor.collapse_shape %2079 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1153 = tensor.dim %2049, %c1 : tensor<4x?x32x2x32xf16>
    %2080 = tensor.empty(%dim_1153) : tensor<4x32x?x64xf16>
    %transposed_1154 = linalg.transpose ins(%collapsed_1131 : tensor<4x?x32x64xf16>) outs(%2080 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2081 = tensor.empty(%dim_1141) : tensor<4x32x?x64xf16>
    %transposed_1155 = linalg.transpose ins(%collapsed_1151 : tensor<4x?x32x64xf16>) outs(%2081 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2082 = tensor.empty(%dim_1122) : tensor<4x32x?x64xf16>
    %transposed_1156 = linalg.transpose ins(%collapsed_1152 : tensor<4x?x32x64xf16>) outs(%2082 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1157 = tensor.collapse_shape %transposed_1154 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1158 = tensor.collapse_shape %transposed_1155 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1159 = tensor.collapse_shape %transposed_1156 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1160 = tensor.dim %transposed_1154, %c2 : tensor<4x32x?x64xf16>
    %2083 = tensor.empty(%dim_1160) : tensor<128x?x64xf16>
    %2084 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1157, %collapsed_1158, %collapsed_1159, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%2083 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1161 = tensor.expand_shape %2084 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1160, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1162 = tensor.dim %expanded_1161, %c2 : tensor<4x32x?x64xf16>
    %2085 = tensor.empty(%dim_1162) : tensor<4x?x32x64xf16>
    %transposed_1163 = linalg.transpose ins(%expanded_1161 : tensor<4x32x?x64xf16>) outs(%2085 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1164 = tensor.collapse_shape %transposed_1163 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2086 = iree_tensor_ext.bitcast %__auto.blk.13.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1165 = tensor.expand_shape %2086 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1166 = tensor.extract_slice %expanded_1165[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2087 = iree_tensor_ext.bitcast %extracted_slice_1166 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1167 = tensor.extract_slice %expanded_1165[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2088 = iree_tensor_ext.bitcast %extracted_slice_1167 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1168 = tensor.dim %collapsed_1164, %c1 : tensor<4x?x2048xf16>
    %2089 = tensor.empty() : tensor<2048x64x32xf16>
    %2090 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2087, %2088 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2089 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1169 = tensor.expand_shape %collapsed_1164 [[0], [1], [2, 3]] output_shape [4, %dim_1168, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2091 = tensor.empty(%dim_1168) : tensor<4x?x2048xf32>
    %2092 = linalg.fill ins(%cst_3 : f32) outs(%2091 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2093 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1169, %2090 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2092 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2094 = tensor.empty(%dim_1168) : tensor<4x?x2048xf16>
    %2095 = linalg.copy ins(%2093 : tensor<4x?x2048xf32>) outs(%2094 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2096 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1992, %2095 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2097 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2096 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2098 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2097 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2099 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2098 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2100 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2099 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2101 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2100 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2101 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2103 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2097, %2102 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2104 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2103 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2105 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.ffn_norm.weight, %2104 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2106 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2105 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2107 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1170 = tensor.expand_shape %2107 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1171 = tensor.extract_slice %expanded_1170[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2108 = iree_tensor_ext.bitcast %extracted_slice_1171 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1172 = tensor.extract_slice %expanded_1170[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2109 = iree_tensor_ext.bitcast %extracted_slice_1172 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1173 = tensor.dim %2106, %c1 : tensor<4x?x2048xf16>
    %2110 = tensor.empty() : tensor<5632x64x32xf16>
    %2111 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2108, %2109 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2110 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1174 = tensor.expand_shape %2106 [[0], [1], [2, 3]] output_shape [4, %dim_1173, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2112 = tensor.empty(%dim_1173) : tensor<4x?x5632xf32>
    %2113 = linalg.fill ins(%cst_3 : f32) outs(%2112 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2114 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1174, %2111 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2113 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2115 = tensor.empty(%dim_1173) : tensor<4x?x5632xf16>
    %2116 = linalg.copy ins(%2114 : tensor<4x?x5632xf32>) outs(%2115 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1175 = tensor.dim %2116, %c1 : tensor<4x?x5632xf16>
    %2117 = tensor.empty(%dim_1175) : tensor<4x?x5632xf16>
    %2118 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2116 : tensor<4x?x5632xf16>) outs(%2117 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %2119 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2118, %2116 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2117 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2120 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1176 = tensor.expand_shape %2120 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1177 = tensor.extract_slice %expanded_1176[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2121 = iree_tensor_ext.bitcast %extracted_slice_1177 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1178 = tensor.extract_slice %expanded_1176[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2122 = iree_tensor_ext.bitcast %extracted_slice_1178 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1179 = tensor.dim %2106, %c1 : tensor<4x?x2048xf16>
    %2123 = tensor.empty() : tensor<5632x64x32xf16>
    %2124 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2121, %2122 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2123 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1180 = tensor.expand_shape %2106 [[0], [1], [2, 3]] output_shape [4, %dim_1179, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2125 = tensor.empty(%dim_1179) : tensor<4x?x5632xf32>
    %2126 = linalg.fill ins(%cst_3 : f32) outs(%2125 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2127 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1180, %2124 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2126 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2128 = tensor.empty(%dim_1179) : tensor<4x?x5632xf16>
    %2129 = linalg.copy ins(%2127 : tensor<4x?x5632xf32>) outs(%2128 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2130 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2119, %2129 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2117 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2131 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1181 = tensor.expand_shape %2131 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1182 = tensor.extract_slice %expanded_1181[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2132 = iree_tensor_ext.bitcast %extracted_slice_1182 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1183 = tensor.extract_slice %expanded_1181[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2133 = iree_tensor_ext.bitcast %extracted_slice_1183 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1184 = tensor.dim %2130, %c1 : tensor<4x?x5632xf16>
    %2134 = tensor.empty() : tensor<2048x176x32xf16>
    %2135 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2132, %2133 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2134 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1185 = tensor.expand_shape %2130 [[0], [1], [2, 3]] output_shape [4, %dim_1184, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2136 = tensor.empty(%dim_1184) : tensor<4x?x2048xf32>
    %2137 = linalg.fill ins(%cst_3 : f32) outs(%2136 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2138 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1185, %2135 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2137 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2139 = tensor.empty(%dim_1184) : tensor<4x?x2048xf16>
    %2140 = linalg.copy ins(%2138 : tensor<4x?x2048xf32>) outs(%2139 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2141 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2096, %2140 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2142 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2141 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2143 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2142 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2144 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2143 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2145 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2144 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2146 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2145 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2147 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2146 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2148 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2142, %2147 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2149 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2148 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2150 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.attn_norm.weight, %2149 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2151 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2150 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2152 = iree_tensor_ext.bitcast %__auto.blk.14.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1186 = tensor.expand_shape %2152 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1187 = tensor.extract_slice %expanded_1186[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2153 = iree_tensor_ext.bitcast %extracted_slice_1187 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1188 = tensor.extract_slice %expanded_1186[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2154 = iree_tensor_ext.bitcast %extracted_slice_1188 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1189 = tensor.dim %2151, %c1 : tensor<4x?x2048xf16>
    %2155 = tensor.empty() : tensor<2048x64x32xf16>
    %2156 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2153, %2154 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2155 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1190 = tensor.expand_shape %2151 [[0], [1], [2, 3]] output_shape [4, %dim_1189, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2157 = tensor.empty(%dim_1189) : tensor<4x?x2048xf32>
    %2158 = linalg.fill ins(%cst_3 : f32) outs(%2157 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2159 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1190, %2156 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2158 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2160 = tensor.empty(%dim_1189) : tensor<4x?x2048xf16>
    %2161 = linalg.copy ins(%2159 : tensor<4x?x2048xf32>) outs(%2160 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2162 = iree_tensor_ext.bitcast %__auto.blk.14.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1191 = tensor.expand_shape %2162 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1192 = tensor.extract_slice %expanded_1191[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2163 = iree_tensor_ext.bitcast %extracted_slice_1192 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1193 = tensor.extract_slice %expanded_1191[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2164 = iree_tensor_ext.bitcast %extracted_slice_1193 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1194 = tensor.dim %2151, %c1 : tensor<4x?x2048xf16>
    %2165 = tensor.empty() : tensor<256x64x32xf16>
    %2166 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2163, %2164 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2165 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1195 = tensor.expand_shape %2151 [[0], [1], [2, 3]] output_shape [4, %dim_1194, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2167 = tensor.empty(%dim_1194) : tensor<4x?x256xf32>
    %2168 = linalg.fill ins(%cst_3 : f32) outs(%2167 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2169 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1195, %2166 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2168 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2170 = tensor.empty(%dim_1194) : tensor<4x?x256xf16>
    %2171 = linalg.copy ins(%2169 : tensor<4x?x256xf32>) outs(%2170 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2172 = iree_tensor_ext.bitcast %__auto.blk.14.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1196 = tensor.expand_shape %2172 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1197 = tensor.extract_slice %expanded_1196[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2173 = iree_tensor_ext.bitcast %extracted_slice_1197 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1198 = tensor.extract_slice %expanded_1196[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2174 = iree_tensor_ext.bitcast %extracted_slice_1198 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1199 = tensor.dim %2151, %c1 : tensor<4x?x2048xf16>
    %2175 = tensor.empty() : tensor<256x64x32xf16>
    %2176 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2175 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1200 = tensor.expand_shape %2151 [[0], [1], [2, 3]] output_shape [4, %dim_1199, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2177 = tensor.empty(%dim_1199) : tensor<4x?x256xf32>
    %2178 = linalg.fill ins(%cst_3 : f32) outs(%2177 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2179 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1200, %2176 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2178 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2180 = tensor.empty(%dim_1199) : tensor<4x?x256xf16>
    %2181 = linalg.copy ins(%2179 : tensor<4x?x256xf32>) outs(%2180 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1201 = tensor.dim %2161, %c1 : tensor<4x?x2048xf16>
    %expanded_1202 = tensor.expand_shape %2161 [[0], [1], [2, 3]] output_shape [4, %dim_1201, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1203 = tensor.dim %2171, %c1 : tensor<4x?x256xf16>
    %expanded_1204 = tensor.expand_shape %2171 [[0], [1], [2, 3]] output_shape [4, %dim_1203, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1205 = tensor.dim %2181, %c1 : tensor<4x?x256xf16>
    %expanded_1206 = tensor.expand_shape %2181 [[0], [1], [2, 3]] output_shape [4, %dim_1205, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2182 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1207 = tensor.expand_shape %2182 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2183 = linalg.batch_matmul ins(%expanded_1207, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1208 = linalg.transpose ins(%2183 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2184 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1208 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2185 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2184, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2186 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2185 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2187 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1208 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2188 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2187, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2189 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2188 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1209 = tensor.expand_shape %2186 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1210 = tensor.expand_shape %2189 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1211 = tensor.extract_slice %expanded_1202[0, 0, 0, 0] [4, %dim_1201, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1212 = tensor.extract_slice %expanded_1202[0, 0, 0, 1] [4, %dim_1201, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2190 = tensor.empty(%dim_1201) : tensor<4x?x32x32xf16>
    %2191 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1211, %expanded_1209 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2190 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2192 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1212, %expanded_1210 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2190 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2193 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2191, %2192 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2190 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2194 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1212, %expanded_1209 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2190 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2195 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1211, %expanded_1210 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2190 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2196 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2194, %2195 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2190 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1213 = tensor.dim %2193, %c1 : tensor<4x?x32x32xf16>
    %2197 = tensor.empty(%dim_1213) : tensor<4x?x32x2x32xf16>
    %2198 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2193, %2196 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2197 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1214 = tensor.collapse_shape %2198 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2199 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1215 = tensor.expand_shape %2199 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2200 = linalg.batch_matmul ins(%expanded_1215, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1216 = linalg.transpose ins(%2200 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2201 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1216 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2202 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2201, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2203 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2202 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2204 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1216 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2205 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2204, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2206 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2205 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1217 = tensor.expand_shape %2203 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1218 = tensor.expand_shape %2206 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1219 = tensor.extract_slice %expanded_1204[0, 0, 0, 0] [4, %dim_1203, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1220 = tensor.extract_slice %expanded_1204[0, 0, 0, 1] [4, %dim_1203, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2207 = tensor.empty(%dim_1203) : tensor<4x?x4x32xf16>
    %2208 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1219, %expanded_1217 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2207 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2209 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1220, %expanded_1218 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2207 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2210 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2208, %2209 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2207 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2211 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1220, %expanded_1217 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2207 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2212 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1219, %expanded_1218 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2207 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2213 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2211, %2212 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2207 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1221 = tensor.dim %2210, %c1 : tensor<4x?x4x32xf16>
    %2214 = tensor.empty(%dim_1221) : tensor<4x?x4x2x32xf16>
    %2215 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2210, %2213 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2214 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1222 = tensor.collapse_shape %2215 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2216 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c14_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %2217 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2216 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1223 = tensor.collapse_shape %2217 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1224 = tensor.dim %2215, %c1 : tensor<4x?x4x2x32xf16>
    %2218 = arith.divsi %dim_1224, %c32 : index
    %expanded_1225 = tensor.expand_shape %collapsed_1222 [[0], [1, 2], [3], [4]] output_shape [4, %2218, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1226 = tensor.collapse_shape %expanded_1225 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2219 = affine.apply #map14()[%2218]
    %2220 = tensor.empty(%2219) : tensor<?x4x32x64xf16>
    %transposed_1227 = linalg.transpose ins(%collapsed_1226 : tensor<?x32x4x64xf16>) outs(%2220 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1228 = tensor.expand_shape %collapsed_1223 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2221 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1227, %expanded_1228 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2077 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2222 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2217 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1229 = tensor.collapse_shape %2222 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %2223 = arith.divsi %dim_1205, %c32 : index
    %expanded_1230 = tensor.expand_shape %2181 [[0], [1, 2], [3, 4]] output_shape [4, %2223, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1231 = tensor.collapse_shape %expanded_1230 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2224 = affine.apply #map14()[%2223]
    %2225 = tensor.empty(%2224) : tensor<?x4x32x64xf16>
    %transposed_1232 = linalg.transpose ins(%collapsed_1231 : tensor<?x32x4x64xf16>) outs(%2225 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1233 = tensor.expand_shape %collapsed_1229 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2226 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1232, %expanded_1233 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2221 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2227 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1222 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1234 = tensor.collapse_shape %2227 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2228 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1206 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1235 = tensor.collapse_shape %2228 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1236 = tensor.dim %2198, %c1 : tensor<4x?x32x2x32xf16>
    %2229 = tensor.empty(%dim_1236) : tensor<4x32x?x64xf16>
    %transposed_1237 = linalg.transpose ins(%collapsed_1214 : tensor<4x?x32x64xf16>) outs(%2229 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2230 = tensor.empty(%dim_1224) : tensor<4x32x?x64xf16>
    %transposed_1238 = linalg.transpose ins(%collapsed_1234 : tensor<4x?x32x64xf16>) outs(%2230 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2231 = tensor.empty(%dim_1205) : tensor<4x32x?x64xf16>
    %transposed_1239 = linalg.transpose ins(%collapsed_1235 : tensor<4x?x32x64xf16>) outs(%2231 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1240 = tensor.collapse_shape %transposed_1237 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1241 = tensor.collapse_shape %transposed_1238 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1242 = tensor.collapse_shape %transposed_1239 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1243 = tensor.dim %transposed_1237, %c2 : tensor<4x32x?x64xf16>
    %2232 = tensor.empty(%dim_1243) : tensor<128x?x64xf16>
    %2233 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1240, %collapsed_1241, %collapsed_1242, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%2232 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1244 = tensor.expand_shape %2233 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1243, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1245 = tensor.dim %expanded_1244, %c2 : tensor<4x32x?x64xf16>
    %2234 = tensor.empty(%dim_1245) : tensor<4x?x32x64xf16>
    %transposed_1246 = linalg.transpose ins(%expanded_1244 : tensor<4x32x?x64xf16>) outs(%2234 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1247 = tensor.collapse_shape %transposed_1246 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2235 = iree_tensor_ext.bitcast %__auto.blk.14.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1248 = tensor.expand_shape %2235 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1249 = tensor.extract_slice %expanded_1248[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2236 = iree_tensor_ext.bitcast %extracted_slice_1249 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1250 = tensor.extract_slice %expanded_1248[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2237 = iree_tensor_ext.bitcast %extracted_slice_1250 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1251 = tensor.dim %collapsed_1247, %c1 : tensor<4x?x2048xf16>
    %2238 = tensor.empty() : tensor<2048x64x32xf16>
    %2239 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2236, %2237 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2238 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1252 = tensor.expand_shape %collapsed_1247 [[0], [1], [2, 3]] output_shape [4, %dim_1251, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2240 = tensor.empty(%dim_1251) : tensor<4x?x2048xf32>
    %2241 = linalg.fill ins(%cst_3 : f32) outs(%2240 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2242 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1252, %2239 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2243 = tensor.empty(%dim_1251) : tensor<4x?x2048xf16>
    %2244 = linalg.copy ins(%2242 : tensor<4x?x2048xf32>) outs(%2243 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2245 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2141, %2244 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2246 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2245 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2247 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2246 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2248 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2247 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2248 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2250 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2249 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2251 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2250 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2252 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2246, %2251 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2253 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2252 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2254 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.ffn_norm.weight, %2253 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2255 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2254 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2256 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1253 = tensor.expand_shape %2256 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1254 = tensor.extract_slice %expanded_1253[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2257 = iree_tensor_ext.bitcast %extracted_slice_1254 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1255 = tensor.extract_slice %expanded_1253[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2258 = iree_tensor_ext.bitcast %extracted_slice_1255 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1256 = tensor.dim %2255, %c1 : tensor<4x?x2048xf16>
    %2259 = tensor.empty() : tensor<5632x64x32xf16>
    %2260 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2257, %2258 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2259 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1257 = tensor.expand_shape %2255 [[0], [1], [2, 3]] output_shape [4, %dim_1256, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2261 = tensor.empty(%dim_1256) : tensor<4x?x5632xf32>
    %2262 = linalg.fill ins(%cst_3 : f32) outs(%2261 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2263 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1257, %2260 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2262 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2264 = tensor.empty(%dim_1256) : tensor<4x?x5632xf16>
    %2265 = linalg.copy ins(%2263 : tensor<4x?x5632xf32>) outs(%2264 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1258 = tensor.dim %2265, %c1 : tensor<4x?x5632xf16>
    %2266 = tensor.empty(%dim_1258) : tensor<4x?x5632xf16>
    %2267 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2265 : tensor<4x?x5632xf16>) outs(%2266 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %2268 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2267, %2265 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2266 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2269 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1259 = tensor.expand_shape %2269 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1260 = tensor.extract_slice %expanded_1259[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2270 = iree_tensor_ext.bitcast %extracted_slice_1260 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1261 = tensor.extract_slice %expanded_1259[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2271 = iree_tensor_ext.bitcast %extracted_slice_1261 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1262 = tensor.dim %2255, %c1 : tensor<4x?x2048xf16>
    %2272 = tensor.empty() : tensor<5632x64x32xf16>
    %2273 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2270, %2271 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2272 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1263 = tensor.expand_shape %2255 [[0], [1], [2, 3]] output_shape [4, %dim_1262, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2274 = tensor.empty(%dim_1262) : tensor<4x?x5632xf32>
    %2275 = linalg.fill ins(%cst_3 : f32) outs(%2274 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2276 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1263, %2273 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2275 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2277 = tensor.empty(%dim_1262) : tensor<4x?x5632xf16>
    %2278 = linalg.copy ins(%2276 : tensor<4x?x5632xf32>) outs(%2277 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2279 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2268, %2278 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2266 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2280 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1264 = tensor.expand_shape %2280 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1265 = tensor.extract_slice %expanded_1264[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2281 = iree_tensor_ext.bitcast %extracted_slice_1265 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1266 = tensor.extract_slice %expanded_1264[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2282 = iree_tensor_ext.bitcast %extracted_slice_1266 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1267 = tensor.dim %2279, %c1 : tensor<4x?x5632xf16>
    %2283 = tensor.empty() : tensor<2048x176x32xf16>
    %2284 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2281, %2282 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2283 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1268 = tensor.expand_shape %2279 [[0], [1], [2, 3]] output_shape [4, %dim_1267, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2285 = tensor.empty(%dim_1267) : tensor<4x?x2048xf32>
    %2286 = linalg.fill ins(%cst_3 : f32) outs(%2285 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2287 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1268, %2284 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2286 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2288 = tensor.empty(%dim_1267) : tensor<4x?x2048xf16>
    %2289 = linalg.copy ins(%2287 : tensor<4x?x2048xf32>) outs(%2288 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2290 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2245, %2289 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2291 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2290 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2291 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2293 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2292 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2294 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2293 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2295 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2294 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2296 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2295 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2297 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2291, %2296 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2298 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2297 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2299 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.attn_norm.weight, %2298 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2300 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2299 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2301 = iree_tensor_ext.bitcast %__auto.blk.15.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1269 = tensor.expand_shape %2301 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1270 = tensor.extract_slice %expanded_1269[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2302 = iree_tensor_ext.bitcast %extracted_slice_1270 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1271 = tensor.extract_slice %expanded_1269[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2303 = iree_tensor_ext.bitcast %extracted_slice_1271 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1272 = tensor.dim %2300, %c1 : tensor<4x?x2048xf16>
    %2304 = tensor.empty() : tensor<2048x64x32xf16>
    %2305 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2302, %2303 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2304 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1273 = tensor.expand_shape %2300 [[0], [1], [2, 3]] output_shape [4, %dim_1272, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2306 = tensor.empty(%dim_1272) : tensor<4x?x2048xf32>
    %2307 = linalg.fill ins(%cst_3 : f32) outs(%2306 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2308 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1273, %2305 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2307 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2309 = tensor.empty(%dim_1272) : tensor<4x?x2048xf16>
    %2310 = linalg.copy ins(%2308 : tensor<4x?x2048xf32>) outs(%2309 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2311 = iree_tensor_ext.bitcast %__auto.blk.15.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1274 = tensor.expand_shape %2311 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1275 = tensor.extract_slice %expanded_1274[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2312 = iree_tensor_ext.bitcast %extracted_slice_1275 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1276 = tensor.extract_slice %expanded_1274[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2313 = iree_tensor_ext.bitcast %extracted_slice_1276 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1277 = tensor.dim %2300, %c1 : tensor<4x?x2048xf16>
    %2314 = tensor.empty() : tensor<256x64x32xf16>
    %2315 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2312, %2313 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2314 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1278 = tensor.expand_shape %2300 [[0], [1], [2, 3]] output_shape [4, %dim_1277, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2316 = tensor.empty(%dim_1277) : tensor<4x?x256xf32>
    %2317 = linalg.fill ins(%cst_3 : f32) outs(%2316 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2318 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1278, %2315 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2317 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2319 = tensor.empty(%dim_1277) : tensor<4x?x256xf16>
    %2320 = linalg.copy ins(%2318 : tensor<4x?x256xf32>) outs(%2319 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2321 = iree_tensor_ext.bitcast %__auto.blk.15.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1279 = tensor.expand_shape %2321 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1280 = tensor.extract_slice %expanded_1279[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2322 = iree_tensor_ext.bitcast %extracted_slice_1280 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1281 = tensor.extract_slice %expanded_1279[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2323 = iree_tensor_ext.bitcast %extracted_slice_1281 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1282 = tensor.dim %2300, %c1 : tensor<4x?x2048xf16>
    %2324 = tensor.empty() : tensor<256x64x32xf16>
    %2325 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2322, %2323 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2324 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1283 = tensor.expand_shape %2300 [[0], [1], [2, 3]] output_shape [4, %dim_1282, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2326 = tensor.empty(%dim_1282) : tensor<4x?x256xf32>
    %2327 = linalg.fill ins(%cst_3 : f32) outs(%2326 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2328 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1283, %2325 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2327 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2329 = tensor.empty(%dim_1282) : tensor<4x?x256xf16>
    %2330 = linalg.copy ins(%2328 : tensor<4x?x256xf32>) outs(%2329 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1284 = tensor.dim %2310, %c1 : tensor<4x?x2048xf16>
    %expanded_1285 = tensor.expand_shape %2310 [[0], [1], [2, 3]] output_shape [4, %dim_1284, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1286 = tensor.dim %2320, %c1 : tensor<4x?x256xf16>
    %expanded_1287 = tensor.expand_shape %2320 [[0], [1], [2, 3]] output_shape [4, %dim_1286, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1288 = tensor.dim %2330, %c1 : tensor<4x?x256xf16>
    %expanded_1289 = tensor.expand_shape %2330 [[0], [1], [2, 3]] output_shape [4, %dim_1288, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2331 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1290 = tensor.expand_shape %2331 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2332 = linalg.batch_matmul ins(%expanded_1290, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1291 = linalg.transpose ins(%2332 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2333 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1291 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2334 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2333, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2335 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2334 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2336 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1291 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2337 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2336, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2338 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2337 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1292 = tensor.expand_shape %2335 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1293 = tensor.expand_shape %2338 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1294 = tensor.extract_slice %expanded_1285[0, 0, 0, 0] [4, %dim_1284, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1295 = tensor.extract_slice %expanded_1285[0, 0, 0, 1] [4, %dim_1284, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2339 = tensor.empty(%dim_1284) : tensor<4x?x32x32xf16>
    %2340 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1294, %expanded_1292 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2339 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2341 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1295, %expanded_1293 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2339 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2342 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2340, %2341 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2339 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2343 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1295, %expanded_1292 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2339 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2344 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1294, %expanded_1293 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2339 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2345 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2343, %2344 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2339 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1296 = tensor.dim %2342, %c1 : tensor<4x?x32x32xf16>
    %2346 = tensor.empty(%dim_1296) : tensor<4x?x32x2x32xf16>
    %2347 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2342, %2345 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2346 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1297 = tensor.collapse_shape %2347 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2348 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1298 = tensor.expand_shape %2348 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2349 = linalg.batch_matmul ins(%expanded_1298, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1299 = linalg.transpose ins(%2349 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2350 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1299 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2351 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2350, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2352 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2351 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2353 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1299 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2354 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2353, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2355 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2354 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1300 = tensor.expand_shape %2352 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1301 = tensor.expand_shape %2355 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1302 = tensor.extract_slice %expanded_1287[0, 0, 0, 0] [4, %dim_1286, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1303 = tensor.extract_slice %expanded_1287[0, 0, 0, 1] [4, %dim_1286, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2356 = tensor.empty(%dim_1286) : tensor<4x?x4x32xf16>
    %2357 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1302, %expanded_1300 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2356 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2358 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1303, %expanded_1301 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2356 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2359 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2357, %2358 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2356 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2360 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1303, %expanded_1300 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2356 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2361 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1302, %expanded_1301 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2356 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2362 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2360, %2361 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2356 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1304 = tensor.dim %2359, %c1 : tensor<4x?x4x32xf16>
    %2363 = tensor.empty(%dim_1304) : tensor<4x?x4x2x32xf16>
    %2364 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2359, %2362 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2363 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1305 = tensor.collapse_shape %2364 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2365 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c15_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %2366 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2365 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1306 = tensor.collapse_shape %2366 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1307 = tensor.dim %2364, %c1 : tensor<4x?x4x2x32xf16>
    %2367 = arith.divsi %dim_1307, %c32 : index
    %expanded_1308 = tensor.expand_shape %collapsed_1305 [[0], [1, 2], [3], [4]] output_shape [4, %2367, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1309 = tensor.collapse_shape %expanded_1308 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2368 = affine.apply #map14()[%2367]
    %2369 = tensor.empty(%2368) : tensor<?x4x32x64xf16>
    %transposed_1310 = linalg.transpose ins(%collapsed_1309 : tensor<?x32x4x64xf16>) outs(%2369 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1311 = tensor.expand_shape %collapsed_1306 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2370 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1310, %expanded_1311 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2226 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2371 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2366 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1312 = tensor.collapse_shape %2371 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %2372 = arith.divsi %dim_1288, %c32 : index
    %expanded_1313 = tensor.expand_shape %2330 [[0], [1, 2], [3, 4]] output_shape [4, %2372, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1314 = tensor.collapse_shape %expanded_1313 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2373 = affine.apply #map14()[%2372]
    %2374 = tensor.empty(%2373) : tensor<?x4x32x64xf16>
    %transposed_1315 = linalg.transpose ins(%collapsed_1314 : tensor<?x32x4x64xf16>) outs(%2374 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1316 = tensor.expand_shape %collapsed_1312 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2375 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1315, %expanded_1316 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2370 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2376 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1305 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1317 = tensor.collapse_shape %2376 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2377 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1289 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1318 = tensor.collapse_shape %2377 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1319 = tensor.dim %2347, %c1 : tensor<4x?x32x2x32xf16>
    %2378 = tensor.empty(%dim_1319) : tensor<4x32x?x64xf16>
    %transposed_1320 = linalg.transpose ins(%collapsed_1297 : tensor<4x?x32x64xf16>) outs(%2378 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2379 = tensor.empty(%dim_1307) : tensor<4x32x?x64xf16>
    %transposed_1321 = linalg.transpose ins(%collapsed_1317 : tensor<4x?x32x64xf16>) outs(%2379 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2380 = tensor.empty(%dim_1288) : tensor<4x32x?x64xf16>
    %transposed_1322 = linalg.transpose ins(%collapsed_1318 : tensor<4x?x32x64xf16>) outs(%2380 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1323 = tensor.collapse_shape %transposed_1320 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1324 = tensor.collapse_shape %transposed_1321 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1325 = tensor.collapse_shape %transposed_1322 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1326 = tensor.dim %transposed_1320, %c2 : tensor<4x32x?x64xf16>
    %2381 = tensor.empty(%dim_1326) : tensor<128x?x64xf16>
    %2382 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1323, %collapsed_1324, %collapsed_1325, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%2381 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1327 = tensor.expand_shape %2382 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1326, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1328 = tensor.dim %expanded_1327, %c2 : tensor<4x32x?x64xf16>
    %2383 = tensor.empty(%dim_1328) : tensor<4x?x32x64xf16>
    %transposed_1329 = linalg.transpose ins(%expanded_1327 : tensor<4x32x?x64xf16>) outs(%2383 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1330 = tensor.collapse_shape %transposed_1329 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2384 = iree_tensor_ext.bitcast %__auto.blk.15.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1331 = tensor.expand_shape %2384 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1332 = tensor.extract_slice %expanded_1331[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2385 = iree_tensor_ext.bitcast %extracted_slice_1332 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1333 = tensor.extract_slice %expanded_1331[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2386 = iree_tensor_ext.bitcast %extracted_slice_1333 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1334 = tensor.dim %collapsed_1330, %c1 : tensor<4x?x2048xf16>
    %2387 = tensor.empty() : tensor<2048x64x32xf16>
    %2388 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2385, %2386 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2387 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1335 = tensor.expand_shape %collapsed_1330 [[0], [1], [2, 3]] output_shape [4, %dim_1334, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2389 = tensor.empty(%dim_1334) : tensor<4x?x2048xf32>
    %2390 = linalg.fill ins(%cst_3 : f32) outs(%2389 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2391 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1335, %2388 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2390 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2392 = tensor.empty(%dim_1334) : tensor<4x?x2048xf16>
    %2393 = linalg.copy ins(%2391 : tensor<4x?x2048xf32>) outs(%2392 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2394 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2290, %2393 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2395 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2394 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2396 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2395 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2397 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2396 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2398 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2397 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2399 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2398 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2400 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2399 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2401 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2395, %2400 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2402 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2401 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2403 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.ffn_norm.weight, %2402 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2404 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2403 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2405 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1336 = tensor.expand_shape %2405 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1337 = tensor.extract_slice %expanded_1336[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2406 = iree_tensor_ext.bitcast %extracted_slice_1337 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1338 = tensor.extract_slice %expanded_1336[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2407 = iree_tensor_ext.bitcast %extracted_slice_1338 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1339 = tensor.dim %2404, %c1 : tensor<4x?x2048xf16>
    %2408 = tensor.empty() : tensor<5632x64x32xf16>
    %2409 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2406, %2407 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2408 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1340 = tensor.expand_shape %2404 [[0], [1], [2, 3]] output_shape [4, %dim_1339, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2410 = tensor.empty(%dim_1339) : tensor<4x?x5632xf32>
    %2411 = linalg.fill ins(%cst_3 : f32) outs(%2410 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2412 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1340, %2409 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2411 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2413 = tensor.empty(%dim_1339) : tensor<4x?x5632xf16>
    %2414 = linalg.copy ins(%2412 : tensor<4x?x5632xf32>) outs(%2413 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1341 = tensor.dim %2414, %c1 : tensor<4x?x5632xf16>
    %2415 = tensor.empty(%dim_1341) : tensor<4x?x5632xf16>
    %2416 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2414 : tensor<4x?x5632xf16>) outs(%2415 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %2417 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2416, %2414 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2415 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2418 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1342 = tensor.expand_shape %2418 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1343 = tensor.extract_slice %expanded_1342[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2419 = iree_tensor_ext.bitcast %extracted_slice_1343 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1344 = tensor.extract_slice %expanded_1342[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2420 = iree_tensor_ext.bitcast %extracted_slice_1344 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1345 = tensor.dim %2404, %c1 : tensor<4x?x2048xf16>
    %2421 = tensor.empty() : tensor<5632x64x32xf16>
    %2422 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2419, %2420 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2421 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1346 = tensor.expand_shape %2404 [[0], [1], [2, 3]] output_shape [4, %dim_1345, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2423 = tensor.empty(%dim_1345) : tensor<4x?x5632xf32>
    %2424 = linalg.fill ins(%cst_3 : f32) outs(%2423 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2425 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1346, %2422 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2424 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2426 = tensor.empty(%dim_1345) : tensor<4x?x5632xf16>
    %2427 = linalg.copy ins(%2425 : tensor<4x?x5632xf32>) outs(%2426 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2428 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2417, %2427 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2415 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2429 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1347 = tensor.expand_shape %2429 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1348 = tensor.extract_slice %expanded_1347[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2430 = iree_tensor_ext.bitcast %extracted_slice_1348 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1349 = tensor.extract_slice %expanded_1347[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2431 = iree_tensor_ext.bitcast %extracted_slice_1349 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1350 = tensor.dim %2428, %c1 : tensor<4x?x5632xf16>
    %2432 = tensor.empty() : tensor<2048x176x32xf16>
    %2433 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2430, %2431 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2432 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1351 = tensor.expand_shape %2428 [[0], [1], [2, 3]] output_shape [4, %dim_1350, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2434 = tensor.empty(%dim_1350) : tensor<4x?x2048xf32>
    %2435 = linalg.fill ins(%cst_3 : f32) outs(%2434 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2436 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1351, %2433 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2435 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2437 = tensor.empty(%dim_1350) : tensor<4x?x2048xf16>
    %2438 = linalg.copy ins(%2436 : tensor<4x?x2048xf32>) outs(%2437 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2439 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2394, %2438 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2440 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2439 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2441 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2440 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2442 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2441 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2443 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2442 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2444 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2443 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2445 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2444 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2446 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2440, %2445 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2447 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2446 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2448 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.attn_norm.weight, %2447 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2449 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2448 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2450 = iree_tensor_ext.bitcast %__auto.blk.16.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1352 = tensor.expand_shape %2450 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1353 = tensor.extract_slice %expanded_1352[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2451 = iree_tensor_ext.bitcast %extracted_slice_1353 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1354 = tensor.extract_slice %expanded_1352[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2452 = iree_tensor_ext.bitcast %extracted_slice_1354 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1355 = tensor.dim %2449, %c1 : tensor<4x?x2048xf16>
    %2453 = tensor.empty() : tensor<2048x64x32xf16>
    %2454 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2451, %2452 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2453 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1356 = tensor.expand_shape %2449 [[0], [1], [2, 3]] output_shape [4, %dim_1355, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2455 = tensor.empty(%dim_1355) : tensor<4x?x2048xf32>
    %2456 = linalg.fill ins(%cst_3 : f32) outs(%2455 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2457 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1356, %2454 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2456 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2458 = tensor.empty(%dim_1355) : tensor<4x?x2048xf16>
    %2459 = linalg.copy ins(%2457 : tensor<4x?x2048xf32>) outs(%2458 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2460 = iree_tensor_ext.bitcast %__auto.blk.16.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1357 = tensor.expand_shape %2460 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1358 = tensor.extract_slice %expanded_1357[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2461 = iree_tensor_ext.bitcast %extracted_slice_1358 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1359 = tensor.extract_slice %expanded_1357[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2462 = iree_tensor_ext.bitcast %extracted_slice_1359 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1360 = tensor.dim %2449, %c1 : tensor<4x?x2048xf16>
    %2463 = tensor.empty() : tensor<256x64x32xf16>
    %2464 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2461, %2462 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2463 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1361 = tensor.expand_shape %2449 [[0], [1], [2, 3]] output_shape [4, %dim_1360, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2465 = tensor.empty(%dim_1360) : tensor<4x?x256xf32>
    %2466 = linalg.fill ins(%cst_3 : f32) outs(%2465 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2467 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1361, %2464 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2466 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2468 = tensor.empty(%dim_1360) : tensor<4x?x256xf16>
    %2469 = linalg.copy ins(%2467 : tensor<4x?x256xf32>) outs(%2468 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2470 = iree_tensor_ext.bitcast %__auto.blk.16.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1362 = tensor.expand_shape %2470 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1363 = tensor.extract_slice %expanded_1362[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2471 = iree_tensor_ext.bitcast %extracted_slice_1363 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1364 = tensor.extract_slice %expanded_1362[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2472 = iree_tensor_ext.bitcast %extracted_slice_1364 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1365 = tensor.dim %2449, %c1 : tensor<4x?x2048xf16>
    %2473 = tensor.empty() : tensor<256x64x32xf16>
    %2474 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2471, %2472 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2473 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1366 = tensor.expand_shape %2449 [[0], [1], [2, 3]] output_shape [4, %dim_1365, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2475 = tensor.empty(%dim_1365) : tensor<4x?x256xf32>
    %2476 = linalg.fill ins(%cst_3 : f32) outs(%2475 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2477 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1366, %2474 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2476 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2478 = tensor.empty(%dim_1365) : tensor<4x?x256xf16>
    %2479 = linalg.copy ins(%2477 : tensor<4x?x256xf32>) outs(%2478 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1367 = tensor.dim %2459, %c1 : tensor<4x?x2048xf16>
    %expanded_1368 = tensor.expand_shape %2459 [[0], [1], [2, 3]] output_shape [4, %dim_1367, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1369 = tensor.dim %2469, %c1 : tensor<4x?x256xf16>
    %expanded_1370 = tensor.expand_shape %2469 [[0], [1], [2, 3]] output_shape [4, %dim_1369, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1371 = tensor.dim %2479, %c1 : tensor<4x?x256xf16>
    %expanded_1372 = tensor.expand_shape %2479 [[0], [1], [2, 3]] output_shape [4, %dim_1371, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2480 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1373 = tensor.expand_shape %2480 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2481 = linalg.batch_matmul ins(%expanded_1373, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1374 = linalg.transpose ins(%2481 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2482 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1374 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2483 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2482, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2484 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2483 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2485 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1374 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2486 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2485, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2487 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2486 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1375 = tensor.expand_shape %2484 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1376 = tensor.expand_shape %2487 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1377 = tensor.extract_slice %expanded_1368[0, 0, 0, 0] [4, %dim_1367, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1378 = tensor.extract_slice %expanded_1368[0, 0, 0, 1] [4, %dim_1367, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2488 = tensor.empty(%dim_1367) : tensor<4x?x32x32xf16>
    %2489 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1377, %expanded_1375 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2488 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2490 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1378, %expanded_1376 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2488 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2491 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2489, %2490 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2488 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2492 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1378, %expanded_1375 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2488 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2493 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1377, %expanded_1376 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2488 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2494 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2492, %2493 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2488 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1379 = tensor.dim %2491, %c1 : tensor<4x?x32x32xf16>
    %2495 = tensor.empty(%dim_1379) : tensor<4x?x32x2x32xf16>
    %2496 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2491, %2494 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2495 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1380 = tensor.collapse_shape %2496 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2497 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1381 = tensor.expand_shape %2497 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2498 = linalg.batch_matmul ins(%expanded_1381, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1382 = linalg.transpose ins(%2498 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2499 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1382 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2500 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2499, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2501 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2500 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2502 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1382 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2503 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2502, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2504 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2503 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1383 = tensor.expand_shape %2501 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1384 = tensor.expand_shape %2504 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1385 = tensor.extract_slice %expanded_1370[0, 0, 0, 0] [4, %dim_1369, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1386 = tensor.extract_slice %expanded_1370[0, 0, 0, 1] [4, %dim_1369, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2505 = tensor.empty(%dim_1369) : tensor<4x?x4x32xf16>
    %2506 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1385, %expanded_1383 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2505 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2507 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1386, %expanded_1384 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2505 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2508 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2506, %2507 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2505 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2509 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1386, %expanded_1383 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2505 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2510 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1385, %expanded_1384 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2505 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2511 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2509, %2510 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2505 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1387 = tensor.dim %2508, %c1 : tensor<4x?x4x32xf16>
    %2512 = tensor.empty(%dim_1387) : tensor<4x?x4x2x32xf16>
    %2513 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2508, %2511 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2512 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1388 = tensor.collapse_shape %2513 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2514 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c16_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %2515 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2514 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1389 = tensor.collapse_shape %2515 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1390 = tensor.dim %2513, %c1 : tensor<4x?x4x2x32xf16>
    %2516 = arith.divsi %dim_1390, %c32 : index
    %expanded_1391 = tensor.expand_shape %collapsed_1388 [[0], [1, 2], [3], [4]] output_shape [4, %2516, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1392 = tensor.collapse_shape %expanded_1391 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2517 = affine.apply #map14()[%2516]
    %2518 = tensor.empty(%2517) : tensor<?x4x32x64xf16>
    %transposed_1393 = linalg.transpose ins(%collapsed_1392 : tensor<?x32x4x64xf16>) outs(%2518 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1394 = tensor.expand_shape %collapsed_1389 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2519 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1393, %expanded_1394 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2375 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2520 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2515 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1395 = tensor.collapse_shape %2520 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %2521 = arith.divsi %dim_1371, %c32 : index
    %expanded_1396 = tensor.expand_shape %2479 [[0], [1, 2], [3, 4]] output_shape [4, %2521, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1397 = tensor.collapse_shape %expanded_1396 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2522 = affine.apply #map14()[%2521]
    %2523 = tensor.empty(%2522) : tensor<?x4x32x64xf16>
    %transposed_1398 = linalg.transpose ins(%collapsed_1397 : tensor<?x32x4x64xf16>) outs(%2523 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1399 = tensor.expand_shape %collapsed_1395 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2524 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1398, %expanded_1399 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2519 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2525 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1388 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1400 = tensor.collapse_shape %2525 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2526 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1372 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1401 = tensor.collapse_shape %2526 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1402 = tensor.dim %2496, %c1 : tensor<4x?x32x2x32xf16>
    %2527 = tensor.empty(%dim_1402) : tensor<4x32x?x64xf16>
    %transposed_1403 = linalg.transpose ins(%collapsed_1380 : tensor<4x?x32x64xf16>) outs(%2527 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2528 = tensor.empty(%dim_1390) : tensor<4x32x?x64xf16>
    %transposed_1404 = linalg.transpose ins(%collapsed_1400 : tensor<4x?x32x64xf16>) outs(%2528 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2529 = tensor.empty(%dim_1371) : tensor<4x32x?x64xf16>
    %transposed_1405 = linalg.transpose ins(%collapsed_1401 : tensor<4x?x32x64xf16>) outs(%2529 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1406 = tensor.collapse_shape %transposed_1403 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1407 = tensor.collapse_shape %transposed_1404 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1408 = tensor.collapse_shape %transposed_1405 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1409 = tensor.dim %transposed_1403, %c2 : tensor<4x32x?x64xf16>
    %2530 = tensor.empty(%dim_1409) : tensor<128x?x64xf16>
    %2531 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1406, %collapsed_1407, %collapsed_1408, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%2530 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1410 = tensor.expand_shape %2531 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1409, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1411 = tensor.dim %expanded_1410, %c2 : tensor<4x32x?x64xf16>
    %2532 = tensor.empty(%dim_1411) : tensor<4x?x32x64xf16>
    %transposed_1412 = linalg.transpose ins(%expanded_1410 : tensor<4x32x?x64xf16>) outs(%2532 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1413 = tensor.collapse_shape %transposed_1412 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2533 = iree_tensor_ext.bitcast %__auto.blk.16.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1414 = tensor.expand_shape %2533 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1415 = tensor.extract_slice %expanded_1414[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2534 = iree_tensor_ext.bitcast %extracted_slice_1415 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1416 = tensor.extract_slice %expanded_1414[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2535 = iree_tensor_ext.bitcast %extracted_slice_1416 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1417 = tensor.dim %collapsed_1413, %c1 : tensor<4x?x2048xf16>
    %2536 = tensor.empty() : tensor<2048x64x32xf16>
    %2537 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2534, %2535 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2536 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1418 = tensor.expand_shape %collapsed_1413 [[0], [1], [2, 3]] output_shape [4, %dim_1417, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2538 = tensor.empty(%dim_1417) : tensor<4x?x2048xf32>
    %2539 = linalg.fill ins(%cst_3 : f32) outs(%2538 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2540 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1418, %2537 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2539 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2541 = tensor.empty(%dim_1417) : tensor<4x?x2048xf16>
    %2542 = linalg.copy ins(%2540 : tensor<4x?x2048xf32>) outs(%2541 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2543 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2439, %2542 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2544 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2543 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2545 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2544 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2546 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2545 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2547 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2546 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2548 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2547 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2549 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2548 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2550 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2544, %2549 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2551 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2550 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2552 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.ffn_norm.weight, %2551 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2553 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2552 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2554 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1419 = tensor.expand_shape %2554 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1420 = tensor.extract_slice %expanded_1419[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2555 = iree_tensor_ext.bitcast %extracted_slice_1420 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1421 = tensor.extract_slice %expanded_1419[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2556 = iree_tensor_ext.bitcast %extracted_slice_1421 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1422 = tensor.dim %2553, %c1 : tensor<4x?x2048xf16>
    %2557 = tensor.empty() : tensor<5632x64x32xf16>
    %2558 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2555, %2556 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2557 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1423 = tensor.expand_shape %2553 [[0], [1], [2, 3]] output_shape [4, %dim_1422, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2559 = tensor.empty(%dim_1422) : tensor<4x?x5632xf32>
    %2560 = linalg.fill ins(%cst_3 : f32) outs(%2559 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2561 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1423, %2558 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2560 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2562 = tensor.empty(%dim_1422) : tensor<4x?x5632xf16>
    %2563 = linalg.copy ins(%2561 : tensor<4x?x5632xf32>) outs(%2562 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1424 = tensor.dim %2563, %c1 : tensor<4x?x5632xf16>
    %2564 = tensor.empty(%dim_1424) : tensor<4x?x5632xf16>
    %2565 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2563 : tensor<4x?x5632xf16>) outs(%2564 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %2566 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2565, %2563 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2564 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2567 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1425 = tensor.expand_shape %2567 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1426 = tensor.extract_slice %expanded_1425[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2568 = iree_tensor_ext.bitcast %extracted_slice_1426 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1427 = tensor.extract_slice %expanded_1425[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2569 = iree_tensor_ext.bitcast %extracted_slice_1427 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1428 = tensor.dim %2553, %c1 : tensor<4x?x2048xf16>
    %2570 = tensor.empty() : tensor<5632x64x32xf16>
    %2571 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2568, %2569 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2570 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1429 = tensor.expand_shape %2553 [[0], [1], [2, 3]] output_shape [4, %dim_1428, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2572 = tensor.empty(%dim_1428) : tensor<4x?x5632xf32>
    %2573 = linalg.fill ins(%cst_3 : f32) outs(%2572 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2574 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1429, %2571 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2573 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2575 = tensor.empty(%dim_1428) : tensor<4x?x5632xf16>
    %2576 = linalg.copy ins(%2574 : tensor<4x?x5632xf32>) outs(%2575 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2577 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2566, %2576 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2564 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2578 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1430 = tensor.expand_shape %2578 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1431 = tensor.extract_slice %expanded_1430[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2579 = iree_tensor_ext.bitcast %extracted_slice_1431 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1432 = tensor.extract_slice %expanded_1430[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2580 = iree_tensor_ext.bitcast %extracted_slice_1432 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1433 = tensor.dim %2577, %c1 : tensor<4x?x5632xf16>
    %2581 = tensor.empty() : tensor<2048x176x32xf16>
    %2582 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2579, %2580 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2581 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1434 = tensor.expand_shape %2577 [[0], [1], [2, 3]] output_shape [4, %dim_1433, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2583 = tensor.empty(%dim_1433) : tensor<4x?x2048xf32>
    %2584 = linalg.fill ins(%cst_3 : f32) outs(%2583 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2585 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1434, %2582 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2584 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2586 = tensor.empty(%dim_1433) : tensor<4x?x2048xf16>
    %2587 = linalg.copy ins(%2585 : tensor<4x?x2048xf32>) outs(%2586 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2588 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2543, %2587 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2589 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2588 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2590 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2589 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2591 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2590 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2592 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2591 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2593 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2592 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2594 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2593 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2595 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2589, %2594 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2596 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2595 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2597 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.attn_norm.weight, %2596 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2598 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2597 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2599 = iree_tensor_ext.bitcast %__auto.blk.17.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1435 = tensor.expand_shape %2599 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1436 = tensor.extract_slice %expanded_1435[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2600 = iree_tensor_ext.bitcast %extracted_slice_1436 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1437 = tensor.extract_slice %expanded_1435[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2601 = iree_tensor_ext.bitcast %extracted_slice_1437 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1438 = tensor.dim %2598, %c1 : tensor<4x?x2048xf16>
    %2602 = tensor.empty() : tensor<2048x64x32xf16>
    %2603 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2600, %2601 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2602 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1439 = tensor.expand_shape %2598 [[0], [1], [2, 3]] output_shape [4, %dim_1438, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2604 = tensor.empty(%dim_1438) : tensor<4x?x2048xf32>
    %2605 = linalg.fill ins(%cst_3 : f32) outs(%2604 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2606 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1439, %2603 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2605 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2607 = tensor.empty(%dim_1438) : tensor<4x?x2048xf16>
    %2608 = linalg.copy ins(%2606 : tensor<4x?x2048xf32>) outs(%2607 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2609 = iree_tensor_ext.bitcast %__auto.blk.17.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1440 = tensor.expand_shape %2609 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1441 = tensor.extract_slice %expanded_1440[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2610 = iree_tensor_ext.bitcast %extracted_slice_1441 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1442 = tensor.extract_slice %expanded_1440[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2611 = iree_tensor_ext.bitcast %extracted_slice_1442 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1443 = tensor.dim %2598, %c1 : tensor<4x?x2048xf16>
    %2612 = tensor.empty() : tensor<256x64x32xf16>
    %2613 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2610, %2611 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2612 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1444 = tensor.expand_shape %2598 [[0], [1], [2, 3]] output_shape [4, %dim_1443, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2614 = tensor.empty(%dim_1443) : tensor<4x?x256xf32>
    %2615 = linalg.fill ins(%cst_3 : f32) outs(%2614 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2616 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1444, %2613 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2615 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2617 = tensor.empty(%dim_1443) : tensor<4x?x256xf16>
    %2618 = linalg.copy ins(%2616 : tensor<4x?x256xf32>) outs(%2617 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2619 = iree_tensor_ext.bitcast %__auto.blk.17.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1445 = tensor.expand_shape %2619 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1446 = tensor.extract_slice %expanded_1445[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2620 = iree_tensor_ext.bitcast %extracted_slice_1446 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1447 = tensor.extract_slice %expanded_1445[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2621 = iree_tensor_ext.bitcast %extracted_slice_1447 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1448 = tensor.dim %2598, %c1 : tensor<4x?x2048xf16>
    %2622 = tensor.empty() : tensor<256x64x32xf16>
    %2623 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2620, %2621 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2622 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1449 = tensor.expand_shape %2598 [[0], [1], [2, 3]] output_shape [4, %dim_1448, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2624 = tensor.empty(%dim_1448) : tensor<4x?x256xf32>
    %2625 = linalg.fill ins(%cst_3 : f32) outs(%2624 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2626 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1449, %2623 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2625 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2627 = tensor.empty(%dim_1448) : tensor<4x?x256xf16>
    %2628 = linalg.copy ins(%2626 : tensor<4x?x256xf32>) outs(%2627 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1450 = tensor.dim %2608, %c1 : tensor<4x?x2048xf16>
    %expanded_1451 = tensor.expand_shape %2608 [[0], [1], [2, 3]] output_shape [4, %dim_1450, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1452 = tensor.dim %2618, %c1 : tensor<4x?x256xf16>
    %expanded_1453 = tensor.expand_shape %2618 [[0], [1], [2, 3]] output_shape [4, %dim_1452, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1454 = tensor.dim %2628, %c1 : tensor<4x?x256xf16>
    %expanded_1455 = tensor.expand_shape %2628 [[0], [1], [2, 3]] output_shape [4, %dim_1454, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2629 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1456 = tensor.expand_shape %2629 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2630 = linalg.batch_matmul ins(%expanded_1456, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1457 = linalg.transpose ins(%2630 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2631 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1457 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2632 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2631, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2633 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2632 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2634 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1457 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2635 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2634, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2636 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2635 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1458 = tensor.expand_shape %2633 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1459 = tensor.expand_shape %2636 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1460 = tensor.extract_slice %expanded_1451[0, 0, 0, 0] [4, %dim_1450, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1461 = tensor.extract_slice %expanded_1451[0, 0, 0, 1] [4, %dim_1450, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2637 = tensor.empty(%dim_1450) : tensor<4x?x32x32xf16>
    %2638 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1460, %expanded_1458 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2637 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2639 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1461, %expanded_1459 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2637 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2640 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2638, %2639 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2637 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2641 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1461, %expanded_1458 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2637 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2642 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1460, %expanded_1459 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2637 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2643 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2641, %2642 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2637 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1462 = tensor.dim %2640, %c1 : tensor<4x?x32x32xf16>
    %2644 = tensor.empty(%dim_1462) : tensor<4x?x32x2x32xf16>
    %2645 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2640, %2643 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2644 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1463 = tensor.collapse_shape %2645 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2646 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1464 = tensor.expand_shape %2646 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2647 = linalg.batch_matmul ins(%expanded_1464, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1465 = linalg.transpose ins(%2647 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2648 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1465 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2649 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2648, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2650 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2649 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2651 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1465 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2652 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2651, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2653 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2652 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1466 = tensor.expand_shape %2650 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1467 = tensor.expand_shape %2653 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1468 = tensor.extract_slice %expanded_1453[0, 0, 0, 0] [4, %dim_1452, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1469 = tensor.extract_slice %expanded_1453[0, 0, 0, 1] [4, %dim_1452, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2654 = tensor.empty(%dim_1452) : tensor<4x?x4x32xf16>
    %2655 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1468, %expanded_1466 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2654 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2656 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1469, %expanded_1467 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2654 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2657 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2655, %2656 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2654 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2658 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1469, %expanded_1466 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2654 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2659 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1468, %expanded_1467 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2654 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2660 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2658, %2659 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2654 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1470 = tensor.dim %2657, %c1 : tensor<4x?x4x32xf16>
    %2661 = tensor.empty(%dim_1470) : tensor<4x?x4x2x32xf16>
    %2662 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2657, %2660 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2661 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1471 = tensor.collapse_shape %2662 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2663 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c17_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %2664 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2663 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1472 = tensor.collapse_shape %2664 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1473 = tensor.dim %2662, %c1 : tensor<4x?x4x2x32xf16>
    %2665 = arith.divsi %dim_1473, %c32 : index
    %expanded_1474 = tensor.expand_shape %collapsed_1471 [[0], [1, 2], [3], [4]] output_shape [4, %2665, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1475 = tensor.collapse_shape %expanded_1474 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2666 = affine.apply #map14()[%2665]
    %2667 = tensor.empty(%2666) : tensor<?x4x32x64xf16>
    %transposed_1476 = linalg.transpose ins(%collapsed_1475 : tensor<?x32x4x64xf16>) outs(%2667 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1477 = tensor.expand_shape %collapsed_1472 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2668 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1476, %expanded_1477 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2524 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2669 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2664 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1478 = tensor.collapse_shape %2669 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %2670 = arith.divsi %dim_1454, %c32 : index
    %expanded_1479 = tensor.expand_shape %2628 [[0], [1, 2], [3, 4]] output_shape [4, %2670, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1480 = tensor.collapse_shape %expanded_1479 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2671 = affine.apply #map14()[%2670]
    %2672 = tensor.empty(%2671) : tensor<?x4x32x64xf16>
    %transposed_1481 = linalg.transpose ins(%collapsed_1480 : tensor<?x32x4x64xf16>) outs(%2672 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1482 = tensor.expand_shape %collapsed_1478 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2673 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1481, %expanded_1482 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2668 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2674 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1471 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1483 = tensor.collapse_shape %2674 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2675 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1455 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1484 = tensor.collapse_shape %2675 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1485 = tensor.dim %2645, %c1 : tensor<4x?x32x2x32xf16>
    %2676 = tensor.empty(%dim_1485) : tensor<4x32x?x64xf16>
    %transposed_1486 = linalg.transpose ins(%collapsed_1463 : tensor<4x?x32x64xf16>) outs(%2676 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2677 = tensor.empty(%dim_1473) : tensor<4x32x?x64xf16>
    %transposed_1487 = linalg.transpose ins(%collapsed_1483 : tensor<4x?x32x64xf16>) outs(%2677 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2678 = tensor.empty(%dim_1454) : tensor<4x32x?x64xf16>
    %transposed_1488 = linalg.transpose ins(%collapsed_1484 : tensor<4x?x32x64xf16>) outs(%2678 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1489 = tensor.collapse_shape %transposed_1486 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1490 = tensor.collapse_shape %transposed_1487 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1491 = tensor.collapse_shape %transposed_1488 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1492 = tensor.dim %transposed_1486, %c2 : tensor<4x32x?x64xf16>
    %2679 = tensor.empty(%dim_1492) : tensor<128x?x64xf16>
    %2680 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1489, %collapsed_1490, %collapsed_1491, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%2679 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1493 = tensor.expand_shape %2680 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1492, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1494 = tensor.dim %expanded_1493, %c2 : tensor<4x32x?x64xf16>
    %2681 = tensor.empty(%dim_1494) : tensor<4x?x32x64xf16>
    %transposed_1495 = linalg.transpose ins(%expanded_1493 : tensor<4x32x?x64xf16>) outs(%2681 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1496 = tensor.collapse_shape %transposed_1495 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2682 = iree_tensor_ext.bitcast %__auto.blk.17.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1497 = tensor.expand_shape %2682 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1498 = tensor.extract_slice %expanded_1497[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2683 = iree_tensor_ext.bitcast %extracted_slice_1498 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1499 = tensor.extract_slice %expanded_1497[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2684 = iree_tensor_ext.bitcast %extracted_slice_1499 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1500 = tensor.dim %collapsed_1496, %c1 : tensor<4x?x2048xf16>
    %2685 = tensor.empty() : tensor<2048x64x32xf16>
    %2686 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2683, %2684 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2685 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1501 = tensor.expand_shape %collapsed_1496 [[0], [1], [2, 3]] output_shape [4, %dim_1500, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2687 = tensor.empty(%dim_1500) : tensor<4x?x2048xf32>
    %2688 = linalg.fill ins(%cst_3 : f32) outs(%2687 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2689 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1501, %2686 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2688 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2690 = tensor.empty(%dim_1500) : tensor<4x?x2048xf16>
    %2691 = linalg.copy ins(%2689 : tensor<4x?x2048xf32>) outs(%2690 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2692 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2588, %2691 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2693 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2692 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2694 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2693 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2695 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2694 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2696 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2695 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2697 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2696 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2698 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2697 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2699 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2693, %2698 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2700 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2699 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2701 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.ffn_norm.weight, %2700 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2702 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2701 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2703 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1502 = tensor.expand_shape %2703 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1503 = tensor.extract_slice %expanded_1502[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2704 = iree_tensor_ext.bitcast %extracted_slice_1503 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1504 = tensor.extract_slice %expanded_1502[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2705 = iree_tensor_ext.bitcast %extracted_slice_1504 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1505 = tensor.dim %2702, %c1 : tensor<4x?x2048xf16>
    %2706 = tensor.empty() : tensor<5632x64x32xf16>
    %2707 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2704, %2705 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2706 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1506 = tensor.expand_shape %2702 [[0], [1], [2, 3]] output_shape [4, %dim_1505, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2708 = tensor.empty(%dim_1505) : tensor<4x?x5632xf32>
    %2709 = linalg.fill ins(%cst_3 : f32) outs(%2708 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2710 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1506, %2707 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2709 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2711 = tensor.empty(%dim_1505) : tensor<4x?x5632xf16>
    %2712 = linalg.copy ins(%2710 : tensor<4x?x5632xf32>) outs(%2711 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1507 = tensor.dim %2712, %c1 : tensor<4x?x5632xf16>
    %2713 = tensor.empty(%dim_1507) : tensor<4x?x5632xf16>
    %2714 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2712 : tensor<4x?x5632xf16>) outs(%2713 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %2715 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2714, %2712 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2713 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2716 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1508 = tensor.expand_shape %2716 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1509 = tensor.extract_slice %expanded_1508[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2717 = iree_tensor_ext.bitcast %extracted_slice_1509 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1510 = tensor.extract_slice %expanded_1508[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2718 = iree_tensor_ext.bitcast %extracted_slice_1510 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1511 = tensor.dim %2702, %c1 : tensor<4x?x2048xf16>
    %2719 = tensor.empty() : tensor<5632x64x32xf16>
    %2720 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2717, %2718 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2719 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1512 = tensor.expand_shape %2702 [[0], [1], [2, 3]] output_shape [4, %dim_1511, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2721 = tensor.empty(%dim_1511) : tensor<4x?x5632xf32>
    %2722 = linalg.fill ins(%cst_3 : f32) outs(%2721 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2723 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1512, %2720 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2722 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2724 = tensor.empty(%dim_1511) : tensor<4x?x5632xf16>
    %2725 = linalg.copy ins(%2723 : tensor<4x?x5632xf32>) outs(%2724 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2726 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2715, %2725 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2713 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2727 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1513 = tensor.expand_shape %2727 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1514 = tensor.extract_slice %expanded_1513[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2728 = iree_tensor_ext.bitcast %extracted_slice_1514 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1515 = tensor.extract_slice %expanded_1513[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2729 = iree_tensor_ext.bitcast %extracted_slice_1515 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1516 = tensor.dim %2726, %c1 : tensor<4x?x5632xf16>
    %2730 = tensor.empty() : tensor<2048x176x32xf16>
    %2731 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2728, %2729 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2730 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1517 = tensor.expand_shape %2726 [[0], [1], [2, 3]] output_shape [4, %dim_1516, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2732 = tensor.empty(%dim_1516) : tensor<4x?x2048xf32>
    %2733 = linalg.fill ins(%cst_3 : f32) outs(%2732 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2734 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1517, %2731 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2733 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2735 = tensor.empty(%dim_1516) : tensor<4x?x2048xf16>
    %2736 = linalg.copy ins(%2734 : tensor<4x?x2048xf32>) outs(%2735 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2737 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2692, %2736 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2738 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2737 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2739 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2738 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2740 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2739 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2741 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2740 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2742 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2741 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2743 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2742 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2744 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2738, %2743 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2745 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2744 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2746 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.attn_norm.weight, %2745 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2747 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2746 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2748 = iree_tensor_ext.bitcast %__auto.blk.18.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1518 = tensor.expand_shape %2748 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1519 = tensor.extract_slice %expanded_1518[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2749 = iree_tensor_ext.bitcast %extracted_slice_1519 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1520 = tensor.extract_slice %expanded_1518[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2750 = iree_tensor_ext.bitcast %extracted_slice_1520 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1521 = tensor.dim %2747, %c1 : tensor<4x?x2048xf16>
    %2751 = tensor.empty() : tensor<2048x64x32xf16>
    %2752 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2749, %2750 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2751 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1522 = tensor.expand_shape %2747 [[0], [1], [2, 3]] output_shape [4, %dim_1521, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2753 = tensor.empty(%dim_1521) : tensor<4x?x2048xf32>
    %2754 = linalg.fill ins(%cst_3 : f32) outs(%2753 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2755 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1522, %2752 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2754 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2756 = tensor.empty(%dim_1521) : tensor<4x?x2048xf16>
    %2757 = linalg.copy ins(%2755 : tensor<4x?x2048xf32>) outs(%2756 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2758 = iree_tensor_ext.bitcast %__auto.blk.18.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1523 = tensor.expand_shape %2758 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1524 = tensor.extract_slice %expanded_1523[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2759 = iree_tensor_ext.bitcast %extracted_slice_1524 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1525 = tensor.extract_slice %expanded_1523[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2760 = iree_tensor_ext.bitcast %extracted_slice_1525 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1526 = tensor.dim %2747, %c1 : tensor<4x?x2048xf16>
    %2761 = tensor.empty() : tensor<256x64x32xf16>
    %2762 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2759, %2760 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2761 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1527 = tensor.expand_shape %2747 [[0], [1], [2, 3]] output_shape [4, %dim_1526, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2763 = tensor.empty(%dim_1526) : tensor<4x?x256xf32>
    %2764 = linalg.fill ins(%cst_3 : f32) outs(%2763 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2765 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1527, %2762 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2764 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2766 = tensor.empty(%dim_1526) : tensor<4x?x256xf16>
    %2767 = linalg.copy ins(%2765 : tensor<4x?x256xf32>) outs(%2766 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2768 = iree_tensor_ext.bitcast %__auto.blk.18.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1528 = tensor.expand_shape %2768 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1529 = tensor.extract_slice %expanded_1528[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2769 = iree_tensor_ext.bitcast %extracted_slice_1529 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1530 = tensor.extract_slice %expanded_1528[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2770 = iree_tensor_ext.bitcast %extracted_slice_1530 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1531 = tensor.dim %2747, %c1 : tensor<4x?x2048xf16>
    %2771 = tensor.empty() : tensor<256x64x32xf16>
    %2772 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2769, %2770 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2771 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1532 = tensor.expand_shape %2747 [[0], [1], [2, 3]] output_shape [4, %dim_1531, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2773 = tensor.empty(%dim_1531) : tensor<4x?x256xf32>
    %2774 = linalg.fill ins(%cst_3 : f32) outs(%2773 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2775 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1532, %2772 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2774 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2776 = tensor.empty(%dim_1531) : tensor<4x?x256xf16>
    %2777 = linalg.copy ins(%2775 : tensor<4x?x256xf32>) outs(%2776 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1533 = tensor.dim %2757, %c1 : tensor<4x?x2048xf16>
    %expanded_1534 = tensor.expand_shape %2757 [[0], [1], [2, 3]] output_shape [4, %dim_1533, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1535 = tensor.dim %2767, %c1 : tensor<4x?x256xf16>
    %expanded_1536 = tensor.expand_shape %2767 [[0], [1], [2, 3]] output_shape [4, %dim_1535, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1537 = tensor.dim %2777, %c1 : tensor<4x?x256xf16>
    %expanded_1538 = tensor.expand_shape %2777 [[0], [1], [2, 3]] output_shape [4, %dim_1537, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2778 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1539 = tensor.expand_shape %2778 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2779 = linalg.batch_matmul ins(%expanded_1539, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1540 = linalg.transpose ins(%2779 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2780 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1540 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2781 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2780, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2782 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2781 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2783 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1540 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2784 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2783, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2785 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2784 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1541 = tensor.expand_shape %2782 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1542 = tensor.expand_shape %2785 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1543 = tensor.extract_slice %expanded_1534[0, 0, 0, 0] [4, %dim_1533, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1544 = tensor.extract_slice %expanded_1534[0, 0, 0, 1] [4, %dim_1533, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2786 = tensor.empty(%dim_1533) : tensor<4x?x32x32xf16>
    %2787 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1543, %expanded_1541 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2786 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2788 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1544, %expanded_1542 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2786 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2789 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2787, %2788 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2786 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2790 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1544, %expanded_1541 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2786 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2791 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1543, %expanded_1542 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2786 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2792 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2790, %2791 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2786 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1545 = tensor.dim %2789, %c1 : tensor<4x?x32x32xf16>
    %2793 = tensor.empty(%dim_1545) : tensor<4x?x32x2x32xf16>
    %2794 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2789, %2792 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2793 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1546 = tensor.collapse_shape %2794 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2795 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1547 = tensor.expand_shape %2795 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2796 = linalg.batch_matmul ins(%expanded_1547, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1548 = linalg.transpose ins(%2796 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2797 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1548 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2798 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2797, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2799 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2798 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2800 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1548 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2801 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2800, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2802 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2801 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1549 = tensor.expand_shape %2799 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1550 = tensor.expand_shape %2802 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1551 = tensor.extract_slice %expanded_1536[0, 0, 0, 0] [4, %dim_1535, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1552 = tensor.extract_slice %expanded_1536[0, 0, 0, 1] [4, %dim_1535, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2803 = tensor.empty(%dim_1535) : tensor<4x?x4x32xf16>
    %2804 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1551, %expanded_1549 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2803 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2805 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1552, %expanded_1550 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2803 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2806 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2804, %2805 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2803 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2807 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1552, %expanded_1549 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2803 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2808 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1551, %expanded_1550 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2803 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2809 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2807, %2808 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2803 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1553 = tensor.dim %2806, %c1 : tensor<4x?x4x32xf16>
    %2810 = tensor.empty(%dim_1553) : tensor<4x?x4x2x32xf16>
    %2811 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2806, %2809 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2810 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1554 = tensor.collapse_shape %2811 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2812 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c18_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %2813 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2812 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1555 = tensor.collapse_shape %2813 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1556 = tensor.dim %2811, %c1 : tensor<4x?x4x2x32xf16>
    %2814 = arith.divsi %dim_1556, %c32 : index
    %expanded_1557 = tensor.expand_shape %collapsed_1554 [[0], [1, 2], [3], [4]] output_shape [4, %2814, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1558 = tensor.collapse_shape %expanded_1557 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2815 = affine.apply #map14()[%2814]
    %2816 = tensor.empty(%2815) : tensor<?x4x32x64xf16>
    %transposed_1559 = linalg.transpose ins(%collapsed_1558 : tensor<?x32x4x64xf16>) outs(%2816 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1560 = tensor.expand_shape %collapsed_1555 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2817 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1559, %expanded_1560 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2673 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2818 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2813 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1561 = tensor.collapse_shape %2818 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %2819 = arith.divsi %dim_1537, %c32 : index
    %expanded_1562 = tensor.expand_shape %2777 [[0], [1, 2], [3, 4]] output_shape [4, %2819, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1563 = tensor.collapse_shape %expanded_1562 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2820 = affine.apply #map14()[%2819]
    %2821 = tensor.empty(%2820) : tensor<?x4x32x64xf16>
    %transposed_1564 = linalg.transpose ins(%collapsed_1563 : tensor<?x32x4x64xf16>) outs(%2821 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1565 = tensor.expand_shape %collapsed_1561 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2822 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1564, %expanded_1565 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2817 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2823 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1554 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1566 = tensor.collapse_shape %2823 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2824 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1538 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1567 = tensor.collapse_shape %2824 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1568 = tensor.dim %2794, %c1 : tensor<4x?x32x2x32xf16>
    %2825 = tensor.empty(%dim_1568) : tensor<4x32x?x64xf16>
    %transposed_1569 = linalg.transpose ins(%collapsed_1546 : tensor<4x?x32x64xf16>) outs(%2825 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2826 = tensor.empty(%dim_1556) : tensor<4x32x?x64xf16>
    %transposed_1570 = linalg.transpose ins(%collapsed_1566 : tensor<4x?x32x64xf16>) outs(%2826 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2827 = tensor.empty(%dim_1537) : tensor<4x32x?x64xf16>
    %transposed_1571 = linalg.transpose ins(%collapsed_1567 : tensor<4x?x32x64xf16>) outs(%2827 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1572 = tensor.collapse_shape %transposed_1569 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1573 = tensor.collapse_shape %transposed_1570 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1574 = tensor.collapse_shape %transposed_1571 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1575 = tensor.dim %transposed_1569, %c2 : tensor<4x32x?x64xf16>
    %2828 = tensor.empty(%dim_1575) : tensor<128x?x64xf16>
    %2829 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1572, %collapsed_1573, %collapsed_1574, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%2828 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1576 = tensor.expand_shape %2829 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1575, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1577 = tensor.dim %expanded_1576, %c2 : tensor<4x32x?x64xf16>
    %2830 = tensor.empty(%dim_1577) : tensor<4x?x32x64xf16>
    %transposed_1578 = linalg.transpose ins(%expanded_1576 : tensor<4x32x?x64xf16>) outs(%2830 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1579 = tensor.collapse_shape %transposed_1578 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2831 = iree_tensor_ext.bitcast %__auto.blk.18.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1580 = tensor.expand_shape %2831 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1581 = tensor.extract_slice %expanded_1580[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2832 = iree_tensor_ext.bitcast %extracted_slice_1581 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1582 = tensor.extract_slice %expanded_1580[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2833 = iree_tensor_ext.bitcast %extracted_slice_1582 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1583 = tensor.dim %collapsed_1579, %c1 : tensor<4x?x2048xf16>
    %2834 = tensor.empty() : tensor<2048x64x32xf16>
    %2835 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2832, %2833 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2834 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1584 = tensor.expand_shape %collapsed_1579 [[0], [1], [2, 3]] output_shape [4, %dim_1583, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2836 = tensor.empty(%dim_1583) : tensor<4x?x2048xf32>
    %2837 = linalg.fill ins(%cst_3 : f32) outs(%2836 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2838 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1584, %2835 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2837 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2839 = tensor.empty(%dim_1583) : tensor<4x?x2048xf16>
    %2840 = linalg.copy ins(%2838 : tensor<4x?x2048xf32>) outs(%2839 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2841 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2737, %2840 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2842 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2841 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2843 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2842 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2844 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2843 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2845 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2844 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2846 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2845 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2847 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2846 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2848 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2842, %2847 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2849 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2848 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2850 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.ffn_norm.weight, %2849 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2851 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2850 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2852 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1585 = tensor.expand_shape %2852 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1586 = tensor.extract_slice %expanded_1585[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2853 = iree_tensor_ext.bitcast %extracted_slice_1586 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1587 = tensor.extract_slice %expanded_1585[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2854 = iree_tensor_ext.bitcast %extracted_slice_1587 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1588 = tensor.dim %2851, %c1 : tensor<4x?x2048xf16>
    %2855 = tensor.empty() : tensor<5632x64x32xf16>
    %2856 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2853, %2854 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2855 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1589 = tensor.expand_shape %2851 [[0], [1], [2, 3]] output_shape [4, %dim_1588, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2857 = tensor.empty(%dim_1588) : tensor<4x?x5632xf32>
    %2858 = linalg.fill ins(%cst_3 : f32) outs(%2857 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2859 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1589, %2856 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2858 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2860 = tensor.empty(%dim_1588) : tensor<4x?x5632xf16>
    %2861 = linalg.copy ins(%2859 : tensor<4x?x5632xf32>) outs(%2860 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1590 = tensor.dim %2861, %c1 : tensor<4x?x5632xf16>
    %2862 = tensor.empty(%dim_1590) : tensor<4x?x5632xf16>
    %2863 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2861 : tensor<4x?x5632xf16>) outs(%2862 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %2864 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2863, %2861 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2862 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2865 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1591 = tensor.expand_shape %2865 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1592 = tensor.extract_slice %expanded_1591[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2866 = iree_tensor_ext.bitcast %extracted_slice_1592 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1593 = tensor.extract_slice %expanded_1591[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2867 = iree_tensor_ext.bitcast %extracted_slice_1593 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1594 = tensor.dim %2851, %c1 : tensor<4x?x2048xf16>
    %2868 = tensor.empty() : tensor<5632x64x32xf16>
    %2869 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2866, %2867 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2868 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1595 = tensor.expand_shape %2851 [[0], [1], [2, 3]] output_shape [4, %dim_1594, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2870 = tensor.empty(%dim_1594) : tensor<4x?x5632xf32>
    %2871 = linalg.fill ins(%cst_3 : f32) outs(%2870 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %2872 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1595, %2869 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%2871 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %2873 = tensor.empty(%dim_1594) : tensor<4x?x5632xf16>
    %2874 = linalg.copy ins(%2872 : tensor<4x?x5632xf32>) outs(%2873 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2875 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2864, %2874 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%2862 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %2876 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1596 = tensor.expand_shape %2876 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1597 = tensor.extract_slice %expanded_1596[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2877 = iree_tensor_ext.bitcast %extracted_slice_1597 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1598 = tensor.extract_slice %expanded_1596[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2878 = iree_tensor_ext.bitcast %extracted_slice_1598 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1599 = tensor.dim %2875, %c1 : tensor<4x?x5632xf16>
    %2879 = tensor.empty() : tensor<2048x176x32xf16>
    %2880 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2877, %2878 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2879 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1600 = tensor.expand_shape %2875 [[0], [1], [2, 3]] output_shape [4, %dim_1599, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2881 = tensor.empty(%dim_1599) : tensor<4x?x2048xf32>
    %2882 = linalg.fill ins(%cst_3 : f32) outs(%2881 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2883 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1600, %2880 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%2882 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2884 = tensor.empty(%dim_1599) : tensor<4x?x2048xf16>
    %2885 = linalg.copy ins(%2883 : tensor<4x?x2048xf32>) outs(%2884 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2886 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2841, %2885 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2887 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2886 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2888 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2887 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2889 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2888 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2890 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2889 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2891 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2890 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2892 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2891 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2893 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2887, %2892 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2894 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2893 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2895 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.attn_norm.weight, %2894 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %2896 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2895 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2897 = iree_tensor_ext.bitcast %__auto.blk.19.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1601 = tensor.expand_shape %2897 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1602 = tensor.extract_slice %expanded_1601[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2898 = iree_tensor_ext.bitcast %extracted_slice_1602 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1603 = tensor.extract_slice %expanded_1601[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2899 = iree_tensor_ext.bitcast %extracted_slice_1603 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1604 = tensor.dim %2896, %c1 : tensor<4x?x2048xf16>
    %2900 = tensor.empty() : tensor<2048x64x32xf16>
    %2901 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2898, %2899 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2900 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1605 = tensor.expand_shape %2896 [[0], [1], [2, 3]] output_shape [4, %dim_1604, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2902 = tensor.empty(%dim_1604) : tensor<4x?x2048xf32>
    %2903 = linalg.fill ins(%cst_3 : f32) outs(%2902 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2904 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1605, %2901 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2903 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2905 = tensor.empty(%dim_1604) : tensor<4x?x2048xf16>
    %2906 = linalg.copy ins(%2904 : tensor<4x?x2048xf32>) outs(%2905 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2907 = iree_tensor_ext.bitcast %__auto.blk.19.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1606 = tensor.expand_shape %2907 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1607 = tensor.extract_slice %expanded_1606[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2908 = iree_tensor_ext.bitcast %extracted_slice_1607 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1608 = tensor.extract_slice %expanded_1606[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2909 = iree_tensor_ext.bitcast %extracted_slice_1608 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1609 = tensor.dim %2896, %c1 : tensor<4x?x2048xf16>
    %2910 = tensor.empty() : tensor<256x64x32xf16>
    %2911 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2908, %2909 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2910 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1610 = tensor.expand_shape %2896 [[0], [1], [2, 3]] output_shape [4, %dim_1609, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2912 = tensor.empty(%dim_1609) : tensor<4x?x256xf32>
    %2913 = linalg.fill ins(%cst_3 : f32) outs(%2912 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2914 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1610, %2911 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2913 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2915 = tensor.empty(%dim_1609) : tensor<4x?x256xf16>
    %2916 = linalg.copy ins(%2914 : tensor<4x?x256xf32>) outs(%2915 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2917 = iree_tensor_ext.bitcast %__auto.blk.19.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1611 = tensor.expand_shape %2917 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1612 = tensor.extract_slice %expanded_1611[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2918 = iree_tensor_ext.bitcast %extracted_slice_1612 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1613 = tensor.extract_slice %expanded_1611[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2919 = iree_tensor_ext.bitcast %extracted_slice_1613 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1614 = tensor.dim %2896, %c1 : tensor<4x?x2048xf16>
    %2920 = tensor.empty() : tensor<256x64x32xf16>
    %2921 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2918, %2919 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2920 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1615 = tensor.expand_shape %2896 [[0], [1], [2, 3]] output_shape [4, %dim_1614, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2922 = tensor.empty(%dim_1614) : tensor<4x?x256xf32>
    %2923 = linalg.fill ins(%cst_3 : f32) outs(%2922 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %2924 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1615, %2921 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%2923 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %2925 = tensor.empty(%dim_1614) : tensor<4x?x256xf16>
    %2926 = linalg.copy ins(%2924 : tensor<4x?x256xf32>) outs(%2925 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1616 = tensor.dim %2906, %c1 : tensor<4x?x2048xf16>
    %expanded_1617 = tensor.expand_shape %2906 [[0], [1], [2, 3]] output_shape [4, %dim_1616, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1618 = tensor.dim %2916, %c1 : tensor<4x?x256xf16>
    %expanded_1619 = tensor.expand_shape %2916 [[0], [1], [2, 3]] output_shape [4, %dim_1618, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1620 = tensor.dim %2926, %c1 : tensor<4x?x256xf16>
    %expanded_1621 = tensor.expand_shape %2926 [[0], [1], [2, 3]] output_shape [4, %dim_1620, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2927 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1622 = tensor.expand_shape %2927 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2928 = linalg.batch_matmul ins(%expanded_1622, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1623 = linalg.transpose ins(%2928 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2929 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1623 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2930 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2929, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2931 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2930 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2932 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1623 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2933 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2932, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2934 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2933 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1624 = tensor.expand_shape %2931 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1625 = tensor.expand_shape %2934 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1626 = tensor.extract_slice %expanded_1617[0, 0, 0, 0] [4, %dim_1616, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1627 = tensor.extract_slice %expanded_1617[0, 0, 0, 1] [4, %dim_1616, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2935 = tensor.empty(%dim_1616) : tensor<4x?x32x32xf16>
    %2936 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1626, %expanded_1624 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2935 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2937 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1627, %expanded_1625 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2935 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2938 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2936, %2937 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2935 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2939 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1627, %expanded_1624 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2935 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2940 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1626, %expanded_1625 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%2935 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %2941 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2939, %2940 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2935 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1628 = tensor.dim %2938, %c1 : tensor<4x?x32x32xf16>
    %2942 = tensor.empty(%dim_1628) : tensor<4x?x32x2x32xf16>
    %2943 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2938, %2941 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%2942 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1629 = tensor.collapse_shape %2943 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2944 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1630 = tensor.expand_shape %2944 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2945 = linalg.batch_matmul ins(%expanded_1630, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1631 = linalg.transpose ins(%2945 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2946 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1631 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2947 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2946, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2948 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2947 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %2949 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1631 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2950 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2949, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %2951 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2950 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1632 = tensor.expand_shape %2948 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1633 = tensor.expand_shape %2951 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1634 = tensor.extract_slice %expanded_1619[0, 0, 0, 0] [4, %dim_1618, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1635 = tensor.extract_slice %expanded_1619[0, 0, 0, 1] [4, %dim_1618, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2952 = tensor.empty(%dim_1618) : tensor<4x?x4x32xf16>
    %2953 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1634, %expanded_1632 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2952 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2954 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1635, %expanded_1633 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2952 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2955 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2953, %2954 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2952 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2956 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1635, %expanded_1632 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2952 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2957 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1634, %expanded_1633 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%2952 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %2958 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2956, %2957 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2952 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1636 = tensor.dim %2955, %c1 : tensor<4x?x4x32xf16>
    %2959 = tensor.empty(%dim_1636) : tensor<4x?x4x2x32xf16>
    %2960 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2955, %2958 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%2959 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1637 = tensor.collapse_shape %2960 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2961 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c19_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %2962 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2961 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1638 = tensor.collapse_shape %2962 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1639 = tensor.dim %2960, %c1 : tensor<4x?x4x2x32xf16>
    %2963 = arith.divsi %dim_1639, %c32 : index
    %expanded_1640 = tensor.expand_shape %collapsed_1637 [[0], [1, 2], [3], [4]] output_shape [4, %2963, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1641 = tensor.collapse_shape %expanded_1640 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2964 = affine.apply #map14()[%2963]
    %2965 = tensor.empty(%2964) : tensor<?x4x32x64xf16>
    %transposed_1642 = linalg.transpose ins(%collapsed_1641 : tensor<?x32x4x64xf16>) outs(%2965 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1643 = tensor.expand_shape %collapsed_1638 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2966 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1642, %expanded_1643 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2822 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2967 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2962 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1644 = tensor.collapse_shape %2967 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %2968 = arith.divsi %dim_1620, %c32 : index
    %expanded_1645 = tensor.expand_shape %2926 [[0], [1, 2], [3, 4]] output_shape [4, %2968, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1646 = tensor.collapse_shape %expanded_1645 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %2969 = affine.apply #map14()[%2968]
    %2970 = tensor.empty(%2969) : tensor<?x4x32x64xf16>
    %transposed_1647 = linalg.transpose ins(%collapsed_1646 : tensor<?x32x4x64xf16>) outs(%2970 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1648 = tensor.expand_shape %collapsed_1644 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2971 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1647, %expanded_1648 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2966 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2972 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1637 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1649 = tensor.collapse_shape %2972 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2973 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1621 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1650 = tensor.collapse_shape %2973 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1651 = tensor.dim %2943, %c1 : tensor<4x?x32x2x32xf16>
    %2974 = tensor.empty(%dim_1651) : tensor<4x32x?x64xf16>
    %transposed_1652 = linalg.transpose ins(%collapsed_1629 : tensor<4x?x32x64xf16>) outs(%2974 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2975 = tensor.empty(%dim_1639) : tensor<4x32x?x64xf16>
    %transposed_1653 = linalg.transpose ins(%collapsed_1649 : tensor<4x?x32x64xf16>) outs(%2975 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2976 = tensor.empty(%dim_1620) : tensor<4x32x?x64xf16>
    %transposed_1654 = linalg.transpose ins(%collapsed_1650 : tensor<4x?x32x64xf16>) outs(%2976 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1655 = tensor.collapse_shape %transposed_1652 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1656 = tensor.collapse_shape %transposed_1653 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1657 = tensor.collapse_shape %transposed_1654 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1658 = tensor.dim %transposed_1652, %c2 : tensor<4x32x?x64xf16>
    %2977 = tensor.empty(%dim_1658) : tensor<128x?x64xf16>
    %2978 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1655, %collapsed_1656, %collapsed_1657, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%2977 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1659 = tensor.expand_shape %2978 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1658, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1660 = tensor.dim %expanded_1659, %c2 : tensor<4x32x?x64xf16>
    %2979 = tensor.empty(%dim_1660) : tensor<4x?x32x64xf16>
    %transposed_1661 = linalg.transpose ins(%expanded_1659 : tensor<4x32x?x64xf16>) outs(%2979 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1662 = tensor.collapse_shape %transposed_1661 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2980 = iree_tensor_ext.bitcast %__auto.blk.19.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1663 = tensor.expand_shape %2980 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1664 = tensor.extract_slice %expanded_1663[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2981 = iree_tensor_ext.bitcast %extracted_slice_1664 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1665 = tensor.extract_slice %expanded_1663[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2982 = iree_tensor_ext.bitcast %extracted_slice_1665 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1666 = tensor.dim %collapsed_1662, %c1 : tensor<4x?x2048xf16>
    %2983 = tensor.empty() : tensor<2048x64x32xf16>
    %2984 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2981, %2982 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2983 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1667 = tensor.expand_shape %collapsed_1662 [[0], [1], [2, 3]] output_shape [4, %dim_1666, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2985 = tensor.empty(%dim_1666) : tensor<4x?x2048xf32>
    %2986 = linalg.fill ins(%cst_3 : f32) outs(%2985 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2987 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1667, %2984 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2986 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %2988 = tensor.empty(%dim_1666) : tensor<4x?x2048xf16>
    %2989 = linalg.copy ins(%2987 : tensor<4x?x2048xf32>) outs(%2988 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2990 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2886, %2989 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2991 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2990 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2992 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2991 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2993 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2992 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2994 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2993 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2995 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2994 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2996 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2995 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %2997 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2991, %2996 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %2998 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2997 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %2999 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.ffn_norm.weight, %2998 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %3000 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2999 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3001 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1668 = tensor.expand_shape %3001 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1669 = tensor.extract_slice %expanded_1668[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3002 = iree_tensor_ext.bitcast %extracted_slice_1669 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1670 = tensor.extract_slice %expanded_1668[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3003 = iree_tensor_ext.bitcast %extracted_slice_1670 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1671 = tensor.dim %3000, %c1 : tensor<4x?x2048xf16>
    %3004 = tensor.empty() : tensor<5632x64x32xf16>
    %3005 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3002, %3003 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3004 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1672 = tensor.expand_shape %3000 [[0], [1], [2, 3]] output_shape [4, %dim_1671, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3006 = tensor.empty(%dim_1671) : tensor<4x?x5632xf32>
    %3007 = linalg.fill ins(%cst_3 : f32) outs(%3006 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %3008 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1672, %3005 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%3007 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %3009 = tensor.empty(%dim_1671) : tensor<4x?x5632xf16>
    %3010 = linalg.copy ins(%3008 : tensor<4x?x5632xf32>) outs(%3009 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1673 = tensor.dim %3010, %c1 : tensor<4x?x5632xf16>
    %3011 = tensor.empty(%dim_1673) : tensor<4x?x5632xf16>
    %3012 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3010 : tensor<4x?x5632xf16>) outs(%3011 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %3013 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3012, %3010 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%3011 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %3014 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1674 = tensor.expand_shape %3014 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1675 = tensor.extract_slice %expanded_1674[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3015 = iree_tensor_ext.bitcast %extracted_slice_1675 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1676 = tensor.extract_slice %expanded_1674[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3016 = iree_tensor_ext.bitcast %extracted_slice_1676 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1677 = tensor.dim %3000, %c1 : tensor<4x?x2048xf16>
    %3017 = tensor.empty() : tensor<5632x64x32xf16>
    %3018 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3015, %3016 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3017 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1678 = tensor.expand_shape %3000 [[0], [1], [2, 3]] output_shape [4, %dim_1677, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3019 = tensor.empty(%dim_1677) : tensor<4x?x5632xf32>
    %3020 = linalg.fill ins(%cst_3 : f32) outs(%3019 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %3021 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1678, %3018 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%3020 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %3022 = tensor.empty(%dim_1677) : tensor<4x?x5632xf16>
    %3023 = linalg.copy ins(%3021 : tensor<4x?x5632xf32>) outs(%3022 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %3024 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3013, %3023 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%3011 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %3025 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1679 = tensor.expand_shape %3025 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1680 = tensor.extract_slice %expanded_1679[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %3026 = iree_tensor_ext.bitcast %extracted_slice_1680 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1681 = tensor.extract_slice %expanded_1679[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %3027 = iree_tensor_ext.bitcast %extracted_slice_1681 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1682 = tensor.dim %3024, %c1 : tensor<4x?x5632xf16>
    %3028 = tensor.empty() : tensor<2048x176x32xf16>
    %3029 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3026, %3027 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%3028 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1683 = tensor.expand_shape %3024 [[0], [1], [2, 3]] output_shape [4, %dim_1682, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %3030 = tensor.empty(%dim_1682) : tensor<4x?x2048xf32>
    %3031 = linalg.fill ins(%cst_3 : f32) outs(%3030 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %3032 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1683, %3029 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%3031 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %3033 = tensor.empty(%dim_1682) : tensor<4x?x2048xf16>
    %3034 = linalg.copy ins(%3032 : tensor<4x?x2048xf32>) outs(%3033 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %3035 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2990, %3034 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3036 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3035 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3037 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3036 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3038 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3037 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3039 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3038 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3040 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3039 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3041 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3040 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3042 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3036, %3041 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3043 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3042 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3044 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.attn_norm.weight, %3043 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %3045 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3044 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3046 = iree_tensor_ext.bitcast %__auto.blk.20.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1684 = tensor.expand_shape %3046 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1685 = tensor.extract_slice %expanded_1684[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3047 = iree_tensor_ext.bitcast %extracted_slice_1685 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1686 = tensor.extract_slice %expanded_1684[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3048 = iree_tensor_ext.bitcast %extracted_slice_1686 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1687 = tensor.dim %3045, %c1 : tensor<4x?x2048xf16>
    %3049 = tensor.empty() : tensor<2048x64x32xf16>
    %3050 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3047, %3048 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3049 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1688 = tensor.expand_shape %3045 [[0], [1], [2, 3]] output_shape [4, %dim_1687, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3051 = tensor.empty(%dim_1687) : tensor<4x?x2048xf32>
    %3052 = linalg.fill ins(%cst_3 : f32) outs(%3051 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %3053 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1688, %3050 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%3052 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %3054 = tensor.empty(%dim_1687) : tensor<4x?x2048xf16>
    %3055 = linalg.copy ins(%3053 : tensor<4x?x2048xf32>) outs(%3054 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %3056 = iree_tensor_ext.bitcast %__auto.blk.20.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1689 = tensor.expand_shape %3056 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1690 = tensor.extract_slice %expanded_1689[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3057 = iree_tensor_ext.bitcast %extracted_slice_1690 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1691 = tensor.extract_slice %expanded_1689[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3058 = iree_tensor_ext.bitcast %extracted_slice_1691 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1692 = tensor.dim %3045, %c1 : tensor<4x?x2048xf16>
    %3059 = tensor.empty() : tensor<256x64x32xf16>
    %3060 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3057, %3058 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3059 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1693 = tensor.expand_shape %3045 [[0], [1], [2, 3]] output_shape [4, %dim_1692, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3061 = tensor.empty(%dim_1692) : tensor<4x?x256xf32>
    %3062 = linalg.fill ins(%cst_3 : f32) outs(%3061 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %3063 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1693, %3060 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%3062 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %3064 = tensor.empty(%dim_1692) : tensor<4x?x256xf16>
    %3065 = linalg.copy ins(%3063 : tensor<4x?x256xf32>) outs(%3064 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %3066 = iree_tensor_ext.bitcast %__auto.blk.20.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1694 = tensor.expand_shape %3066 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1695 = tensor.extract_slice %expanded_1694[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3067 = iree_tensor_ext.bitcast %extracted_slice_1695 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1696 = tensor.extract_slice %expanded_1694[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3068 = iree_tensor_ext.bitcast %extracted_slice_1696 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1697 = tensor.dim %3045, %c1 : tensor<4x?x2048xf16>
    %3069 = tensor.empty() : tensor<256x64x32xf16>
    %3070 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3067, %3068 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3069 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1698 = tensor.expand_shape %3045 [[0], [1], [2, 3]] output_shape [4, %dim_1697, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3071 = tensor.empty(%dim_1697) : tensor<4x?x256xf32>
    %3072 = linalg.fill ins(%cst_3 : f32) outs(%3071 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %3073 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1698, %3070 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%3072 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %3074 = tensor.empty(%dim_1697) : tensor<4x?x256xf16>
    %3075 = linalg.copy ins(%3073 : tensor<4x?x256xf32>) outs(%3074 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1699 = tensor.dim %3055, %c1 : tensor<4x?x2048xf16>
    %expanded_1700 = tensor.expand_shape %3055 [[0], [1], [2, 3]] output_shape [4, %dim_1699, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1701 = tensor.dim %3065, %c1 : tensor<4x?x256xf16>
    %expanded_1702 = tensor.expand_shape %3065 [[0], [1], [2, 3]] output_shape [4, %dim_1701, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1703 = tensor.dim %3075, %c1 : tensor<4x?x256xf16>
    %expanded_1704 = tensor.expand_shape %3075 [[0], [1], [2, 3]] output_shape [4, %dim_1703, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %3076 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1705 = tensor.expand_shape %3076 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %3077 = linalg.batch_matmul ins(%expanded_1705, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1706 = linalg.transpose ins(%3077 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %3078 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1706 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3079 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3078, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3080 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3079 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %3081 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1706 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3082 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3081, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3083 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3082 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1707 = tensor.expand_shape %3080 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1708 = tensor.expand_shape %3083 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1709 = tensor.extract_slice %expanded_1700[0, 0, 0, 0] [4, %dim_1699, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1710 = tensor.extract_slice %expanded_1700[0, 0, 0, 1] [4, %dim_1699, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %3084 = tensor.empty(%dim_1699) : tensor<4x?x32x32xf16>
    %3085 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1709, %expanded_1707 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3084 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3086 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1710, %expanded_1708 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3084 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3087 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3085, %3086 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%3084 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3088 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1710, %expanded_1707 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3084 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3089 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1709, %expanded_1708 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3084 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3090 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3088, %3089 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%3084 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1711 = tensor.dim %3087, %c1 : tensor<4x?x32x32xf16>
    %3091 = tensor.empty(%dim_1711) : tensor<4x?x32x2x32xf16>
    %3092 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3087, %3090 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%3091 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1712 = tensor.collapse_shape %3092 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %3093 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1713 = tensor.expand_shape %3093 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %3094 = linalg.batch_matmul ins(%expanded_1713, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1714 = linalg.transpose ins(%3094 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %3095 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1714 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3096 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3095, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3097 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3096 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %3098 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1714 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3099 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3098, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3100 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3099 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1715 = tensor.expand_shape %3097 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1716 = tensor.expand_shape %3100 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1717 = tensor.extract_slice %expanded_1702[0, 0, 0, 0] [4, %dim_1701, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1718 = tensor.extract_slice %expanded_1702[0, 0, 0, 1] [4, %dim_1701, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %3101 = tensor.empty(%dim_1701) : tensor<4x?x4x32xf16>
    %3102 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1717, %expanded_1715 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3101 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3103 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1718, %expanded_1716 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3101 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3104 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3102, %3103 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%3101 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3105 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1718, %expanded_1715 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3101 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3106 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1717, %expanded_1716 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3101 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3107 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3105, %3106 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%3101 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1719 = tensor.dim %3104, %c1 : tensor<4x?x4x32xf16>
    %3108 = tensor.empty(%dim_1719) : tensor<4x?x4x2x32xf16>
    %3109 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3104, %3107 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%3108 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1720 = tensor.collapse_shape %3109 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %3110 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c20_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %3111 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%3110 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1721 = tensor.collapse_shape %3111 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1722 = tensor.dim %3109, %c1 : tensor<4x?x4x2x32xf16>
    %3112 = arith.divsi %dim_1722, %c32 : index
    %expanded_1723 = tensor.expand_shape %collapsed_1720 [[0], [1, 2], [3], [4]] output_shape [4, %3112, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1724 = tensor.collapse_shape %expanded_1723 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %3113 = affine.apply #map14()[%3112]
    %3114 = tensor.empty(%3113) : tensor<?x4x32x64xf16>
    %transposed_1725 = linalg.transpose ins(%collapsed_1724 : tensor<?x32x4x64xf16>) outs(%3114 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1726 = tensor.expand_shape %collapsed_1721 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %3115 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1725, %expanded_1726 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2971 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %3116 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%3111 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1727 = tensor.collapse_shape %3116 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %3117 = arith.divsi %dim_1703, %c32 : index
    %expanded_1728 = tensor.expand_shape %3075 [[0], [1, 2], [3, 4]] output_shape [4, %3117, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1729 = tensor.collapse_shape %expanded_1728 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %3118 = affine.apply #map14()[%3117]
    %3119 = tensor.empty(%3118) : tensor<?x4x32x64xf16>
    %transposed_1730 = linalg.transpose ins(%collapsed_1729 : tensor<?x32x4x64xf16>) outs(%3119 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1731 = tensor.expand_shape %collapsed_1727 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %3120 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1730, %expanded_1731 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%3115 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %3121 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1720 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1732 = tensor.collapse_shape %3121 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %3122 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1704 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1733 = tensor.collapse_shape %3122 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1734 = tensor.dim %3092, %c1 : tensor<4x?x32x2x32xf16>
    %3123 = tensor.empty(%dim_1734) : tensor<4x32x?x64xf16>
    %transposed_1735 = linalg.transpose ins(%collapsed_1712 : tensor<4x?x32x64xf16>) outs(%3123 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3124 = tensor.empty(%dim_1722) : tensor<4x32x?x64xf16>
    %transposed_1736 = linalg.transpose ins(%collapsed_1732 : tensor<4x?x32x64xf16>) outs(%3124 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3125 = tensor.empty(%dim_1703) : tensor<4x32x?x64xf16>
    %transposed_1737 = linalg.transpose ins(%collapsed_1733 : tensor<4x?x32x64xf16>) outs(%3125 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1738 = tensor.collapse_shape %transposed_1735 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1739 = tensor.collapse_shape %transposed_1736 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1740 = tensor.collapse_shape %transposed_1737 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1741 = tensor.dim %transposed_1735, %c2 : tensor<4x32x?x64xf16>
    %3126 = tensor.empty(%dim_1741) : tensor<128x?x64xf16>
    %3127 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1738, %collapsed_1739, %collapsed_1740, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%3126 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1742 = tensor.expand_shape %3127 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1741, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1743 = tensor.dim %expanded_1742, %c2 : tensor<4x32x?x64xf16>
    %3128 = tensor.empty(%dim_1743) : tensor<4x?x32x64xf16>
    %transposed_1744 = linalg.transpose ins(%expanded_1742 : tensor<4x32x?x64xf16>) outs(%3128 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1745 = tensor.collapse_shape %transposed_1744 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %3129 = iree_tensor_ext.bitcast %__auto.blk.20.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1746 = tensor.expand_shape %3129 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1747 = tensor.extract_slice %expanded_1746[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3130 = iree_tensor_ext.bitcast %extracted_slice_1747 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1748 = tensor.extract_slice %expanded_1746[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3131 = iree_tensor_ext.bitcast %extracted_slice_1748 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1749 = tensor.dim %collapsed_1745, %c1 : tensor<4x?x2048xf16>
    %3132 = tensor.empty() : tensor<2048x64x32xf16>
    %3133 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3130, %3131 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3132 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1750 = tensor.expand_shape %collapsed_1745 [[0], [1], [2, 3]] output_shape [4, %dim_1749, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3134 = tensor.empty(%dim_1749) : tensor<4x?x2048xf32>
    %3135 = linalg.fill ins(%cst_3 : f32) outs(%3134 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %3136 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1750, %3133 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%3135 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %3137 = tensor.empty(%dim_1749) : tensor<4x?x2048xf16>
    %3138 = linalg.copy ins(%3136 : tensor<4x?x2048xf32>) outs(%3137 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %3139 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3035, %3138 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3140 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3139 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3141 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3140 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3142 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3141 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3143 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3142 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3144 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3143 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3145 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3144 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3146 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3140, %3145 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3147 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3146 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3148 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.ffn_norm.weight, %3147 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %3149 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3148 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3150 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1751 = tensor.expand_shape %3150 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1752 = tensor.extract_slice %expanded_1751[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3151 = iree_tensor_ext.bitcast %extracted_slice_1752 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1753 = tensor.extract_slice %expanded_1751[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3152 = iree_tensor_ext.bitcast %extracted_slice_1753 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1754 = tensor.dim %3149, %c1 : tensor<4x?x2048xf16>
    %3153 = tensor.empty() : tensor<5632x64x32xf16>
    %3154 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3151, %3152 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3153 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1755 = tensor.expand_shape %3149 [[0], [1], [2, 3]] output_shape [4, %dim_1754, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3155 = tensor.empty(%dim_1754) : tensor<4x?x5632xf32>
    %3156 = linalg.fill ins(%cst_3 : f32) outs(%3155 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %3157 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1755, %3154 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%3156 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %3158 = tensor.empty(%dim_1754) : tensor<4x?x5632xf16>
    %3159 = linalg.copy ins(%3157 : tensor<4x?x5632xf32>) outs(%3158 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1756 = tensor.dim %3159, %c1 : tensor<4x?x5632xf16>
    %3160 = tensor.empty(%dim_1756) : tensor<4x?x5632xf16>
    %3161 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3159 : tensor<4x?x5632xf16>) outs(%3160 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %3162 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3161, %3159 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%3160 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %3163 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1757 = tensor.expand_shape %3163 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1758 = tensor.extract_slice %expanded_1757[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3164 = iree_tensor_ext.bitcast %extracted_slice_1758 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1759 = tensor.extract_slice %expanded_1757[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3165 = iree_tensor_ext.bitcast %extracted_slice_1759 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1760 = tensor.dim %3149, %c1 : tensor<4x?x2048xf16>
    %3166 = tensor.empty() : tensor<5632x64x32xf16>
    %3167 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3164, %3165 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3166 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1761 = tensor.expand_shape %3149 [[0], [1], [2, 3]] output_shape [4, %dim_1760, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3168 = tensor.empty(%dim_1760) : tensor<4x?x5632xf32>
    %3169 = linalg.fill ins(%cst_3 : f32) outs(%3168 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %3170 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1761, %3167 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%3169 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %3171 = tensor.empty(%dim_1760) : tensor<4x?x5632xf16>
    %3172 = linalg.copy ins(%3170 : tensor<4x?x5632xf32>) outs(%3171 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %3173 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3162, %3172 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%3160 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %3174 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1762 = tensor.expand_shape %3174 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1763 = tensor.extract_slice %expanded_1762[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %3175 = iree_tensor_ext.bitcast %extracted_slice_1763 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1764 = tensor.extract_slice %expanded_1762[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %3176 = iree_tensor_ext.bitcast %extracted_slice_1764 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1765 = tensor.dim %3173, %c1 : tensor<4x?x5632xf16>
    %3177 = tensor.empty() : tensor<2048x176x32xf16>
    %3178 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3175, %3176 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%3177 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1766 = tensor.expand_shape %3173 [[0], [1], [2, 3]] output_shape [4, %dim_1765, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %3179 = tensor.empty(%dim_1765) : tensor<4x?x2048xf32>
    %3180 = linalg.fill ins(%cst_3 : f32) outs(%3179 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %3181 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1766, %3178 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%3180 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %3182 = tensor.empty(%dim_1765) : tensor<4x?x2048xf16>
    %3183 = linalg.copy ins(%3181 : tensor<4x?x2048xf32>) outs(%3182 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %3184 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3139, %3183 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3185 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3184 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3186 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3185 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3187 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3186 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3188 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3187 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3189 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3188 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3190 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3189 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3191 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3185, %3190 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3192 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3191 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3193 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.attn_norm.weight, %3192 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %3194 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3193 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3195 = iree_tensor_ext.bitcast %__auto.blk.21.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1767 = tensor.expand_shape %3195 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1768 = tensor.extract_slice %expanded_1767[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3196 = iree_tensor_ext.bitcast %extracted_slice_1768 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1769 = tensor.extract_slice %expanded_1767[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3197 = iree_tensor_ext.bitcast %extracted_slice_1769 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1770 = tensor.dim %3194, %c1 : tensor<4x?x2048xf16>
    %3198 = tensor.empty() : tensor<2048x64x32xf16>
    %3199 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3196, %3197 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3198 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1771 = tensor.expand_shape %3194 [[0], [1], [2, 3]] output_shape [4, %dim_1770, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3200 = tensor.empty(%dim_1770) : tensor<4x?x2048xf32>
    %3201 = linalg.fill ins(%cst_3 : f32) outs(%3200 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %3202 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1771, %3199 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%3201 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %3203 = tensor.empty(%dim_1770) : tensor<4x?x2048xf16>
    %3204 = linalg.copy ins(%3202 : tensor<4x?x2048xf32>) outs(%3203 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %3205 = iree_tensor_ext.bitcast %__auto.blk.21.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1772 = tensor.expand_shape %3205 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1773 = tensor.extract_slice %expanded_1772[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3206 = iree_tensor_ext.bitcast %extracted_slice_1773 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1774 = tensor.extract_slice %expanded_1772[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3207 = iree_tensor_ext.bitcast %extracted_slice_1774 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1775 = tensor.dim %3194, %c1 : tensor<4x?x2048xf16>
    %3208 = tensor.empty() : tensor<256x64x32xf16>
    %3209 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3206, %3207 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3208 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1776 = tensor.expand_shape %3194 [[0], [1], [2, 3]] output_shape [4, %dim_1775, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3210 = tensor.empty(%dim_1775) : tensor<4x?x256xf32>
    %3211 = linalg.fill ins(%cst_3 : f32) outs(%3210 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %3212 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1776, %3209 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%3211 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %3213 = tensor.empty(%dim_1775) : tensor<4x?x256xf16>
    %3214 = linalg.copy ins(%3212 : tensor<4x?x256xf32>) outs(%3213 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %3215 = iree_tensor_ext.bitcast %__auto.blk.21.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1777 = tensor.expand_shape %3215 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1778 = tensor.extract_slice %expanded_1777[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3216 = iree_tensor_ext.bitcast %extracted_slice_1778 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1779 = tensor.extract_slice %expanded_1777[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3217 = iree_tensor_ext.bitcast %extracted_slice_1779 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %dim_1780 = tensor.dim %3194, %c1 : tensor<4x?x2048xf16>
    %3218 = tensor.empty() : tensor<256x64x32xf16>
    %3219 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3216, %3217 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3218 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1781 = tensor.expand_shape %3194 [[0], [1], [2, 3]] output_shape [4, %dim_1780, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3220 = tensor.empty(%dim_1780) : tensor<4x?x256xf32>
    %3221 = linalg.fill ins(%cst_3 : f32) outs(%3220 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %3222 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1781, %3219 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%3221 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x256xf32>
    %3223 = tensor.empty(%dim_1780) : tensor<4x?x256xf16>
    %3224 = linalg.copy ins(%3222 : tensor<4x?x256xf32>) outs(%3223 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %dim_1782 = tensor.dim %3204, %c1 : tensor<4x?x2048xf16>
    %expanded_1783 = tensor.expand_shape %3204 [[0], [1], [2, 3]] output_shape [4, %dim_1782, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %dim_1784 = tensor.dim %3214, %c1 : tensor<4x?x256xf16>
    %expanded_1785 = tensor.expand_shape %3214 [[0], [1], [2, 3]] output_shape [4, %dim_1784, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %dim_1786 = tensor.dim %3224, %c1 : tensor<4x?x256xf16>
    %expanded_1787 = tensor.expand_shape %3224 [[0], [1], [2, 3]] output_shape [4, %dim_1786, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %3225 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1788 = tensor.expand_shape %3225 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %3226 = linalg.batch_matmul ins(%expanded_1788, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1789 = linalg.transpose ins(%3226 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %3227 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1789 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3228 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3227, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3229 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3228 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %3230 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1789 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3231 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3230, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3232 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3231 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1790 = tensor.expand_shape %3229 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1791 = tensor.expand_shape %3232 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1792 = tensor.extract_slice %expanded_1783[0, 0, 0, 0] [4, %dim_1782, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1793 = tensor.extract_slice %expanded_1783[0, 0, 0, 1] [4, %dim_1782, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %3233 = tensor.empty(%dim_1782) : tensor<4x?x32x32xf16>
    %3234 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1792, %expanded_1790 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3233 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3235 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1793, %expanded_1791 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3233 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3236 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3234, %3235 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%3233 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3237 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1793, %expanded_1790 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3233 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3238 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1792, %expanded_1791 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%3233 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %3239 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3237, %3238 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%3233 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x32x32xf16>
    %dim_1794 = tensor.dim %3236, %c1 : tensor<4x?x32x32xf16>
    %3240 = tensor.empty(%dim_1794) : tensor<4x?x32x2x32xf16>
    %3241 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3236, %3239 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%3240 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1795 = tensor.collapse_shape %3241 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %3242 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%73 : tensor<32xf32>) outs(%70 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %3358, "unimplemented: tensor with zero element"
      %3359 = arith.divf %cst_4, %in : f32
      linalg.yield %3359 : f32
    } -> tensor<32xf32>
    %expanded_1796 = tensor.expand_shape %3242 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %3243 = linalg.batch_matmul ins(%expanded_1796, %76 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%78 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1797 = linalg.transpose ins(%3243 : tensor<1x32x?xf32>) outs(%80 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %3244 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1797 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.cos %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3245 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3244, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3246 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3245 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %3247 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1797 : tensor<1x?x32xf32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.sin %in : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3248 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3247, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%80 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<1x?x32xf32>
    %3249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3248 : tensor<1x?x32xf32>) outs(%83 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1798 = tensor.expand_shape %3246 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1799 = tensor.expand_shape %3249 [[0], [1], [2, 3]] output_shape [1, %dim_11, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1800 = tensor.extract_slice %expanded_1785[0, 0, 0, 0] [4, %dim_1784, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1801 = tensor.extract_slice %expanded_1785[0, 0, 0, 1] [4, %dim_1784, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %3250 = tensor.empty(%dim_1784) : tensor<4x?x4x32xf16>
    %3251 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1800, %expanded_1798 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3250 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3252 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1801, %expanded_1799 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3250 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3253 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3251, %3252 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%3250 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.subf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3254 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1801, %expanded_1798 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3250 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3255 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1800, %expanded_1799 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%3250 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %3256 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3254, %3255 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%3250 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x4x32xf16>
    %dim_1802 = tensor.dim %3253, %c1 : tensor<4x?x4x32xf16>
    %3257 = tensor.empty(%dim_1802) : tensor<4x?x4x2x32xf16>
    %3258 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3253, %3256 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%3257 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = linalg.index 3 : index
      %3359 = arith.cmpi eq, %3358, %c0 : index
      %3360 = arith.select %3359, %in, %in_1860 : f16
      linalg.yield %3360 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1803 = tensor.collapse_shape %3258 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %3259 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%115 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c21_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %3260 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%3259 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1804 = tensor.collapse_shape %3260 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %dim_1805 = tensor.dim %3258, %c1 : tensor<4x?x4x2x32xf16>
    %3261 = arith.divsi %dim_1805, %c32 : index
    %expanded_1806 = tensor.expand_shape %collapsed_1803 [[0], [1, 2], [3], [4]] output_shape [4, %3261, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1807 = tensor.collapse_shape %expanded_1806 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %3262 = affine.apply #map14()[%3261]
    %3263 = tensor.empty(%3262) : tensor<?x4x32x64xf16>
    %transposed_1808 = linalg.transpose ins(%collapsed_1807 : tensor<?x32x4x64xf16>) outs(%3263 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1809 = tensor.expand_shape %collapsed_1804 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %3264 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1808, %expanded_1809 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%3120 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %3265 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%3260 : tensor<4x?xi64>) outs(%114 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3358 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3358 : i64
    } -> tensor<4x?xi64>
    %collapsed_1810 = tensor.collapse_shape %3265 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %3266 = arith.divsi %dim_1786, %c32 : index
    %expanded_1811 = tensor.expand_shape %3224 [[0], [1, 2], [3, 4]] output_shape [4, %3266, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1812 = tensor.collapse_shape %expanded_1811 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %3267 = affine.apply #map14()[%3266]
    %3268 = tensor.empty(%3267) : tensor<?x4x32x64xf16>
    %transposed_1813 = linalg.transpose ins(%collapsed_1812 : tensor<?x32x4x64xf16>) outs(%3268 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1814 = tensor.expand_shape %collapsed_1810 [[0, 1]] output_shape [%120, 1] : tensor<?xi64> into tensor<?x1xi64>
    %3269 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1813, %expanded_1814 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%3264 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %dim_1815 = tensor.dim %3269, %c0 : tensor<?x4x32x64xf16>
    %3270 = arith.divsi %dim_1815, %c44 : index
    %expanded_1816 = tensor.expand_shape %3269 [[0, 1, 2], [3], [4], [5]] output_shape [%3270, 22, 2, 4, 32, 64] : tensor<?x4x32x64xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_1817 = tensor.collapse_shape %expanded_1816 [[0], [1, 2, 3, 4, 5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x360448xf16>
    %3271 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1803 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1818 = tensor.collapse_shape %3271 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %3272 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1787 : tensor<4x?x4x64xf16>) outs(%138 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1819 = tensor.collapse_shape %3272 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %dim_1820 = tensor.dim %3241, %c1 : tensor<4x?x32x2x32xf16>
    %3273 = tensor.empty(%dim_1820) : tensor<4x32x?x64xf16>
    %transposed_1821 = linalg.transpose ins(%collapsed_1795 : tensor<4x?x32x64xf16>) outs(%3273 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3274 = tensor.empty(%dim_1805) : tensor<4x32x?x64xf16>
    %transposed_1822 = linalg.transpose ins(%collapsed_1818 : tensor<4x?x32x64xf16>) outs(%3274 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3275 = tensor.empty(%dim_1786) : tensor<4x32x?x64xf16>
    %transposed_1823 = linalg.transpose ins(%collapsed_1819 : tensor<4x?x32x64xf16>) outs(%3275 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1824 = tensor.collapse_shape %transposed_1821 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1825 = tensor.collapse_shape %transposed_1822 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1826 = tensor.collapse_shape %transposed_1823 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %dim_1827 = tensor.dim %transposed_1821, %c2 : tensor<4x32x?x64xf16>
    %3276 = tensor.empty(%dim_1827) : tensor<128x?x64xf16>
    %3277 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1824, %collapsed_1825, %collapsed_1826, %cst, %collapsed_80 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%3276 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1828 = tensor.expand_shape %3277 [[0, 1], [2], [3]] output_shape [4, 32, %dim_1827, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1829 = tensor.dim %expanded_1828, %c2 : tensor<4x32x?x64xf16>
    %3278 = tensor.empty(%dim_1829) : tensor<4x?x32x64xf16>
    %transposed_1830 = linalg.transpose ins(%expanded_1828 : tensor<4x32x?x64xf16>) outs(%3278 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1831 = tensor.collapse_shape %transposed_1830 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %3279 = iree_tensor_ext.bitcast %__auto.blk.21.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1832 = tensor.expand_shape %3279 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1833 = tensor.extract_slice %expanded_1832[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3280 = iree_tensor_ext.bitcast %extracted_slice_1833 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1834 = tensor.extract_slice %expanded_1832[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3281 = iree_tensor_ext.bitcast %extracted_slice_1834 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1835 = tensor.dim %collapsed_1831, %c1 : tensor<4x?x2048xf16>
    %3282 = tensor.empty() : tensor<2048x64x32xf16>
    %3283 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3280, %3281 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3282 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1836 = tensor.expand_shape %collapsed_1831 [[0], [1], [2, 3]] output_shape [4, %dim_1835, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3284 = tensor.empty(%dim_1835) : tensor<4x?x2048xf32>
    %3285 = linalg.fill ins(%cst_3 : f32) outs(%3284 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %3286 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1836, %3283 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%3285 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %3287 = tensor.empty(%dim_1835) : tensor<4x?x2048xf16>
    %3288 = linalg.copy ins(%3286 : tensor<4x?x2048xf32>) outs(%3287 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %3289 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3184, %3288 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3290 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3289 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3291 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3290 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3292 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3291 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3293 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3292 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3294 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3293 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3295 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3294 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3296 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3290, %3295 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3297 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3296 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3298 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.ffn_norm.weight, %3297 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %3299 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3298 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3300 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1837 = tensor.expand_shape %3300 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1838 = tensor.extract_slice %expanded_1837[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3301 = iree_tensor_ext.bitcast %extracted_slice_1838 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1839 = tensor.extract_slice %expanded_1837[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3302 = iree_tensor_ext.bitcast %extracted_slice_1839 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1840 = tensor.dim %3299, %c1 : tensor<4x?x2048xf16>
    %3303 = tensor.empty() : tensor<5632x64x32xf16>
    %3304 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3301, %3302 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3303 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1841 = tensor.expand_shape %3299 [[0], [1], [2, 3]] output_shape [4, %dim_1840, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3305 = tensor.empty(%dim_1840) : tensor<4x?x5632xf32>
    %3306 = linalg.fill ins(%cst_3 : f32) outs(%3305 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %3307 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1841, %3304 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%3306 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %3308 = tensor.empty(%dim_1840) : tensor<4x?x5632xf16>
    %3309 = linalg.copy ins(%3307 : tensor<4x?x5632xf32>) outs(%3308 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %dim_1842 = tensor.dim %3309, %c1 : tensor<4x?x5632xf16>
    %3310 = tensor.empty(%dim_1842) : tensor<4x?x5632xf16>
    %3311 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3309 : tensor<4x?x5632xf16>) outs(%3310 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3358 = arith.negf %in : f16
      %3359 = math.exp %3358 : f16
      %3360 = arith.addf %3359, %cst_5 : f16
      %3361 = arith.divf %cst_5, %3360 : f16
      linalg.yield %3361 : f16
    } -> tensor<4x?x5632xf16>
    %3312 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3311, %3309 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%3310 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %3313 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1843 = tensor.expand_shape %3313 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1844 = tensor.extract_slice %expanded_1843[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3314 = iree_tensor_ext.bitcast %extracted_slice_1844 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1845 = tensor.extract_slice %expanded_1843[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3315 = iree_tensor_ext.bitcast %extracted_slice_1845 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %dim_1846 = tensor.dim %3299, %c1 : tensor<4x?x2048xf16>
    %3316 = tensor.empty() : tensor<5632x64x32xf16>
    %3317 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3314, %3315 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3316 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1847 = tensor.expand_shape %3299 [[0], [1], [2, 3]] output_shape [4, %dim_1846, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3318 = tensor.empty(%dim_1846) : tensor<4x?x5632xf32>
    %3319 = linalg.fill ins(%cst_3 : f32) outs(%3318 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %3320 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1847, %3317 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%3319 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x5632xf32>
    %3321 = tensor.empty(%dim_1846) : tensor<4x?x5632xf16>
    %3322 = linalg.copy ins(%3320 : tensor<4x?x5632xf32>) outs(%3321 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %3323 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3312, %3322 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%3310 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.mulf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x5632xf16>
    %3324 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1848 = tensor.expand_shape %3324 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1849 = tensor.extract_slice %expanded_1848[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %3325 = iree_tensor_ext.bitcast %extracted_slice_1849 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1850 = tensor.extract_slice %expanded_1848[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %3326 = iree_tensor_ext.bitcast %extracted_slice_1850 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %dim_1851 = tensor.dim %3323, %c1 : tensor<4x?x5632xf16>
    %3327 = tensor.empty() : tensor<2048x176x32xf16>
    %3328 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3325, %3326 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%3327 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1852 = tensor.expand_shape %3323 [[0], [1], [2, 3]] output_shape [4, %dim_1851, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %3329 = tensor.empty(%dim_1851) : tensor<4x?x2048xf32>
    %3330 = linalg.fill ins(%cst_3 : f32) outs(%3329 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %3331 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1852, %3328 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%3330 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x2048xf32>
    %3332 = tensor.empty(%dim_1851) : tensor<4x?x2048xf16>
    %3333 = linalg.copy ins(%3331 : tensor<4x?x2048xf32>) outs(%3332 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %3334 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3289, %3333 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f16):
      %3358 = arith.addf %in, %in_1860 : f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3335 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3334 : tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3358 = arith.extf %in : f16 to f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3336 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3335 : tensor<4x?x2048xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3337 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3336 : tensor<4x?x2048xf32>) outs(%27 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %out : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3338 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3337 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.divf %in, %cst_6 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3339 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3338 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = arith.addf %in, %cst_7 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3339 : tensor<4x?x1xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3358 = math.rsqrt %in : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x1xf32>
    %3341 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3335, %3340 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f32, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f32
      linalg.yield %3358 : f32
    } -> tensor<4x?x2048xf32>
    %3342 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3341 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3343 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.output_norm.weight, %3342 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%23 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1860: f16, %out: f32):
      %3358 = arith.extf %in_1860 : f16 to f32
      %3359 = arith.mulf %in, %3358 : f32
      linalg.yield %3359 : f32
    } -> tensor<4x?x2048xf32>
    %3344 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3343 : tensor<4x?x2048xf32>) outs(%21 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3358 = arith.truncf %in : f32 to f16
      linalg.yield %3358 : f16
    } -> tensor<4x?x2048xf16>
    %3345 = iree_tensor_ext.bitcast %__auto.output.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded_1853 = tensor.expand_shape %3345 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice_1854 = tensor.extract_slice %expanded_1853[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %3346 = iree_tensor_ext.bitcast %extracted_slice_1854 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_1855 = tensor.extract_slice %expanded_1853[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %3347 = iree_tensor_ext.bitcast %extracted_slice_1855 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %dim_1856 = tensor.dim %3344, %c1 : tensor<4x?x2048xf16>
    %3348 = tensor.empty() : tensor<32000x64x32xf16>
    %3349 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3346, %3347 : tensor<32000x64x1xf16>, tensor<32000x64x32xi8>) outs(%3348 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1860: i8, %out: f16):
      %3358 = arith.extsi %in_1860 : i8 to i32
      %3359 = arith.sitofp %3358 : i32 to f16
      %3360 = arith.mulf %3359, %in : f16
      linalg.yield %3360 : f16
    } -> tensor<32000x64x32xf16>
    %expanded_1857 = tensor.expand_shape %3344 [[0], [1], [2, 3]] output_shape [4, %dim_1856, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %3350 = tensor.empty(%dim_1856) : tensor<4x?x32000xf32>
    %3351 = linalg.fill ins(%cst_3 : f32) outs(%3350 : tensor<4x?x32000xf32>) -> tensor<4x?x32000xf32>
    %3352 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1857, %3349 : tensor<4x?x64x32xf16>, tensor<32000x64x32xf16>) outs(%3351 : tensor<4x?x32000xf32>) {
    ^bb0(%in: f16, %in_1860: f16, %out: f32):
      %3358 = arith.mulf %in, %in_1860 : f16
      %3359 = arith.extf %3358 : f16 to f32
      %3360 = arith.addf %3359, %out : f32
      linalg.yield %3360 : f32
    } -> tensor<4x?x32000xf32>
    %3353 = tensor.empty(%dim_1856) : tensor<4x?x32000xf16>
    %3354 = linalg.copy ins(%3352 : tensor<4x?x32000xf32>) outs(%3353 : tensor<4x?x32000xf16>) -> tensor<4x?x32000xf16>
    %dim_1858 = tensor.dim %collapsed_1817, %c0 : tensor<?x360448xf16>
    %3355 = hal.tensor.alias on(#hal.device.promise<@__device_0>) wait(%arg4) => %collapsed_1817 : tensor<?x360448xf16>{%dim_1858} to %arg3 : !hal.buffer_view
    %3356:2 = hal.tensor.barrier join(%3355, %3354 : tensor<?x360448xf16>, tensor<4x?x32000xf16>) => %arg5 : !hal.fence
    %dim_1859 = tensor.dim %3356#1, %c1 : tensor<4x?x32000xf16>
    %3357 = hal.tensor.export %3356#1 : tensor<4x?x32000xf16>{%dim_1859} -> !hal.buffer_view
    util.return %3357 : !hal.buffer_view
  }
  util.func public @prefill_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @prefill_bs4$async(%arg0, %arg1, %arg2, %arg3, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
  util.func public @decode_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view, %arg5: !hal.fence, %arg6: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %c21 = arith.constant 21 : index
    %c20 = arith.constant 20 : index
    %c19 = arith.constant 19 : index
    %c18 = arith.constant 18 : index
    %c17 = arith.constant 17 : index
    %c16 = arith.constant 16 : index
    %c15 = arith.constant 15 : index
    %c14 = arith.constant 14 : index
    %c13 = arith.constant 13 : index
    %c12 = arith.constant 12 : index
    %c11 = arith.constant 11 : index
    %c10 = arith.constant 10 : index
    %c9 = arith.constant 9 : index
    %c8 = arith.constant 8 : index
    %c7 = arith.constant 7 : index
    %c6 = arith.constant 6 : index
    %c5 = arith.constant 5 : index
    %c4 = arith.constant 4 : index
    %c2 = arith.constant 2 : index
    %cst = arith.constant 1.250000e-01 : f16
    %c3 = arith.constant 3 : index
    %cst_0 = arith.constant dense<1> : tensor<1x1x1xi64>
    %cst_1 = arith.constant dense<0> : tensor<1x1x1xi64>
    %c21_i64 = arith.constant 21 : i64
    %c20_i64 = arith.constant 20 : i64
    %c19_i64 = arith.constant 19 : i64
    %c18_i64 = arith.constant 18 : i64
    %c16_i64 = arith.constant 16 : i64
    %c15_i64 = arith.constant 15 : i64
    %c14_i64 = arith.constant 14 : i64
    %c13_i64 = arith.constant 13 : i64
    %c12_i64 = arith.constant 12 : i64
    %c11_i64 = arith.constant 11 : i64
    %c10_i64 = arith.constant 10 : i64
    %c9_i64 = arith.constant 9 : i64
    %c7_i64 = arith.constant 7 : i64
    %c8_i64 = arith.constant 8 : i64
    %c22_i64 = arith.constant 22 : i64
    %c3_i64 = arith.constant 3 : i64
    %c32_i64 = arith.constant 32 : i64
    %c4_i64 = arith.constant 4 : i64
    %c6_i64 = arith.constant 6 : i64
    %c5_i64 = arith.constant 5 : i64
    %c17_i64 = arith.constant 17 : i64
    %c2_i64 = arith.constant 2 : i64
    %c0_i64 = arith.constant 0 : i64
    %c1_i64 = arith.constant 1 : i64
    %c0 = arith.constant 0 : index
    %cst_2 = arith.constant dense<0xFC00> : tensor<f16>
    %cst_3 = arith.constant dense<0> : tensor<i64>
    %cst_4 = arith.constant dense<1.000000e+00> : tensor<f32>
    %c1 = arith.constant 1 : index
    %c32000 = arith.constant 32000 : index
    %cst_5 = arith.constant 0.000000e+00 : f32
    %cst_6 = arith.constant 1.000000e+00 : f32
    %c5632 = arith.constant 5632 : index
    %cst_7 = arith.constant 1.000000e+00 : f16
    %cst_8 = arith.constant 2.048000e+03 : f32
    %cst_9 = arith.constant 9.99999974E-6 : f32
    %cst_10 = arith.constant 6.400000e+01 : f32
    %cst_11 = arith.constant 1.000000e+04 : f32
    %cst_12 = arith.constant 3.200000e+01 : f32
    %0 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg0 : !hal.buffer_view -> tensor<4x1xi64>
    %1 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %2 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg2 : !hal.buffer_view -> tensor<4xi64>
    %3 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[1] : index
    %4 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg3 : !hal.buffer_view -> tensor<4x?xi64>{%3}
    %dim = tensor.dim %4, %c1 : tensor<4x?xi64>
    %__auto.token_embd.weight = util.global.load @__auto.token_embd.weight : tensor<32000x2176xi8>
    %__auto.blk.0.attn_norm.weight = util.global.load @__auto.blk.0.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.attn_q.weight = util.global.load @__auto.blk.0.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.0.attn_k.weight = util.global.load @__auto.blk.0.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_v.weight = util.global.load @__auto.blk.0.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_output.weight = util.global.load @__auto.blk.0.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.0.ffn_norm.weight = util.global.load @__auto.blk.0.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.ffn_gate.weight = util.global.load @__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_up.weight = util.global.load @__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_down.weight = util.global.load @__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.1.attn_norm.weight = util.global.load @__auto.blk.1.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.attn_q.weight = util.global.load @__auto.blk.1.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.1.attn_k.weight = util.global.load @__auto.blk.1.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_v.weight = util.global.load @__auto.blk.1.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_output.weight = util.global.load @__auto.blk.1.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.1.ffn_norm.weight = util.global.load @__auto.blk.1.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.ffn_gate.weight = util.global.load @__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_up.weight = util.global.load @__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_down.weight = util.global.load @__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.2.attn_norm.weight = util.global.load @__auto.blk.2.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.attn_q.weight = util.global.load @__auto.blk.2.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.2.attn_k.weight = util.global.load @__auto.blk.2.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_v.weight = util.global.load @__auto.blk.2.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_output.weight = util.global.load @__auto.blk.2.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.2.ffn_norm.weight = util.global.load @__auto.blk.2.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.ffn_gate.weight = util.global.load @__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_up.weight = util.global.load @__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_down.weight = util.global.load @__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.3.attn_norm.weight = util.global.load @__auto.blk.3.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.attn_q.weight = util.global.load @__auto.blk.3.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.3.attn_k.weight = util.global.load @__auto.blk.3.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_v.weight = util.global.load @__auto.blk.3.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_output.weight = util.global.load @__auto.blk.3.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.3.ffn_norm.weight = util.global.load @__auto.blk.3.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.ffn_gate.weight = util.global.load @__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_up.weight = util.global.load @__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_down.weight = util.global.load @__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.4.attn_norm.weight = util.global.load @__auto.blk.4.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.attn_q.weight = util.global.load @__auto.blk.4.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.4.attn_k.weight = util.global.load @__auto.blk.4.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_v.weight = util.global.load @__auto.blk.4.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_output.weight = util.global.load @__auto.blk.4.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.4.ffn_norm.weight = util.global.load @__auto.blk.4.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.ffn_gate.weight = util.global.load @__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_up.weight = util.global.load @__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_down.weight = util.global.load @__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.5.attn_norm.weight = util.global.load @__auto.blk.5.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.attn_q.weight = util.global.load @__auto.blk.5.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.5.attn_k.weight = util.global.load @__auto.blk.5.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_v.weight = util.global.load @__auto.blk.5.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_output.weight = util.global.load @__auto.blk.5.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.5.ffn_norm.weight = util.global.load @__auto.blk.5.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.ffn_gate.weight = util.global.load @__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_up.weight = util.global.load @__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_down.weight = util.global.load @__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.6.attn_norm.weight = util.global.load @__auto.blk.6.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.attn_q.weight = util.global.load @__auto.blk.6.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.6.attn_k.weight = util.global.load @__auto.blk.6.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_v.weight = util.global.load @__auto.blk.6.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_output.weight = util.global.load @__auto.blk.6.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.6.ffn_norm.weight = util.global.load @__auto.blk.6.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.ffn_gate.weight = util.global.load @__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_up.weight = util.global.load @__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_down.weight = util.global.load @__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.7.attn_norm.weight = util.global.load @__auto.blk.7.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.attn_q.weight = util.global.load @__auto.blk.7.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.7.attn_k.weight = util.global.load @__auto.blk.7.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_v.weight = util.global.load @__auto.blk.7.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_output.weight = util.global.load @__auto.blk.7.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.7.ffn_norm.weight = util.global.load @__auto.blk.7.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.ffn_gate.weight = util.global.load @__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_up.weight = util.global.load @__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_down.weight = util.global.load @__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.8.attn_norm.weight = util.global.load @__auto.blk.8.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.attn_q.weight = util.global.load @__auto.blk.8.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.8.attn_k.weight = util.global.load @__auto.blk.8.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_v.weight = util.global.load @__auto.blk.8.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_output.weight = util.global.load @__auto.blk.8.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.8.ffn_norm.weight = util.global.load @__auto.blk.8.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.ffn_gate.weight = util.global.load @__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_up.weight = util.global.load @__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_down.weight = util.global.load @__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.9.attn_norm.weight = util.global.load @__auto.blk.9.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.attn_q.weight = util.global.load @__auto.blk.9.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.9.attn_k.weight = util.global.load @__auto.blk.9.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_v.weight = util.global.load @__auto.blk.9.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_output.weight = util.global.load @__auto.blk.9.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.9.ffn_norm.weight = util.global.load @__auto.blk.9.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.ffn_gate.weight = util.global.load @__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_up.weight = util.global.load @__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_down.weight = util.global.load @__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.10.attn_norm.weight = util.global.load @__auto.blk.10.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.attn_q.weight = util.global.load @__auto.blk.10.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.10.attn_k.weight = util.global.load @__auto.blk.10.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_v.weight = util.global.load @__auto.blk.10.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_output.weight = util.global.load @__auto.blk.10.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.10.ffn_norm.weight = util.global.load @__auto.blk.10.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.ffn_gate.weight = util.global.load @__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_up.weight = util.global.load @__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_down.weight = util.global.load @__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.11.attn_norm.weight = util.global.load @__auto.blk.11.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.attn_q.weight = util.global.load @__auto.blk.11.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.11.attn_k.weight = util.global.load @__auto.blk.11.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_v.weight = util.global.load @__auto.blk.11.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_output.weight = util.global.load @__auto.blk.11.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.11.ffn_norm.weight = util.global.load @__auto.blk.11.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.ffn_gate.weight = util.global.load @__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_up.weight = util.global.load @__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_down.weight = util.global.load @__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.12.attn_norm.weight = util.global.load @__auto.blk.12.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.attn_q.weight = util.global.load @__auto.blk.12.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.12.attn_k.weight = util.global.load @__auto.blk.12.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_v.weight = util.global.load @__auto.blk.12.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_output.weight = util.global.load @__auto.blk.12.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.12.ffn_norm.weight = util.global.load @__auto.blk.12.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.ffn_gate.weight = util.global.load @__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_up.weight = util.global.load @__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_down.weight = util.global.load @__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.13.attn_norm.weight = util.global.load @__auto.blk.13.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.attn_q.weight = util.global.load @__auto.blk.13.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.13.attn_k.weight = util.global.load @__auto.blk.13.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_v.weight = util.global.load @__auto.blk.13.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_output.weight = util.global.load @__auto.blk.13.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.13.ffn_norm.weight = util.global.load @__auto.blk.13.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.ffn_gate.weight = util.global.load @__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_up.weight = util.global.load @__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_down.weight = util.global.load @__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.14.attn_norm.weight = util.global.load @__auto.blk.14.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.attn_q.weight = util.global.load @__auto.blk.14.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.14.attn_k.weight = util.global.load @__auto.blk.14.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_v.weight = util.global.load @__auto.blk.14.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_output.weight = util.global.load @__auto.blk.14.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.14.ffn_norm.weight = util.global.load @__auto.blk.14.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.ffn_gate.weight = util.global.load @__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_up.weight = util.global.load @__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_down.weight = util.global.load @__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.15.attn_norm.weight = util.global.load @__auto.blk.15.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.attn_q.weight = util.global.load @__auto.blk.15.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.15.attn_k.weight = util.global.load @__auto.blk.15.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_v.weight = util.global.load @__auto.blk.15.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_output.weight = util.global.load @__auto.blk.15.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.15.ffn_norm.weight = util.global.load @__auto.blk.15.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.ffn_gate.weight = util.global.load @__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_up.weight = util.global.load @__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_down.weight = util.global.load @__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.16.attn_norm.weight = util.global.load @__auto.blk.16.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.attn_q.weight = util.global.load @__auto.blk.16.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.16.attn_k.weight = util.global.load @__auto.blk.16.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_v.weight = util.global.load @__auto.blk.16.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_output.weight = util.global.load @__auto.blk.16.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.16.ffn_norm.weight = util.global.load @__auto.blk.16.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.ffn_gate.weight = util.global.load @__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_up.weight = util.global.load @__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_down.weight = util.global.load @__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.17.attn_norm.weight = util.global.load @__auto.blk.17.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.attn_q.weight = util.global.load @__auto.blk.17.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.17.attn_k.weight = util.global.load @__auto.blk.17.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_v.weight = util.global.load @__auto.blk.17.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_output.weight = util.global.load @__auto.blk.17.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.17.ffn_norm.weight = util.global.load @__auto.blk.17.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.ffn_gate.weight = util.global.load @__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_up.weight = util.global.load @__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_down.weight = util.global.load @__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.18.attn_norm.weight = util.global.load @__auto.blk.18.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.attn_q.weight = util.global.load @__auto.blk.18.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.18.attn_k.weight = util.global.load @__auto.blk.18.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_v.weight = util.global.load @__auto.blk.18.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_output.weight = util.global.load @__auto.blk.18.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.18.ffn_norm.weight = util.global.load @__auto.blk.18.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.ffn_gate.weight = util.global.load @__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_up.weight = util.global.load @__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_down.weight = util.global.load @__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.19.attn_norm.weight = util.global.load @__auto.blk.19.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.attn_q.weight = util.global.load @__auto.blk.19.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.19.attn_k.weight = util.global.load @__auto.blk.19.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_v.weight = util.global.load @__auto.blk.19.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_output.weight = util.global.load @__auto.blk.19.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.19.ffn_norm.weight = util.global.load @__auto.blk.19.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.ffn_gate.weight = util.global.load @__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_up.weight = util.global.load @__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_down.weight = util.global.load @__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.20.attn_norm.weight = util.global.load @__auto.blk.20.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.attn_q.weight = util.global.load @__auto.blk.20.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.20.attn_k.weight = util.global.load @__auto.blk.20.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_v.weight = util.global.load @__auto.blk.20.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_output.weight = util.global.load @__auto.blk.20.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.20.ffn_norm.weight = util.global.load @__auto.blk.20.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.ffn_gate.weight = util.global.load @__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_up.weight = util.global.load @__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_down.weight = util.global.load @__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.21.attn_norm.weight = util.global.load @__auto.blk.21.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.attn_q.weight = util.global.load @__auto.blk.21.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.21.attn_k.weight = util.global.load @__auto.blk.21.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_v.weight = util.global.load @__auto.blk.21.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_output.weight = util.global.load @__auto.blk.21.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.21.ffn_norm.weight = util.global.load @__auto.blk.21.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.ffn_gate.weight = util.global.load @__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_up.weight = util.global.load @__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_down.weight = util.global.load @__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.output_norm.weight = util.global.load @__auto.output_norm.weight : tensor<2048xf32>
    %__auto.output.weight = util.global.load @__auto.output.weight : tensor<32000x2176xi8>
    %5 = hal.buffer_view.dim<%arg4 : !hal.buffer_view>[0] : index
    %6 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg4 : !hal.buffer_view -> tensor<?x360448xf16>{%5}
    %dim_13 = tensor.dim %6, %c0 : tensor<?x360448xf16>
    %7 = util.assume.int %dim<umin = 1, umax = 63> : index
    %8 = flow.tensor.tie_shape %4 : tensor<4x?xi64>{%7}
    %9 = util.assume.int %dim_13<umin = 1, umax = 9007199254740991> : index
    %10 = flow.tensor.tie_shape %6 : tensor<?x360448xf16>{%9}
    %dim_14 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %11 = arith.index_cast %dim_14 : index to i64
    %12 = iree_tensor_ext.bitcast %__auto.token_embd.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded = tensor.expand_shape %12 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice = tensor.extract_slice %expanded[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %13 = iree_tensor_ext.bitcast %extracted_slice : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_15 = tensor.extract_slice %expanded[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %14 = iree_tensor_ext.bitcast %extracted_slice_15 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %15 = tensor.empty() : tensor<32000x64x32xf16>
    %16 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%14 : tensor<32000x64x32xi8>) outs(%15 : tensor<32000x64x32xf16>) {
    ^bb0(%in: i8, %out: f16):
      %3584 = arith.sitofp %in : i8 to f16
      linalg.yield %3584 : f16
    } -> tensor<32000x64x32xf16>
    %17 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%13, %16 : tensor<32000x64x1xf16>, tensor<32000x64x32xf16>) outs(%15 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed = tensor.collapse_shape %17 [[0], [1, 2]] : tensor<32000x64x32xf16> into tensor<32000x2048xf16>
    %18 = tensor.empty() : tensor<4x1x2048xf16>
    %19 = linalg.generic {indexing_maps = [#map2, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%0 : tensor<4x1xi64>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: i64, %out: f16):
      %3584 = arith.index_cast %in : i64 to index
      %3585 = linalg.index 2 : index
      %3586 = arith.cmpi slt, %3584, %c32000 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %collapsed[%3584, %3585] : tensor<32000x2048xf16>
      linalg.yield %extracted : f16
    } -> tensor<4x1x2048xf16>
    %20 = tensor.empty() : tensor<4x1x2048xf32>
    %21 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%19 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %22 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%21 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %23 = tensor.empty() : tensor<4x1x1xf32>
    %24 = linalg.fill ins(%cst_5 : f32) outs(%23 : tensor<4x1x1xf32>) -> tensor<4x1x1xf32>
    %25 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%22 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %26 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%25 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %27 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%26 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %28 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%27 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %29 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%21, %28 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %30 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%29 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %31 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.attn_norm.weight, %30 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %32 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%31 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %33 = iree_tensor_ext.bitcast %__auto.blk.0.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_16 = tensor.expand_shape %33 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_17 = tensor.extract_slice %expanded_16[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %34 = iree_tensor_ext.bitcast %extracted_slice_17 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_18 = tensor.extract_slice %expanded_16[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %35 = iree_tensor_ext.bitcast %extracted_slice_18 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %36 = tensor.empty() : tensor<2048x64x32xf16>
    %37 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%34, %35 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_19 = tensor.expand_shape %32 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %38 = tensor.empty() : tensor<4x1x2048xf32>
    %39 = linalg.fill ins(%cst_5 : f32) outs(%38 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %40 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_19, %37 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%39 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %41 = tensor.empty() : tensor<4x1x2048xf16>
    %42 = linalg.copy ins(%40 : tensor<4x1x2048xf32>) outs(%41 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %43 = iree_tensor_ext.bitcast %__auto.blk.0.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_20 = tensor.expand_shape %43 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_21 = tensor.extract_slice %expanded_20[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %44 = iree_tensor_ext.bitcast %extracted_slice_21 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_22 = tensor.extract_slice %expanded_20[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %45 = iree_tensor_ext.bitcast %extracted_slice_22 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %46 = tensor.empty() : tensor<256x64x32xf16>
    %47 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%44, %45 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_23 = tensor.expand_shape %32 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %48 = tensor.empty() : tensor<4x1x256xf32>
    %49 = linalg.fill ins(%cst_5 : f32) outs(%48 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %50 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_23, %47 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %51 = tensor.empty() : tensor<4x1x256xf16>
    %52 = linalg.copy ins(%50 : tensor<4x1x256xf32>) outs(%51 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %53 = iree_tensor_ext.bitcast %__auto.blk.0.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_24 = tensor.expand_shape %53 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_25 = tensor.extract_slice %expanded_24[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %54 = iree_tensor_ext.bitcast %extracted_slice_25 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_26 = tensor.extract_slice %expanded_24[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %55 = iree_tensor_ext.bitcast %extracted_slice_26 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %56 = tensor.empty() : tensor<256x64x32xf16>
    %57 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%54, %55 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%56 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_27 = tensor.expand_shape %32 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %58 = tensor.empty() : tensor<4x1x256xf32>
    %59 = linalg.fill ins(%cst_5 : f32) outs(%58 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %60 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_27, %57 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%59 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %61 = tensor.empty() : tensor<4x1x256xf16>
    %62 = linalg.copy ins(%60 : tensor<4x1x256xf32>) outs(%61 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_28 = tensor.expand_shape %42 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_29 = tensor.expand_shape %52 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_30 = tensor.expand_shape %62 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %63 = tensor.empty() : tensor<1xi64>
    %64 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%63 : tensor<1xi64>) {
    ^bb0(%out: i64):
      linalg.yield %c0_i64 : i64
    } -> tensor<1xi64>
    %expanded_31 = tensor.expand_shape %64 [[0, 1]] output_shape [1, 1] : tensor<1xi64> into tensor<1x1xi64>
    %expanded_32 = tensor.expand_shape %2 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %65 = tensor.empty() : tensor<4x1xi64>
    %66 = linalg.generic {indexing_maps = [#map28, #map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_31, %expanded_32 : tensor<1x1xi64>, tensor<4x1xi64>) outs(%65 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1xi64>
    %67 = tensor.empty() : tensor<32xi64>
    %68 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%67 : tensor<32xi64>) {
    ^bb0(%out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %3584 : index to i64
      %3586 = arith.muli %3585, %c2_i64 : i64
      linalg.yield %3586 : i64
    } -> tensor<32xi64>
    %69 = tensor.empty() : tensor<32xf32>
    %70 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%68 : tensor<32xi64>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: i64, %out: f32):
      %3584 = arith.sitofp %in : i64 to f32
      linalg.yield %3584 : f32
    } -> tensor<32xf32>
    %71 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%70 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_10 : f32
      linalg.yield %3584 : f32
    } -> tensor<32xf32>
    %72 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%71 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.powf %cst_11, %in : f32
      linalg.yield %3584 : f32
    } -> tensor<32xf32>
    %73 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %74 = tensor.empty() : tensor<4x32x1xf32>
    %expanded_33 = tensor.expand_shape %73 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %75 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_33 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %expanded_34 = tensor.expand_shape %66 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %76 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_34 : tensor<4x1x1xi64>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: i64, %out: f32):
      %3584 = arith.sitofp %in : i64 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %77 = linalg.fill ins(%cst_5 : f32) outs(%74 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %78 = linalg.batch_matmul ins(%75, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %79 = tensor.empty() : tensor<4x1x32xf32>
    %transposed = linalg.transpose ins(%78 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %80 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %81 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%80, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %82 = tensor.empty() : tensor<4x1x32xf16>
    %83 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%81 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %84 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %85 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%84, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %86 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%85 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_35 = tensor.expand_shape %83 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_36 = tensor.expand_shape %86 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %87 = tensor.empty() : tensor<4x1x32x64xf16>
    %extracted_slice_37 = tensor.extract_slice %expanded_28[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_38 = tensor.extract_slice %expanded_28[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %88 = tensor.empty() : tensor<4x1x32x32xf16>
    %89 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_37, %expanded_35 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %90 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %expanded_36 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %91 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%89, %90 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %92 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %expanded_35 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %93 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_37, %expanded_36 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %94 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%92, %93 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %95 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %96 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%91, %94 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%95 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_39 = tensor.collapse_shape %96 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %97 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_40 = tensor.expand_shape %97 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %98 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_40 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %99 = linalg.batch_matmul ins(%98, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_41 = linalg.transpose ins(%99 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %100 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_41 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %101 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%100, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%101 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %103 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_41 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %104 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%103, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %105 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%104 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_42 = tensor.expand_shape %102 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_43 = tensor.expand_shape %105 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_44 = tensor.extract_slice %expanded_29[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_45 = tensor.extract_slice %expanded_29[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %106 = tensor.empty() : tensor<4x1x4x32xf16>
    %107 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_44, %expanded_42 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %108 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_45, %expanded_43 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %109 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%107, %108 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %110 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_45, %expanded_42 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %111 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_44, %expanded_43 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %112 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%110, %111 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %113 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %114 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%109, %112 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%113 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %dim_46 = tensor.dim %10, %c0 : tensor<?x360448xf16>
    %expanded_47 = tensor.expand_shape %10 [[0], [1, 2, 3, 4, 5]] output_shape [%dim_46, 22, 2, 4, 32, 64] : tensor<?x360448xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_48 = tensor.collapse_shape %expanded_47 [[0, 1, 2, 3, 4], [5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x64xf16>
    %115 = tensor.empty() : tensor<4xi64>
    %116 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2 : tensor<4xi64>) outs(%115 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.sitofp %in : i64 to f32
      %3585 = arith.divf %3584, %cst_12 : f32
      %3586 = math.floor %3585 : f32
      %3587 = arith.fptosi %3586 : f32 to i64
      linalg.yield %3587 : i64
    } -> tensor<4xi64>
    %expanded_49 = tensor.expand_shape %116 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %117 = linalg.fill ins(%c0_i64 : i64) outs(%65 : tensor<4x1xi64>) -> tensor<4x1xi64>
    %118 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_50 = tensor.expand_shape %118 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %119 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2 : tensor<4xi64>) outs(%115 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.remsi %in, %c32_i64 : i64
      %3585 = arith.cmpi ne, %3584, %c0_i64 : i64
      %3586 = arith.cmpi slt, %3584, %c0_i64 : i64
      %3587 = arith.andi %3585, %3586 : i1
      %3588 = arith.addi %3584, %c32_i64 : i64
      %3589 = arith.select %3587, %3588, %3584 : i64
      linalg.yield %3589 : i64
    } -> tensor<4xi64>
    %expanded_51 = tensor.expand_shape %119 [[0, 1, 2]] output_shape [4, 1, 1] : tensor<4xi64> into tensor<4x1x1xi64>
    %120 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%115 : tensor<4xi64>) {
    ^bb0(%out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %3584 : index to i64
      linalg.yield %3585 : i64
    } -> tensor<4xi64>
    %expanded_52 = tensor.expand_shape %120 [[0, 1, 2]] output_shape [1, 1, 4] : tensor<4xi64> into tensor<1x1x4xi64>
    %121 = tensor.empty() : tensor<4x1x1xi64>
    %122 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_50 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %123 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%122 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %124 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%123, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %125 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%124 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %126 = tensor.empty() : tensor<4x1x4xi64>
    %127 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%125, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %128 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%127 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %129 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%128, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_53 = tensor.collapse_shape %129 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_54 = tensor.expand_shape %collapsed_53 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_55 = tensor.collapse_shape %114 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %130 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_55, %expanded_54 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%collapsed_48 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %131 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%123, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %132 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%131 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %133 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%132, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %134 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%133 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %135 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%134, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_56 = tensor.collapse_shape %135 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_57 = tensor.expand_shape %collapsed_56 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_58 = tensor.collapse_shape %expanded_30 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %136 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_58, %expanded_57 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%130 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_59 = tensor.dim %136, %c0 : tensor<?x64xf16>
    %137 = arith.divsi %dim_59, %c5632 : index
    %expanded_60 = tensor.expand_shape %136 [[0, 1, 2, 3, 4], [5]] output_shape [%137, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_61 = tensor.dim %expanded_60, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_62 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_63 = tensor.extract_slice %expanded_60[0, %c0, %c0, 0, 0, 0] [%dim_61, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %138 = tensor.empty(%dim_62) : tensor<4x?x4x32x64xf16>
    %139 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_63, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%138 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_64 = tensor.dim %expanded_60, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_65 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_66 = tensor.extract_slice %expanded_60[0, %c0, %c1, 0, 0, 0] [%dim_64, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %140 = tensor.empty(%dim_65) : tensor<4x?x4x32x64xf16>
    %141 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_66, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%140 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_67 = tensor.dim %139, %c1 : tensor<4x?x4x32x64xf16>
    %142 = tensor.empty(%dim_67) : tensor<4x?x32x4x64xf16>
    %transposed_68 = linalg.transpose ins(%139 : tensor<4x?x4x32x64xf16>) outs(%142 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %143 = arith.muli %11, %c32_i64 : i64
    %collapsed_69 = tensor.collapse_shape %transposed_68 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_70 = tensor.dim %141, %c1 : tensor<4x?x4x32x64xf16>
    %144 = tensor.empty(%dim_70) : tensor<4x?x32x4x64xf16>
    %transposed_71 = linalg.transpose ins(%141 : tensor<4x?x4x32x64xf16>) outs(%144 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_72 = tensor.collapse_shape %transposed_71 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %145 = arith.index_cast %143 : i64 to index
    %146 = tensor.empty(%145) : tensor<?xi64>
    %147 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%146 : tensor<?xi64>) {
    ^bb0(%out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %3584 : index to i64
      linalg.yield %3585 : i64
    } -> tensor<?xi64>
    %expanded_73 = tensor.expand_shape %1 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %148 = tensor.empty(%145) : tensor<4x?xi1>
    %149 = linalg.generic {indexing_maps = [#map15, #map16, #map13], iterator_types = ["parallel", "parallel"]} ins(%147, %expanded_73 : tensor<?xi64>, tensor<4x1xi64>) outs(%148 : tensor<4x?xi1>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i1):
      %3584 = arith.cmpi sge, %in, %in_1706 : i64
      linalg.yield %3584 : i1
    } -> tensor<4x?xi1>
    %150 = tensor.empty() : tensor<f16>
    %151 = linalg.generic {indexing_maps = [#map20, #map20], iterator_types = []} ins(%cst_3 : tensor<i64>) outs(%150 : tensor<f16>) {
    ^bb0(%in: i64, %out: f16):
      %3584 = arith.sitofp %in : i64 to f16
      linalg.yield %3584 : f16
    } -> tensor<f16>
    %152 = tensor.empty(%145) : tensor<4x?xf16>
    %153 = linalg.generic {indexing_maps = [#map13, #map31, #map31, #map13], iterator_types = ["parallel", "parallel"]} ins(%149, %cst_2, %151 : tensor<4x?xi1>, tensor<f16>, tensor<f16>) outs(%152 : tensor<4x?xf16>) {
    ^bb0(%in: i1, %in_1706: f16, %in_1707: f16, %out: f16):
      %3584 = arith.select %in, %in_1706, %in_1707 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x?xf16>
    %expanded_74 = tensor.expand_shape %153 [[0], [1, 2, 3]] output_shape [4, 1, 1, %145] : tensor<4x?xf16> into tensor<4x1x1x?xf16>
    %154 = tensor.empty(%145) : tensor<4x?x4x8x64xf16>
    %155 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_69 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_75 = tensor.collapse_shape %155 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %156 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_72 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_76 = tensor.collapse_shape %156 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %157 = tensor.empty() : tensor<4x32x1x64xf16>
    %transposed_77 = linalg.transpose ins(%collapsed_39 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %158 = affine.apply #map32()[%dim_67]
    %159 = tensor.empty(%158) : tensor<4x32x?x64xf16>
    %transposed_78 = linalg.transpose ins(%collapsed_75 : tensor<4x?x32x64xf16>) outs(%159 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %160 = affine.apply #map32()[%dim_70]
    %161 = tensor.empty(%160) : tensor<4x32x?x64xf16>
    %transposed_79 = linalg.transpose ins(%collapsed_76 : tensor<4x?x32x64xf16>) outs(%161 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %dim_80 = tensor.dim %expanded_74, %c3 : tensor<4x1x1x?xf16>
    %162 = tensor.empty(%dim_80) : tensor<4x32x1x?xf16>
    %163 = linalg.generic {indexing_maps = [#map22, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_74 : tensor<4x1x1x?xf16>) outs(%162 : tensor<4x32x1x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x32x1x?xf16>
    %collapsed_81 = tensor.collapse_shape %transposed_77 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_82 = tensor.collapse_shape %transposed_78 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_83 = tensor.collapse_shape %transposed_79 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_84 = tensor.collapse_shape %163 [[0, 1], [2], [3]] : tensor<4x32x1x?xf16> into tensor<128x1x?xf16>
    %164 = tensor.empty() : tensor<128x1x64xf16>
    %165 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_81, %collapsed_82, %collapsed_83, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_85 = tensor.expand_shape %165 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_86 = linalg.transpose ins(%expanded_85 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_87 = tensor.collapse_shape %transposed_86 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %166 = iree_tensor_ext.bitcast %__auto.blk.0.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_88 = tensor.expand_shape %166 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_89 = tensor.extract_slice %expanded_88[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %167 = iree_tensor_ext.bitcast %extracted_slice_89 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_90 = tensor.extract_slice %expanded_88[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %168 = iree_tensor_ext.bitcast %extracted_slice_90 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %169 = tensor.empty() : tensor<2048x64x32xf16>
    %170 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%167, %168 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%169 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_91 = tensor.expand_shape %collapsed_87 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %171 = tensor.empty() : tensor<4x1x2048xf32>
    %172 = linalg.fill ins(%cst_5 : f32) outs(%171 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %173 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_91, %170 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%172 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %174 = tensor.empty() : tensor<4x1x2048xf16>
    %175 = linalg.copy ins(%173 : tensor<4x1x2048xf32>) outs(%174 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %176 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%19, %175 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %177 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%176 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %178 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%177 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %179 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%178 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %180 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%179 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %181 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%180 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %182 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%181 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %183 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%177, %182 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %184 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%183 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %185 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.ffn_norm.weight, %184 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %186 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%185 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %187 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_92 = tensor.expand_shape %187 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_93 = tensor.extract_slice %expanded_92[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %188 = iree_tensor_ext.bitcast %extracted_slice_93 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_94 = tensor.extract_slice %expanded_92[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %189 = iree_tensor_ext.bitcast %extracted_slice_94 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %190 = tensor.empty() : tensor<5632x64x32xf16>
    %191 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%188, %189 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%190 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_95 = tensor.expand_shape %186 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %192 = tensor.empty() : tensor<4x1x5632xf32>
    %193 = linalg.fill ins(%cst_5 : f32) outs(%192 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %194 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_95, %191 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%193 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %195 = tensor.empty() : tensor<4x1x5632xf16>
    %196 = linalg.copy ins(%194 : tensor<4x1x5632xf32>) outs(%195 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %197 = tensor.empty() : tensor<4x1x5632xf16>
    %198 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%196 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %199 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%198, %196 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %200 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_96 = tensor.expand_shape %200 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_97 = tensor.extract_slice %expanded_96[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %201 = iree_tensor_ext.bitcast %extracted_slice_97 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_98 = tensor.extract_slice %expanded_96[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %202 = iree_tensor_ext.bitcast %extracted_slice_98 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %203 = tensor.empty() : tensor<5632x64x32xf16>
    %204 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%201, %202 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%203 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_99 = tensor.expand_shape %186 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %205 = tensor.empty() : tensor<4x1x5632xf32>
    %206 = linalg.fill ins(%cst_5 : f32) outs(%205 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %207 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_99, %204 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%206 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %208 = tensor.empty() : tensor<4x1x5632xf16>
    %209 = linalg.copy ins(%207 : tensor<4x1x5632xf32>) outs(%208 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %210 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%199, %209 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %211 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_100 = tensor.expand_shape %211 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_101 = tensor.extract_slice %expanded_100[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %212 = iree_tensor_ext.bitcast %extracted_slice_101 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_102 = tensor.extract_slice %expanded_100[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %213 = iree_tensor_ext.bitcast %extracted_slice_102 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %214 = tensor.empty() : tensor<2048x176x32xf16>
    %215 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%212, %213 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%214 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_103 = tensor.expand_shape %210 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %216 = tensor.empty() : tensor<4x1x2048xf32>
    %217 = linalg.fill ins(%cst_5 : f32) outs(%216 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %218 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_103, %215 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%217 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %219 = tensor.empty() : tensor<4x1x2048xf16>
    %220 = linalg.copy ins(%218 : tensor<4x1x2048xf32>) outs(%219 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %221 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%176, %220 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %222 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%221 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %223 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%222 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %224 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%223 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %225 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%224 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %226 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%225 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %227 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%226 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %228 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%222, %227 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %229 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%228 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %230 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.attn_norm.weight, %229 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %231 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%230 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %232 = iree_tensor_ext.bitcast %__auto.blk.1.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_104 = tensor.expand_shape %232 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_105 = tensor.extract_slice %expanded_104[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %233 = iree_tensor_ext.bitcast %extracted_slice_105 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_106 = tensor.extract_slice %expanded_104[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %234 = iree_tensor_ext.bitcast %extracted_slice_106 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %235 = tensor.empty() : tensor<2048x64x32xf16>
    %236 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%233, %234 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%235 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_107 = tensor.expand_shape %231 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %237 = tensor.empty() : tensor<4x1x2048xf32>
    %238 = linalg.fill ins(%cst_5 : f32) outs(%237 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %239 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_107, %236 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %240 = tensor.empty() : tensor<4x1x2048xf16>
    %241 = linalg.copy ins(%239 : tensor<4x1x2048xf32>) outs(%240 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %242 = iree_tensor_ext.bitcast %__auto.blk.1.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_108 = tensor.expand_shape %242 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_109 = tensor.extract_slice %expanded_108[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %243 = iree_tensor_ext.bitcast %extracted_slice_109 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_110 = tensor.extract_slice %expanded_108[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %244 = iree_tensor_ext.bitcast %extracted_slice_110 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %245 = tensor.empty() : tensor<256x64x32xf16>
    %246 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%243, %244 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%245 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_111 = tensor.expand_shape %231 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %247 = tensor.empty() : tensor<4x1x256xf32>
    %248 = linalg.fill ins(%cst_5 : f32) outs(%247 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %249 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_111, %246 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%248 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %250 = tensor.empty() : tensor<4x1x256xf16>
    %251 = linalg.copy ins(%249 : tensor<4x1x256xf32>) outs(%250 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %252 = iree_tensor_ext.bitcast %__auto.blk.1.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_112 = tensor.expand_shape %252 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_113 = tensor.extract_slice %expanded_112[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %253 = iree_tensor_ext.bitcast %extracted_slice_113 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_114 = tensor.extract_slice %expanded_112[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %254 = iree_tensor_ext.bitcast %extracted_slice_114 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %255 = tensor.empty() : tensor<256x64x32xf16>
    %256 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%253, %254 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%255 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_115 = tensor.expand_shape %231 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %257 = tensor.empty() : tensor<4x1x256xf32>
    %258 = linalg.fill ins(%cst_5 : f32) outs(%257 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %259 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_115, %256 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%258 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %260 = tensor.empty() : tensor<4x1x256xf16>
    %261 = linalg.copy ins(%259 : tensor<4x1x256xf32>) outs(%260 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_116 = tensor.expand_shape %241 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_117 = tensor.expand_shape %251 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_118 = tensor.expand_shape %261 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %262 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_119 = tensor.expand_shape %262 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %263 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_119 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %264 = linalg.batch_matmul ins(%263, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_120 = linalg.transpose ins(%264 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %265 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_120 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %266 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%265, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %267 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%266 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %268 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_120 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %269 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%268, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %270 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%269 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_121 = tensor.expand_shape %267 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_122 = tensor.expand_shape %270 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_123 = tensor.extract_slice %expanded_116[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_124 = tensor.extract_slice %expanded_116[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %271 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_123, %expanded_121 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %272 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_124, %expanded_122 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %273 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%271, %272 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %274 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_124, %expanded_121 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %275 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_123, %expanded_122 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %276 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%274, %275 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %277 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %278 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%273, %276 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%277 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_125 = tensor.collapse_shape %278 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %279 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_126 = tensor.expand_shape %279 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %280 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_126 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %281 = linalg.batch_matmul ins(%280, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_127 = linalg.transpose ins(%281 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %282 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_127 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %283 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%282, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %284 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%283 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %285 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_127 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %286 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%285, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %287 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%286 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_128 = tensor.expand_shape %284 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_129 = tensor.expand_shape %287 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_130 = tensor.extract_slice %expanded_117[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_131 = tensor.extract_slice %expanded_117[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %288 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_130, %expanded_128 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %289 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_131, %expanded_129 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %290 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%288, %289 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %291 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_131, %expanded_128 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %292 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_130, %expanded_129 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %293 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%291, %292 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %294 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %295 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%290, %293 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%294 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %296 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_132 = tensor.expand_shape %296 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %297 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_132 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %298 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%297 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c1_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %299 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%298 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %300 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%299, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %301 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%300 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %302 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%301, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %303 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%302 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %304 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%303, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_133 = tensor.collapse_shape %304 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_134 = tensor.expand_shape %collapsed_133 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_135 = tensor.collapse_shape %295 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %305 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_135, %expanded_134 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%136 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %306 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%299, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %307 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%306 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %308 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%307, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %309 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%308 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %310 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%309, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_136 = tensor.collapse_shape %310 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_137 = tensor.expand_shape %collapsed_136 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_138 = tensor.collapse_shape %expanded_118 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %311 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_138, %expanded_137 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%305 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_139 = tensor.dim %311, %c0 : tensor<?x64xf16>
    %312 = arith.divsi %dim_139, %c5632 : index
    %expanded_140 = tensor.expand_shape %311 [[0, 1, 2, 3, 4], [5]] output_shape [%312, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_141 = tensor.dim %expanded_140, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_142 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_143 = tensor.extract_slice %expanded_140[0, %c1, %c0, 0, 0, 0] [%dim_141, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %313 = tensor.empty(%dim_142) : tensor<4x?x4x32x64xf16>
    %314 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_143, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%313 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_144 = tensor.dim %expanded_140, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_145 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_146 = tensor.extract_slice %expanded_140[0, %c1, %c1, 0, 0, 0] [%dim_144, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %315 = tensor.empty(%dim_145) : tensor<4x?x4x32x64xf16>
    %316 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_146, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%315 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_147 = tensor.dim %314, %c1 : tensor<4x?x4x32x64xf16>
    %317 = tensor.empty(%dim_147) : tensor<4x?x32x4x64xf16>
    %transposed_148 = linalg.transpose ins(%314 : tensor<4x?x4x32x64xf16>) outs(%317 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_149 = tensor.collapse_shape %transposed_148 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_150 = tensor.dim %316, %c1 : tensor<4x?x4x32x64xf16>
    %318 = tensor.empty(%dim_150) : tensor<4x?x32x4x64xf16>
    %transposed_151 = linalg.transpose ins(%316 : tensor<4x?x4x32x64xf16>) outs(%318 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_152 = tensor.collapse_shape %transposed_151 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %319 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_149 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_153 = tensor.collapse_shape %319 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %320 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_152 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_154 = tensor.collapse_shape %320 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_155 = linalg.transpose ins(%collapsed_125 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %321 = affine.apply #map32()[%dim_147]
    %322 = tensor.empty(%321) : tensor<4x32x?x64xf16>
    %transposed_156 = linalg.transpose ins(%collapsed_153 : tensor<4x?x32x64xf16>) outs(%322 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %323 = affine.apply #map32()[%dim_150]
    %324 = tensor.empty(%323) : tensor<4x32x?x64xf16>
    %transposed_157 = linalg.transpose ins(%collapsed_154 : tensor<4x?x32x64xf16>) outs(%324 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_158 = tensor.collapse_shape %transposed_155 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_159 = tensor.collapse_shape %transposed_156 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_160 = tensor.collapse_shape %transposed_157 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %325 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_158, %collapsed_159, %collapsed_160, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_161 = tensor.expand_shape %325 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_162 = linalg.transpose ins(%expanded_161 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_163 = tensor.collapse_shape %transposed_162 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %326 = iree_tensor_ext.bitcast %__auto.blk.1.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_164 = tensor.expand_shape %326 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_165 = tensor.extract_slice %expanded_164[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %327 = iree_tensor_ext.bitcast %extracted_slice_165 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_166 = tensor.extract_slice %expanded_164[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %328 = iree_tensor_ext.bitcast %extracted_slice_166 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %329 = tensor.empty() : tensor<2048x64x32xf16>
    %330 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%327, %328 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%329 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_167 = tensor.expand_shape %collapsed_163 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %331 = tensor.empty() : tensor<4x1x2048xf32>
    %332 = linalg.fill ins(%cst_5 : f32) outs(%331 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %333 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_167, %330 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%332 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %334 = tensor.empty() : tensor<4x1x2048xf16>
    %335 = linalg.copy ins(%333 : tensor<4x1x2048xf32>) outs(%334 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %336 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%221, %335 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %337 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%336 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %338 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%337 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %339 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%338 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%339 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %341 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%340 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %342 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%341 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %343 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%337, %342 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %344 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%343 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %345 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.ffn_norm.weight, %344 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %346 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%345 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %347 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_168 = tensor.expand_shape %347 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_169 = tensor.extract_slice %expanded_168[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %348 = iree_tensor_ext.bitcast %extracted_slice_169 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_170 = tensor.extract_slice %expanded_168[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %349 = iree_tensor_ext.bitcast %extracted_slice_170 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %350 = tensor.empty() : tensor<5632x64x32xf16>
    %351 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%348, %349 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%350 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_171 = tensor.expand_shape %346 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %352 = tensor.empty() : tensor<4x1x5632xf32>
    %353 = linalg.fill ins(%cst_5 : f32) outs(%352 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %354 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_171, %351 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%353 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %355 = tensor.empty() : tensor<4x1x5632xf16>
    %356 = linalg.copy ins(%354 : tensor<4x1x5632xf32>) outs(%355 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %357 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%356 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %358 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%357, %356 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %359 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_172 = tensor.expand_shape %359 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_173 = tensor.extract_slice %expanded_172[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %360 = iree_tensor_ext.bitcast %extracted_slice_173 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_174 = tensor.extract_slice %expanded_172[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %361 = iree_tensor_ext.bitcast %extracted_slice_174 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %362 = tensor.empty() : tensor<5632x64x32xf16>
    %363 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%360, %361 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%362 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_175 = tensor.expand_shape %346 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %364 = tensor.empty() : tensor<4x1x5632xf32>
    %365 = linalg.fill ins(%cst_5 : f32) outs(%364 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %366 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_175, %363 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%365 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %367 = tensor.empty() : tensor<4x1x5632xf16>
    %368 = linalg.copy ins(%366 : tensor<4x1x5632xf32>) outs(%367 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %369 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%358, %368 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %370 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_176 = tensor.expand_shape %370 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_177 = tensor.extract_slice %expanded_176[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %371 = iree_tensor_ext.bitcast %extracted_slice_177 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_178 = tensor.extract_slice %expanded_176[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %372 = iree_tensor_ext.bitcast %extracted_slice_178 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %373 = tensor.empty() : tensor<2048x176x32xf16>
    %374 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%371, %372 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%373 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_179 = tensor.expand_shape %369 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %375 = tensor.empty() : tensor<4x1x2048xf32>
    %376 = linalg.fill ins(%cst_5 : f32) outs(%375 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %377 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_179, %374 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%376 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %378 = tensor.empty() : tensor<4x1x2048xf16>
    %379 = linalg.copy ins(%377 : tensor<4x1x2048xf32>) outs(%378 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %380 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%336, %379 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %381 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%380 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %382 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%381 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %383 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%382 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %384 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%383 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %385 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%384 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %386 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%385 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %387 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%381, %386 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %388 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%387 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %389 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.attn_norm.weight, %388 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %390 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%389 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %391 = iree_tensor_ext.bitcast %__auto.blk.2.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_180 = tensor.expand_shape %391 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_181 = tensor.extract_slice %expanded_180[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %392 = iree_tensor_ext.bitcast %extracted_slice_181 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_182 = tensor.extract_slice %expanded_180[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %393 = iree_tensor_ext.bitcast %extracted_slice_182 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %394 = tensor.empty() : tensor<2048x64x32xf16>
    %395 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%392, %393 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%394 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_183 = tensor.expand_shape %390 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %396 = tensor.empty() : tensor<4x1x2048xf32>
    %397 = linalg.fill ins(%cst_5 : f32) outs(%396 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %398 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_183, %395 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%397 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %399 = tensor.empty() : tensor<4x1x2048xf16>
    %400 = linalg.copy ins(%398 : tensor<4x1x2048xf32>) outs(%399 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %401 = iree_tensor_ext.bitcast %__auto.blk.2.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_184 = tensor.expand_shape %401 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_185 = tensor.extract_slice %expanded_184[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %402 = iree_tensor_ext.bitcast %extracted_slice_185 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_186 = tensor.extract_slice %expanded_184[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %403 = iree_tensor_ext.bitcast %extracted_slice_186 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %404 = tensor.empty() : tensor<256x64x32xf16>
    %405 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%402, %403 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%404 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_187 = tensor.expand_shape %390 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %406 = tensor.empty() : tensor<4x1x256xf32>
    %407 = linalg.fill ins(%cst_5 : f32) outs(%406 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %408 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_187, %405 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%407 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %409 = tensor.empty() : tensor<4x1x256xf16>
    %410 = linalg.copy ins(%408 : tensor<4x1x256xf32>) outs(%409 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %411 = iree_tensor_ext.bitcast %__auto.blk.2.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_188 = tensor.expand_shape %411 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_189 = tensor.extract_slice %expanded_188[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %412 = iree_tensor_ext.bitcast %extracted_slice_189 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_190 = tensor.extract_slice %expanded_188[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %413 = iree_tensor_ext.bitcast %extracted_slice_190 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %414 = tensor.empty() : tensor<256x64x32xf16>
    %415 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%412, %413 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%414 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_191 = tensor.expand_shape %390 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %416 = tensor.empty() : tensor<4x1x256xf32>
    %417 = linalg.fill ins(%cst_5 : f32) outs(%416 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %418 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_191, %415 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%417 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %419 = tensor.empty() : tensor<4x1x256xf16>
    %420 = linalg.copy ins(%418 : tensor<4x1x256xf32>) outs(%419 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_192 = tensor.expand_shape %400 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_193 = tensor.expand_shape %410 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_194 = tensor.expand_shape %420 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %421 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_195 = tensor.expand_shape %421 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %422 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_195 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %423 = linalg.batch_matmul ins(%422, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_196 = linalg.transpose ins(%423 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %424 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_196 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %425 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%424, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %426 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%425 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %427 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_196 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %428 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%427, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %429 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%428 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_197 = tensor.expand_shape %426 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_198 = tensor.expand_shape %429 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_199 = tensor.extract_slice %expanded_192[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_200 = tensor.extract_slice %expanded_192[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %430 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_199, %expanded_197 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %431 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_200, %expanded_198 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %432 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%430, %431 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %433 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_200, %expanded_197 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %434 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_199, %expanded_198 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %435 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%433, %434 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %436 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %437 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%432, %435 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%436 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_201 = tensor.collapse_shape %437 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %438 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_202 = tensor.expand_shape %438 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %439 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_202 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %440 = linalg.batch_matmul ins(%439, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_203 = linalg.transpose ins(%440 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %441 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_203 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %442 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%441, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %443 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%442 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %444 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_203 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %445 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%444, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %446 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%445 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_204 = tensor.expand_shape %443 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_205 = tensor.expand_shape %446 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_206 = tensor.extract_slice %expanded_193[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_207 = tensor.extract_slice %expanded_193[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %447 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_206, %expanded_204 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %448 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_207, %expanded_205 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %449 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%447, %448 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %450 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_207, %expanded_204 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %451 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_206, %expanded_205 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %452 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%450, %451 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %453 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %454 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%449, %452 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%453 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %455 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_208 = tensor.expand_shape %455 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %456 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_208 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %457 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%456 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %458 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%457 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %459 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%458, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %460 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%459 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %461 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%460, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %462 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%461 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %463 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%462, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_209 = tensor.collapse_shape %463 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_210 = tensor.expand_shape %collapsed_209 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_211 = tensor.collapse_shape %454 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %464 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_211, %expanded_210 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%311 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %465 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%458, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %466 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%465 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %467 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%466, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %468 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%467 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %469 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%468, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_212 = tensor.collapse_shape %469 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_213 = tensor.expand_shape %collapsed_212 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_214 = tensor.collapse_shape %expanded_194 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %470 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_214, %expanded_213 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%464 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_215 = tensor.dim %470, %c0 : tensor<?x64xf16>
    %471 = arith.divsi %dim_215, %c5632 : index
    %expanded_216 = tensor.expand_shape %470 [[0, 1, 2, 3, 4], [5]] output_shape [%471, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_217 = tensor.dim %expanded_216, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_218 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_219 = tensor.extract_slice %expanded_216[0, %c2, %c0, 0, 0, 0] [%dim_217, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %472 = tensor.empty(%dim_218) : tensor<4x?x4x32x64xf16>
    %473 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_219, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%472 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_220 = tensor.dim %expanded_216, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_221 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_222 = tensor.extract_slice %expanded_216[0, %c2, %c1, 0, 0, 0] [%dim_220, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %474 = tensor.empty(%dim_221) : tensor<4x?x4x32x64xf16>
    %475 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_222, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%474 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_223 = tensor.dim %473, %c1 : tensor<4x?x4x32x64xf16>
    %476 = tensor.empty(%dim_223) : tensor<4x?x32x4x64xf16>
    %transposed_224 = linalg.transpose ins(%473 : tensor<4x?x4x32x64xf16>) outs(%476 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_225 = tensor.collapse_shape %transposed_224 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_226 = tensor.dim %475, %c1 : tensor<4x?x4x32x64xf16>
    %477 = tensor.empty(%dim_226) : tensor<4x?x32x4x64xf16>
    %transposed_227 = linalg.transpose ins(%475 : tensor<4x?x4x32x64xf16>) outs(%477 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_228 = tensor.collapse_shape %transposed_227 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %478 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_225 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_229 = tensor.collapse_shape %478 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %479 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_228 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_230 = tensor.collapse_shape %479 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_231 = linalg.transpose ins(%collapsed_201 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %480 = affine.apply #map32()[%dim_223]
    %481 = tensor.empty(%480) : tensor<4x32x?x64xf16>
    %transposed_232 = linalg.transpose ins(%collapsed_229 : tensor<4x?x32x64xf16>) outs(%481 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %482 = affine.apply #map32()[%dim_226]
    %483 = tensor.empty(%482) : tensor<4x32x?x64xf16>
    %transposed_233 = linalg.transpose ins(%collapsed_230 : tensor<4x?x32x64xf16>) outs(%483 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_234 = tensor.collapse_shape %transposed_231 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_235 = tensor.collapse_shape %transposed_232 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_236 = tensor.collapse_shape %transposed_233 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %484 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_234, %collapsed_235, %collapsed_236, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_237 = tensor.expand_shape %484 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_238 = linalg.transpose ins(%expanded_237 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_239 = tensor.collapse_shape %transposed_238 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %485 = iree_tensor_ext.bitcast %__auto.blk.2.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_240 = tensor.expand_shape %485 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_241 = tensor.extract_slice %expanded_240[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %486 = iree_tensor_ext.bitcast %extracted_slice_241 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_242 = tensor.extract_slice %expanded_240[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %487 = iree_tensor_ext.bitcast %extracted_slice_242 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %488 = tensor.empty() : tensor<2048x64x32xf16>
    %489 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%486, %487 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%488 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_243 = tensor.expand_shape %collapsed_239 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %490 = tensor.empty() : tensor<4x1x2048xf32>
    %491 = linalg.fill ins(%cst_5 : f32) outs(%490 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %492 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_243, %489 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%491 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %493 = tensor.empty() : tensor<4x1x2048xf16>
    %494 = linalg.copy ins(%492 : tensor<4x1x2048xf32>) outs(%493 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %495 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%380, %494 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %496 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%495 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %497 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%496 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %498 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%497 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %499 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%498 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %500 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%499 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %501 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%500 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %502 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%496, %501 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %503 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%502 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %504 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.ffn_norm.weight, %503 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %505 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%504 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %506 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_244 = tensor.expand_shape %506 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_245 = tensor.extract_slice %expanded_244[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %507 = iree_tensor_ext.bitcast %extracted_slice_245 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_246 = tensor.extract_slice %expanded_244[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %508 = iree_tensor_ext.bitcast %extracted_slice_246 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %509 = tensor.empty() : tensor<5632x64x32xf16>
    %510 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%507, %508 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%509 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_247 = tensor.expand_shape %505 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %511 = tensor.empty() : tensor<4x1x5632xf32>
    %512 = linalg.fill ins(%cst_5 : f32) outs(%511 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %513 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_247, %510 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%512 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %514 = tensor.empty() : tensor<4x1x5632xf16>
    %515 = linalg.copy ins(%513 : tensor<4x1x5632xf32>) outs(%514 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %516 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%515 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %517 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%516, %515 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %518 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_248 = tensor.expand_shape %518 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_249 = tensor.extract_slice %expanded_248[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %519 = iree_tensor_ext.bitcast %extracted_slice_249 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_250 = tensor.extract_slice %expanded_248[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %520 = iree_tensor_ext.bitcast %extracted_slice_250 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %521 = tensor.empty() : tensor<5632x64x32xf16>
    %522 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%519, %520 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%521 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_251 = tensor.expand_shape %505 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %523 = tensor.empty() : tensor<4x1x5632xf32>
    %524 = linalg.fill ins(%cst_5 : f32) outs(%523 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %525 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_251, %522 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%524 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %526 = tensor.empty() : tensor<4x1x5632xf16>
    %527 = linalg.copy ins(%525 : tensor<4x1x5632xf32>) outs(%526 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %528 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%517, %527 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %529 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_252 = tensor.expand_shape %529 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_253 = tensor.extract_slice %expanded_252[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %530 = iree_tensor_ext.bitcast %extracted_slice_253 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_254 = tensor.extract_slice %expanded_252[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %531 = iree_tensor_ext.bitcast %extracted_slice_254 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %532 = tensor.empty() : tensor<2048x176x32xf16>
    %533 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%530, %531 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%532 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_255 = tensor.expand_shape %528 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %534 = tensor.empty() : tensor<4x1x2048xf32>
    %535 = linalg.fill ins(%cst_5 : f32) outs(%534 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %536 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_255, %533 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%535 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %537 = tensor.empty() : tensor<4x1x2048xf16>
    %538 = linalg.copy ins(%536 : tensor<4x1x2048xf32>) outs(%537 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %539 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%495, %538 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %540 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%539 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %541 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%540 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %542 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%541 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %543 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%542 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %544 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%543 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %545 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%544 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %546 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%540, %545 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %547 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%546 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %548 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.attn_norm.weight, %547 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %549 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%548 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %550 = iree_tensor_ext.bitcast %__auto.blk.3.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_256 = tensor.expand_shape %550 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_257 = tensor.extract_slice %expanded_256[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %551 = iree_tensor_ext.bitcast %extracted_slice_257 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_258 = tensor.extract_slice %expanded_256[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %552 = iree_tensor_ext.bitcast %extracted_slice_258 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %553 = tensor.empty() : tensor<2048x64x32xf16>
    %554 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%551, %552 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%553 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_259 = tensor.expand_shape %549 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %555 = tensor.empty() : tensor<4x1x2048xf32>
    %556 = linalg.fill ins(%cst_5 : f32) outs(%555 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %557 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_259, %554 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%556 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %558 = tensor.empty() : tensor<4x1x2048xf16>
    %559 = linalg.copy ins(%557 : tensor<4x1x2048xf32>) outs(%558 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %560 = iree_tensor_ext.bitcast %__auto.blk.3.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_260 = tensor.expand_shape %560 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_261 = tensor.extract_slice %expanded_260[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %561 = iree_tensor_ext.bitcast %extracted_slice_261 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_262 = tensor.extract_slice %expanded_260[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %562 = iree_tensor_ext.bitcast %extracted_slice_262 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %563 = tensor.empty() : tensor<256x64x32xf16>
    %564 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%561, %562 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%563 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_263 = tensor.expand_shape %549 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %565 = tensor.empty() : tensor<4x1x256xf32>
    %566 = linalg.fill ins(%cst_5 : f32) outs(%565 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %567 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_263, %564 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%566 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %568 = tensor.empty() : tensor<4x1x256xf16>
    %569 = linalg.copy ins(%567 : tensor<4x1x256xf32>) outs(%568 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %570 = iree_tensor_ext.bitcast %__auto.blk.3.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_264 = tensor.expand_shape %570 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_265 = tensor.extract_slice %expanded_264[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %571 = iree_tensor_ext.bitcast %extracted_slice_265 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_266 = tensor.extract_slice %expanded_264[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %572 = iree_tensor_ext.bitcast %extracted_slice_266 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %573 = tensor.empty() : tensor<256x64x32xf16>
    %574 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%571, %572 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%573 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_267 = tensor.expand_shape %549 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %575 = tensor.empty() : tensor<4x1x256xf32>
    %576 = linalg.fill ins(%cst_5 : f32) outs(%575 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %577 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_267, %574 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%576 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %578 = tensor.empty() : tensor<4x1x256xf16>
    %579 = linalg.copy ins(%577 : tensor<4x1x256xf32>) outs(%578 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_268 = tensor.expand_shape %559 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_269 = tensor.expand_shape %569 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_270 = tensor.expand_shape %579 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %580 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_271 = tensor.expand_shape %580 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %581 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_271 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %582 = linalg.batch_matmul ins(%581, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_272 = linalg.transpose ins(%582 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %583 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_272 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %584 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%583, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %585 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%584 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %586 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_272 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %587 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%586, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %588 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%587 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_273 = tensor.expand_shape %585 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_274 = tensor.expand_shape %588 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_275 = tensor.extract_slice %expanded_268[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_276 = tensor.extract_slice %expanded_268[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %589 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_275, %expanded_273 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %590 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_276, %expanded_274 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %591 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%589, %590 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %592 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_276, %expanded_273 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %593 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_275, %expanded_274 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %594 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%592, %593 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %595 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %596 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%591, %594 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%595 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_277 = tensor.collapse_shape %596 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %597 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_278 = tensor.expand_shape %597 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %598 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_278 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %599 = linalg.batch_matmul ins(%598, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_279 = linalg.transpose ins(%599 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %600 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_279 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %601 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%600, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %602 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%601 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %603 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_279 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %604 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%603, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %605 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%604 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_280 = tensor.expand_shape %602 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_281 = tensor.expand_shape %605 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_282 = tensor.extract_slice %expanded_269[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_283 = tensor.extract_slice %expanded_269[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %606 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_282, %expanded_280 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %607 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_283, %expanded_281 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %608 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%606, %607 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %609 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_283, %expanded_280 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %610 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_282, %expanded_281 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %611 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%609, %610 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %612 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %613 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%608, %611 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%612 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %614 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_284 = tensor.expand_shape %614 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %615 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_284 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %616 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%615 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c3_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %617 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%616 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %618 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%617, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %619 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%618 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %620 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%619, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %621 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%620 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %622 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%621, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_285 = tensor.collapse_shape %622 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_286 = tensor.expand_shape %collapsed_285 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_287 = tensor.collapse_shape %613 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %623 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_287, %expanded_286 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%470 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %624 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%617, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %625 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%624 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %626 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%625, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %627 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%626 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %628 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%627, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_288 = tensor.collapse_shape %628 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_289 = tensor.expand_shape %collapsed_288 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_290 = tensor.collapse_shape %expanded_270 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %629 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_290, %expanded_289 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%623 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_291 = tensor.dim %629, %c0 : tensor<?x64xf16>
    %630 = arith.divsi %dim_291, %c5632 : index
    %expanded_292 = tensor.expand_shape %629 [[0, 1, 2, 3, 4], [5]] output_shape [%630, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_293 = tensor.dim %expanded_292, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_294 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_295 = tensor.extract_slice %expanded_292[0, %c3, %c0, 0, 0, 0] [%dim_293, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %631 = tensor.empty(%dim_294) : tensor<4x?x4x32x64xf16>
    %632 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_295, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%631 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_296 = tensor.dim %expanded_292, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_297 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_298 = tensor.extract_slice %expanded_292[0, %c3, %c1, 0, 0, 0] [%dim_296, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %633 = tensor.empty(%dim_297) : tensor<4x?x4x32x64xf16>
    %634 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_298, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%633 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_299 = tensor.dim %632, %c1 : tensor<4x?x4x32x64xf16>
    %635 = tensor.empty(%dim_299) : tensor<4x?x32x4x64xf16>
    %transposed_300 = linalg.transpose ins(%632 : tensor<4x?x4x32x64xf16>) outs(%635 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_301 = tensor.collapse_shape %transposed_300 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_302 = tensor.dim %634, %c1 : tensor<4x?x4x32x64xf16>
    %636 = tensor.empty(%dim_302) : tensor<4x?x32x4x64xf16>
    %transposed_303 = linalg.transpose ins(%634 : tensor<4x?x4x32x64xf16>) outs(%636 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_304 = tensor.collapse_shape %transposed_303 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %637 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_301 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_305 = tensor.collapse_shape %637 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %638 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_304 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_306 = tensor.collapse_shape %638 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_307 = linalg.transpose ins(%collapsed_277 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %639 = affine.apply #map32()[%dim_299]
    %640 = tensor.empty(%639) : tensor<4x32x?x64xf16>
    %transposed_308 = linalg.transpose ins(%collapsed_305 : tensor<4x?x32x64xf16>) outs(%640 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %641 = affine.apply #map32()[%dim_302]
    %642 = tensor.empty(%641) : tensor<4x32x?x64xf16>
    %transposed_309 = linalg.transpose ins(%collapsed_306 : tensor<4x?x32x64xf16>) outs(%642 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_310 = tensor.collapse_shape %transposed_307 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_311 = tensor.collapse_shape %transposed_308 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_312 = tensor.collapse_shape %transposed_309 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %643 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_310, %collapsed_311, %collapsed_312, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_313 = tensor.expand_shape %643 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_314 = linalg.transpose ins(%expanded_313 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_315 = tensor.collapse_shape %transposed_314 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %644 = iree_tensor_ext.bitcast %__auto.blk.3.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_316 = tensor.expand_shape %644 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_317 = tensor.extract_slice %expanded_316[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %645 = iree_tensor_ext.bitcast %extracted_slice_317 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_318 = tensor.extract_slice %expanded_316[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %646 = iree_tensor_ext.bitcast %extracted_slice_318 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %647 = tensor.empty() : tensor<2048x64x32xf16>
    %648 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%645, %646 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%647 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_319 = tensor.expand_shape %collapsed_315 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %649 = tensor.empty() : tensor<4x1x2048xf32>
    %650 = linalg.fill ins(%cst_5 : f32) outs(%649 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %651 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_319, %648 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%650 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %652 = tensor.empty() : tensor<4x1x2048xf16>
    %653 = linalg.copy ins(%651 : tensor<4x1x2048xf32>) outs(%652 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %654 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%539, %653 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %655 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%654 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %656 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%655 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %657 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%656 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %658 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%657 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %659 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%658 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %660 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%659 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %661 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%655, %660 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %662 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%661 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %663 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.ffn_norm.weight, %662 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %664 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%663 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %665 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_320 = tensor.expand_shape %665 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_321 = tensor.extract_slice %expanded_320[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %666 = iree_tensor_ext.bitcast %extracted_slice_321 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_322 = tensor.extract_slice %expanded_320[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %667 = iree_tensor_ext.bitcast %extracted_slice_322 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %668 = tensor.empty() : tensor<5632x64x32xf16>
    %669 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%666, %667 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%668 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_323 = tensor.expand_shape %664 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %670 = tensor.empty() : tensor<4x1x5632xf32>
    %671 = linalg.fill ins(%cst_5 : f32) outs(%670 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %672 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_323, %669 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%671 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %673 = tensor.empty() : tensor<4x1x5632xf16>
    %674 = linalg.copy ins(%672 : tensor<4x1x5632xf32>) outs(%673 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %675 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%674 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %676 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%675, %674 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %677 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_324 = tensor.expand_shape %677 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_325 = tensor.extract_slice %expanded_324[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %678 = iree_tensor_ext.bitcast %extracted_slice_325 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_326 = tensor.extract_slice %expanded_324[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %679 = iree_tensor_ext.bitcast %extracted_slice_326 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %680 = tensor.empty() : tensor<5632x64x32xf16>
    %681 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%678, %679 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%680 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_327 = tensor.expand_shape %664 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %682 = tensor.empty() : tensor<4x1x5632xf32>
    %683 = linalg.fill ins(%cst_5 : f32) outs(%682 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %684 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_327, %681 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%683 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %685 = tensor.empty() : tensor<4x1x5632xf16>
    %686 = linalg.copy ins(%684 : tensor<4x1x5632xf32>) outs(%685 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %687 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%676, %686 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %688 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_328 = tensor.expand_shape %688 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_329 = tensor.extract_slice %expanded_328[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %689 = iree_tensor_ext.bitcast %extracted_slice_329 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_330 = tensor.extract_slice %expanded_328[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %690 = iree_tensor_ext.bitcast %extracted_slice_330 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %691 = tensor.empty() : tensor<2048x176x32xf16>
    %692 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%689, %690 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%691 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_331 = tensor.expand_shape %687 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %693 = tensor.empty() : tensor<4x1x2048xf32>
    %694 = linalg.fill ins(%cst_5 : f32) outs(%693 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %695 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_331, %692 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%694 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %696 = tensor.empty() : tensor<4x1x2048xf16>
    %697 = linalg.copy ins(%695 : tensor<4x1x2048xf32>) outs(%696 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %698 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%654, %697 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %699 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%698 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %700 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%699 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %701 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%700 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %702 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%701 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %703 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%702 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %704 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%703 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %705 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%699, %704 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %706 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%705 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %707 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.attn_norm.weight, %706 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %708 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%707 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %709 = iree_tensor_ext.bitcast %__auto.blk.4.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_332 = tensor.expand_shape %709 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_333 = tensor.extract_slice %expanded_332[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %710 = iree_tensor_ext.bitcast %extracted_slice_333 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_334 = tensor.extract_slice %expanded_332[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %711 = iree_tensor_ext.bitcast %extracted_slice_334 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %712 = tensor.empty() : tensor<2048x64x32xf16>
    %713 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%710, %711 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%712 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_335 = tensor.expand_shape %708 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %714 = tensor.empty() : tensor<4x1x2048xf32>
    %715 = linalg.fill ins(%cst_5 : f32) outs(%714 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %716 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_335, %713 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%715 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %717 = tensor.empty() : tensor<4x1x2048xf16>
    %718 = linalg.copy ins(%716 : tensor<4x1x2048xf32>) outs(%717 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %719 = iree_tensor_ext.bitcast %__auto.blk.4.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_336 = tensor.expand_shape %719 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_337 = tensor.extract_slice %expanded_336[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %720 = iree_tensor_ext.bitcast %extracted_slice_337 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_338 = tensor.extract_slice %expanded_336[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %721 = iree_tensor_ext.bitcast %extracted_slice_338 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %722 = tensor.empty() : tensor<256x64x32xf16>
    %723 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%720, %721 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%722 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_339 = tensor.expand_shape %708 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %724 = tensor.empty() : tensor<4x1x256xf32>
    %725 = linalg.fill ins(%cst_5 : f32) outs(%724 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %726 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_339, %723 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%725 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %727 = tensor.empty() : tensor<4x1x256xf16>
    %728 = linalg.copy ins(%726 : tensor<4x1x256xf32>) outs(%727 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %729 = iree_tensor_ext.bitcast %__auto.blk.4.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_340 = tensor.expand_shape %729 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_341 = tensor.extract_slice %expanded_340[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %730 = iree_tensor_ext.bitcast %extracted_slice_341 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_342 = tensor.extract_slice %expanded_340[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %731 = iree_tensor_ext.bitcast %extracted_slice_342 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %732 = tensor.empty() : tensor<256x64x32xf16>
    %733 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%730, %731 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%732 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_343 = tensor.expand_shape %708 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %734 = tensor.empty() : tensor<4x1x256xf32>
    %735 = linalg.fill ins(%cst_5 : f32) outs(%734 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %736 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_343, %733 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%735 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %737 = tensor.empty() : tensor<4x1x256xf16>
    %738 = linalg.copy ins(%736 : tensor<4x1x256xf32>) outs(%737 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_344 = tensor.expand_shape %718 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_345 = tensor.expand_shape %728 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_346 = tensor.expand_shape %738 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %739 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_347 = tensor.expand_shape %739 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %740 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_347 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %741 = linalg.batch_matmul ins(%740, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_348 = linalg.transpose ins(%741 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %742 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_348 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %743 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%742, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %744 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%743 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %745 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_348 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %746 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%745, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %747 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%746 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_349 = tensor.expand_shape %744 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_350 = tensor.expand_shape %747 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_351 = tensor.extract_slice %expanded_344[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_352 = tensor.extract_slice %expanded_344[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %748 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_351, %expanded_349 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %749 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_352, %expanded_350 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %750 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%748, %749 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %751 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_352, %expanded_349 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %752 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_351, %expanded_350 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %753 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%751, %752 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %754 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %755 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%750, %753 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%754 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_353 = tensor.collapse_shape %755 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %756 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_354 = tensor.expand_shape %756 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %757 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_354 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %758 = linalg.batch_matmul ins(%757, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_355 = linalg.transpose ins(%758 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %759 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_355 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %760 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%759, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %761 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%760 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %762 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_355 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %763 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%762, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %764 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%763 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_356 = tensor.expand_shape %761 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_357 = tensor.expand_shape %764 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_358 = tensor.extract_slice %expanded_345[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_359 = tensor.extract_slice %expanded_345[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %765 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_358, %expanded_356 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %766 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_359, %expanded_357 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %767 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%765, %766 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %768 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_359, %expanded_356 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %769 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_358, %expanded_357 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %770 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%768, %769 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %771 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %772 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%767, %770 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%771 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %773 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_360 = tensor.expand_shape %773 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %774 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_360 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %775 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%774 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %776 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%775 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %777 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%776, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %778 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%777 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %779 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%778, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %780 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%779 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %781 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%780, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_361 = tensor.collapse_shape %781 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_362 = tensor.expand_shape %collapsed_361 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_363 = tensor.collapse_shape %772 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %782 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_363, %expanded_362 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%629 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %783 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%776, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %784 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%783 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %785 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%784, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %786 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%785 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %787 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%786, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_364 = tensor.collapse_shape %787 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_365 = tensor.expand_shape %collapsed_364 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_366 = tensor.collapse_shape %expanded_346 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %788 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_366, %expanded_365 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%782 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_367 = tensor.dim %788, %c0 : tensor<?x64xf16>
    %789 = arith.divsi %dim_367, %c5632 : index
    %expanded_368 = tensor.expand_shape %788 [[0, 1, 2, 3, 4], [5]] output_shape [%789, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_369 = tensor.dim %expanded_368, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_370 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_371 = tensor.extract_slice %expanded_368[0, %c4, %c0, 0, 0, 0] [%dim_369, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %790 = tensor.empty(%dim_370) : tensor<4x?x4x32x64xf16>
    %791 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_371, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%790 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_372 = tensor.dim %expanded_368, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_373 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_374 = tensor.extract_slice %expanded_368[0, %c4, %c1, 0, 0, 0] [%dim_372, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %792 = tensor.empty(%dim_373) : tensor<4x?x4x32x64xf16>
    %793 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_374, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%792 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_375 = tensor.dim %791, %c1 : tensor<4x?x4x32x64xf16>
    %794 = tensor.empty(%dim_375) : tensor<4x?x32x4x64xf16>
    %transposed_376 = linalg.transpose ins(%791 : tensor<4x?x4x32x64xf16>) outs(%794 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_377 = tensor.collapse_shape %transposed_376 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_378 = tensor.dim %793, %c1 : tensor<4x?x4x32x64xf16>
    %795 = tensor.empty(%dim_378) : tensor<4x?x32x4x64xf16>
    %transposed_379 = linalg.transpose ins(%793 : tensor<4x?x4x32x64xf16>) outs(%795 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_380 = tensor.collapse_shape %transposed_379 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %796 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_377 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_381 = tensor.collapse_shape %796 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %797 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_380 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_382 = tensor.collapse_shape %797 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_383 = linalg.transpose ins(%collapsed_353 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %798 = affine.apply #map32()[%dim_375]
    %799 = tensor.empty(%798) : tensor<4x32x?x64xf16>
    %transposed_384 = linalg.transpose ins(%collapsed_381 : tensor<4x?x32x64xf16>) outs(%799 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %800 = affine.apply #map32()[%dim_378]
    %801 = tensor.empty(%800) : tensor<4x32x?x64xf16>
    %transposed_385 = linalg.transpose ins(%collapsed_382 : tensor<4x?x32x64xf16>) outs(%801 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_386 = tensor.collapse_shape %transposed_383 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_387 = tensor.collapse_shape %transposed_384 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_388 = tensor.collapse_shape %transposed_385 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %802 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_386, %collapsed_387, %collapsed_388, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_389 = tensor.expand_shape %802 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_390 = linalg.transpose ins(%expanded_389 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_391 = tensor.collapse_shape %transposed_390 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %803 = iree_tensor_ext.bitcast %__auto.blk.4.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_392 = tensor.expand_shape %803 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_393 = tensor.extract_slice %expanded_392[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %804 = iree_tensor_ext.bitcast %extracted_slice_393 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_394 = tensor.extract_slice %expanded_392[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %805 = iree_tensor_ext.bitcast %extracted_slice_394 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %806 = tensor.empty() : tensor<2048x64x32xf16>
    %807 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%804, %805 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%806 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_395 = tensor.expand_shape %collapsed_391 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %808 = tensor.empty() : tensor<4x1x2048xf32>
    %809 = linalg.fill ins(%cst_5 : f32) outs(%808 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %810 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_395, %807 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%809 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %811 = tensor.empty() : tensor<4x1x2048xf16>
    %812 = linalg.copy ins(%810 : tensor<4x1x2048xf32>) outs(%811 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %813 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%698, %812 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %814 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%813 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %815 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%814 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %816 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%815 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %817 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%816 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %818 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%817 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %819 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%818 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %820 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%814, %819 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %821 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%820 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %822 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.ffn_norm.weight, %821 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %823 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%822 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %824 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_396 = tensor.expand_shape %824 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_397 = tensor.extract_slice %expanded_396[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %825 = iree_tensor_ext.bitcast %extracted_slice_397 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_398 = tensor.extract_slice %expanded_396[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %826 = iree_tensor_ext.bitcast %extracted_slice_398 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %827 = tensor.empty() : tensor<5632x64x32xf16>
    %828 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%825, %826 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%827 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_399 = tensor.expand_shape %823 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %829 = tensor.empty() : tensor<4x1x5632xf32>
    %830 = linalg.fill ins(%cst_5 : f32) outs(%829 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %831 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_399, %828 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%830 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %832 = tensor.empty() : tensor<4x1x5632xf16>
    %833 = linalg.copy ins(%831 : tensor<4x1x5632xf32>) outs(%832 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %834 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%833 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %835 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%834, %833 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %836 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_400 = tensor.expand_shape %836 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_401 = tensor.extract_slice %expanded_400[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %837 = iree_tensor_ext.bitcast %extracted_slice_401 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_402 = tensor.extract_slice %expanded_400[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %838 = iree_tensor_ext.bitcast %extracted_slice_402 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %839 = tensor.empty() : tensor<5632x64x32xf16>
    %840 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%837, %838 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%839 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_403 = tensor.expand_shape %823 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %841 = tensor.empty() : tensor<4x1x5632xf32>
    %842 = linalg.fill ins(%cst_5 : f32) outs(%841 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %843 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_403, %840 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%842 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %844 = tensor.empty() : tensor<4x1x5632xf16>
    %845 = linalg.copy ins(%843 : tensor<4x1x5632xf32>) outs(%844 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %846 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%835, %845 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %847 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_404 = tensor.expand_shape %847 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_405 = tensor.extract_slice %expanded_404[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %848 = iree_tensor_ext.bitcast %extracted_slice_405 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_406 = tensor.extract_slice %expanded_404[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %849 = iree_tensor_ext.bitcast %extracted_slice_406 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %850 = tensor.empty() : tensor<2048x176x32xf16>
    %851 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%848, %849 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%850 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_407 = tensor.expand_shape %846 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %852 = tensor.empty() : tensor<4x1x2048xf32>
    %853 = linalg.fill ins(%cst_5 : f32) outs(%852 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %854 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_407, %851 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%853 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %855 = tensor.empty() : tensor<4x1x2048xf16>
    %856 = linalg.copy ins(%854 : tensor<4x1x2048xf32>) outs(%855 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %857 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%813, %856 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %858 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%857 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %859 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%858 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %860 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%859 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %861 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%860 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %862 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%861 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %863 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%862 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %864 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%858, %863 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %865 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%864 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %866 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.attn_norm.weight, %865 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %867 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%866 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %868 = iree_tensor_ext.bitcast %__auto.blk.5.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_408 = tensor.expand_shape %868 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_409 = tensor.extract_slice %expanded_408[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %869 = iree_tensor_ext.bitcast %extracted_slice_409 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_410 = tensor.extract_slice %expanded_408[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %870 = iree_tensor_ext.bitcast %extracted_slice_410 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %871 = tensor.empty() : tensor<2048x64x32xf16>
    %872 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%869, %870 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%871 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_411 = tensor.expand_shape %867 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %873 = tensor.empty() : tensor<4x1x2048xf32>
    %874 = linalg.fill ins(%cst_5 : f32) outs(%873 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %875 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_411, %872 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%874 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %876 = tensor.empty() : tensor<4x1x2048xf16>
    %877 = linalg.copy ins(%875 : tensor<4x1x2048xf32>) outs(%876 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %878 = iree_tensor_ext.bitcast %__auto.blk.5.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_412 = tensor.expand_shape %878 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_413 = tensor.extract_slice %expanded_412[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %879 = iree_tensor_ext.bitcast %extracted_slice_413 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_414 = tensor.extract_slice %expanded_412[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %880 = iree_tensor_ext.bitcast %extracted_slice_414 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %881 = tensor.empty() : tensor<256x64x32xf16>
    %882 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%879, %880 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%881 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_415 = tensor.expand_shape %867 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %883 = tensor.empty() : tensor<4x1x256xf32>
    %884 = linalg.fill ins(%cst_5 : f32) outs(%883 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %885 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_415, %882 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%884 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %886 = tensor.empty() : tensor<4x1x256xf16>
    %887 = linalg.copy ins(%885 : tensor<4x1x256xf32>) outs(%886 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %888 = iree_tensor_ext.bitcast %__auto.blk.5.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_416 = tensor.expand_shape %888 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_417 = tensor.extract_slice %expanded_416[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %889 = iree_tensor_ext.bitcast %extracted_slice_417 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_418 = tensor.extract_slice %expanded_416[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %890 = iree_tensor_ext.bitcast %extracted_slice_418 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %891 = tensor.empty() : tensor<256x64x32xf16>
    %892 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%889, %890 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%891 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_419 = tensor.expand_shape %867 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %893 = tensor.empty() : tensor<4x1x256xf32>
    %894 = linalg.fill ins(%cst_5 : f32) outs(%893 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %895 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_419, %892 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%894 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %896 = tensor.empty() : tensor<4x1x256xf16>
    %897 = linalg.copy ins(%895 : tensor<4x1x256xf32>) outs(%896 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_420 = tensor.expand_shape %877 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_421 = tensor.expand_shape %887 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_422 = tensor.expand_shape %897 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %898 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_423 = tensor.expand_shape %898 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %899 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_423 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %900 = linalg.batch_matmul ins(%899, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_424 = linalg.transpose ins(%900 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %901 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_424 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %902 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%901, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %903 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%902 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %904 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_424 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %905 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%904, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %906 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%905 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_425 = tensor.expand_shape %903 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_426 = tensor.expand_shape %906 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_427 = tensor.extract_slice %expanded_420[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_428 = tensor.extract_slice %expanded_420[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %907 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_427, %expanded_425 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %908 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_428, %expanded_426 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %909 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%907, %908 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %910 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_428, %expanded_425 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %911 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_427, %expanded_426 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %912 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%910, %911 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %913 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %914 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%909, %912 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%913 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_429 = tensor.collapse_shape %914 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %915 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_430 = tensor.expand_shape %915 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %916 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_430 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %917 = linalg.batch_matmul ins(%916, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_431 = linalg.transpose ins(%917 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %918 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_431 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %919 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%918, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %920 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%919 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %921 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_431 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %922 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%921, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %923 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%922 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_432 = tensor.expand_shape %920 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_433 = tensor.expand_shape %923 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_434 = tensor.extract_slice %expanded_421[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_435 = tensor.extract_slice %expanded_421[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %924 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_434, %expanded_432 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %925 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_435, %expanded_433 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %926 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%924, %925 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %927 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_435, %expanded_432 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %928 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_434, %expanded_433 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %929 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%927, %928 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %930 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %931 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%926, %929 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%930 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %932 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_436 = tensor.expand_shape %932 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %933 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_436 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %934 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%933 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c5_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %935 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%934 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %936 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%935, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %937 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%936 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %938 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%937, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %939 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%938 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %940 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%939, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_437 = tensor.collapse_shape %940 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_438 = tensor.expand_shape %collapsed_437 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_439 = tensor.collapse_shape %931 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %941 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_439, %expanded_438 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%788 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %942 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%935, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %943 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%942 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %944 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%943, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %945 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%944 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %946 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%945, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_440 = tensor.collapse_shape %946 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_441 = tensor.expand_shape %collapsed_440 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_442 = tensor.collapse_shape %expanded_422 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %947 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_442, %expanded_441 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%941 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_443 = tensor.dim %947, %c0 : tensor<?x64xf16>
    %948 = arith.divsi %dim_443, %c5632 : index
    %expanded_444 = tensor.expand_shape %947 [[0, 1, 2, 3, 4], [5]] output_shape [%948, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_445 = tensor.dim %expanded_444, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_446 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_447 = tensor.extract_slice %expanded_444[0, %c5, %c0, 0, 0, 0] [%dim_445, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %949 = tensor.empty(%dim_446) : tensor<4x?x4x32x64xf16>
    %950 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_447, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%949 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_448 = tensor.dim %expanded_444, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_449 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_450 = tensor.extract_slice %expanded_444[0, %c5, %c1, 0, 0, 0] [%dim_448, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %951 = tensor.empty(%dim_449) : tensor<4x?x4x32x64xf16>
    %952 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_450, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%951 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_451 = tensor.dim %950, %c1 : tensor<4x?x4x32x64xf16>
    %953 = tensor.empty(%dim_451) : tensor<4x?x32x4x64xf16>
    %transposed_452 = linalg.transpose ins(%950 : tensor<4x?x4x32x64xf16>) outs(%953 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_453 = tensor.collapse_shape %transposed_452 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_454 = tensor.dim %952, %c1 : tensor<4x?x4x32x64xf16>
    %954 = tensor.empty(%dim_454) : tensor<4x?x32x4x64xf16>
    %transposed_455 = linalg.transpose ins(%952 : tensor<4x?x4x32x64xf16>) outs(%954 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_456 = tensor.collapse_shape %transposed_455 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %955 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_453 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_457 = tensor.collapse_shape %955 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %956 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_456 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_458 = tensor.collapse_shape %956 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_459 = linalg.transpose ins(%collapsed_429 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %957 = affine.apply #map32()[%dim_451]
    %958 = tensor.empty(%957) : tensor<4x32x?x64xf16>
    %transposed_460 = linalg.transpose ins(%collapsed_457 : tensor<4x?x32x64xf16>) outs(%958 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %959 = affine.apply #map32()[%dim_454]
    %960 = tensor.empty(%959) : tensor<4x32x?x64xf16>
    %transposed_461 = linalg.transpose ins(%collapsed_458 : tensor<4x?x32x64xf16>) outs(%960 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_462 = tensor.collapse_shape %transposed_459 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_463 = tensor.collapse_shape %transposed_460 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_464 = tensor.collapse_shape %transposed_461 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %961 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_462, %collapsed_463, %collapsed_464, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_465 = tensor.expand_shape %961 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_466 = linalg.transpose ins(%expanded_465 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_467 = tensor.collapse_shape %transposed_466 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %962 = iree_tensor_ext.bitcast %__auto.blk.5.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_468 = tensor.expand_shape %962 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_469 = tensor.extract_slice %expanded_468[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %963 = iree_tensor_ext.bitcast %extracted_slice_469 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_470 = tensor.extract_slice %expanded_468[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %964 = iree_tensor_ext.bitcast %extracted_slice_470 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %965 = tensor.empty() : tensor<2048x64x32xf16>
    %966 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%963, %964 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%965 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_471 = tensor.expand_shape %collapsed_467 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %967 = tensor.empty() : tensor<4x1x2048xf32>
    %968 = linalg.fill ins(%cst_5 : f32) outs(%967 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %969 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_471, %966 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%968 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %970 = tensor.empty() : tensor<4x1x2048xf16>
    %971 = linalg.copy ins(%969 : tensor<4x1x2048xf32>) outs(%970 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %972 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%857, %971 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %973 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%972 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %974 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%973 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %975 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%974 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %976 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%975 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %977 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%976 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %978 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%977 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %979 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%973, %978 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %980 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%979 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %981 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.ffn_norm.weight, %980 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %982 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%981 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %983 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_472 = tensor.expand_shape %983 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_473 = tensor.extract_slice %expanded_472[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %984 = iree_tensor_ext.bitcast %extracted_slice_473 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_474 = tensor.extract_slice %expanded_472[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %985 = iree_tensor_ext.bitcast %extracted_slice_474 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %986 = tensor.empty() : tensor<5632x64x32xf16>
    %987 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%984, %985 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%986 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_475 = tensor.expand_shape %982 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %988 = tensor.empty() : tensor<4x1x5632xf32>
    %989 = linalg.fill ins(%cst_5 : f32) outs(%988 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %990 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_475, %987 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%989 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %991 = tensor.empty() : tensor<4x1x5632xf16>
    %992 = linalg.copy ins(%990 : tensor<4x1x5632xf32>) outs(%991 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %993 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%992 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %994 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%993, %992 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %995 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_476 = tensor.expand_shape %995 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_477 = tensor.extract_slice %expanded_476[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %996 = iree_tensor_ext.bitcast %extracted_slice_477 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_478 = tensor.extract_slice %expanded_476[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %997 = iree_tensor_ext.bitcast %extracted_slice_478 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %998 = tensor.empty() : tensor<5632x64x32xf16>
    %999 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%996, %997 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%998 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_479 = tensor.expand_shape %982 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1000 = tensor.empty() : tensor<4x1x5632xf32>
    %1001 = linalg.fill ins(%cst_5 : f32) outs(%1000 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1002 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_479, %999 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1001 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1003 = tensor.empty() : tensor<4x1x5632xf16>
    %1004 = linalg.copy ins(%1002 : tensor<4x1x5632xf32>) outs(%1003 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1005 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%994, %1004 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1006 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_480 = tensor.expand_shape %1006 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_481 = tensor.extract_slice %expanded_480[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1007 = iree_tensor_ext.bitcast %extracted_slice_481 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_482 = tensor.extract_slice %expanded_480[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1008 = iree_tensor_ext.bitcast %extracted_slice_482 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1009 = tensor.empty() : tensor<2048x176x32xf16>
    %1010 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1007, %1008 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1009 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_483 = tensor.expand_shape %1005 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1011 = tensor.empty() : tensor<4x1x2048xf32>
    %1012 = linalg.fill ins(%cst_5 : f32) outs(%1011 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1013 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_483, %1010 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%1012 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1014 = tensor.empty() : tensor<4x1x2048xf16>
    %1015 = linalg.copy ins(%1013 : tensor<4x1x2048xf32>) outs(%1014 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1016 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%972, %1015 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1017 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1016 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1018 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1017 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1019 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1018 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1020 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1019 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1021 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1020 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1022 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1021 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1023 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1017, %1022 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1024 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1023 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1025 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.attn_norm.weight, %1024 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1026 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1025 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1027 = iree_tensor_ext.bitcast %__auto.blk.6.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_484 = tensor.expand_shape %1027 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_485 = tensor.extract_slice %expanded_484[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1028 = iree_tensor_ext.bitcast %extracted_slice_485 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_486 = tensor.extract_slice %expanded_484[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1029 = iree_tensor_ext.bitcast %extracted_slice_486 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1030 = tensor.empty() : tensor<2048x64x32xf16>
    %1031 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1028, %1029 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1030 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_487 = tensor.expand_shape %1026 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1032 = tensor.empty() : tensor<4x1x2048xf32>
    %1033 = linalg.fill ins(%cst_5 : f32) outs(%1032 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1034 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_487, %1031 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1033 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1035 = tensor.empty() : tensor<4x1x2048xf16>
    %1036 = linalg.copy ins(%1034 : tensor<4x1x2048xf32>) outs(%1035 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1037 = iree_tensor_ext.bitcast %__auto.blk.6.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_488 = tensor.expand_shape %1037 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_489 = tensor.extract_slice %expanded_488[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1038 = iree_tensor_ext.bitcast %extracted_slice_489 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_490 = tensor.extract_slice %expanded_488[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1039 = iree_tensor_ext.bitcast %extracted_slice_490 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1040 = tensor.empty() : tensor<256x64x32xf16>
    %1041 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1038, %1039 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1040 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_491 = tensor.expand_shape %1026 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1042 = tensor.empty() : tensor<4x1x256xf32>
    %1043 = linalg.fill ins(%cst_5 : f32) outs(%1042 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1044 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_491, %1041 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1043 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1045 = tensor.empty() : tensor<4x1x256xf16>
    %1046 = linalg.copy ins(%1044 : tensor<4x1x256xf32>) outs(%1045 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1047 = iree_tensor_ext.bitcast %__auto.blk.6.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_492 = tensor.expand_shape %1047 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_493 = tensor.extract_slice %expanded_492[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1048 = iree_tensor_ext.bitcast %extracted_slice_493 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_494 = tensor.extract_slice %expanded_492[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1049 = iree_tensor_ext.bitcast %extracted_slice_494 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1050 = tensor.empty() : tensor<256x64x32xf16>
    %1051 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1048, %1049 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1050 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_495 = tensor.expand_shape %1026 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1052 = tensor.empty() : tensor<4x1x256xf32>
    %1053 = linalg.fill ins(%cst_5 : f32) outs(%1052 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1054 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_495, %1051 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1053 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1055 = tensor.empty() : tensor<4x1x256xf16>
    %1056 = linalg.copy ins(%1054 : tensor<4x1x256xf32>) outs(%1055 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_496 = tensor.expand_shape %1036 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_497 = tensor.expand_shape %1046 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_498 = tensor.expand_shape %1056 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1057 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_499 = tensor.expand_shape %1057 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1058 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_499 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1059 = linalg.batch_matmul ins(%1058, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_500 = linalg.transpose ins(%1059 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1060 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_500 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1061 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1060, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1062 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1061 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1063 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_500 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1064 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1063, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1065 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1064 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_501 = tensor.expand_shape %1062 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_502 = tensor.expand_shape %1065 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_503 = tensor.extract_slice %expanded_496[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_504 = tensor.extract_slice %expanded_496[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1066 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_503, %expanded_501 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1067 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_504, %expanded_502 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1068 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1066, %1067 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1069 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_504, %expanded_501 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1070 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_503, %expanded_502 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1071 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1069, %1070 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1072 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %1073 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1068, %1071 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%1072 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_505 = tensor.collapse_shape %1073 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1074 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_506 = tensor.expand_shape %1074 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1075 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_506 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1076 = linalg.batch_matmul ins(%1075, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_507 = linalg.transpose ins(%1076 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1077 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_507 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1078 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1077, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1079 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1078 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1080 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_507 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1081 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1080, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1082 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1081 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_508 = tensor.expand_shape %1079 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_509 = tensor.expand_shape %1082 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_510 = tensor.extract_slice %expanded_497[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_511 = tensor.extract_slice %expanded_497[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1083 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_510, %expanded_508 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1084 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_511, %expanded_509 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1085 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1083, %1084 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1086 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_511, %expanded_508 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1087 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_510, %expanded_509 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1088 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1086, %1087 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1089 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %1090 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1085, %1088 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%1089 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1091 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_512 = tensor.expand_shape %1091 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1092 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_512 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1093 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1092 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c6_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1094 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1093 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1095 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1094, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1096 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1095 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1097 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1096, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1098 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1097 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1099 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1098, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_513 = tensor.collapse_shape %1099 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_514 = tensor.expand_shape %collapsed_513 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_515 = tensor.collapse_shape %1090 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1100 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_515, %expanded_514 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%947 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1101 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1094, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1101 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1103 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1102, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1104 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1103 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1105 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1104, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_516 = tensor.collapse_shape %1105 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_517 = tensor.expand_shape %collapsed_516 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_518 = tensor.collapse_shape %expanded_498 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1106 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_518, %expanded_517 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1100 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_519 = tensor.dim %1106, %c0 : tensor<?x64xf16>
    %1107 = arith.divsi %dim_519, %c5632 : index
    %expanded_520 = tensor.expand_shape %1106 [[0, 1, 2, 3, 4], [5]] output_shape [%1107, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_521 = tensor.dim %expanded_520, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_522 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_523 = tensor.extract_slice %expanded_520[0, %c6, %c0, 0, 0, 0] [%dim_521, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1108 = tensor.empty(%dim_522) : tensor<4x?x4x32x64xf16>
    %1109 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_523, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1108 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_524 = tensor.dim %expanded_520, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_525 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_526 = tensor.extract_slice %expanded_520[0, %c6, %c1, 0, 0, 0] [%dim_524, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1110 = tensor.empty(%dim_525) : tensor<4x?x4x32x64xf16>
    %1111 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_526, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1110 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_527 = tensor.dim %1109, %c1 : tensor<4x?x4x32x64xf16>
    %1112 = tensor.empty(%dim_527) : tensor<4x?x32x4x64xf16>
    %transposed_528 = linalg.transpose ins(%1109 : tensor<4x?x4x32x64xf16>) outs(%1112 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_529 = tensor.collapse_shape %transposed_528 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_530 = tensor.dim %1111, %c1 : tensor<4x?x4x32x64xf16>
    %1113 = tensor.empty(%dim_530) : tensor<4x?x32x4x64xf16>
    %transposed_531 = linalg.transpose ins(%1111 : tensor<4x?x4x32x64xf16>) outs(%1113 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_532 = tensor.collapse_shape %transposed_531 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1114 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_529 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_533 = tensor.collapse_shape %1114 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1115 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_532 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_534 = tensor.collapse_shape %1115 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_535 = linalg.transpose ins(%collapsed_505 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %1116 = affine.apply #map32()[%dim_527]
    %1117 = tensor.empty(%1116) : tensor<4x32x?x64xf16>
    %transposed_536 = linalg.transpose ins(%collapsed_533 : tensor<4x?x32x64xf16>) outs(%1117 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1118 = affine.apply #map32()[%dim_530]
    %1119 = tensor.empty(%1118) : tensor<4x32x?x64xf16>
    %transposed_537 = linalg.transpose ins(%collapsed_534 : tensor<4x?x32x64xf16>) outs(%1119 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_538 = tensor.collapse_shape %transposed_535 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_539 = tensor.collapse_shape %transposed_536 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_540 = tensor.collapse_shape %transposed_537 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1120 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_538, %collapsed_539, %collapsed_540, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_541 = tensor.expand_shape %1120 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_542 = linalg.transpose ins(%expanded_541 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_543 = tensor.collapse_shape %transposed_542 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1121 = iree_tensor_ext.bitcast %__auto.blk.6.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_544 = tensor.expand_shape %1121 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_545 = tensor.extract_slice %expanded_544[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1122 = iree_tensor_ext.bitcast %extracted_slice_545 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_546 = tensor.extract_slice %expanded_544[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1123 = iree_tensor_ext.bitcast %extracted_slice_546 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1124 = tensor.empty() : tensor<2048x64x32xf16>
    %1125 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1122, %1123 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1124 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_547 = tensor.expand_shape %collapsed_543 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1126 = tensor.empty() : tensor<4x1x2048xf32>
    %1127 = linalg.fill ins(%cst_5 : f32) outs(%1126 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1128 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_547, %1125 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1127 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1129 = tensor.empty() : tensor<4x1x2048xf16>
    %1130 = linalg.copy ins(%1128 : tensor<4x1x2048xf32>) outs(%1129 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1131 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1016, %1130 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1132 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1131 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1133 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1132 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1134 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1133 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1135 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1134 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1136 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1135 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1137 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1136 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1138 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1132, %1137 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1139 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1138 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1140 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.ffn_norm.weight, %1139 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1141 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1140 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1142 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_548 = tensor.expand_shape %1142 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_549 = tensor.extract_slice %expanded_548[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1143 = iree_tensor_ext.bitcast %extracted_slice_549 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_550 = tensor.extract_slice %expanded_548[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1144 = iree_tensor_ext.bitcast %extracted_slice_550 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1145 = tensor.empty() : tensor<5632x64x32xf16>
    %1146 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1143, %1144 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1145 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_551 = tensor.expand_shape %1141 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1147 = tensor.empty() : tensor<4x1x5632xf32>
    %1148 = linalg.fill ins(%cst_5 : f32) outs(%1147 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1149 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_551, %1146 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1148 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1150 = tensor.empty() : tensor<4x1x5632xf16>
    %1151 = linalg.copy ins(%1149 : tensor<4x1x5632xf32>) outs(%1150 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1152 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1151 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %1153 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1152, %1151 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1154 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_552 = tensor.expand_shape %1154 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_553 = tensor.extract_slice %expanded_552[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1155 = iree_tensor_ext.bitcast %extracted_slice_553 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_554 = tensor.extract_slice %expanded_552[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1156 = iree_tensor_ext.bitcast %extracted_slice_554 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1157 = tensor.empty() : tensor<5632x64x32xf16>
    %1158 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1155, %1156 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1157 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_555 = tensor.expand_shape %1141 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1159 = tensor.empty() : tensor<4x1x5632xf32>
    %1160 = linalg.fill ins(%cst_5 : f32) outs(%1159 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1161 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_555, %1158 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1160 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1162 = tensor.empty() : tensor<4x1x5632xf16>
    %1163 = linalg.copy ins(%1161 : tensor<4x1x5632xf32>) outs(%1162 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1164 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1153, %1163 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1165 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_556 = tensor.expand_shape %1165 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_557 = tensor.extract_slice %expanded_556[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1166 = iree_tensor_ext.bitcast %extracted_slice_557 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_558 = tensor.extract_slice %expanded_556[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1167 = iree_tensor_ext.bitcast %extracted_slice_558 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1168 = tensor.empty() : tensor<2048x176x32xf16>
    %1169 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1166, %1167 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1168 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_559 = tensor.expand_shape %1164 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1170 = tensor.empty() : tensor<4x1x2048xf32>
    %1171 = linalg.fill ins(%cst_5 : f32) outs(%1170 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1172 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_559, %1169 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%1171 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1173 = tensor.empty() : tensor<4x1x2048xf16>
    %1174 = linalg.copy ins(%1172 : tensor<4x1x2048xf32>) outs(%1173 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1175 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1131, %1174 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1176 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1175 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1177 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1176 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1178 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1177 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1179 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1178 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1180 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1179 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1181 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1180 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1182 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1176, %1181 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1183 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1182 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1184 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.attn_norm.weight, %1183 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1185 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1184 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1186 = iree_tensor_ext.bitcast %__auto.blk.7.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_560 = tensor.expand_shape %1186 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_561 = tensor.extract_slice %expanded_560[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1187 = iree_tensor_ext.bitcast %extracted_slice_561 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_562 = tensor.extract_slice %expanded_560[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1188 = iree_tensor_ext.bitcast %extracted_slice_562 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1189 = tensor.empty() : tensor<2048x64x32xf16>
    %1190 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1187, %1188 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1189 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_563 = tensor.expand_shape %1185 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1191 = tensor.empty() : tensor<4x1x2048xf32>
    %1192 = linalg.fill ins(%cst_5 : f32) outs(%1191 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1193 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_563, %1190 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1192 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1194 = tensor.empty() : tensor<4x1x2048xf16>
    %1195 = linalg.copy ins(%1193 : tensor<4x1x2048xf32>) outs(%1194 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1196 = iree_tensor_ext.bitcast %__auto.blk.7.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_564 = tensor.expand_shape %1196 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_565 = tensor.extract_slice %expanded_564[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1197 = iree_tensor_ext.bitcast %extracted_slice_565 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_566 = tensor.extract_slice %expanded_564[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1198 = iree_tensor_ext.bitcast %extracted_slice_566 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1199 = tensor.empty() : tensor<256x64x32xf16>
    %1200 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1197, %1198 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1199 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_567 = tensor.expand_shape %1185 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1201 = tensor.empty() : tensor<4x1x256xf32>
    %1202 = linalg.fill ins(%cst_5 : f32) outs(%1201 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1203 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_567, %1200 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1202 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1204 = tensor.empty() : tensor<4x1x256xf16>
    %1205 = linalg.copy ins(%1203 : tensor<4x1x256xf32>) outs(%1204 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1206 = iree_tensor_ext.bitcast %__auto.blk.7.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_568 = tensor.expand_shape %1206 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_569 = tensor.extract_slice %expanded_568[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1207 = iree_tensor_ext.bitcast %extracted_slice_569 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_570 = tensor.extract_slice %expanded_568[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1208 = iree_tensor_ext.bitcast %extracted_slice_570 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1209 = tensor.empty() : tensor<256x64x32xf16>
    %1210 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1207, %1208 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1209 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_571 = tensor.expand_shape %1185 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1211 = tensor.empty() : tensor<4x1x256xf32>
    %1212 = linalg.fill ins(%cst_5 : f32) outs(%1211 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1213 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_571, %1210 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1212 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1214 = tensor.empty() : tensor<4x1x256xf16>
    %1215 = linalg.copy ins(%1213 : tensor<4x1x256xf32>) outs(%1214 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_572 = tensor.expand_shape %1195 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_573 = tensor.expand_shape %1205 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_574 = tensor.expand_shape %1215 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1216 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_575 = tensor.expand_shape %1216 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1217 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_575 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1218 = linalg.batch_matmul ins(%1217, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_576 = linalg.transpose ins(%1218 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1219 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_576 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1220 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1219, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1221 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1220 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1222 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_576 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1223 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1222, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1224 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1223 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_577 = tensor.expand_shape %1221 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_578 = tensor.expand_shape %1224 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_579 = tensor.extract_slice %expanded_572[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_580 = tensor.extract_slice %expanded_572[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1225 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_579, %expanded_577 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1226 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_580, %expanded_578 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1227 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1225, %1226 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1228 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_580, %expanded_577 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1229 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_579, %expanded_578 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1230 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1228, %1229 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1231 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %1232 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1227, %1230 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%1231 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_581 = tensor.collapse_shape %1232 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1233 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_582 = tensor.expand_shape %1233 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1234 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_582 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1235 = linalg.batch_matmul ins(%1234, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_583 = linalg.transpose ins(%1235 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1236 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_583 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1237 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1236, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1238 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1237 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1239 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_583 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1240 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1239, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1241 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1240 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_584 = tensor.expand_shape %1238 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_585 = tensor.expand_shape %1241 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_586 = tensor.extract_slice %expanded_573[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_587 = tensor.extract_slice %expanded_573[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1242 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_586, %expanded_584 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1243 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_587, %expanded_585 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1244 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1242, %1243 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1245 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_587, %expanded_584 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1246 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_586, %expanded_585 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1247 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1245, %1246 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1248 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %1249 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1244, %1247 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%1248 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1250 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_588 = tensor.expand_shape %1250 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1251 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_588 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1251 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c7_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1253 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1252 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1254 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1253, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1255 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1254 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1256 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1255, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1256 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1258 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1257, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_589 = tensor.collapse_shape %1258 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_590 = tensor.expand_shape %collapsed_589 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_591 = tensor.collapse_shape %1249 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1259 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_591, %expanded_590 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1106 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1260 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1253, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1261 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1260 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1262 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1261, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1263 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1262 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1264 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1263, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_592 = tensor.collapse_shape %1264 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_593 = tensor.expand_shape %collapsed_592 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_594 = tensor.collapse_shape %expanded_574 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1265 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_594, %expanded_593 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1259 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_595 = tensor.dim %1265, %c0 : tensor<?x64xf16>
    %1266 = arith.divsi %dim_595, %c5632 : index
    %expanded_596 = tensor.expand_shape %1265 [[0, 1, 2, 3, 4], [5]] output_shape [%1266, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_597 = tensor.dim %expanded_596, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_598 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_599 = tensor.extract_slice %expanded_596[0, %c7, %c0, 0, 0, 0] [%dim_597, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1267 = tensor.empty(%dim_598) : tensor<4x?x4x32x64xf16>
    %1268 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_599, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1267 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_600 = tensor.dim %expanded_596, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_601 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_602 = tensor.extract_slice %expanded_596[0, %c7, %c1, 0, 0, 0] [%dim_600, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1269 = tensor.empty(%dim_601) : tensor<4x?x4x32x64xf16>
    %1270 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_602, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1269 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_603 = tensor.dim %1268, %c1 : tensor<4x?x4x32x64xf16>
    %1271 = tensor.empty(%dim_603) : tensor<4x?x32x4x64xf16>
    %transposed_604 = linalg.transpose ins(%1268 : tensor<4x?x4x32x64xf16>) outs(%1271 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_605 = tensor.collapse_shape %transposed_604 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_606 = tensor.dim %1270, %c1 : tensor<4x?x4x32x64xf16>
    %1272 = tensor.empty(%dim_606) : tensor<4x?x32x4x64xf16>
    %transposed_607 = linalg.transpose ins(%1270 : tensor<4x?x4x32x64xf16>) outs(%1272 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_608 = tensor.collapse_shape %transposed_607 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1273 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_605 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_609 = tensor.collapse_shape %1273 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1274 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_608 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_610 = tensor.collapse_shape %1274 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_611 = linalg.transpose ins(%collapsed_581 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %1275 = affine.apply #map32()[%dim_603]
    %1276 = tensor.empty(%1275) : tensor<4x32x?x64xf16>
    %transposed_612 = linalg.transpose ins(%collapsed_609 : tensor<4x?x32x64xf16>) outs(%1276 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1277 = affine.apply #map32()[%dim_606]
    %1278 = tensor.empty(%1277) : tensor<4x32x?x64xf16>
    %transposed_613 = linalg.transpose ins(%collapsed_610 : tensor<4x?x32x64xf16>) outs(%1278 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_614 = tensor.collapse_shape %transposed_611 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_615 = tensor.collapse_shape %transposed_612 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_616 = tensor.collapse_shape %transposed_613 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1279 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_614, %collapsed_615, %collapsed_616, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_617 = tensor.expand_shape %1279 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_618 = linalg.transpose ins(%expanded_617 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_619 = tensor.collapse_shape %transposed_618 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1280 = iree_tensor_ext.bitcast %__auto.blk.7.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_620 = tensor.expand_shape %1280 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_621 = tensor.extract_slice %expanded_620[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1281 = iree_tensor_ext.bitcast %extracted_slice_621 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_622 = tensor.extract_slice %expanded_620[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1282 = iree_tensor_ext.bitcast %extracted_slice_622 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1283 = tensor.empty() : tensor<2048x64x32xf16>
    %1284 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1281, %1282 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1283 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_623 = tensor.expand_shape %collapsed_619 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1285 = tensor.empty() : tensor<4x1x2048xf32>
    %1286 = linalg.fill ins(%cst_5 : f32) outs(%1285 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1287 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_623, %1284 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1286 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1288 = tensor.empty() : tensor<4x1x2048xf16>
    %1289 = linalg.copy ins(%1287 : tensor<4x1x2048xf32>) outs(%1288 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1290 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1175, %1289 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1291 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1290 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1291 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1293 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1292 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1294 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1293 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1295 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1294 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1296 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1295 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1297 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1291, %1296 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1298 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1297 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1299 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.ffn_norm.weight, %1298 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1300 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1299 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1301 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_624 = tensor.expand_shape %1301 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_625 = tensor.extract_slice %expanded_624[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1302 = iree_tensor_ext.bitcast %extracted_slice_625 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_626 = tensor.extract_slice %expanded_624[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1303 = iree_tensor_ext.bitcast %extracted_slice_626 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1304 = tensor.empty() : tensor<5632x64x32xf16>
    %1305 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1302, %1303 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1304 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_627 = tensor.expand_shape %1300 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1306 = tensor.empty() : tensor<4x1x5632xf32>
    %1307 = linalg.fill ins(%cst_5 : f32) outs(%1306 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1308 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_627, %1305 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1307 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1309 = tensor.empty() : tensor<4x1x5632xf16>
    %1310 = linalg.copy ins(%1308 : tensor<4x1x5632xf32>) outs(%1309 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1311 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1310 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %1312 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1311, %1310 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1313 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_628 = tensor.expand_shape %1313 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_629 = tensor.extract_slice %expanded_628[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1314 = iree_tensor_ext.bitcast %extracted_slice_629 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_630 = tensor.extract_slice %expanded_628[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1315 = iree_tensor_ext.bitcast %extracted_slice_630 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1316 = tensor.empty() : tensor<5632x64x32xf16>
    %1317 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1314, %1315 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1316 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_631 = tensor.expand_shape %1300 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1318 = tensor.empty() : tensor<4x1x5632xf32>
    %1319 = linalg.fill ins(%cst_5 : f32) outs(%1318 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1320 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_631, %1317 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1319 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1321 = tensor.empty() : tensor<4x1x5632xf16>
    %1322 = linalg.copy ins(%1320 : tensor<4x1x5632xf32>) outs(%1321 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1323 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1312, %1322 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1324 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_632 = tensor.expand_shape %1324 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_633 = tensor.extract_slice %expanded_632[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1325 = iree_tensor_ext.bitcast %extracted_slice_633 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_634 = tensor.extract_slice %expanded_632[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1326 = iree_tensor_ext.bitcast %extracted_slice_634 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1327 = tensor.empty() : tensor<2048x176x32xf16>
    %1328 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1325, %1326 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1327 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_635 = tensor.expand_shape %1323 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1329 = tensor.empty() : tensor<4x1x2048xf32>
    %1330 = linalg.fill ins(%cst_5 : f32) outs(%1329 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1331 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_635, %1328 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%1330 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1332 = tensor.empty() : tensor<4x1x2048xf16>
    %1333 = linalg.copy ins(%1331 : tensor<4x1x2048xf32>) outs(%1332 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1334 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1290, %1333 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1335 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1334 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1336 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1335 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1337 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1336 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1338 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1337 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1339 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1338 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1339 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1341 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1335, %1340 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1342 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1341 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1343 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.attn_norm.weight, %1342 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1344 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1343 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1345 = iree_tensor_ext.bitcast %__auto.blk.8.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_636 = tensor.expand_shape %1345 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_637 = tensor.extract_slice %expanded_636[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1346 = iree_tensor_ext.bitcast %extracted_slice_637 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_638 = tensor.extract_slice %expanded_636[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1347 = iree_tensor_ext.bitcast %extracted_slice_638 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1348 = tensor.empty() : tensor<2048x64x32xf16>
    %1349 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1346, %1347 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1348 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_639 = tensor.expand_shape %1344 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1350 = tensor.empty() : tensor<4x1x2048xf32>
    %1351 = linalg.fill ins(%cst_5 : f32) outs(%1350 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1352 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_639, %1349 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1351 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1353 = tensor.empty() : tensor<4x1x2048xf16>
    %1354 = linalg.copy ins(%1352 : tensor<4x1x2048xf32>) outs(%1353 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1355 = iree_tensor_ext.bitcast %__auto.blk.8.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_640 = tensor.expand_shape %1355 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_641 = tensor.extract_slice %expanded_640[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1356 = iree_tensor_ext.bitcast %extracted_slice_641 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_642 = tensor.extract_slice %expanded_640[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1357 = iree_tensor_ext.bitcast %extracted_slice_642 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1358 = tensor.empty() : tensor<256x64x32xf16>
    %1359 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1356, %1357 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1358 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_643 = tensor.expand_shape %1344 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1360 = tensor.empty() : tensor<4x1x256xf32>
    %1361 = linalg.fill ins(%cst_5 : f32) outs(%1360 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1362 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_643, %1359 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1361 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1363 = tensor.empty() : tensor<4x1x256xf16>
    %1364 = linalg.copy ins(%1362 : tensor<4x1x256xf32>) outs(%1363 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1365 = iree_tensor_ext.bitcast %__auto.blk.8.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_644 = tensor.expand_shape %1365 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_645 = tensor.extract_slice %expanded_644[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1366 = iree_tensor_ext.bitcast %extracted_slice_645 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_646 = tensor.extract_slice %expanded_644[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1367 = iree_tensor_ext.bitcast %extracted_slice_646 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1368 = tensor.empty() : tensor<256x64x32xf16>
    %1369 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1366, %1367 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1368 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_647 = tensor.expand_shape %1344 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1370 = tensor.empty() : tensor<4x1x256xf32>
    %1371 = linalg.fill ins(%cst_5 : f32) outs(%1370 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1372 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_647, %1369 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1371 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1373 = tensor.empty() : tensor<4x1x256xf16>
    %1374 = linalg.copy ins(%1372 : tensor<4x1x256xf32>) outs(%1373 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_648 = tensor.expand_shape %1354 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_649 = tensor.expand_shape %1364 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_650 = tensor.expand_shape %1374 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1375 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_651 = tensor.expand_shape %1375 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1376 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_651 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1377 = linalg.batch_matmul ins(%1376, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_652 = linalg.transpose ins(%1377 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1378 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_652 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1379 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1378, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1380 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1379 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1381 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_652 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1382 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1381, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1383 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1382 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_653 = tensor.expand_shape %1380 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_654 = tensor.expand_shape %1383 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_655 = tensor.extract_slice %expanded_648[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_656 = tensor.extract_slice %expanded_648[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1384 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_655, %expanded_653 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1385 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_656, %expanded_654 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1386 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1384, %1385 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1387 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_656, %expanded_653 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1388 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_655, %expanded_654 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1389 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1387, %1388 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1390 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %1391 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1386, %1389 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%1390 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_657 = tensor.collapse_shape %1391 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1392 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_658 = tensor.expand_shape %1392 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1393 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_658 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1394 = linalg.batch_matmul ins(%1393, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_659 = linalg.transpose ins(%1394 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1395 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_659 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1396 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1395, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1397 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1396 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1398 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_659 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1399 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1398, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1400 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1399 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_660 = tensor.expand_shape %1397 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_661 = tensor.expand_shape %1400 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_662 = tensor.extract_slice %expanded_649[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_663 = tensor.extract_slice %expanded_649[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1401 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_662, %expanded_660 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1402 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_663, %expanded_661 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1403 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1401, %1402 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1404 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_663, %expanded_660 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1405 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_662, %expanded_661 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1406 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1404, %1405 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1407 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %1408 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1403, %1406 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%1407 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1409 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_664 = tensor.expand_shape %1409 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1410 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_664 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1411 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1410 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c8_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1412 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1411 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1413 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1412, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1414 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1413 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1415 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1414, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1416 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1415 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1417 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1416, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_665 = tensor.collapse_shape %1417 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_666 = tensor.expand_shape %collapsed_665 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_667 = tensor.collapse_shape %1408 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1418 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_667, %expanded_666 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1265 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1419 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1412, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1420 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1419 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1421 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1420, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1422 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1421 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1423 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1422, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_668 = tensor.collapse_shape %1423 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_669 = tensor.expand_shape %collapsed_668 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_670 = tensor.collapse_shape %expanded_650 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1424 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_670, %expanded_669 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1418 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_671 = tensor.dim %1424, %c0 : tensor<?x64xf16>
    %1425 = arith.divsi %dim_671, %c5632 : index
    %expanded_672 = tensor.expand_shape %1424 [[0, 1, 2, 3, 4], [5]] output_shape [%1425, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_673 = tensor.dim %expanded_672, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_674 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_675 = tensor.extract_slice %expanded_672[0, %c8, %c0, 0, 0, 0] [%dim_673, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1426 = tensor.empty(%dim_674) : tensor<4x?x4x32x64xf16>
    %1427 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_675, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1426 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_676 = tensor.dim %expanded_672, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_677 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_678 = tensor.extract_slice %expanded_672[0, %c8, %c1, 0, 0, 0] [%dim_676, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1428 = tensor.empty(%dim_677) : tensor<4x?x4x32x64xf16>
    %1429 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_678, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1428 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_679 = tensor.dim %1427, %c1 : tensor<4x?x4x32x64xf16>
    %1430 = tensor.empty(%dim_679) : tensor<4x?x32x4x64xf16>
    %transposed_680 = linalg.transpose ins(%1427 : tensor<4x?x4x32x64xf16>) outs(%1430 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_681 = tensor.collapse_shape %transposed_680 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_682 = tensor.dim %1429, %c1 : tensor<4x?x4x32x64xf16>
    %1431 = tensor.empty(%dim_682) : tensor<4x?x32x4x64xf16>
    %transposed_683 = linalg.transpose ins(%1429 : tensor<4x?x4x32x64xf16>) outs(%1431 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_684 = tensor.collapse_shape %transposed_683 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1432 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_681 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_685 = tensor.collapse_shape %1432 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1433 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_684 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_686 = tensor.collapse_shape %1433 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_687 = linalg.transpose ins(%collapsed_657 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %1434 = affine.apply #map32()[%dim_679]
    %1435 = tensor.empty(%1434) : tensor<4x32x?x64xf16>
    %transposed_688 = linalg.transpose ins(%collapsed_685 : tensor<4x?x32x64xf16>) outs(%1435 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1436 = affine.apply #map32()[%dim_682]
    %1437 = tensor.empty(%1436) : tensor<4x32x?x64xf16>
    %transposed_689 = linalg.transpose ins(%collapsed_686 : tensor<4x?x32x64xf16>) outs(%1437 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_690 = tensor.collapse_shape %transposed_687 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_691 = tensor.collapse_shape %transposed_688 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_692 = tensor.collapse_shape %transposed_689 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1438 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_690, %collapsed_691, %collapsed_692, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_693 = tensor.expand_shape %1438 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_694 = linalg.transpose ins(%expanded_693 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_695 = tensor.collapse_shape %transposed_694 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1439 = iree_tensor_ext.bitcast %__auto.blk.8.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_696 = tensor.expand_shape %1439 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_697 = tensor.extract_slice %expanded_696[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1440 = iree_tensor_ext.bitcast %extracted_slice_697 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_698 = tensor.extract_slice %expanded_696[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1441 = iree_tensor_ext.bitcast %extracted_slice_698 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1442 = tensor.empty() : tensor<2048x64x32xf16>
    %1443 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1440, %1441 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1442 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_699 = tensor.expand_shape %collapsed_695 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1444 = tensor.empty() : tensor<4x1x2048xf32>
    %1445 = linalg.fill ins(%cst_5 : f32) outs(%1444 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1446 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_699, %1443 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1445 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1447 = tensor.empty() : tensor<4x1x2048xf16>
    %1448 = linalg.copy ins(%1446 : tensor<4x1x2048xf32>) outs(%1447 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1449 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1334, %1448 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1450 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1449 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1451 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1450 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1452 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1451 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1453 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1452 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1454 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1453 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1455 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1454 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1456 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1450, %1455 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1457 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1456 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1458 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.ffn_norm.weight, %1457 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1459 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1458 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1460 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_700 = tensor.expand_shape %1460 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_701 = tensor.extract_slice %expanded_700[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1461 = iree_tensor_ext.bitcast %extracted_slice_701 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_702 = tensor.extract_slice %expanded_700[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1462 = iree_tensor_ext.bitcast %extracted_slice_702 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1463 = tensor.empty() : tensor<5632x64x32xf16>
    %1464 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1461, %1462 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1463 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_703 = tensor.expand_shape %1459 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1465 = tensor.empty() : tensor<4x1x5632xf32>
    %1466 = linalg.fill ins(%cst_5 : f32) outs(%1465 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1467 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_703, %1464 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1466 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1468 = tensor.empty() : tensor<4x1x5632xf16>
    %1469 = linalg.copy ins(%1467 : tensor<4x1x5632xf32>) outs(%1468 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1470 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1469 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %1471 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1470, %1469 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1472 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_704 = tensor.expand_shape %1472 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_705 = tensor.extract_slice %expanded_704[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1473 = iree_tensor_ext.bitcast %extracted_slice_705 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_706 = tensor.extract_slice %expanded_704[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1474 = iree_tensor_ext.bitcast %extracted_slice_706 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1475 = tensor.empty() : tensor<5632x64x32xf16>
    %1476 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1473, %1474 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1475 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_707 = tensor.expand_shape %1459 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1477 = tensor.empty() : tensor<4x1x5632xf32>
    %1478 = linalg.fill ins(%cst_5 : f32) outs(%1477 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1479 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_707, %1476 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1478 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1480 = tensor.empty() : tensor<4x1x5632xf16>
    %1481 = linalg.copy ins(%1479 : tensor<4x1x5632xf32>) outs(%1480 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1482 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1471, %1481 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1483 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_708 = tensor.expand_shape %1483 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_709 = tensor.extract_slice %expanded_708[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1484 = iree_tensor_ext.bitcast %extracted_slice_709 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_710 = tensor.extract_slice %expanded_708[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1485 = iree_tensor_ext.bitcast %extracted_slice_710 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1486 = tensor.empty() : tensor<2048x176x32xf16>
    %1487 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1484, %1485 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1486 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_711 = tensor.expand_shape %1482 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1488 = tensor.empty() : tensor<4x1x2048xf32>
    %1489 = linalg.fill ins(%cst_5 : f32) outs(%1488 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1490 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_711, %1487 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%1489 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1491 = tensor.empty() : tensor<4x1x2048xf16>
    %1492 = linalg.copy ins(%1490 : tensor<4x1x2048xf32>) outs(%1491 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1493 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1449, %1492 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1494 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1493 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1495 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1494 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1496 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1495 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1497 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1496 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1498 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1497 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1499 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1498 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1500 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1494, %1499 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1501 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1500 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1502 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.attn_norm.weight, %1501 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1503 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1502 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1504 = iree_tensor_ext.bitcast %__auto.blk.9.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_712 = tensor.expand_shape %1504 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_713 = tensor.extract_slice %expanded_712[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1505 = iree_tensor_ext.bitcast %extracted_slice_713 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_714 = tensor.extract_slice %expanded_712[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1506 = iree_tensor_ext.bitcast %extracted_slice_714 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1507 = tensor.empty() : tensor<2048x64x32xf16>
    %1508 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1505, %1506 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1507 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_715 = tensor.expand_shape %1503 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1509 = tensor.empty() : tensor<4x1x2048xf32>
    %1510 = linalg.fill ins(%cst_5 : f32) outs(%1509 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1511 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_715, %1508 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1510 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1512 = tensor.empty() : tensor<4x1x2048xf16>
    %1513 = linalg.copy ins(%1511 : tensor<4x1x2048xf32>) outs(%1512 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1514 = iree_tensor_ext.bitcast %__auto.blk.9.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_716 = tensor.expand_shape %1514 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_717 = tensor.extract_slice %expanded_716[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1515 = iree_tensor_ext.bitcast %extracted_slice_717 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_718 = tensor.extract_slice %expanded_716[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1516 = iree_tensor_ext.bitcast %extracted_slice_718 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1517 = tensor.empty() : tensor<256x64x32xf16>
    %1518 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1515, %1516 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1517 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_719 = tensor.expand_shape %1503 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1519 = tensor.empty() : tensor<4x1x256xf32>
    %1520 = linalg.fill ins(%cst_5 : f32) outs(%1519 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1521 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_719, %1518 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1520 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1522 = tensor.empty() : tensor<4x1x256xf16>
    %1523 = linalg.copy ins(%1521 : tensor<4x1x256xf32>) outs(%1522 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1524 = iree_tensor_ext.bitcast %__auto.blk.9.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_720 = tensor.expand_shape %1524 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_721 = tensor.extract_slice %expanded_720[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1525 = iree_tensor_ext.bitcast %extracted_slice_721 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_722 = tensor.extract_slice %expanded_720[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1526 = iree_tensor_ext.bitcast %extracted_slice_722 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1527 = tensor.empty() : tensor<256x64x32xf16>
    %1528 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1525, %1526 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1527 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_723 = tensor.expand_shape %1503 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1529 = tensor.empty() : tensor<4x1x256xf32>
    %1530 = linalg.fill ins(%cst_5 : f32) outs(%1529 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1531 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_723, %1528 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1530 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1532 = tensor.empty() : tensor<4x1x256xf16>
    %1533 = linalg.copy ins(%1531 : tensor<4x1x256xf32>) outs(%1532 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_724 = tensor.expand_shape %1513 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_725 = tensor.expand_shape %1523 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_726 = tensor.expand_shape %1533 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1534 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_727 = tensor.expand_shape %1534 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1535 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_727 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1536 = linalg.batch_matmul ins(%1535, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_728 = linalg.transpose ins(%1536 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1537 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_728 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1538 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1537, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1539 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1538 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1540 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_728 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1541 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1540, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1542 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1541 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_729 = tensor.expand_shape %1539 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_730 = tensor.expand_shape %1542 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_731 = tensor.extract_slice %expanded_724[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_732 = tensor.extract_slice %expanded_724[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1543 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_731, %expanded_729 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1544 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_732, %expanded_730 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1545 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1543, %1544 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1546 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_732, %expanded_729 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1547 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_731, %expanded_730 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1548 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1546, %1547 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1549 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %1550 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1545, %1548 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%1549 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_733 = tensor.collapse_shape %1550 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1551 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_734 = tensor.expand_shape %1551 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1552 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_734 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1553 = linalg.batch_matmul ins(%1552, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_735 = linalg.transpose ins(%1553 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1554 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_735 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1555 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1554, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1556 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1555 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1557 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_735 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1558 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1557, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1559 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1558 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_736 = tensor.expand_shape %1556 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_737 = tensor.expand_shape %1559 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_738 = tensor.extract_slice %expanded_725[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_739 = tensor.extract_slice %expanded_725[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1560 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_738, %expanded_736 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1561 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_739, %expanded_737 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1562 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1560, %1561 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1563 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_739, %expanded_736 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1564 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_738, %expanded_737 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1565 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1563, %1564 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1566 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %1567 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1562, %1565 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%1566 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1568 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_740 = tensor.expand_shape %1568 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1569 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_740 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1570 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1569 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c9_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1571 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1570 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1572 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1571, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1573 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1572 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1574 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1573, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1575 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1574 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1576 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1575, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_741 = tensor.collapse_shape %1576 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_742 = tensor.expand_shape %collapsed_741 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_743 = tensor.collapse_shape %1567 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1577 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_743, %expanded_742 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1424 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1578 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1571, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1579 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1578 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1580 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1579, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1581 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1580 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1582 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1581, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_744 = tensor.collapse_shape %1582 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_745 = tensor.expand_shape %collapsed_744 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_746 = tensor.collapse_shape %expanded_726 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1583 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_746, %expanded_745 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1577 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_747 = tensor.dim %1583, %c0 : tensor<?x64xf16>
    %1584 = arith.divsi %dim_747, %c5632 : index
    %expanded_748 = tensor.expand_shape %1583 [[0, 1, 2, 3, 4], [5]] output_shape [%1584, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_749 = tensor.dim %expanded_748, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_750 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_751 = tensor.extract_slice %expanded_748[0, %c9, %c0, 0, 0, 0] [%dim_749, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1585 = tensor.empty(%dim_750) : tensor<4x?x4x32x64xf16>
    %1586 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_751, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1585 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_752 = tensor.dim %expanded_748, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_753 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_754 = tensor.extract_slice %expanded_748[0, %c9, %c1, 0, 0, 0] [%dim_752, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1587 = tensor.empty(%dim_753) : tensor<4x?x4x32x64xf16>
    %1588 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_754, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1587 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_755 = tensor.dim %1586, %c1 : tensor<4x?x4x32x64xf16>
    %1589 = tensor.empty(%dim_755) : tensor<4x?x32x4x64xf16>
    %transposed_756 = linalg.transpose ins(%1586 : tensor<4x?x4x32x64xf16>) outs(%1589 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_757 = tensor.collapse_shape %transposed_756 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_758 = tensor.dim %1588, %c1 : tensor<4x?x4x32x64xf16>
    %1590 = tensor.empty(%dim_758) : tensor<4x?x32x4x64xf16>
    %transposed_759 = linalg.transpose ins(%1588 : tensor<4x?x4x32x64xf16>) outs(%1590 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_760 = tensor.collapse_shape %transposed_759 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1591 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_757 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_761 = tensor.collapse_shape %1591 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1592 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_760 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_762 = tensor.collapse_shape %1592 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_763 = linalg.transpose ins(%collapsed_733 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %1593 = affine.apply #map32()[%dim_755]
    %1594 = tensor.empty(%1593) : tensor<4x32x?x64xf16>
    %transposed_764 = linalg.transpose ins(%collapsed_761 : tensor<4x?x32x64xf16>) outs(%1594 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1595 = affine.apply #map32()[%dim_758]
    %1596 = tensor.empty(%1595) : tensor<4x32x?x64xf16>
    %transposed_765 = linalg.transpose ins(%collapsed_762 : tensor<4x?x32x64xf16>) outs(%1596 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_766 = tensor.collapse_shape %transposed_763 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_767 = tensor.collapse_shape %transposed_764 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_768 = tensor.collapse_shape %transposed_765 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1597 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_766, %collapsed_767, %collapsed_768, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_769 = tensor.expand_shape %1597 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_770 = linalg.transpose ins(%expanded_769 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_771 = tensor.collapse_shape %transposed_770 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1598 = iree_tensor_ext.bitcast %__auto.blk.9.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_772 = tensor.expand_shape %1598 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_773 = tensor.extract_slice %expanded_772[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1599 = iree_tensor_ext.bitcast %extracted_slice_773 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_774 = tensor.extract_slice %expanded_772[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1600 = iree_tensor_ext.bitcast %extracted_slice_774 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1601 = tensor.empty() : tensor<2048x64x32xf16>
    %1602 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1599, %1600 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1601 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_775 = tensor.expand_shape %collapsed_771 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1603 = tensor.empty() : tensor<4x1x2048xf32>
    %1604 = linalg.fill ins(%cst_5 : f32) outs(%1603 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1605 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_775, %1602 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1604 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1606 = tensor.empty() : tensor<4x1x2048xf16>
    %1607 = linalg.copy ins(%1605 : tensor<4x1x2048xf32>) outs(%1606 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1608 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1493, %1607 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1609 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1608 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1610 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1609 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1611 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1610 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1612 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1611 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1613 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1612 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1614 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1613 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1615 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1609, %1614 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1616 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1615 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1617 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.ffn_norm.weight, %1616 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1618 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1617 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1619 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_776 = tensor.expand_shape %1619 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_777 = tensor.extract_slice %expanded_776[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1620 = iree_tensor_ext.bitcast %extracted_slice_777 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_778 = tensor.extract_slice %expanded_776[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1621 = iree_tensor_ext.bitcast %extracted_slice_778 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1622 = tensor.empty() : tensor<5632x64x32xf16>
    %1623 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1620, %1621 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1622 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_779 = tensor.expand_shape %1618 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1624 = tensor.empty() : tensor<4x1x5632xf32>
    %1625 = linalg.fill ins(%cst_5 : f32) outs(%1624 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1626 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_779, %1623 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1625 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1627 = tensor.empty() : tensor<4x1x5632xf16>
    %1628 = linalg.copy ins(%1626 : tensor<4x1x5632xf32>) outs(%1627 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1629 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1628 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %1630 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1629, %1628 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1631 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_780 = tensor.expand_shape %1631 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_781 = tensor.extract_slice %expanded_780[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1632 = iree_tensor_ext.bitcast %extracted_slice_781 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_782 = tensor.extract_slice %expanded_780[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1633 = iree_tensor_ext.bitcast %extracted_slice_782 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1634 = tensor.empty() : tensor<5632x64x32xf16>
    %1635 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1632, %1633 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1634 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_783 = tensor.expand_shape %1618 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1636 = tensor.empty() : tensor<4x1x5632xf32>
    %1637 = linalg.fill ins(%cst_5 : f32) outs(%1636 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1638 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_783, %1635 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1637 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1639 = tensor.empty() : tensor<4x1x5632xf16>
    %1640 = linalg.copy ins(%1638 : tensor<4x1x5632xf32>) outs(%1639 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1641 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1630, %1640 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1642 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_784 = tensor.expand_shape %1642 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_785 = tensor.extract_slice %expanded_784[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1643 = iree_tensor_ext.bitcast %extracted_slice_785 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_786 = tensor.extract_slice %expanded_784[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1644 = iree_tensor_ext.bitcast %extracted_slice_786 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1645 = tensor.empty() : tensor<2048x176x32xf16>
    %1646 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1643, %1644 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1645 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_787 = tensor.expand_shape %1641 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1647 = tensor.empty() : tensor<4x1x2048xf32>
    %1648 = linalg.fill ins(%cst_5 : f32) outs(%1647 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1649 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_787, %1646 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%1648 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1650 = tensor.empty() : tensor<4x1x2048xf16>
    %1651 = linalg.copy ins(%1649 : tensor<4x1x2048xf32>) outs(%1650 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1652 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1608, %1651 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1653 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1652 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1654 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1653 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1655 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1654 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1656 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1655 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1657 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1656 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1658 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1657 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1659 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1653, %1658 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1660 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1659 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1661 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.attn_norm.weight, %1660 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1662 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1661 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1663 = iree_tensor_ext.bitcast %__auto.blk.10.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_788 = tensor.expand_shape %1663 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_789 = tensor.extract_slice %expanded_788[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1664 = iree_tensor_ext.bitcast %extracted_slice_789 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_790 = tensor.extract_slice %expanded_788[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1665 = iree_tensor_ext.bitcast %extracted_slice_790 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1666 = tensor.empty() : tensor<2048x64x32xf16>
    %1667 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1664, %1665 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1666 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_791 = tensor.expand_shape %1662 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1668 = tensor.empty() : tensor<4x1x2048xf32>
    %1669 = linalg.fill ins(%cst_5 : f32) outs(%1668 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1670 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_791, %1667 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1669 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1671 = tensor.empty() : tensor<4x1x2048xf16>
    %1672 = linalg.copy ins(%1670 : tensor<4x1x2048xf32>) outs(%1671 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1673 = iree_tensor_ext.bitcast %__auto.blk.10.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_792 = tensor.expand_shape %1673 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_793 = tensor.extract_slice %expanded_792[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1674 = iree_tensor_ext.bitcast %extracted_slice_793 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_794 = tensor.extract_slice %expanded_792[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1675 = iree_tensor_ext.bitcast %extracted_slice_794 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1676 = tensor.empty() : tensor<256x64x32xf16>
    %1677 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1674, %1675 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1676 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_795 = tensor.expand_shape %1662 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1678 = tensor.empty() : tensor<4x1x256xf32>
    %1679 = linalg.fill ins(%cst_5 : f32) outs(%1678 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1680 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_795, %1677 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1679 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1681 = tensor.empty() : tensor<4x1x256xf16>
    %1682 = linalg.copy ins(%1680 : tensor<4x1x256xf32>) outs(%1681 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1683 = iree_tensor_ext.bitcast %__auto.blk.10.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_796 = tensor.expand_shape %1683 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_797 = tensor.extract_slice %expanded_796[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1684 = iree_tensor_ext.bitcast %extracted_slice_797 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_798 = tensor.extract_slice %expanded_796[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1685 = iree_tensor_ext.bitcast %extracted_slice_798 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1686 = tensor.empty() : tensor<256x64x32xf16>
    %1687 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1684, %1685 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1686 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_799 = tensor.expand_shape %1662 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1688 = tensor.empty() : tensor<4x1x256xf32>
    %1689 = linalg.fill ins(%cst_5 : f32) outs(%1688 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1690 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_799, %1687 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1689 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1691 = tensor.empty() : tensor<4x1x256xf16>
    %1692 = linalg.copy ins(%1690 : tensor<4x1x256xf32>) outs(%1691 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_800 = tensor.expand_shape %1672 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_801 = tensor.expand_shape %1682 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_802 = tensor.expand_shape %1692 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1693 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_803 = tensor.expand_shape %1693 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1694 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_803 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1695 = linalg.batch_matmul ins(%1694, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_804 = linalg.transpose ins(%1695 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1696 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_804 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1697 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1696, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1698 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1697 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1699 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_804 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1700 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1699, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1701 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1700 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_805 = tensor.expand_shape %1698 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_806 = tensor.expand_shape %1701 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_807 = tensor.extract_slice %expanded_800[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_808 = tensor.extract_slice %expanded_800[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1702 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_807, %expanded_805 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1703 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_808, %expanded_806 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1704 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1702, %1703 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1705 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_808, %expanded_805 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1706 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_807, %expanded_806 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1707 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1705, %1706 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1708 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %1709 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1704, %1707 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%1708 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_809 = tensor.collapse_shape %1709 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1710 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_810 = tensor.expand_shape %1710 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1711 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_810 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1712 = linalg.batch_matmul ins(%1711, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_811 = linalg.transpose ins(%1712 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1713 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_811 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1714 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1713, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1715 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1714 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1716 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_811 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1717 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1716, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1718 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1717 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_812 = tensor.expand_shape %1715 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_813 = tensor.expand_shape %1718 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_814 = tensor.extract_slice %expanded_801[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_815 = tensor.extract_slice %expanded_801[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1719 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_814, %expanded_812 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1720 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_815, %expanded_813 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1721 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1719, %1720 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1722 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_815, %expanded_812 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1723 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_814, %expanded_813 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1724 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1722, %1723 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1725 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %1726 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1721, %1724 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%1725 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1727 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_816 = tensor.expand_shape %1727 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1728 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_816 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1729 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1728 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c10_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1730 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1729 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1731 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1730, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1732 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1731 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1733 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1732, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1734 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1733 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1735 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1734, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_817 = tensor.collapse_shape %1735 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_818 = tensor.expand_shape %collapsed_817 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_819 = tensor.collapse_shape %1726 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1736 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_819, %expanded_818 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1583 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1737 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1730, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1738 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1737 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1739 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1738, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1740 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1739 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1741 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1740, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_820 = tensor.collapse_shape %1741 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_821 = tensor.expand_shape %collapsed_820 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_822 = tensor.collapse_shape %expanded_802 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1742 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_822, %expanded_821 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1736 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_823 = tensor.dim %1742, %c0 : tensor<?x64xf16>
    %1743 = arith.divsi %dim_823, %c5632 : index
    %expanded_824 = tensor.expand_shape %1742 [[0, 1, 2, 3, 4], [5]] output_shape [%1743, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_825 = tensor.dim %expanded_824, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_826 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_827 = tensor.extract_slice %expanded_824[0, %c10, %c0, 0, 0, 0] [%dim_825, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1744 = tensor.empty(%dim_826) : tensor<4x?x4x32x64xf16>
    %1745 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_827, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1744 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_828 = tensor.dim %expanded_824, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_829 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_830 = tensor.extract_slice %expanded_824[0, %c10, %c1, 0, 0, 0] [%dim_828, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1746 = tensor.empty(%dim_829) : tensor<4x?x4x32x64xf16>
    %1747 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_830, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1746 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_831 = tensor.dim %1745, %c1 : tensor<4x?x4x32x64xf16>
    %1748 = tensor.empty(%dim_831) : tensor<4x?x32x4x64xf16>
    %transposed_832 = linalg.transpose ins(%1745 : tensor<4x?x4x32x64xf16>) outs(%1748 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_833 = tensor.collapse_shape %transposed_832 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_834 = tensor.dim %1747, %c1 : tensor<4x?x4x32x64xf16>
    %1749 = tensor.empty(%dim_834) : tensor<4x?x32x4x64xf16>
    %transposed_835 = linalg.transpose ins(%1747 : tensor<4x?x4x32x64xf16>) outs(%1749 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_836 = tensor.collapse_shape %transposed_835 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1750 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_833 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_837 = tensor.collapse_shape %1750 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1751 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_836 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_838 = tensor.collapse_shape %1751 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_839 = linalg.transpose ins(%collapsed_809 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %1752 = affine.apply #map32()[%dim_831]
    %1753 = tensor.empty(%1752) : tensor<4x32x?x64xf16>
    %transposed_840 = linalg.transpose ins(%collapsed_837 : tensor<4x?x32x64xf16>) outs(%1753 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1754 = affine.apply #map32()[%dim_834]
    %1755 = tensor.empty(%1754) : tensor<4x32x?x64xf16>
    %transposed_841 = linalg.transpose ins(%collapsed_838 : tensor<4x?x32x64xf16>) outs(%1755 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_842 = tensor.collapse_shape %transposed_839 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_843 = tensor.collapse_shape %transposed_840 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_844 = tensor.collapse_shape %transposed_841 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1756 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_842, %collapsed_843, %collapsed_844, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_845 = tensor.expand_shape %1756 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_846 = linalg.transpose ins(%expanded_845 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_847 = tensor.collapse_shape %transposed_846 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1757 = iree_tensor_ext.bitcast %__auto.blk.10.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_848 = tensor.expand_shape %1757 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_849 = tensor.extract_slice %expanded_848[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1758 = iree_tensor_ext.bitcast %extracted_slice_849 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_850 = tensor.extract_slice %expanded_848[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1759 = iree_tensor_ext.bitcast %extracted_slice_850 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1760 = tensor.empty() : tensor<2048x64x32xf16>
    %1761 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1758, %1759 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1760 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_851 = tensor.expand_shape %collapsed_847 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1762 = tensor.empty() : tensor<4x1x2048xf32>
    %1763 = linalg.fill ins(%cst_5 : f32) outs(%1762 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1764 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_851, %1761 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1763 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1765 = tensor.empty() : tensor<4x1x2048xf16>
    %1766 = linalg.copy ins(%1764 : tensor<4x1x2048xf32>) outs(%1765 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1767 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1652, %1766 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1768 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1767 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1769 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1768 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1770 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1769 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1771 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1770 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1772 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1771 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1773 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1772 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1774 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1768, %1773 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1775 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1774 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1776 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.ffn_norm.weight, %1775 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1777 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1776 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1778 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_852 = tensor.expand_shape %1778 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_853 = tensor.extract_slice %expanded_852[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1779 = iree_tensor_ext.bitcast %extracted_slice_853 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_854 = tensor.extract_slice %expanded_852[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1780 = iree_tensor_ext.bitcast %extracted_slice_854 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1781 = tensor.empty() : tensor<5632x64x32xf16>
    %1782 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1779, %1780 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1781 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_855 = tensor.expand_shape %1777 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1783 = tensor.empty() : tensor<4x1x5632xf32>
    %1784 = linalg.fill ins(%cst_5 : f32) outs(%1783 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1785 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_855, %1782 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1784 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1786 = tensor.empty() : tensor<4x1x5632xf16>
    %1787 = linalg.copy ins(%1785 : tensor<4x1x5632xf32>) outs(%1786 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1788 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1787 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %1789 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1788, %1787 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1790 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_856 = tensor.expand_shape %1790 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_857 = tensor.extract_slice %expanded_856[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1791 = iree_tensor_ext.bitcast %extracted_slice_857 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_858 = tensor.extract_slice %expanded_856[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1792 = iree_tensor_ext.bitcast %extracted_slice_858 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1793 = tensor.empty() : tensor<5632x64x32xf16>
    %1794 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1791, %1792 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1793 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_859 = tensor.expand_shape %1777 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1795 = tensor.empty() : tensor<4x1x5632xf32>
    %1796 = linalg.fill ins(%cst_5 : f32) outs(%1795 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1797 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_859, %1794 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1796 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1798 = tensor.empty() : tensor<4x1x5632xf16>
    %1799 = linalg.copy ins(%1797 : tensor<4x1x5632xf32>) outs(%1798 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1800 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1789, %1799 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1801 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_860 = tensor.expand_shape %1801 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_861 = tensor.extract_slice %expanded_860[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1802 = iree_tensor_ext.bitcast %extracted_slice_861 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_862 = tensor.extract_slice %expanded_860[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1803 = iree_tensor_ext.bitcast %extracted_slice_862 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1804 = tensor.empty() : tensor<2048x176x32xf16>
    %1805 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1802, %1803 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1804 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_863 = tensor.expand_shape %1800 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1806 = tensor.empty() : tensor<4x1x2048xf32>
    %1807 = linalg.fill ins(%cst_5 : f32) outs(%1806 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1808 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_863, %1805 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%1807 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1809 = tensor.empty() : tensor<4x1x2048xf16>
    %1810 = linalg.copy ins(%1808 : tensor<4x1x2048xf32>) outs(%1809 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1811 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1767, %1810 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1812 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1811 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1813 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1812 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1814 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1813 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1815 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1814 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1816 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1815 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1817 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1816 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1818 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1812, %1817 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1819 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1818 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1820 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.attn_norm.weight, %1819 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1821 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1820 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1822 = iree_tensor_ext.bitcast %__auto.blk.11.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_864 = tensor.expand_shape %1822 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_865 = tensor.extract_slice %expanded_864[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1823 = iree_tensor_ext.bitcast %extracted_slice_865 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_866 = tensor.extract_slice %expanded_864[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1824 = iree_tensor_ext.bitcast %extracted_slice_866 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1825 = tensor.empty() : tensor<2048x64x32xf16>
    %1826 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1823, %1824 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1825 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_867 = tensor.expand_shape %1821 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1827 = tensor.empty() : tensor<4x1x2048xf32>
    %1828 = linalg.fill ins(%cst_5 : f32) outs(%1827 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1829 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_867, %1826 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1828 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1830 = tensor.empty() : tensor<4x1x2048xf16>
    %1831 = linalg.copy ins(%1829 : tensor<4x1x2048xf32>) outs(%1830 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1832 = iree_tensor_ext.bitcast %__auto.blk.11.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_868 = tensor.expand_shape %1832 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_869 = tensor.extract_slice %expanded_868[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1833 = iree_tensor_ext.bitcast %extracted_slice_869 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_870 = tensor.extract_slice %expanded_868[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1834 = iree_tensor_ext.bitcast %extracted_slice_870 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1835 = tensor.empty() : tensor<256x64x32xf16>
    %1836 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1833, %1834 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1835 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_871 = tensor.expand_shape %1821 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1837 = tensor.empty() : tensor<4x1x256xf32>
    %1838 = linalg.fill ins(%cst_5 : f32) outs(%1837 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1839 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_871, %1836 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1838 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1840 = tensor.empty() : tensor<4x1x256xf16>
    %1841 = linalg.copy ins(%1839 : tensor<4x1x256xf32>) outs(%1840 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1842 = iree_tensor_ext.bitcast %__auto.blk.11.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_872 = tensor.expand_shape %1842 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_873 = tensor.extract_slice %expanded_872[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1843 = iree_tensor_ext.bitcast %extracted_slice_873 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_874 = tensor.extract_slice %expanded_872[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1844 = iree_tensor_ext.bitcast %extracted_slice_874 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1845 = tensor.empty() : tensor<256x64x32xf16>
    %1846 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1843, %1844 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1845 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_875 = tensor.expand_shape %1821 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1847 = tensor.empty() : tensor<4x1x256xf32>
    %1848 = linalg.fill ins(%cst_5 : f32) outs(%1847 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1849 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_875, %1846 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1848 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1850 = tensor.empty() : tensor<4x1x256xf16>
    %1851 = linalg.copy ins(%1849 : tensor<4x1x256xf32>) outs(%1850 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_876 = tensor.expand_shape %1831 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_877 = tensor.expand_shape %1841 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_878 = tensor.expand_shape %1851 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1852 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_879 = tensor.expand_shape %1852 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1853 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_879 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1854 = linalg.batch_matmul ins(%1853, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_880 = linalg.transpose ins(%1854 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1855 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_880 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1856 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1855, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1857 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1856 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1858 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_880 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1859 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1858, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1860 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1859 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_881 = tensor.expand_shape %1857 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_882 = tensor.expand_shape %1860 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_883 = tensor.extract_slice %expanded_876[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_884 = tensor.extract_slice %expanded_876[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1861 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_883, %expanded_881 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1862 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_884, %expanded_882 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1863 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1861, %1862 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1864 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_884, %expanded_881 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1865 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_883, %expanded_882 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1866 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1864, %1865 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %1867 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %1868 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1863, %1866 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%1867 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_885 = tensor.collapse_shape %1868 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1869 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_886 = tensor.expand_shape %1869 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1870 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_886 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1871 = linalg.batch_matmul ins(%1870, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_887 = linalg.transpose ins(%1871 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1872 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_887 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1873 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1872, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1874 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1873 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %1875 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_887 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1876 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1875, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %1877 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1876 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_888 = tensor.expand_shape %1874 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_889 = tensor.expand_shape %1877 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_890 = tensor.extract_slice %expanded_877[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_891 = tensor.extract_slice %expanded_877[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1878 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_890, %expanded_888 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1879 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_891, %expanded_889 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1880 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1878, %1879 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1881 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_891, %expanded_888 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1882 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_890, %expanded_889 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1883 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1881, %1882 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %1884 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %1885 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1880, %1883 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%1884 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1886 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_892 = tensor.expand_shape %1886 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1887 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_892 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1888 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1887 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c11_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1889 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1888 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1890 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1889, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1891 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1890 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1892 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1891, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1893 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1892 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1894 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1893, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_893 = tensor.collapse_shape %1894 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_894 = tensor.expand_shape %collapsed_893 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_895 = tensor.collapse_shape %1885 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1895 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_895, %expanded_894 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1742 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1896 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1889, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1897 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1896 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %1898 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1897, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1899 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1898 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %1900 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1899, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_896 = tensor.collapse_shape %1900 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_897 = tensor.expand_shape %collapsed_896 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_898 = tensor.collapse_shape %expanded_878 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1901 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_898, %expanded_897 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1895 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_899 = tensor.dim %1901, %c0 : tensor<?x64xf16>
    %1902 = arith.divsi %dim_899, %c5632 : index
    %expanded_900 = tensor.expand_shape %1901 [[0, 1, 2, 3, 4], [5]] output_shape [%1902, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_901 = tensor.dim %expanded_900, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_902 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_903 = tensor.extract_slice %expanded_900[0, %c11, %c0, 0, 0, 0] [%dim_901, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1903 = tensor.empty(%dim_902) : tensor<4x?x4x32x64xf16>
    %1904 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_903, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1903 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_904 = tensor.dim %expanded_900, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_905 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_906 = tensor.extract_slice %expanded_900[0, %c11, %c1, 0, 0, 0] [%dim_904, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1905 = tensor.empty(%dim_905) : tensor<4x?x4x32x64xf16>
    %1906 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_906, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%1905 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_907 = tensor.dim %1904, %c1 : tensor<4x?x4x32x64xf16>
    %1907 = tensor.empty(%dim_907) : tensor<4x?x32x4x64xf16>
    %transposed_908 = linalg.transpose ins(%1904 : tensor<4x?x4x32x64xf16>) outs(%1907 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_909 = tensor.collapse_shape %transposed_908 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_910 = tensor.dim %1906, %c1 : tensor<4x?x4x32x64xf16>
    %1908 = tensor.empty(%dim_910) : tensor<4x?x32x4x64xf16>
    %transposed_911 = linalg.transpose ins(%1906 : tensor<4x?x4x32x64xf16>) outs(%1908 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_912 = tensor.collapse_shape %transposed_911 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1909 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_909 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_913 = tensor.collapse_shape %1909 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1910 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_912 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_914 = tensor.collapse_shape %1910 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_915 = linalg.transpose ins(%collapsed_885 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %1911 = affine.apply #map32()[%dim_907]
    %1912 = tensor.empty(%1911) : tensor<4x32x?x64xf16>
    %transposed_916 = linalg.transpose ins(%collapsed_913 : tensor<4x?x32x64xf16>) outs(%1912 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %1913 = affine.apply #map32()[%dim_910]
    %1914 = tensor.empty(%1913) : tensor<4x32x?x64xf16>
    %transposed_917 = linalg.transpose ins(%collapsed_914 : tensor<4x?x32x64xf16>) outs(%1914 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_918 = tensor.collapse_shape %transposed_915 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_919 = tensor.collapse_shape %transposed_916 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_920 = tensor.collapse_shape %transposed_917 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1915 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_918, %collapsed_919, %collapsed_920, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_921 = tensor.expand_shape %1915 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_922 = linalg.transpose ins(%expanded_921 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_923 = tensor.collapse_shape %transposed_922 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1916 = iree_tensor_ext.bitcast %__auto.blk.11.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_924 = tensor.expand_shape %1916 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_925 = tensor.extract_slice %expanded_924[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1917 = iree_tensor_ext.bitcast %extracted_slice_925 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_926 = tensor.extract_slice %expanded_924[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1918 = iree_tensor_ext.bitcast %extracted_slice_926 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1919 = tensor.empty() : tensor<2048x64x32xf16>
    %1920 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1917, %1918 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1919 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_927 = tensor.expand_shape %collapsed_923 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1921 = tensor.empty() : tensor<4x1x2048xf32>
    %1922 = linalg.fill ins(%cst_5 : f32) outs(%1921 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1923 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_927, %1920 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1922 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1924 = tensor.empty() : tensor<4x1x2048xf16>
    %1925 = linalg.copy ins(%1923 : tensor<4x1x2048xf32>) outs(%1924 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1926 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1811, %1925 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1927 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1926 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1928 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1927 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1929 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1928 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1930 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1929 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1931 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1930 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1932 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1931 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1933 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1927, %1932 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1934 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1933 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1935 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.ffn_norm.weight, %1934 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1936 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1935 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1937 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_928 = tensor.expand_shape %1937 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_929 = tensor.extract_slice %expanded_928[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1938 = iree_tensor_ext.bitcast %extracted_slice_929 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_930 = tensor.extract_slice %expanded_928[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1939 = iree_tensor_ext.bitcast %extracted_slice_930 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1940 = tensor.empty() : tensor<5632x64x32xf16>
    %1941 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1938, %1939 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1940 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_931 = tensor.expand_shape %1936 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1942 = tensor.empty() : tensor<4x1x5632xf32>
    %1943 = linalg.fill ins(%cst_5 : f32) outs(%1942 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1944 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_931, %1941 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1943 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1945 = tensor.empty() : tensor<4x1x5632xf16>
    %1946 = linalg.copy ins(%1944 : tensor<4x1x5632xf32>) outs(%1945 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1947 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1946 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %1948 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1947, %1946 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1949 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_932 = tensor.expand_shape %1949 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_933 = tensor.extract_slice %expanded_932[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1950 = iree_tensor_ext.bitcast %extracted_slice_933 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_934 = tensor.extract_slice %expanded_932[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1951 = iree_tensor_ext.bitcast %extracted_slice_934 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1952 = tensor.empty() : tensor<5632x64x32xf16>
    %1953 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1950, %1951 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%1952 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_935 = tensor.expand_shape %1936 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1954 = tensor.empty() : tensor<4x1x5632xf32>
    %1955 = linalg.fill ins(%cst_5 : f32) outs(%1954 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %1956 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_935, %1953 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%1955 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %1957 = tensor.empty() : tensor<4x1x5632xf16>
    %1958 = linalg.copy ins(%1956 : tensor<4x1x5632xf32>) outs(%1957 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1959 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1948, %1958 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %1960 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_936 = tensor.expand_shape %1960 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_937 = tensor.extract_slice %expanded_936[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1961 = iree_tensor_ext.bitcast %extracted_slice_937 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_938 = tensor.extract_slice %expanded_936[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1962 = iree_tensor_ext.bitcast %extracted_slice_938 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1963 = tensor.empty() : tensor<2048x176x32xf16>
    %1964 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1961, %1962 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%1963 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_939 = tensor.expand_shape %1959 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1965 = tensor.empty() : tensor<4x1x2048xf32>
    %1966 = linalg.fill ins(%cst_5 : f32) outs(%1965 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1967 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_939, %1964 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%1966 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1968 = tensor.empty() : tensor<4x1x2048xf16>
    %1969 = linalg.copy ins(%1967 : tensor<4x1x2048xf32>) outs(%1968 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1970 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1926, %1969 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1971 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1970 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1972 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1971 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1973 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1972 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1974 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1973 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1975 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1974 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1976 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1975 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %1977 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1971, %1976 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %1978 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1977 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1979 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.attn_norm.weight, %1978 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %1980 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1979 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %1981 = iree_tensor_ext.bitcast %__auto.blk.12.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_940 = tensor.expand_shape %1981 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_941 = tensor.extract_slice %expanded_940[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1982 = iree_tensor_ext.bitcast %extracted_slice_941 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_942 = tensor.extract_slice %expanded_940[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1983 = iree_tensor_ext.bitcast %extracted_slice_942 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1984 = tensor.empty() : tensor<2048x64x32xf16>
    %1985 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1982, %1983 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%1984 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_943 = tensor.expand_shape %1980 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1986 = tensor.empty() : tensor<4x1x2048xf32>
    %1987 = linalg.fill ins(%cst_5 : f32) outs(%1986 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %1988 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_943, %1985 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%1987 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %1989 = tensor.empty() : tensor<4x1x2048xf16>
    %1990 = linalg.copy ins(%1988 : tensor<4x1x2048xf32>) outs(%1989 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1991 = iree_tensor_ext.bitcast %__auto.blk.12.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_944 = tensor.expand_shape %1991 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_945 = tensor.extract_slice %expanded_944[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1992 = iree_tensor_ext.bitcast %extracted_slice_945 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_946 = tensor.extract_slice %expanded_944[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1993 = iree_tensor_ext.bitcast %extracted_slice_946 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1994 = tensor.empty() : tensor<256x64x32xf16>
    %1995 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1992, %1993 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%1994 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_947 = tensor.expand_shape %1980 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1996 = tensor.empty() : tensor<4x1x256xf32>
    %1997 = linalg.fill ins(%cst_5 : f32) outs(%1996 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %1998 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_947, %1995 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%1997 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %1999 = tensor.empty() : tensor<4x1x256xf16>
    %2000 = linalg.copy ins(%1998 : tensor<4x1x256xf32>) outs(%1999 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2001 = iree_tensor_ext.bitcast %__auto.blk.12.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_948 = tensor.expand_shape %2001 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_949 = tensor.extract_slice %expanded_948[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2002 = iree_tensor_ext.bitcast %extracted_slice_949 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_950 = tensor.extract_slice %expanded_948[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2003 = iree_tensor_ext.bitcast %extracted_slice_950 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2004 = tensor.empty() : tensor<256x64x32xf16>
    %2005 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2002, %2003 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2004 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_951 = tensor.expand_shape %1980 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2006 = tensor.empty() : tensor<4x1x256xf32>
    %2007 = linalg.fill ins(%cst_5 : f32) outs(%2006 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2008 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_951, %2005 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2007 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2009 = tensor.empty() : tensor<4x1x256xf16>
    %2010 = linalg.copy ins(%2008 : tensor<4x1x256xf32>) outs(%2009 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_952 = tensor.expand_shape %1990 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_953 = tensor.expand_shape %2000 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_954 = tensor.expand_shape %2010 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2011 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_955 = tensor.expand_shape %2011 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2012 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_955 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2013 = linalg.batch_matmul ins(%2012, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_956 = linalg.transpose ins(%2013 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2014 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_956 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2015 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2014, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2016 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2015 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2017 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_956 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2018 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2017, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2019 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2018 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_957 = tensor.expand_shape %2016 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_958 = tensor.expand_shape %2019 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_959 = tensor.extract_slice %expanded_952[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_960 = tensor.extract_slice %expanded_952[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2020 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_959, %expanded_957 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2021 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_960, %expanded_958 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2022 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2020, %2021 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2023 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_960, %expanded_957 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2024 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_959, %expanded_958 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2025 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2023, %2024 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2026 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %2027 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2022, %2025 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%2026 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_961 = tensor.collapse_shape %2027 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2028 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_962 = tensor.expand_shape %2028 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2029 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_962 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2030 = linalg.batch_matmul ins(%2029, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_963 = linalg.transpose ins(%2030 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2031 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_963 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2032 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2031, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2033 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2032 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2034 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_963 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2035 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2034, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2036 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2035 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_964 = tensor.expand_shape %2033 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_965 = tensor.expand_shape %2036 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_966 = tensor.extract_slice %expanded_953[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_967 = tensor.extract_slice %expanded_953[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2037 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_966, %expanded_964 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2038 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_967, %expanded_965 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2039 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2037, %2038 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2040 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_967, %expanded_964 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2041 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_966, %expanded_965 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2042 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2040, %2041 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2043 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %2044 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2039, %2042 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%2043 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2045 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_968 = tensor.expand_shape %2045 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2046 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_968 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2047 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2046 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c12_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2048 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2047 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2049 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2048, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2050 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2049 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2051 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2050, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2052 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2051 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2053 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2052, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_969 = tensor.collapse_shape %2053 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_970 = tensor.expand_shape %collapsed_969 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_971 = tensor.collapse_shape %2044 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2054 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_971, %expanded_970 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1901 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2055 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2048, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2056 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2055 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2057 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2056, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2058 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2057 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2059 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2058, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_972 = tensor.collapse_shape %2059 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_973 = tensor.expand_shape %collapsed_972 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_974 = tensor.collapse_shape %expanded_954 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2060 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_974, %expanded_973 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2054 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_975 = tensor.dim %2060, %c0 : tensor<?x64xf16>
    %2061 = arith.divsi %dim_975, %c5632 : index
    %expanded_976 = tensor.expand_shape %2060 [[0, 1, 2, 3, 4], [5]] output_shape [%2061, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_977 = tensor.dim %expanded_976, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_978 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_979 = tensor.extract_slice %expanded_976[0, %c12, %c0, 0, 0, 0] [%dim_977, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2062 = tensor.empty(%dim_978) : tensor<4x?x4x32x64xf16>
    %2063 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_979, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2062 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_980 = tensor.dim %expanded_976, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_981 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_982 = tensor.extract_slice %expanded_976[0, %c12, %c1, 0, 0, 0] [%dim_980, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2064 = tensor.empty(%dim_981) : tensor<4x?x4x32x64xf16>
    %2065 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_982, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2064 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_983 = tensor.dim %2063, %c1 : tensor<4x?x4x32x64xf16>
    %2066 = tensor.empty(%dim_983) : tensor<4x?x32x4x64xf16>
    %transposed_984 = linalg.transpose ins(%2063 : tensor<4x?x4x32x64xf16>) outs(%2066 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_985 = tensor.collapse_shape %transposed_984 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_986 = tensor.dim %2065, %c1 : tensor<4x?x4x32x64xf16>
    %2067 = tensor.empty(%dim_986) : tensor<4x?x32x4x64xf16>
    %transposed_987 = linalg.transpose ins(%2065 : tensor<4x?x4x32x64xf16>) outs(%2067 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_988 = tensor.collapse_shape %transposed_987 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2068 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_985 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_989 = tensor.collapse_shape %2068 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2069 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_988 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_990 = tensor.collapse_shape %2069 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_991 = linalg.transpose ins(%collapsed_961 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %2070 = affine.apply #map32()[%dim_983]
    %2071 = tensor.empty(%2070) : tensor<4x32x?x64xf16>
    %transposed_992 = linalg.transpose ins(%collapsed_989 : tensor<4x?x32x64xf16>) outs(%2071 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2072 = affine.apply #map32()[%dim_986]
    %2073 = tensor.empty(%2072) : tensor<4x32x?x64xf16>
    %transposed_993 = linalg.transpose ins(%collapsed_990 : tensor<4x?x32x64xf16>) outs(%2073 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_994 = tensor.collapse_shape %transposed_991 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_995 = tensor.collapse_shape %transposed_992 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_996 = tensor.collapse_shape %transposed_993 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2074 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_994, %collapsed_995, %collapsed_996, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_997 = tensor.expand_shape %2074 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_998 = linalg.transpose ins(%expanded_997 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_999 = tensor.collapse_shape %transposed_998 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2075 = iree_tensor_ext.bitcast %__auto.blk.12.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1000 = tensor.expand_shape %2075 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1001 = tensor.extract_slice %expanded_1000[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2076 = iree_tensor_ext.bitcast %extracted_slice_1001 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1002 = tensor.extract_slice %expanded_1000[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2077 = iree_tensor_ext.bitcast %extracted_slice_1002 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2078 = tensor.empty() : tensor<2048x64x32xf16>
    %2079 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2076, %2077 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2078 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1003 = tensor.expand_shape %collapsed_999 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2080 = tensor.empty() : tensor<4x1x2048xf32>
    %2081 = linalg.fill ins(%cst_5 : f32) outs(%2080 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2082 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1003, %2079 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2081 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2083 = tensor.empty() : tensor<4x1x2048xf16>
    %2084 = linalg.copy ins(%2082 : tensor<4x1x2048xf32>) outs(%2083 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2085 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1970, %2084 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2086 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2085 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2087 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2086 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2088 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2087 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2089 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2088 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2090 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2089 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2091 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2090 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2092 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2086, %2091 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2093 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2092 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2094 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.ffn_norm.weight, %2093 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2095 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2094 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2096 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1004 = tensor.expand_shape %2096 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1005 = tensor.extract_slice %expanded_1004[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2097 = iree_tensor_ext.bitcast %extracted_slice_1005 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1006 = tensor.extract_slice %expanded_1004[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2098 = iree_tensor_ext.bitcast %extracted_slice_1006 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2099 = tensor.empty() : tensor<5632x64x32xf16>
    %2100 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2097, %2098 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2099 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1007 = tensor.expand_shape %2095 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2101 = tensor.empty() : tensor<4x1x5632xf32>
    %2102 = linalg.fill ins(%cst_5 : f32) outs(%2101 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2103 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1007, %2100 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2102 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2104 = tensor.empty() : tensor<4x1x5632xf16>
    %2105 = linalg.copy ins(%2103 : tensor<4x1x5632xf32>) outs(%2104 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2106 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2105 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %2107 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2106, %2105 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2108 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1008 = tensor.expand_shape %2108 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1009 = tensor.extract_slice %expanded_1008[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2109 = iree_tensor_ext.bitcast %extracted_slice_1009 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1010 = tensor.extract_slice %expanded_1008[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2110 = iree_tensor_ext.bitcast %extracted_slice_1010 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2111 = tensor.empty() : tensor<5632x64x32xf16>
    %2112 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2109, %2110 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2111 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1011 = tensor.expand_shape %2095 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2113 = tensor.empty() : tensor<4x1x5632xf32>
    %2114 = linalg.fill ins(%cst_5 : f32) outs(%2113 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2115 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1011, %2112 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2114 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2116 = tensor.empty() : tensor<4x1x5632xf16>
    %2117 = linalg.copy ins(%2115 : tensor<4x1x5632xf32>) outs(%2116 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2118 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2107, %2117 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2119 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1012 = tensor.expand_shape %2119 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1013 = tensor.extract_slice %expanded_1012[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2120 = iree_tensor_ext.bitcast %extracted_slice_1013 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1014 = tensor.extract_slice %expanded_1012[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2121 = iree_tensor_ext.bitcast %extracted_slice_1014 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2122 = tensor.empty() : tensor<2048x176x32xf16>
    %2123 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2120, %2121 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2122 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1015 = tensor.expand_shape %2118 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2124 = tensor.empty() : tensor<4x1x2048xf32>
    %2125 = linalg.fill ins(%cst_5 : f32) outs(%2124 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2126 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1015, %2123 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%2125 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2127 = tensor.empty() : tensor<4x1x2048xf16>
    %2128 = linalg.copy ins(%2126 : tensor<4x1x2048xf32>) outs(%2127 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2129 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2085, %2128 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2130 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2129 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2131 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2130 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2132 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2131 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2133 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2132 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2134 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2133 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2135 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2134 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2136 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2130, %2135 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2137 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2136 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2138 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.attn_norm.weight, %2137 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2139 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2138 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2140 = iree_tensor_ext.bitcast %__auto.blk.13.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1016 = tensor.expand_shape %2140 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1017 = tensor.extract_slice %expanded_1016[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2141 = iree_tensor_ext.bitcast %extracted_slice_1017 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1018 = tensor.extract_slice %expanded_1016[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2142 = iree_tensor_ext.bitcast %extracted_slice_1018 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2143 = tensor.empty() : tensor<2048x64x32xf16>
    %2144 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2141, %2142 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2143 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1019 = tensor.expand_shape %2139 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2145 = tensor.empty() : tensor<4x1x2048xf32>
    %2146 = linalg.fill ins(%cst_5 : f32) outs(%2145 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2147 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1019, %2144 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2146 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2148 = tensor.empty() : tensor<4x1x2048xf16>
    %2149 = linalg.copy ins(%2147 : tensor<4x1x2048xf32>) outs(%2148 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2150 = iree_tensor_ext.bitcast %__auto.blk.13.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1020 = tensor.expand_shape %2150 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1021 = tensor.extract_slice %expanded_1020[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2151 = iree_tensor_ext.bitcast %extracted_slice_1021 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1022 = tensor.extract_slice %expanded_1020[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2152 = iree_tensor_ext.bitcast %extracted_slice_1022 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2153 = tensor.empty() : tensor<256x64x32xf16>
    %2154 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2151, %2152 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2153 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1023 = tensor.expand_shape %2139 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2155 = tensor.empty() : tensor<4x1x256xf32>
    %2156 = linalg.fill ins(%cst_5 : f32) outs(%2155 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2157 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1023, %2154 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2156 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2158 = tensor.empty() : tensor<4x1x256xf16>
    %2159 = linalg.copy ins(%2157 : tensor<4x1x256xf32>) outs(%2158 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2160 = iree_tensor_ext.bitcast %__auto.blk.13.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1024 = tensor.expand_shape %2160 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1025 = tensor.extract_slice %expanded_1024[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2161 = iree_tensor_ext.bitcast %extracted_slice_1025 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1026 = tensor.extract_slice %expanded_1024[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2162 = iree_tensor_ext.bitcast %extracted_slice_1026 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2163 = tensor.empty() : tensor<256x64x32xf16>
    %2164 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2161, %2162 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2163 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1027 = tensor.expand_shape %2139 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2165 = tensor.empty() : tensor<4x1x256xf32>
    %2166 = linalg.fill ins(%cst_5 : f32) outs(%2165 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2167 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1027, %2164 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2166 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2168 = tensor.empty() : tensor<4x1x256xf16>
    %2169 = linalg.copy ins(%2167 : tensor<4x1x256xf32>) outs(%2168 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1028 = tensor.expand_shape %2149 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1029 = tensor.expand_shape %2159 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1030 = tensor.expand_shape %2169 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2170 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1031 = tensor.expand_shape %2170 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2171 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1031 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2172 = linalg.batch_matmul ins(%2171, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1032 = linalg.transpose ins(%2172 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2173 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1032 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2174 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2175 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2174 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2176 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1032 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2177 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2176, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2178 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2177 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1033 = tensor.expand_shape %2175 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1034 = tensor.expand_shape %2178 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1035 = tensor.extract_slice %expanded_1028[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1036 = tensor.extract_slice %expanded_1028[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2179 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1035, %expanded_1033 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2180 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1036, %expanded_1034 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2181 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2179, %2180 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2182 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1036, %expanded_1033 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2183 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1035, %expanded_1034 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2184 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2182, %2183 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2185 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %2186 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2181, %2184 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%2185 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1037 = tensor.collapse_shape %2186 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2187 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1038 = tensor.expand_shape %2187 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2188 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1038 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2189 = linalg.batch_matmul ins(%2188, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1039 = linalg.transpose ins(%2189 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2190 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1039 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2191 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2190, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2192 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2191 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2193 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1039 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2194 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2193, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2195 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2194 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1040 = tensor.expand_shape %2192 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1041 = tensor.expand_shape %2195 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1042 = tensor.extract_slice %expanded_1029[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1043 = tensor.extract_slice %expanded_1029[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2196 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1042, %expanded_1040 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2197 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1043, %expanded_1041 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2198 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2196, %2197 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2199 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1043, %expanded_1040 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2200 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1042, %expanded_1041 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2201 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2199, %2200 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2202 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %2203 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2198, %2201 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%2202 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2204 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1044 = tensor.expand_shape %2204 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2205 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1044 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2206 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2205 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c13_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2207 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2206 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2208 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2207, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2209 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2208 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2210 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2209, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2211 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2210 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2212 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2211, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1045 = tensor.collapse_shape %2212 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1046 = tensor.expand_shape %collapsed_1045 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1047 = tensor.collapse_shape %2203 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2213 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1047, %expanded_1046 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2060 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2214 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2207, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2215 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2214 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2216 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2215, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2217 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2216 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2218 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2217, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1048 = tensor.collapse_shape %2218 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1049 = tensor.expand_shape %collapsed_1048 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1050 = tensor.collapse_shape %expanded_1030 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2219 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1050, %expanded_1049 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2213 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1051 = tensor.dim %2219, %c0 : tensor<?x64xf16>
    %2220 = arith.divsi %dim_1051, %c5632 : index
    %expanded_1052 = tensor.expand_shape %2219 [[0, 1, 2, 3, 4], [5]] output_shape [%2220, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1053 = tensor.dim %expanded_1052, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1054 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1055 = tensor.extract_slice %expanded_1052[0, %c13, %c0, 0, 0, 0] [%dim_1053, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2221 = tensor.empty(%dim_1054) : tensor<4x?x4x32x64xf16>
    %2222 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1055, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2221 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1056 = tensor.dim %expanded_1052, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1057 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1058 = tensor.extract_slice %expanded_1052[0, %c13, %c1, 0, 0, 0] [%dim_1056, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2223 = tensor.empty(%dim_1057) : tensor<4x?x4x32x64xf16>
    %2224 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1058, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2223 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1059 = tensor.dim %2222, %c1 : tensor<4x?x4x32x64xf16>
    %2225 = tensor.empty(%dim_1059) : tensor<4x?x32x4x64xf16>
    %transposed_1060 = linalg.transpose ins(%2222 : tensor<4x?x4x32x64xf16>) outs(%2225 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1061 = tensor.collapse_shape %transposed_1060 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1062 = tensor.dim %2224, %c1 : tensor<4x?x4x32x64xf16>
    %2226 = tensor.empty(%dim_1062) : tensor<4x?x32x4x64xf16>
    %transposed_1063 = linalg.transpose ins(%2224 : tensor<4x?x4x32x64xf16>) outs(%2226 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1064 = tensor.collapse_shape %transposed_1063 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2227 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1061 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1065 = tensor.collapse_shape %2227 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2228 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1064 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1066 = tensor.collapse_shape %2228 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1067 = linalg.transpose ins(%collapsed_1037 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %2229 = affine.apply #map32()[%dim_1059]
    %2230 = tensor.empty(%2229) : tensor<4x32x?x64xf16>
    %transposed_1068 = linalg.transpose ins(%collapsed_1065 : tensor<4x?x32x64xf16>) outs(%2230 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2231 = affine.apply #map32()[%dim_1062]
    %2232 = tensor.empty(%2231) : tensor<4x32x?x64xf16>
    %transposed_1069 = linalg.transpose ins(%collapsed_1066 : tensor<4x?x32x64xf16>) outs(%2232 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1070 = tensor.collapse_shape %transposed_1067 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1071 = tensor.collapse_shape %transposed_1068 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1072 = tensor.collapse_shape %transposed_1069 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2233 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1070, %collapsed_1071, %collapsed_1072, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1073 = tensor.expand_shape %2233 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1074 = linalg.transpose ins(%expanded_1073 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1075 = tensor.collapse_shape %transposed_1074 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2234 = iree_tensor_ext.bitcast %__auto.blk.13.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1076 = tensor.expand_shape %2234 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1077 = tensor.extract_slice %expanded_1076[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2235 = iree_tensor_ext.bitcast %extracted_slice_1077 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1078 = tensor.extract_slice %expanded_1076[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2236 = iree_tensor_ext.bitcast %extracted_slice_1078 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2237 = tensor.empty() : tensor<2048x64x32xf16>
    %2238 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2235, %2236 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2237 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1079 = tensor.expand_shape %collapsed_1075 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2239 = tensor.empty() : tensor<4x1x2048xf32>
    %2240 = linalg.fill ins(%cst_5 : f32) outs(%2239 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2241 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1079, %2238 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2240 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2242 = tensor.empty() : tensor<4x1x2048xf16>
    %2243 = linalg.copy ins(%2241 : tensor<4x1x2048xf32>) outs(%2242 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2244 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2129, %2243 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2245 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2244 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2246 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2245 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2247 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2246 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2248 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2247 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2248 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2250 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2249 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2251 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2245, %2250 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2251 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2253 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.ffn_norm.weight, %2252 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2254 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2253 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2255 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1080 = tensor.expand_shape %2255 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1081 = tensor.extract_slice %expanded_1080[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2256 = iree_tensor_ext.bitcast %extracted_slice_1081 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1082 = tensor.extract_slice %expanded_1080[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2257 = iree_tensor_ext.bitcast %extracted_slice_1082 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2258 = tensor.empty() : tensor<5632x64x32xf16>
    %2259 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2256, %2257 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2258 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1083 = tensor.expand_shape %2254 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2260 = tensor.empty() : tensor<4x1x5632xf32>
    %2261 = linalg.fill ins(%cst_5 : f32) outs(%2260 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2262 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1083, %2259 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2261 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2263 = tensor.empty() : tensor<4x1x5632xf16>
    %2264 = linalg.copy ins(%2262 : tensor<4x1x5632xf32>) outs(%2263 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2265 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2264 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %2266 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2265, %2264 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2267 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1084 = tensor.expand_shape %2267 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1085 = tensor.extract_slice %expanded_1084[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2268 = iree_tensor_ext.bitcast %extracted_slice_1085 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1086 = tensor.extract_slice %expanded_1084[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2269 = iree_tensor_ext.bitcast %extracted_slice_1086 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2270 = tensor.empty() : tensor<5632x64x32xf16>
    %2271 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2268, %2269 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2270 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1087 = tensor.expand_shape %2254 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2272 = tensor.empty() : tensor<4x1x5632xf32>
    %2273 = linalg.fill ins(%cst_5 : f32) outs(%2272 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2274 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1087, %2271 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2273 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2275 = tensor.empty() : tensor<4x1x5632xf16>
    %2276 = linalg.copy ins(%2274 : tensor<4x1x5632xf32>) outs(%2275 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2277 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2266, %2276 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2278 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1088 = tensor.expand_shape %2278 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1089 = tensor.extract_slice %expanded_1088[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2279 = iree_tensor_ext.bitcast %extracted_slice_1089 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1090 = tensor.extract_slice %expanded_1088[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2280 = iree_tensor_ext.bitcast %extracted_slice_1090 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2281 = tensor.empty() : tensor<2048x176x32xf16>
    %2282 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2279, %2280 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2281 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1091 = tensor.expand_shape %2277 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2283 = tensor.empty() : tensor<4x1x2048xf32>
    %2284 = linalg.fill ins(%cst_5 : f32) outs(%2283 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2285 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1091, %2282 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%2284 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2286 = tensor.empty() : tensor<4x1x2048xf16>
    %2287 = linalg.copy ins(%2285 : tensor<4x1x2048xf32>) outs(%2286 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2288 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2244, %2287 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2289 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2288 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2290 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2289 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2291 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2290 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2291 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2293 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2292 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2294 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2293 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2295 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2289, %2294 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2296 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2295 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2297 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.attn_norm.weight, %2296 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2298 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2297 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2299 = iree_tensor_ext.bitcast %__auto.blk.14.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1092 = tensor.expand_shape %2299 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1093 = tensor.extract_slice %expanded_1092[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2300 = iree_tensor_ext.bitcast %extracted_slice_1093 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1094 = tensor.extract_slice %expanded_1092[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2301 = iree_tensor_ext.bitcast %extracted_slice_1094 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2302 = tensor.empty() : tensor<2048x64x32xf16>
    %2303 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2300, %2301 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2302 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1095 = tensor.expand_shape %2298 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2304 = tensor.empty() : tensor<4x1x2048xf32>
    %2305 = linalg.fill ins(%cst_5 : f32) outs(%2304 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2306 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1095, %2303 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2305 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2307 = tensor.empty() : tensor<4x1x2048xf16>
    %2308 = linalg.copy ins(%2306 : tensor<4x1x2048xf32>) outs(%2307 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2309 = iree_tensor_ext.bitcast %__auto.blk.14.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1096 = tensor.expand_shape %2309 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1097 = tensor.extract_slice %expanded_1096[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2310 = iree_tensor_ext.bitcast %extracted_slice_1097 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1098 = tensor.extract_slice %expanded_1096[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2311 = iree_tensor_ext.bitcast %extracted_slice_1098 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2312 = tensor.empty() : tensor<256x64x32xf16>
    %2313 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2310, %2311 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2312 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1099 = tensor.expand_shape %2298 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2314 = tensor.empty() : tensor<4x1x256xf32>
    %2315 = linalg.fill ins(%cst_5 : f32) outs(%2314 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2316 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1099, %2313 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2315 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2317 = tensor.empty() : tensor<4x1x256xf16>
    %2318 = linalg.copy ins(%2316 : tensor<4x1x256xf32>) outs(%2317 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2319 = iree_tensor_ext.bitcast %__auto.blk.14.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1100 = tensor.expand_shape %2319 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1101 = tensor.extract_slice %expanded_1100[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2320 = iree_tensor_ext.bitcast %extracted_slice_1101 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1102 = tensor.extract_slice %expanded_1100[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2321 = iree_tensor_ext.bitcast %extracted_slice_1102 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2322 = tensor.empty() : tensor<256x64x32xf16>
    %2323 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2320, %2321 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2322 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1103 = tensor.expand_shape %2298 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2324 = tensor.empty() : tensor<4x1x256xf32>
    %2325 = linalg.fill ins(%cst_5 : f32) outs(%2324 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2326 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1103, %2323 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2325 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2327 = tensor.empty() : tensor<4x1x256xf16>
    %2328 = linalg.copy ins(%2326 : tensor<4x1x256xf32>) outs(%2327 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1104 = tensor.expand_shape %2308 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1105 = tensor.expand_shape %2318 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1106 = tensor.expand_shape %2328 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2329 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1107 = tensor.expand_shape %2329 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2330 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1107 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2331 = linalg.batch_matmul ins(%2330, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1108 = linalg.transpose ins(%2331 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2332 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1108 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2333 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2332, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2334 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2333 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2335 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1108 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2336 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2335, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2337 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2336 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1109 = tensor.expand_shape %2334 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1110 = tensor.expand_shape %2337 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1111 = tensor.extract_slice %expanded_1104[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1112 = tensor.extract_slice %expanded_1104[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2338 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1111, %expanded_1109 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2339 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1112, %expanded_1110 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2340 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2338, %2339 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2341 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1112, %expanded_1109 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2342 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1111, %expanded_1110 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2343 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2341, %2342 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2344 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %2345 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2340, %2343 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%2344 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1113 = tensor.collapse_shape %2345 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2346 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1114 = tensor.expand_shape %2346 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2347 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1114 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2348 = linalg.batch_matmul ins(%2347, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1115 = linalg.transpose ins(%2348 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2349 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1115 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2350 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2349, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2351 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2350 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2352 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1115 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2353 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2352, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2354 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2353 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1116 = tensor.expand_shape %2351 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1117 = tensor.expand_shape %2354 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1118 = tensor.extract_slice %expanded_1105[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1119 = tensor.extract_slice %expanded_1105[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2355 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1118, %expanded_1116 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2356 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1119, %expanded_1117 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2357 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2355, %2356 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2358 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1119, %expanded_1116 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2359 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1118, %expanded_1117 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2360 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2358, %2359 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2361 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %2362 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2357, %2360 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%2361 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2363 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1120 = tensor.expand_shape %2363 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2364 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1120 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2365 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2364 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c14_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2366 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2365 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2367 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2366, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2368 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2367 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2369 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2368, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2370 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2369 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2371 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2370, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1121 = tensor.collapse_shape %2371 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1122 = tensor.expand_shape %collapsed_1121 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1123 = tensor.collapse_shape %2362 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2372 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1123, %expanded_1122 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2219 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2373 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2366, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2374 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2373 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2375 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2374, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2376 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2375 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2377 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2376, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1124 = tensor.collapse_shape %2377 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1125 = tensor.expand_shape %collapsed_1124 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1126 = tensor.collapse_shape %expanded_1106 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2378 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1126, %expanded_1125 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2372 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1127 = tensor.dim %2378, %c0 : tensor<?x64xf16>
    %2379 = arith.divsi %dim_1127, %c5632 : index
    %expanded_1128 = tensor.expand_shape %2378 [[0, 1, 2, 3, 4], [5]] output_shape [%2379, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1129 = tensor.dim %expanded_1128, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1130 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1131 = tensor.extract_slice %expanded_1128[0, %c14, %c0, 0, 0, 0] [%dim_1129, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2380 = tensor.empty(%dim_1130) : tensor<4x?x4x32x64xf16>
    %2381 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1131, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2380 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1132 = tensor.dim %expanded_1128, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1133 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1134 = tensor.extract_slice %expanded_1128[0, %c14, %c1, 0, 0, 0] [%dim_1132, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2382 = tensor.empty(%dim_1133) : tensor<4x?x4x32x64xf16>
    %2383 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1134, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2382 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1135 = tensor.dim %2381, %c1 : tensor<4x?x4x32x64xf16>
    %2384 = tensor.empty(%dim_1135) : tensor<4x?x32x4x64xf16>
    %transposed_1136 = linalg.transpose ins(%2381 : tensor<4x?x4x32x64xf16>) outs(%2384 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1137 = tensor.collapse_shape %transposed_1136 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1138 = tensor.dim %2383, %c1 : tensor<4x?x4x32x64xf16>
    %2385 = tensor.empty(%dim_1138) : tensor<4x?x32x4x64xf16>
    %transposed_1139 = linalg.transpose ins(%2383 : tensor<4x?x4x32x64xf16>) outs(%2385 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1140 = tensor.collapse_shape %transposed_1139 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2386 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1137 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1141 = tensor.collapse_shape %2386 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2387 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1140 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1142 = tensor.collapse_shape %2387 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1143 = linalg.transpose ins(%collapsed_1113 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %2388 = affine.apply #map32()[%dim_1135]
    %2389 = tensor.empty(%2388) : tensor<4x32x?x64xf16>
    %transposed_1144 = linalg.transpose ins(%collapsed_1141 : tensor<4x?x32x64xf16>) outs(%2389 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2390 = affine.apply #map32()[%dim_1138]
    %2391 = tensor.empty(%2390) : tensor<4x32x?x64xf16>
    %transposed_1145 = linalg.transpose ins(%collapsed_1142 : tensor<4x?x32x64xf16>) outs(%2391 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1146 = tensor.collapse_shape %transposed_1143 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1147 = tensor.collapse_shape %transposed_1144 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1148 = tensor.collapse_shape %transposed_1145 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2392 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1146, %collapsed_1147, %collapsed_1148, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1149 = tensor.expand_shape %2392 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1150 = linalg.transpose ins(%expanded_1149 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1151 = tensor.collapse_shape %transposed_1150 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2393 = iree_tensor_ext.bitcast %__auto.blk.14.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1152 = tensor.expand_shape %2393 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1153 = tensor.extract_slice %expanded_1152[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2394 = iree_tensor_ext.bitcast %extracted_slice_1153 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1154 = tensor.extract_slice %expanded_1152[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2395 = iree_tensor_ext.bitcast %extracted_slice_1154 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2396 = tensor.empty() : tensor<2048x64x32xf16>
    %2397 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2394, %2395 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2396 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1155 = tensor.expand_shape %collapsed_1151 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2398 = tensor.empty() : tensor<4x1x2048xf32>
    %2399 = linalg.fill ins(%cst_5 : f32) outs(%2398 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2400 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1155, %2397 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2399 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2401 = tensor.empty() : tensor<4x1x2048xf16>
    %2402 = linalg.copy ins(%2400 : tensor<4x1x2048xf32>) outs(%2401 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2403 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2288, %2402 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2404 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2403 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2405 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2404 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2406 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2405 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2407 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2406 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2408 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2407 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2409 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2408 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2410 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2404, %2409 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2411 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2410 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2412 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.ffn_norm.weight, %2411 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2413 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2412 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2414 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1156 = tensor.expand_shape %2414 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1157 = tensor.extract_slice %expanded_1156[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2415 = iree_tensor_ext.bitcast %extracted_slice_1157 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1158 = tensor.extract_slice %expanded_1156[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2416 = iree_tensor_ext.bitcast %extracted_slice_1158 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2417 = tensor.empty() : tensor<5632x64x32xf16>
    %2418 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2415, %2416 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2417 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1159 = tensor.expand_shape %2413 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2419 = tensor.empty() : tensor<4x1x5632xf32>
    %2420 = linalg.fill ins(%cst_5 : f32) outs(%2419 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2421 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1159, %2418 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2420 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2422 = tensor.empty() : tensor<4x1x5632xf16>
    %2423 = linalg.copy ins(%2421 : tensor<4x1x5632xf32>) outs(%2422 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2424 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2423 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %2425 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2424, %2423 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2426 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1160 = tensor.expand_shape %2426 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1161 = tensor.extract_slice %expanded_1160[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2427 = iree_tensor_ext.bitcast %extracted_slice_1161 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1162 = tensor.extract_slice %expanded_1160[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2428 = iree_tensor_ext.bitcast %extracted_slice_1162 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2429 = tensor.empty() : tensor<5632x64x32xf16>
    %2430 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2427, %2428 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2429 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1163 = tensor.expand_shape %2413 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2431 = tensor.empty() : tensor<4x1x5632xf32>
    %2432 = linalg.fill ins(%cst_5 : f32) outs(%2431 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2433 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1163, %2430 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2432 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2434 = tensor.empty() : tensor<4x1x5632xf16>
    %2435 = linalg.copy ins(%2433 : tensor<4x1x5632xf32>) outs(%2434 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2436 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2425, %2435 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2437 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1164 = tensor.expand_shape %2437 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1165 = tensor.extract_slice %expanded_1164[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2438 = iree_tensor_ext.bitcast %extracted_slice_1165 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1166 = tensor.extract_slice %expanded_1164[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2439 = iree_tensor_ext.bitcast %extracted_slice_1166 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2440 = tensor.empty() : tensor<2048x176x32xf16>
    %2441 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2438, %2439 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2440 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1167 = tensor.expand_shape %2436 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2442 = tensor.empty() : tensor<4x1x2048xf32>
    %2443 = linalg.fill ins(%cst_5 : f32) outs(%2442 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2444 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1167, %2441 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%2443 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2445 = tensor.empty() : tensor<4x1x2048xf16>
    %2446 = linalg.copy ins(%2444 : tensor<4x1x2048xf32>) outs(%2445 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2447 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2403, %2446 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2448 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2447 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2449 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2448 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2450 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2449 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2451 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2450 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2452 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2451 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2453 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2452 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2454 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2448, %2453 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2455 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2454 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2456 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.attn_norm.weight, %2455 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2457 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2456 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2458 = iree_tensor_ext.bitcast %__auto.blk.15.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1168 = tensor.expand_shape %2458 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1169 = tensor.extract_slice %expanded_1168[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2459 = iree_tensor_ext.bitcast %extracted_slice_1169 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1170 = tensor.extract_slice %expanded_1168[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2460 = iree_tensor_ext.bitcast %extracted_slice_1170 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2461 = tensor.empty() : tensor<2048x64x32xf16>
    %2462 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2459, %2460 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2461 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1171 = tensor.expand_shape %2457 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2463 = tensor.empty() : tensor<4x1x2048xf32>
    %2464 = linalg.fill ins(%cst_5 : f32) outs(%2463 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2465 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1171, %2462 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2464 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2466 = tensor.empty() : tensor<4x1x2048xf16>
    %2467 = linalg.copy ins(%2465 : tensor<4x1x2048xf32>) outs(%2466 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2468 = iree_tensor_ext.bitcast %__auto.blk.15.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1172 = tensor.expand_shape %2468 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1173 = tensor.extract_slice %expanded_1172[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2469 = iree_tensor_ext.bitcast %extracted_slice_1173 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1174 = tensor.extract_slice %expanded_1172[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2470 = iree_tensor_ext.bitcast %extracted_slice_1174 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2471 = tensor.empty() : tensor<256x64x32xf16>
    %2472 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2469, %2470 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2471 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1175 = tensor.expand_shape %2457 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2473 = tensor.empty() : tensor<4x1x256xf32>
    %2474 = linalg.fill ins(%cst_5 : f32) outs(%2473 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2475 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1175, %2472 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2474 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2476 = tensor.empty() : tensor<4x1x256xf16>
    %2477 = linalg.copy ins(%2475 : tensor<4x1x256xf32>) outs(%2476 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2478 = iree_tensor_ext.bitcast %__auto.blk.15.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1176 = tensor.expand_shape %2478 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1177 = tensor.extract_slice %expanded_1176[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2479 = iree_tensor_ext.bitcast %extracted_slice_1177 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1178 = tensor.extract_slice %expanded_1176[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2480 = iree_tensor_ext.bitcast %extracted_slice_1178 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2481 = tensor.empty() : tensor<256x64x32xf16>
    %2482 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2479, %2480 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2481 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1179 = tensor.expand_shape %2457 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2483 = tensor.empty() : tensor<4x1x256xf32>
    %2484 = linalg.fill ins(%cst_5 : f32) outs(%2483 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2485 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1179, %2482 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2484 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2486 = tensor.empty() : tensor<4x1x256xf16>
    %2487 = linalg.copy ins(%2485 : tensor<4x1x256xf32>) outs(%2486 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1180 = tensor.expand_shape %2467 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1181 = tensor.expand_shape %2477 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1182 = tensor.expand_shape %2487 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2488 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1183 = tensor.expand_shape %2488 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2489 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1183 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2490 = linalg.batch_matmul ins(%2489, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1184 = linalg.transpose ins(%2490 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2491 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1184 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2492 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2491, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2493 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2492 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2494 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1184 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2495 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2494, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2496 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2495 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1185 = tensor.expand_shape %2493 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1186 = tensor.expand_shape %2496 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1187 = tensor.extract_slice %expanded_1180[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1188 = tensor.extract_slice %expanded_1180[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2497 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1187, %expanded_1185 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2498 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1188, %expanded_1186 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2499 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2497, %2498 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2500 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1188, %expanded_1185 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2501 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1187, %expanded_1186 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2502 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2500, %2501 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2503 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %2504 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2499, %2502 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%2503 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1189 = tensor.collapse_shape %2504 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2505 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1190 = tensor.expand_shape %2505 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2506 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1190 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2507 = linalg.batch_matmul ins(%2506, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1191 = linalg.transpose ins(%2507 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2508 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1191 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2509 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2508, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2510 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2509 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2511 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1191 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2512 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2511, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2513 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2512 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1192 = tensor.expand_shape %2510 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1193 = tensor.expand_shape %2513 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1194 = tensor.extract_slice %expanded_1181[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1195 = tensor.extract_slice %expanded_1181[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2514 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1194, %expanded_1192 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2515 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1195, %expanded_1193 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2516 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2514, %2515 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2517 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1195, %expanded_1192 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2518 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1194, %expanded_1193 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2519 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2517, %2518 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2520 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %2521 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2516, %2519 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%2520 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2522 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1196 = tensor.expand_shape %2522 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2523 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1196 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2524 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2523 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c15_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2525 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2524 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2526 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2525, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2527 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2526 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2528 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2527, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2529 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2528 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2530 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2529, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1197 = tensor.collapse_shape %2530 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1198 = tensor.expand_shape %collapsed_1197 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1199 = tensor.collapse_shape %2521 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2531 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1199, %expanded_1198 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2378 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2532 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2525, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2533 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2532 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2534 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2533, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2535 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2534 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2536 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2535, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1200 = tensor.collapse_shape %2536 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1201 = tensor.expand_shape %collapsed_1200 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1202 = tensor.collapse_shape %expanded_1182 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2537 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1202, %expanded_1201 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2531 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1203 = tensor.dim %2537, %c0 : tensor<?x64xf16>
    %2538 = arith.divsi %dim_1203, %c5632 : index
    %expanded_1204 = tensor.expand_shape %2537 [[0, 1, 2, 3, 4], [5]] output_shape [%2538, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1205 = tensor.dim %expanded_1204, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1206 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1207 = tensor.extract_slice %expanded_1204[0, %c15, %c0, 0, 0, 0] [%dim_1205, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2539 = tensor.empty(%dim_1206) : tensor<4x?x4x32x64xf16>
    %2540 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1207, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2539 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1208 = tensor.dim %expanded_1204, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1209 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1210 = tensor.extract_slice %expanded_1204[0, %c15, %c1, 0, 0, 0] [%dim_1208, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2541 = tensor.empty(%dim_1209) : tensor<4x?x4x32x64xf16>
    %2542 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1210, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2541 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1211 = tensor.dim %2540, %c1 : tensor<4x?x4x32x64xf16>
    %2543 = tensor.empty(%dim_1211) : tensor<4x?x32x4x64xf16>
    %transposed_1212 = linalg.transpose ins(%2540 : tensor<4x?x4x32x64xf16>) outs(%2543 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1213 = tensor.collapse_shape %transposed_1212 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1214 = tensor.dim %2542, %c1 : tensor<4x?x4x32x64xf16>
    %2544 = tensor.empty(%dim_1214) : tensor<4x?x32x4x64xf16>
    %transposed_1215 = linalg.transpose ins(%2542 : tensor<4x?x4x32x64xf16>) outs(%2544 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1216 = tensor.collapse_shape %transposed_1215 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2545 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1213 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1217 = tensor.collapse_shape %2545 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2546 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1216 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1218 = tensor.collapse_shape %2546 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1219 = linalg.transpose ins(%collapsed_1189 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %2547 = affine.apply #map32()[%dim_1211]
    %2548 = tensor.empty(%2547) : tensor<4x32x?x64xf16>
    %transposed_1220 = linalg.transpose ins(%collapsed_1217 : tensor<4x?x32x64xf16>) outs(%2548 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2549 = affine.apply #map32()[%dim_1214]
    %2550 = tensor.empty(%2549) : tensor<4x32x?x64xf16>
    %transposed_1221 = linalg.transpose ins(%collapsed_1218 : tensor<4x?x32x64xf16>) outs(%2550 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1222 = tensor.collapse_shape %transposed_1219 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1223 = tensor.collapse_shape %transposed_1220 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1224 = tensor.collapse_shape %transposed_1221 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2551 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1222, %collapsed_1223, %collapsed_1224, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1225 = tensor.expand_shape %2551 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1226 = linalg.transpose ins(%expanded_1225 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1227 = tensor.collapse_shape %transposed_1226 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2552 = iree_tensor_ext.bitcast %__auto.blk.15.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1228 = tensor.expand_shape %2552 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1229 = tensor.extract_slice %expanded_1228[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2553 = iree_tensor_ext.bitcast %extracted_slice_1229 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1230 = tensor.extract_slice %expanded_1228[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2554 = iree_tensor_ext.bitcast %extracted_slice_1230 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2555 = tensor.empty() : tensor<2048x64x32xf16>
    %2556 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2553, %2554 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2555 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1231 = tensor.expand_shape %collapsed_1227 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2557 = tensor.empty() : tensor<4x1x2048xf32>
    %2558 = linalg.fill ins(%cst_5 : f32) outs(%2557 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2559 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1231, %2556 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2558 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2560 = tensor.empty() : tensor<4x1x2048xf16>
    %2561 = linalg.copy ins(%2559 : tensor<4x1x2048xf32>) outs(%2560 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2562 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2447, %2561 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2563 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2562 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2564 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2563 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2565 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2564 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2566 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2565 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2567 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2566 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2568 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2567 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2569 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2563, %2568 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2570 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2569 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2571 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.ffn_norm.weight, %2570 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2572 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2571 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2573 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1232 = tensor.expand_shape %2573 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1233 = tensor.extract_slice %expanded_1232[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2574 = iree_tensor_ext.bitcast %extracted_slice_1233 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1234 = tensor.extract_slice %expanded_1232[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2575 = iree_tensor_ext.bitcast %extracted_slice_1234 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2576 = tensor.empty() : tensor<5632x64x32xf16>
    %2577 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2574, %2575 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2576 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1235 = tensor.expand_shape %2572 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2578 = tensor.empty() : tensor<4x1x5632xf32>
    %2579 = linalg.fill ins(%cst_5 : f32) outs(%2578 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2580 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1235, %2577 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2579 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2581 = tensor.empty() : tensor<4x1x5632xf16>
    %2582 = linalg.copy ins(%2580 : tensor<4x1x5632xf32>) outs(%2581 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2583 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2582 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %2584 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2583, %2582 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2585 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1236 = tensor.expand_shape %2585 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1237 = tensor.extract_slice %expanded_1236[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2586 = iree_tensor_ext.bitcast %extracted_slice_1237 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1238 = tensor.extract_slice %expanded_1236[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2587 = iree_tensor_ext.bitcast %extracted_slice_1238 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2588 = tensor.empty() : tensor<5632x64x32xf16>
    %2589 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2586, %2587 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2588 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1239 = tensor.expand_shape %2572 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2590 = tensor.empty() : tensor<4x1x5632xf32>
    %2591 = linalg.fill ins(%cst_5 : f32) outs(%2590 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2592 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1239, %2589 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2591 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2593 = tensor.empty() : tensor<4x1x5632xf16>
    %2594 = linalg.copy ins(%2592 : tensor<4x1x5632xf32>) outs(%2593 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2595 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2584, %2594 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2596 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1240 = tensor.expand_shape %2596 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1241 = tensor.extract_slice %expanded_1240[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2597 = iree_tensor_ext.bitcast %extracted_slice_1241 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1242 = tensor.extract_slice %expanded_1240[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2598 = iree_tensor_ext.bitcast %extracted_slice_1242 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2599 = tensor.empty() : tensor<2048x176x32xf16>
    %2600 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2597, %2598 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2599 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1243 = tensor.expand_shape %2595 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2601 = tensor.empty() : tensor<4x1x2048xf32>
    %2602 = linalg.fill ins(%cst_5 : f32) outs(%2601 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2603 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1243, %2600 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%2602 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2604 = tensor.empty() : tensor<4x1x2048xf16>
    %2605 = linalg.copy ins(%2603 : tensor<4x1x2048xf32>) outs(%2604 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2606 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2562, %2605 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2607 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2606 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2608 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2607 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2609 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2608 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2610 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2609 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2611 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2610 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2612 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2611 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2613 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2607, %2612 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2614 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2613 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2615 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.attn_norm.weight, %2614 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2616 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2615 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2617 = iree_tensor_ext.bitcast %__auto.blk.16.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1244 = tensor.expand_shape %2617 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1245 = tensor.extract_slice %expanded_1244[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2618 = iree_tensor_ext.bitcast %extracted_slice_1245 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1246 = tensor.extract_slice %expanded_1244[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2619 = iree_tensor_ext.bitcast %extracted_slice_1246 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2620 = tensor.empty() : tensor<2048x64x32xf16>
    %2621 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2618, %2619 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2620 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1247 = tensor.expand_shape %2616 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2622 = tensor.empty() : tensor<4x1x2048xf32>
    %2623 = linalg.fill ins(%cst_5 : f32) outs(%2622 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2624 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1247, %2621 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2623 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2625 = tensor.empty() : tensor<4x1x2048xf16>
    %2626 = linalg.copy ins(%2624 : tensor<4x1x2048xf32>) outs(%2625 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2627 = iree_tensor_ext.bitcast %__auto.blk.16.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1248 = tensor.expand_shape %2627 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1249 = tensor.extract_slice %expanded_1248[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2628 = iree_tensor_ext.bitcast %extracted_slice_1249 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1250 = tensor.extract_slice %expanded_1248[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2629 = iree_tensor_ext.bitcast %extracted_slice_1250 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2630 = tensor.empty() : tensor<256x64x32xf16>
    %2631 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2628, %2629 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2630 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1251 = tensor.expand_shape %2616 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2632 = tensor.empty() : tensor<4x1x256xf32>
    %2633 = linalg.fill ins(%cst_5 : f32) outs(%2632 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2634 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1251, %2631 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2633 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2635 = tensor.empty() : tensor<4x1x256xf16>
    %2636 = linalg.copy ins(%2634 : tensor<4x1x256xf32>) outs(%2635 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2637 = iree_tensor_ext.bitcast %__auto.blk.16.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1252 = tensor.expand_shape %2637 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1253 = tensor.extract_slice %expanded_1252[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2638 = iree_tensor_ext.bitcast %extracted_slice_1253 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1254 = tensor.extract_slice %expanded_1252[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2639 = iree_tensor_ext.bitcast %extracted_slice_1254 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2640 = tensor.empty() : tensor<256x64x32xf16>
    %2641 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2638, %2639 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2640 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1255 = tensor.expand_shape %2616 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2642 = tensor.empty() : tensor<4x1x256xf32>
    %2643 = linalg.fill ins(%cst_5 : f32) outs(%2642 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2644 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1255, %2641 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2643 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2645 = tensor.empty() : tensor<4x1x256xf16>
    %2646 = linalg.copy ins(%2644 : tensor<4x1x256xf32>) outs(%2645 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1256 = tensor.expand_shape %2626 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1257 = tensor.expand_shape %2636 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1258 = tensor.expand_shape %2646 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2647 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1259 = tensor.expand_shape %2647 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2648 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1259 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2649 = linalg.batch_matmul ins(%2648, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1260 = linalg.transpose ins(%2649 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2650 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1260 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2651 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2650, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2652 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2651 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2653 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1260 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2654 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2653, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2655 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2654 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1261 = tensor.expand_shape %2652 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1262 = tensor.expand_shape %2655 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1263 = tensor.extract_slice %expanded_1256[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1264 = tensor.extract_slice %expanded_1256[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2656 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1263, %expanded_1261 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2657 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1264, %expanded_1262 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2658 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2656, %2657 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2659 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1264, %expanded_1261 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2660 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1263, %expanded_1262 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2661 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2659, %2660 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2662 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %2663 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2658, %2661 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%2662 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1265 = tensor.collapse_shape %2663 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2664 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1266 = tensor.expand_shape %2664 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2665 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1266 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2666 = linalg.batch_matmul ins(%2665, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1267 = linalg.transpose ins(%2666 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2667 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1267 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2668 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2667, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2669 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2668 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2670 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1267 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2671 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2670, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2672 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2671 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1268 = tensor.expand_shape %2669 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1269 = tensor.expand_shape %2672 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1270 = tensor.extract_slice %expanded_1257[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1271 = tensor.extract_slice %expanded_1257[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2673 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1270, %expanded_1268 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2674 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1271, %expanded_1269 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2675 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2673, %2674 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2676 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1271, %expanded_1268 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2677 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1270, %expanded_1269 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2678 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2676, %2677 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2679 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %2680 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2675, %2678 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%2679 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2681 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1272 = tensor.expand_shape %2681 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2682 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1272 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2683 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2682 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c16_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2684 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2683 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2685 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2684, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2686 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2685 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2687 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2686, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2688 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2687 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2689 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2688, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1273 = tensor.collapse_shape %2689 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1274 = tensor.expand_shape %collapsed_1273 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1275 = tensor.collapse_shape %2680 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2690 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1275, %expanded_1274 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2537 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2691 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2684, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2692 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2691 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2693 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2692, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2694 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2693 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2695 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2694, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1276 = tensor.collapse_shape %2695 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1277 = tensor.expand_shape %collapsed_1276 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1278 = tensor.collapse_shape %expanded_1258 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2696 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1278, %expanded_1277 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2690 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1279 = tensor.dim %2696, %c0 : tensor<?x64xf16>
    %2697 = arith.divsi %dim_1279, %c5632 : index
    %expanded_1280 = tensor.expand_shape %2696 [[0, 1, 2, 3, 4], [5]] output_shape [%2697, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1281 = tensor.dim %expanded_1280, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1282 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1283 = tensor.extract_slice %expanded_1280[0, %c16, %c0, 0, 0, 0] [%dim_1281, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2698 = tensor.empty(%dim_1282) : tensor<4x?x4x32x64xf16>
    %2699 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1283, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2698 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1284 = tensor.dim %expanded_1280, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1285 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1286 = tensor.extract_slice %expanded_1280[0, %c16, %c1, 0, 0, 0] [%dim_1284, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2700 = tensor.empty(%dim_1285) : tensor<4x?x4x32x64xf16>
    %2701 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1286, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2700 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1287 = tensor.dim %2699, %c1 : tensor<4x?x4x32x64xf16>
    %2702 = tensor.empty(%dim_1287) : tensor<4x?x32x4x64xf16>
    %transposed_1288 = linalg.transpose ins(%2699 : tensor<4x?x4x32x64xf16>) outs(%2702 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1289 = tensor.collapse_shape %transposed_1288 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1290 = tensor.dim %2701, %c1 : tensor<4x?x4x32x64xf16>
    %2703 = tensor.empty(%dim_1290) : tensor<4x?x32x4x64xf16>
    %transposed_1291 = linalg.transpose ins(%2701 : tensor<4x?x4x32x64xf16>) outs(%2703 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1292 = tensor.collapse_shape %transposed_1291 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2704 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1289 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1293 = tensor.collapse_shape %2704 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2705 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1292 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1294 = tensor.collapse_shape %2705 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1295 = linalg.transpose ins(%collapsed_1265 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %2706 = affine.apply #map32()[%dim_1287]
    %2707 = tensor.empty(%2706) : tensor<4x32x?x64xf16>
    %transposed_1296 = linalg.transpose ins(%collapsed_1293 : tensor<4x?x32x64xf16>) outs(%2707 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2708 = affine.apply #map32()[%dim_1290]
    %2709 = tensor.empty(%2708) : tensor<4x32x?x64xf16>
    %transposed_1297 = linalg.transpose ins(%collapsed_1294 : tensor<4x?x32x64xf16>) outs(%2709 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1298 = tensor.collapse_shape %transposed_1295 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1299 = tensor.collapse_shape %transposed_1296 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1300 = tensor.collapse_shape %transposed_1297 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2710 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1298, %collapsed_1299, %collapsed_1300, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1301 = tensor.expand_shape %2710 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1302 = linalg.transpose ins(%expanded_1301 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1303 = tensor.collapse_shape %transposed_1302 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2711 = iree_tensor_ext.bitcast %__auto.blk.16.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1304 = tensor.expand_shape %2711 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1305 = tensor.extract_slice %expanded_1304[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2712 = iree_tensor_ext.bitcast %extracted_slice_1305 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1306 = tensor.extract_slice %expanded_1304[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2713 = iree_tensor_ext.bitcast %extracted_slice_1306 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2714 = tensor.empty() : tensor<2048x64x32xf16>
    %2715 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2712, %2713 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2714 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1307 = tensor.expand_shape %collapsed_1303 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2716 = tensor.empty() : tensor<4x1x2048xf32>
    %2717 = linalg.fill ins(%cst_5 : f32) outs(%2716 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2718 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1307, %2715 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2717 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2719 = tensor.empty() : tensor<4x1x2048xf16>
    %2720 = linalg.copy ins(%2718 : tensor<4x1x2048xf32>) outs(%2719 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2721 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2606, %2720 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2722 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2721 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2723 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2722 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2724 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2723 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2725 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2724 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2726 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2725 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2727 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2726 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2728 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2722, %2727 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2729 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2728 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2730 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.ffn_norm.weight, %2729 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2731 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2730 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2732 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1308 = tensor.expand_shape %2732 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1309 = tensor.extract_slice %expanded_1308[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2733 = iree_tensor_ext.bitcast %extracted_slice_1309 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1310 = tensor.extract_slice %expanded_1308[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2734 = iree_tensor_ext.bitcast %extracted_slice_1310 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2735 = tensor.empty() : tensor<5632x64x32xf16>
    %2736 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2733, %2734 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2735 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1311 = tensor.expand_shape %2731 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2737 = tensor.empty() : tensor<4x1x5632xf32>
    %2738 = linalg.fill ins(%cst_5 : f32) outs(%2737 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2739 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1311, %2736 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2738 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2740 = tensor.empty() : tensor<4x1x5632xf16>
    %2741 = linalg.copy ins(%2739 : tensor<4x1x5632xf32>) outs(%2740 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2742 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2741 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %2743 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2742, %2741 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2744 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1312 = tensor.expand_shape %2744 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1313 = tensor.extract_slice %expanded_1312[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2745 = iree_tensor_ext.bitcast %extracted_slice_1313 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1314 = tensor.extract_slice %expanded_1312[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2746 = iree_tensor_ext.bitcast %extracted_slice_1314 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2747 = tensor.empty() : tensor<5632x64x32xf16>
    %2748 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2745, %2746 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2747 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1315 = tensor.expand_shape %2731 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2749 = tensor.empty() : tensor<4x1x5632xf32>
    %2750 = linalg.fill ins(%cst_5 : f32) outs(%2749 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2751 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1315, %2748 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2750 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2752 = tensor.empty() : tensor<4x1x5632xf16>
    %2753 = linalg.copy ins(%2751 : tensor<4x1x5632xf32>) outs(%2752 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2754 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2743, %2753 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2755 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1316 = tensor.expand_shape %2755 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1317 = tensor.extract_slice %expanded_1316[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2756 = iree_tensor_ext.bitcast %extracted_slice_1317 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1318 = tensor.extract_slice %expanded_1316[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2757 = iree_tensor_ext.bitcast %extracted_slice_1318 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2758 = tensor.empty() : tensor<2048x176x32xf16>
    %2759 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2756, %2757 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2758 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1319 = tensor.expand_shape %2754 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2760 = tensor.empty() : tensor<4x1x2048xf32>
    %2761 = linalg.fill ins(%cst_5 : f32) outs(%2760 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2762 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1319, %2759 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%2761 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2763 = tensor.empty() : tensor<4x1x2048xf16>
    %2764 = linalg.copy ins(%2762 : tensor<4x1x2048xf32>) outs(%2763 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2765 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2721, %2764 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2766 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2765 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2767 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2766 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2768 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2767 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2769 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2768 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2770 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2769 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2771 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2770 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2772 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2766, %2771 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2773 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2772 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2774 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.attn_norm.weight, %2773 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2775 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2774 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2776 = iree_tensor_ext.bitcast %__auto.blk.17.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1320 = tensor.expand_shape %2776 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1321 = tensor.extract_slice %expanded_1320[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2777 = iree_tensor_ext.bitcast %extracted_slice_1321 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1322 = tensor.extract_slice %expanded_1320[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2778 = iree_tensor_ext.bitcast %extracted_slice_1322 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2779 = tensor.empty() : tensor<2048x64x32xf16>
    %2780 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2777, %2778 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2779 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1323 = tensor.expand_shape %2775 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2781 = tensor.empty() : tensor<4x1x2048xf32>
    %2782 = linalg.fill ins(%cst_5 : f32) outs(%2781 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2783 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1323, %2780 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2782 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2784 = tensor.empty() : tensor<4x1x2048xf16>
    %2785 = linalg.copy ins(%2783 : tensor<4x1x2048xf32>) outs(%2784 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2786 = iree_tensor_ext.bitcast %__auto.blk.17.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1324 = tensor.expand_shape %2786 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1325 = tensor.extract_slice %expanded_1324[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2787 = iree_tensor_ext.bitcast %extracted_slice_1325 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1326 = tensor.extract_slice %expanded_1324[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2788 = iree_tensor_ext.bitcast %extracted_slice_1326 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2789 = tensor.empty() : tensor<256x64x32xf16>
    %2790 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2787, %2788 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2789 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1327 = tensor.expand_shape %2775 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2791 = tensor.empty() : tensor<4x1x256xf32>
    %2792 = linalg.fill ins(%cst_5 : f32) outs(%2791 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2793 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1327, %2790 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2792 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2794 = tensor.empty() : tensor<4x1x256xf16>
    %2795 = linalg.copy ins(%2793 : tensor<4x1x256xf32>) outs(%2794 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2796 = iree_tensor_ext.bitcast %__auto.blk.17.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1328 = tensor.expand_shape %2796 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1329 = tensor.extract_slice %expanded_1328[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2797 = iree_tensor_ext.bitcast %extracted_slice_1329 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1330 = tensor.extract_slice %expanded_1328[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2798 = iree_tensor_ext.bitcast %extracted_slice_1330 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2799 = tensor.empty() : tensor<256x64x32xf16>
    %2800 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2797, %2798 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2799 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1331 = tensor.expand_shape %2775 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2801 = tensor.empty() : tensor<4x1x256xf32>
    %2802 = linalg.fill ins(%cst_5 : f32) outs(%2801 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2803 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1331, %2800 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2802 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2804 = tensor.empty() : tensor<4x1x256xf16>
    %2805 = linalg.copy ins(%2803 : tensor<4x1x256xf32>) outs(%2804 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1332 = tensor.expand_shape %2785 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1333 = tensor.expand_shape %2795 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1334 = tensor.expand_shape %2805 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2806 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1335 = tensor.expand_shape %2806 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2807 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1335 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2808 = linalg.batch_matmul ins(%2807, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1336 = linalg.transpose ins(%2808 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2809 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1336 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2810 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2809, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2811 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2810 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2812 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1336 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2813 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2812, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2814 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2813 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1337 = tensor.expand_shape %2811 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1338 = tensor.expand_shape %2814 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1339 = tensor.extract_slice %expanded_1332[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1340 = tensor.extract_slice %expanded_1332[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2815 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1339, %expanded_1337 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2816 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1340, %expanded_1338 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2817 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2815, %2816 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2818 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1340, %expanded_1337 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2819 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1339, %expanded_1338 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2820 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2818, %2819 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2821 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %2822 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2817, %2820 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%2821 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1341 = tensor.collapse_shape %2822 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2823 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1342 = tensor.expand_shape %2823 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2824 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1342 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2825 = linalg.batch_matmul ins(%2824, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1343 = linalg.transpose ins(%2825 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2826 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1343 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2827 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2826, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2828 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2827 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2829 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1343 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2830 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2829, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2831 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2830 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1344 = tensor.expand_shape %2828 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1345 = tensor.expand_shape %2831 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1346 = tensor.extract_slice %expanded_1333[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1347 = tensor.extract_slice %expanded_1333[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2832 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1346, %expanded_1344 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2833 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1347, %expanded_1345 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2834 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2832, %2833 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2835 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1347, %expanded_1344 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2836 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1346, %expanded_1345 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2837 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2835, %2836 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2838 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %2839 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2834, %2837 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%2838 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2840 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1348 = tensor.expand_shape %2840 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2841 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1348 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2842 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2841 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c17_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2843 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2842 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2844 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2843, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2845 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2844 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2846 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2845, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2847 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2846 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2848 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2847, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1349 = tensor.collapse_shape %2848 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1350 = tensor.expand_shape %collapsed_1349 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1351 = tensor.collapse_shape %2839 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2849 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1351, %expanded_1350 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2696 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2850 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2843, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2851 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2850 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %2852 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2851, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2853 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2852 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %2854 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2853, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1352 = tensor.collapse_shape %2854 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1353 = tensor.expand_shape %collapsed_1352 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1354 = tensor.collapse_shape %expanded_1334 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2855 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1354, %expanded_1353 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2849 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1355 = tensor.dim %2855, %c0 : tensor<?x64xf16>
    %2856 = arith.divsi %dim_1355, %c5632 : index
    %expanded_1356 = tensor.expand_shape %2855 [[0, 1, 2, 3, 4], [5]] output_shape [%2856, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1357 = tensor.dim %expanded_1356, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1358 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1359 = tensor.extract_slice %expanded_1356[0, %c17, %c0, 0, 0, 0] [%dim_1357, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2857 = tensor.empty(%dim_1358) : tensor<4x?x4x32x64xf16>
    %2858 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1359, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2857 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1360 = tensor.dim %expanded_1356, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1361 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1362 = tensor.extract_slice %expanded_1356[0, %c17, %c1, 0, 0, 0] [%dim_1360, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2859 = tensor.empty(%dim_1361) : tensor<4x?x4x32x64xf16>
    %2860 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1362, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%2859 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1363 = tensor.dim %2858, %c1 : tensor<4x?x4x32x64xf16>
    %2861 = tensor.empty(%dim_1363) : tensor<4x?x32x4x64xf16>
    %transposed_1364 = linalg.transpose ins(%2858 : tensor<4x?x4x32x64xf16>) outs(%2861 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1365 = tensor.collapse_shape %transposed_1364 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1366 = tensor.dim %2860, %c1 : tensor<4x?x4x32x64xf16>
    %2862 = tensor.empty(%dim_1366) : tensor<4x?x32x4x64xf16>
    %transposed_1367 = linalg.transpose ins(%2860 : tensor<4x?x4x32x64xf16>) outs(%2862 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1368 = tensor.collapse_shape %transposed_1367 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2863 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1365 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1369 = tensor.collapse_shape %2863 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2864 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1368 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1370 = tensor.collapse_shape %2864 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1371 = linalg.transpose ins(%collapsed_1341 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %2865 = affine.apply #map32()[%dim_1363]
    %2866 = tensor.empty(%2865) : tensor<4x32x?x64xf16>
    %transposed_1372 = linalg.transpose ins(%collapsed_1369 : tensor<4x?x32x64xf16>) outs(%2866 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %2867 = affine.apply #map32()[%dim_1366]
    %2868 = tensor.empty(%2867) : tensor<4x32x?x64xf16>
    %transposed_1373 = linalg.transpose ins(%collapsed_1370 : tensor<4x?x32x64xf16>) outs(%2868 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1374 = tensor.collapse_shape %transposed_1371 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1375 = tensor.collapse_shape %transposed_1372 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1376 = tensor.collapse_shape %transposed_1373 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2869 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1374, %collapsed_1375, %collapsed_1376, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1377 = tensor.expand_shape %2869 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1378 = linalg.transpose ins(%expanded_1377 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1379 = tensor.collapse_shape %transposed_1378 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2870 = iree_tensor_ext.bitcast %__auto.blk.17.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1380 = tensor.expand_shape %2870 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1381 = tensor.extract_slice %expanded_1380[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2871 = iree_tensor_ext.bitcast %extracted_slice_1381 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1382 = tensor.extract_slice %expanded_1380[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2872 = iree_tensor_ext.bitcast %extracted_slice_1382 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2873 = tensor.empty() : tensor<2048x64x32xf16>
    %2874 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2871, %2872 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2873 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1383 = tensor.expand_shape %collapsed_1379 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2875 = tensor.empty() : tensor<4x1x2048xf32>
    %2876 = linalg.fill ins(%cst_5 : f32) outs(%2875 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2877 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1383, %2874 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2876 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2878 = tensor.empty() : tensor<4x1x2048xf16>
    %2879 = linalg.copy ins(%2877 : tensor<4x1x2048xf32>) outs(%2878 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2880 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2765, %2879 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2881 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2880 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2882 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2881 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2883 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2882 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2884 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2883 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2885 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2884 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2886 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2885 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2887 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2881, %2886 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2888 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2887 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2889 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.ffn_norm.weight, %2888 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2890 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2889 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2891 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1384 = tensor.expand_shape %2891 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1385 = tensor.extract_slice %expanded_1384[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2892 = iree_tensor_ext.bitcast %extracted_slice_1385 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1386 = tensor.extract_slice %expanded_1384[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2893 = iree_tensor_ext.bitcast %extracted_slice_1386 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2894 = tensor.empty() : tensor<5632x64x32xf16>
    %2895 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2892, %2893 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2894 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1387 = tensor.expand_shape %2890 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2896 = tensor.empty() : tensor<4x1x5632xf32>
    %2897 = linalg.fill ins(%cst_5 : f32) outs(%2896 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2898 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1387, %2895 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2897 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2899 = tensor.empty() : tensor<4x1x5632xf16>
    %2900 = linalg.copy ins(%2898 : tensor<4x1x5632xf32>) outs(%2899 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2901 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2900 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %2902 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2901, %2900 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2903 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1388 = tensor.expand_shape %2903 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1389 = tensor.extract_slice %expanded_1388[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2904 = iree_tensor_ext.bitcast %extracted_slice_1389 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1390 = tensor.extract_slice %expanded_1388[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2905 = iree_tensor_ext.bitcast %extracted_slice_1390 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2906 = tensor.empty() : tensor<5632x64x32xf16>
    %2907 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2904, %2905 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%2906 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1391 = tensor.expand_shape %2890 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2908 = tensor.empty() : tensor<4x1x5632xf32>
    %2909 = linalg.fill ins(%cst_5 : f32) outs(%2908 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %2910 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1391, %2907 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%2909 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %2911 = tensor.empty() : tensor<4x1x5632xf16>
    %2912 = linalg.copy ins(%2910 : tensor<4x1x5632xf32>) outs(%2911 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2913 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2902, %2912 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %2914 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1392 = tensor.expand_shape %2914 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1393 = tensor.extract_slice %expanded_1392[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2915 = iree_tensor_ext.bitcast %extracted_slice_1393 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1394 = tensor.extract_slice %expanded_1392[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2916 = iree_tensor_ext.bitcast %extracted_slice_1394 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2917 = tensor.empty() : tensor<2048x176x32xf16>
    %2918 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2915, %2916 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%2917 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1395 = tensor.expand_shape %2913 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2919 = tensor.empty() : tensor<4x1x2048xf32>
    %2920 = linalg.fill ins(%cst_5 : f32) outs(%2919 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2921 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1395, %2918 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%2920 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2922 = tensor.empty() : tensor<4x1x2048xf16>
    %2923 = linalg.copy ins(%2921 : tensor<4x1x2048xf32>) outs(%2922 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2924 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2880, %2923 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2925 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2924 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2926 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2925 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2927 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2926 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2928 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2927 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2929 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2928 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2930 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2929 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %2931 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2925, %2930 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %2932 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2931 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2933 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.attn_norm.weight, %2932 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %2934 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2933 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %2935 = iree_tensor_ext.bitcast %__auto.blk.18.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1396 = tensor.expand_shape %2935 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1397 = tensor.extract_slice %expanded_1396[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2936 = iree_tensor_ext.bitcast %extracted_slice_1397 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1398 = tensor.extract_slice %expanded_1396[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2937 = iree_tensor_ext.bitcast %extracted_slice_1398 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2938 = tensor.empty() : tensor<2048x64x32xf16>
    %2939 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2936, %2937 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%2938 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1399 = tensor.expand_shape %2934 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2940 = tensor.empty() : tensor<4x1x2048xf32>
    %2941 = linalg.fill ins(%cst_5 : f32) outs(%2940 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %2942 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1399, %2939 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%2941 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %2943 = tensor.empty() : tensor<4x1x2048xf16>
    %2944 = linalg.copy ins(%2942 : tensor<4x1x2048xf32>) outs(%2943 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2945 = iree_tensor_ext.bitcast %__auto.blk.18.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1400 = tensor.expand_shape %2945 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1401 = tensor.extract_slice %expanded_1400[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2946 = iree_tensor_ext.bitcast %extracted_slice_1401 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1402 = tensor.extract_slice %expanded_1400[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2947 = iree_tensor_ext.bitcast %extracted_slice_1402 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2948 = tensor.empty() : tensor<256x64x32xf16>
    %2949 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2946, %2947 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2948 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1403 = tensor.expand_shape %2934 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2950 = tensor.empty() : tensor<4x1x256xf32>
    %2951 = linalg.fill ins(%cst_5 : f32) outs(%2950 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2952 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1403, %2949 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2951 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2953 = tensor.empty() : tensor<4x1x256xf16>
    %2954 = linalg.copy ins(%2952 : tensor<4x1x256xf32>) outs(%2953 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2955 = iree_tensor_ext.bitcast %__auto.blk.18.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1404 = tensor.expand_shape %2955 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1405 = tensor.extract_slice %expanded_1404[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2956 = iree_tensor_ext.bitcast %extracted_slice_1405 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1406 = tensor.extract_slice %expanded_1404[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2957 = iree_tensor_ext.bitcast %extracted_slice_1406 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2958 = tensor.empty() : tensor<256x64x32xf16>
    %2959 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2956, %2957 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%2958 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1407 = tensor.expand_shape %2934 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2960 = tensor.empty() : tensor<4x1x256xf32>
    %2961 = linalg.fill ins(%cst_5 : f32) outs(%2960 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %2962 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1407, %2959 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%2961 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %2963 = tensor.empty() : tensor<4x1x256xf16>
    %2964 = linalg.copy ins(%2962 : tensor<4x1x256xf32>) outs(%2963 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1408 = tensor.expand_shape %2944 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1409 = tensor.expand_shape %2954 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1410 = tensor.expand_shape %2964 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2965 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1411 = tensor.expand_shape %2965 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2966 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1411 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2967 = linalg.batch_matmul ins(%2966, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1412 = linalg.transpose ins(%2967 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2968 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1412 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2969 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2968, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2970 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2969 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2971 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1412 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2972 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2971, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2973 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2972 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1413 = tensor.expand_shape %2970 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1414 = tensor.expand_shape %2973 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1415 = tensor.extract_slice %expanded_1408[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1416 = tensor.extract_slice %expanded_1408[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2974 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1415, %expanded_1413 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2975 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1416, %expanded_1414 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2976 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2974, %2975 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2977 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1416, %expanded_1413 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2978 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1415, %expanded_1414 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2979 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2977, %2978 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %2980 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %2981 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2976, %2979 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%2980 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1417 = tensor.collapse_shape %2981 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2982 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1418 = tensor.expand_shape %2982 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2983 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1418 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2984 = linalg.batch_matmul ins(%2983, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1419 = linalg.transpose ins(%2984 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2985 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1419 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2986 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2985, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2987 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2986 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %2988 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1419 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2989 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2988, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %2990 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2989 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1420 = tensor.expand_shape %2987 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1421 = tensor.expand_shape %2990 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1422 = tensor.extract_slice %expanded_1409[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1423 = tensor.extract_slice %expanded_1409[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2991 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1422, %expanded_1420 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2992 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1423, %expanded_1421 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2993 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2991, %2992 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2994 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1423, %expanded_1420 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2995 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1422, %expanded_1421 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2996 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2994, %2995 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %2997 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %2998 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2993, %2996 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%2997 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2999 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1424 = tensor.expand_shape %2999 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %3000 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1424 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3001 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3000 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c18_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3002 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3001 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3003 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3002, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3004 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3003 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3005 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3004, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3006 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3005 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3007 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3006, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1425 = tensor.collapse_shape %3007 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1426 = tensor.expand_shape %collapsed_1425 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1427 = tensor.collapse_shape %2998 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %3008 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1427, %expanded_1426 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2855 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %3009 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3002, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3010 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3009 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3011 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3010, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3012 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3011 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3013 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3012, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1428 = tensor.collapse_shape %3013 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1429 = tensor.expand_shape %collapsed_1428 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1430 = tensor.collapse_shape %expanded_1410 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %3014 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1430, %expanded_1429 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%3008 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1431 = tensor.dim %3014, %c0 : tensor<?x64xf16>
    %3015 = arith.divsi %dim_1431, %c5632 : index
    %expanded_1432 = tensor.expand_shape %3014 [[0, 1, 2, 3, 4], [5]] output_shape [%3015, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1433 = tensor.dim %expanded_1432, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1434 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1435 = tensor.extract_slice %expanded_1432[0, %c18, %c0, 0, 0, 0] [%dim_1433, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3016 = tensor.empty(%dim_1434) : tensor<4x?x4x32x64xf16>
    %3017 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1435, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3016 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1436 = tensor.dim %expanded_1432, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1437 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1438 = tensor.extract_slice %expanded_1432[0, %c18, %c1, 0, 0, 0] [%dim_1436, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3018 = tensor.empty(%dim_1437) : tensor<4x?x4x32x64xf16>
    %3019 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1438, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3018 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1439 = tensor.dim %3017, %c1 : tensor<4x?x4x32x64xf16>
    %3020 = tensor.empty(%dim_1439) : tensor<4x?x32x4x64xf16>
    %transposed_1440 = linalg.transpose ins(%3017 : tensor<4x?x4x32x64xf16>) outs(%3020 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1441 = tensor.collapse_shape %transposed_1440 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1442 = tensor.dim %3019, %c1 : tensor<4x?x4x32x64xf16>
    %3021 = tensor.empty(%dim_1442) : tensor<4x?x32x4x64xf16>
    %transposed_1443 = linalg.transpose ins(%3019 : tensor<4x?x4x32x64xf16>) outs(%3021 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1444 = tensor.collapse_shape %transposed_1443 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %3022 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1441 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1445 = tensor.collapse_shape %3022 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %3023 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1444 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1446 = tensor.collapse_shape %3023 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1447 = linalg.transpose ins(%collapsed_1417 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %3024 = affine.apply #map32()[%dim_1439]
    %3025 = tensor.empty(%3024) : tensor<4x32x?x64xf16>
    %transposed_1448 = linalg.transpose ins(%collapsed_1445 : tensor<4x?x32x64xf16>) outs(%3025 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3026 = affine.apply #map32()[%dim_1442]
    %3027 = tensor.empty(%3026) : tensor<4x32x?x64xf16>
    %transposed_1449 = linalg.transpose ins(%collapsed_1446 : tensor<4x?x32x64xf16>) outs(%3027 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1450 = tensor.collapse_shape %transposed_1447 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1451 = tensor.collapse_shape %transposed_1448 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1452 = tensor.collapse_shape %transposed_1449 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %3028 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1450, %collapsed_1451, %collapsed_1452, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1453 = tensor.expand_shape %3028 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1454 = linalg.transpose ins(%expanded_1453 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1455 = tensor.collapse_shape %transposed_1454 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %3029 = iree_tensor_ext.bitcast %__auto.blk.18.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1456 = tensor.expand_shape %3029 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1457 = tensor.extract_slice %expanded_1456[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3030 = iree_tensor_ext.bitcast %extracted_slice_1457 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1458 = tensor.extract_slice %expanded_1456[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3031 = iree_tensor_ext.bitcast %extracted_slice_1458 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %3032 = tensor.empty() : tensor<2048x64x32xf16>
    %3033 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3030, %3031 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3032 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1459 = tensor.expand_shape %collapsed_1455 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3034 = tensor.empty() : tensor<4x1x2048xf32>
    %3035 = linalg.fill ins(%cst_5 : f32) outs(%3034 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3036 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1459, %3033 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%3035 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3037 = tensor.empty() : tensor<4x1x2048xf16>
    %3038 = linalg.copy ins(%3036 : tensor<4x1x2048xf32>) outs(%3037 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3039 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2924, %3038 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3040 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3039 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3041 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3040 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3042 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3041 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3043 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3042 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3044 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3043 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3045 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3044 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3046 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3040, %3045 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3047 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3046 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3048 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.ffn_norm.weight, %3047 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3049 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3048 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3050 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1460 = tensor.expand_shape %3050 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1461 = tensor.extract_slice %expanded_1460[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3051 = iree_tensor_ext.bitcast %extracted_slice_1461 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1462 = tensor.extract_slice %expanded_1460[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3052 = iree_tensor_ext.bitcast %extracted_slice_1462 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3053 = tensor.empty() : tensor<5632x64x32xf16>
    %3054 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3051, %3052 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3053 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1463 = tensor.expand_shape %3049 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3055 = tensor.empty() : tensor<4x1x5632xf32>
    %3056 = linalg.fill ins(%cst_5 : f32) outs(%3055 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3057 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1463, %3054 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3056 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3058 = tensor.empty() : tensor<4x1x5632xf16>
    %3059 = linalg.copy ins(%3057 : tensor<4x1x5632xf32>) outs(%3058 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3060 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3059 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %3061 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3060, %3059 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3062 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1464 = tensor.expand_shape %3062 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1465 = tensor.extract_slice %expanded_1464[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3063 = iree_tensor_ext.bitcast %extracted_slice_1465 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1466 = tensor.extract_slice %expanded_1464[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3064 = iree_tensor_ext.bitcast %extracted_slice_1466 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3065 = tensor.empty() : tensor<5632x64x32xf16>
    %3066 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3063, %3064 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3065 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1467 = tensor.expand_shape %3049 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3067 = tensor.empty() : tensor<4x1x5632xf32>
    %3068 = linalg.fill ins(%cst_5 : f32) outs(%3067 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3069 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1467, %3066 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3068 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3070 = tensor.empty() : tensor<4x1x5632xf16>
    %3071 = linalg.copy ins(%3069 : tensor<4x1x5632xf32>) outs(%3070 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3072 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3061, %3071 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3073 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1468 = tensor.expand_shape %3073 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1469 = tensor.extract_slice %expanded_1468[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %3074 = iree_tensor_ext.bitcast %extracted_slice_1469 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1470 = tensor.extract_slice %expanded_1468[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %3075 = iree_tensor_ext.bitcast %extracted_slice_1470 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %3076 = tensor.empty() : tensor<2048x176x32xf16>
    %3077 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3074, %3075 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%3076 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1471 = tensor.expand_shape %3072 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %3078 = tensor.empty() : tensor<4x1x2048xf32>
    %3079 = linalg.fill ins(%cst_5 : f32) outs(%3078 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3080 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1471, %3077 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%3079 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3081 = tensor.empty() : tensor<4x1x2048xf16>
    %3082 = linalg.copy ins(%3080 : tensor<4x1x2048xf32>) outs(%3081 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3083 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3039, %3082 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3084 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3083 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3085 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3084 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3086 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3085 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3087 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3086 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3088 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3087 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3089 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3088 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3090 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3084, %3089 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3091 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3090 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3092 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.attn_norm.weight, %3091 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3093 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3092 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3094 = iree_tensor_ext.bitcast %__auto.blk.19.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1472 = tensor.expand_shape %3094 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1473 = tensor.extract_slice %expanded_1472[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3095 = iree_tensor_ext.bitcast %extracted_slice_1473 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1474 = tensor.extract_slice %expanded_1472[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3096 = iree_tensor_ext.bitcast %extracted_slice_1474 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %3097 = tensor.empty() : tensor<2048x64x32xf16>
    %3098 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3095, %3096 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3097 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1475 = tensor.expand_shape %3093 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3099 = tensor.empty() : tensor<4x1x2048xf32>
    %3100 = linalg.fill ins(%cst_5 : f32) outs(%3099 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3101 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1475, %3098 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%3100 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3102 = tensor.empty() : tensor<4x1x2048xf16>
    %3103 = linalg.copy ins(%3101 : tensor<4x1x2048xf32>) outs(%3102 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3104 = iree_tensor_ext.bitcast %__auto.blk.19.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1476 = tensor.expand_shape %3104 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1477 = tensor.extract_slice %expanded_1476[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3105 = iree_tensor_ext.bitcast %extracted_slice_1477 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1478 = tensor.extract_slice %expanded_1476[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3106 = iree_tensor_ext.bitcast %extracted_slice_1478 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %3107 = tensor.empty() : tensor<256x64x32xf16>
    %3108 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3105, %3106 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3107 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1479 = tensor.expand_shape %3093 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3109 = tensor.empty() : tensor<4x1x256xf32>
    %3110 = linalg.fill ins(%cst_5 : f32) outs(%3109 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %3111 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1479, %3108 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%3110 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %3112 = tensor.empty() : tensor<4x1x256xf16>
    %3113 = linalg.copy ins(%3111 : tensor<4x1x256xf32>) outs(%3112 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %3114 = iree_tensor_ext.bitcast %__auto.blk.19.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1480 = tensor.expand_shape %3114 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1481 = tensor.extract_slice %expanded_1480[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3115 = iree_tensor_ext.bitcast %extracted_slice_1481 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1482 = tensor.extract_slice %expanded_1480[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3116 = iree_tensor_ext.bitcast %extracted_slice_1482 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %3117 = tensor.empty() : tensor<256x64x32xf16>
    %3118 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3115, %3116 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3117 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1483 = tensor.expand_shape %3093 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3119 = tensor.empty() : tensor<4x1x256xf32>
    %3120 = linalg.fill ins(%cst_5 : f32) outs(%3119 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %3121 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1483, %3118 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%3120 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %3122 = tensor.empty() : tensor<4x1x256xf16>
    %3123 = linalg.copy ins(%3121 : tensor<4x1x256xf32>) outs(%3122 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1484 = tensor.expand_shape %3103 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1485 = tensor.expand_shape %3113 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1486 = tensor.expand_shape %3123 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %3124 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1487 = tensor.expand_shape %3124 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %3125 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1487 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %3126 = linalg.batch_matmul ins(%3125, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1488 = linalg.transpose ins(%3126 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %3127 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1488 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3128 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3127, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3129 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3128 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %3130 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1488 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3131 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3130, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3132 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3131 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1489 = tensor.expand_shape %3129 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1490 = tensor.expand_shape %3132 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1491 = tensor.extract_slice %expanded_1484[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1492 = tensor.extract_slice %expanded_1484[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %3133 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1491, %expanded_1489 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3134 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1492, %expanded_1490 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3135 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3133, %3134 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3136 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1492, %expanded_1489 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3137 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1491, %expanded_1490 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3138 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3136, %3137 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3139 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %3140 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3135, %3138 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%3139 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1493 = tensor.collapse_shape %3140 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %3141 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1494 = tensor.expand_shape %3141 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %3142 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1494 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %3143 = linalg.batch_matmul ins(%3142, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1495 = linalg.transpose ins(%3143 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %3144 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1495 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3145 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3144, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3146 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3145 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %3147 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1495 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3148 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3147, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3149 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3148 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1496 = tensor.expand_shape %3146 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1497 = tensor.expand_shape %3149 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1498 = tensor.extract_slice %expanded_1485[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1499 = tensor.extract_slice %expanded_1485[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %3150 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1498, %expanded_1496 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3151 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1499, %expanded_1497 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3152 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3150, %3151 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3153 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1499, %expanded_1496 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3154 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1498, %expanded_1497 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3155 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3153, %3154 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3156 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %3157 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3152, %3155 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%3156 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %3158 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1500 = tensor.expand_shape %3158 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %3159 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1500 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3160 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3159 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c19_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3161 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3160 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3162 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3161, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3163 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3162 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3164 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3163, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3165 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3164 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3166 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3165, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1501 = tensor.collapse_shape %3166 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1502 = tensor.expand_shape %collapsed_1501 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1503 = tensor.collapse_shape %3157 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %3167 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1503, %expanded_1502 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%3014 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %3168 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3161, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3169 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3168 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3170 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3169, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3171 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3170 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3172 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3171, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1504 = tensor.collapse_shape %3172 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1505 = tensor.expand_shape %collapsed_1504 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1506 = tensor.collapse_shape %expanded_1486 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %3173 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1506, %expanded_1505 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%3167 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1507 = tensor.dim %3173, %c0 : tensor<?x64xf16>
    %3174 = arith.divsi %dim_1507, %c5632 : index
    %expanded_1508 = tensor.expand_shape %3173 [[0, 1, 2, 3, 4], [5]] output_shape [%3174, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1509 = tensor.dim %expanded_1508, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1510 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1511 = tensor.extract_slice %expanded_1508[0, %c19, %c0, 0, 0, 0] [%dim_1509, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3175 = tensor.empty(%dim_1510) : tensor<4x?x4x32x64xf16>
    %3176 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1511, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3175 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1512 = tensor.dim %expanded_1508, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1513 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1514 = tensor.extract_slice %expanded_1508[0, %c19, %c1, 0, 0, 0] [%dim_1512, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3177 = tensor.empty(%dim_1513) : tensor<4x?x4x32x64xf16>
    %3178 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1514, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3177 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1515 = tensor.dim %3176, %c1 : tensor<4x?x4x32x64xf16>
    %3179 = tensor.empty(%dim_1515) : tensor<4x?x32x4x64xf16>
    %transposed_1516 = linalg.transpose ins(%3176 : tensor<4x?x4x32x64xf16>) outs(%3179 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1517 = tensor.collapse_shape %transposed_1516 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1518 = tensor.dim %3178, %c1 : tensor<4x?x4x32x64xf16>
    %3180 = tensor.empty(%dim_1518) : tensor<4x?x32x4x64xf16>
    %transposed_1519 = linalg.transpose ins(%3178 : tensor<4x?x4x32x64xf16>) outs(%3180 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1520 = tensor.collapse_shape %transposed_1519 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %3181 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1517 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1521 = tensor.collapse_shape %3181 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %3182 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1520 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1522 = tensor.collapse_shape %3182 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1523 = linalg.transpose ins(%collapsed_1493 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %3183 = affine.apply #map32()[%dim_1515]
    %3184 = tensor.empty(%3183) : tensor<4x32x?x64xf16>
    %transposed_1524 = linalg.transpose ins(%collapsed_1521 : tensor<4x?x32x64xf16>) outs(%3184 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3185 = affine.apply #map32()[%dim_1518]
    %3186 = tensor.empty(%3185) : tensor<4x32x?x64xf16>
    %transposed_1525 = linalg.transpose ins(%collapsed_1522 : tensor<4x?x32x64xf16>) outs(%3186 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1526 = tensor.collapse_shape %transposed_1523 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1527 = tensor.collapse_shape %transposed_1524 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1528 = tensor.collapse_shape %transposed_1525 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %3187 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1526, %collapsed_1527, %collapsed_1528, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1529 = tensor.expand_shape %3187 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1530 = linalg.transpose ins(%expanded_1529 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1531 = tensor.collapse_shape %transposed_1530 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %3188 = iree_tensor_ext.bitcast %__auto.blk.19.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1532 = tensor.expand_shape %3188 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1533 = tensor.extract_slice %expanded_1532[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3189 = iree_tensor_ext.bitcast %extracted_slice_1533 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1534 = tensor.extract_slice %expanded_1532[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3190 = iree_tensor_ext.bitcast %extracted_slice_1534 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %3191 = tensor.empty() : tensor<2048x64x32xf16>
    %3192 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3189, %3190 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3191 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1535 = tensor.expand_shape %collapsed_1531 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3193 = tensor.empty() : tensor<4x1x2048xf32>
    %3194 = linalg.fill ins(%cst_5 : f32) outs(%3193 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3195 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1535, %3192 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%3194 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3196 = tensor.empty() : tensor<4x1x2048xf16>
    %3197 = linalg.copy ins(%3195 : tensor<4x1x2048xf32>) outs(%3196 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3198 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3083, %3197 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3199 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3198 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3200 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3199 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3201 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3200 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3202 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3201 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3203 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3202 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3204 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3203 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3205 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3199, %3204 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3206 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3205 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3207 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.ffn_norm.weight, %3206 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3208 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3207 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3209 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1536 = tensor.expand_shape %3209 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1537 = tensor.extract_slice %expanded_1536[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3210 = iree_tensor_ext.bitcast %extracted_slice_1537 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1538 = tensor.extract_slice %expanded_1536[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3211 = iree_tensor_ext.bitcast %extracted_slice_1538 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3212 = tensor.empty() : tensor<5632x64x32xf16>
    %3213 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3210, %3211 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3212 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1539 = tensor.expand_shape %3208 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3214 = tensor.empty() : tensor<4x1x5632xf32>
    %3215 = linalg.fill ins(%cst_5 : f32) outs(%3214 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3216 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1539, %3213 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3215 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3217 = tensor.empty() : tensor<4x1x5632xf16>
    %3218 = linalg.copy ins(%3216 : tensor<4x1x5632xf32>) outs(%3217 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3219 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3218 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %3220 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3219, %3218 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3221 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1540 = tensor.expand_shape %3221 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1541 = tensor.extract_slice %expanded_1540[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3222 = iree_tensor_ext.bitcast %extracted_slice_1541 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1542 = tensor.extract_slice %expanded_1540[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3223 = iree_tensor_ext.bitcast %extracted_slice_1542 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3224 = tensor.empty() : tensor<5632x64x32xf16>
    %3225 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3222, %3223 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3224 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1543 = tensor.expand_shape %3208 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3226 = tensor.empty() : tensor<4x1x5632xf32>
    %3227 = linalg.fill ins(%cst_5 : f32) outs(%3226 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3228 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1543, %3225 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3227 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3229 = tensor.empty() : tensor<4x1x5632xf16>
    %3230 = linalg.copy ins(%3228 : tensor<4x1x5632xf32>) outs(%3229 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3231 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3220, %3230 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3232 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1544 = tensor.expand_shape %3232 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1545 = tensor.extract_slice %expanded_1544[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %3233 = iree_tensor_ext.bitcast %extracted_slice_1545 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1546 = tensor.extract_slice %expanded_1544[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %3234 = iree_tensor_ext.bitcast %extracted_slice_1546 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %3235 = tensor.empty() : tensor<2048x176x32xf16>
    %3236 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3233, %3234 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%3235 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1547 = tensor.expand_shape %3231 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %3237 = tensor.empty() : tensor<4x1x2048xf32>
    %3238 = linalg.fill ins(%cst_5 : f32) outs(%3237 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3239 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1547, %3236 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%3238 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3240 = tensor.empty() : tensor<4x1x2048xf16>
    %3241 = linalg.copy ins(%3239 : tensor<4x1x2048xf32>) outs(%3240 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3242 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3198, %3241 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3243 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3242 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3244 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3243 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3245 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3244 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3246 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3245 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3247 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3246 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3248 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3247 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3249 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3243, %3248 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3250 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3249 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3251 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.attn_norm.weight, %3250 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3251 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3253 = iree_tensor_ext.bitcast %__auto.blk.20.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1548 = tensor.expand_shape %3253 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1549 = tensor.extract_slice %expanded_1548[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3254 = iree_tensor_ext.bitcast %extracted_slice_1549 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1550 = tensor.extract_slice %expanded_1548[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3255 = iree_tensor_ext.bitcast %extracted_slice_1550 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %3256 = tensor.empty() : tensor<2048x64x32xf16>
    %3257 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3254, %3255 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3256 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1551 = tensor.expand_shape %3252 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3258 = tensor.empty() : tensor<4x1x2048xf32>
    %3259 = linalg.fill ins(%cst_5 : f32) outs(%3258 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3260 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1551, %3257 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%3259 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3261 = tensor.empty() : tensor<4x1x2048xf16>
    %3262 = linalg.copy ins(%3260 : tensor<4x1x2048xf32>) outs(%3261 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3263 = iree_tensor_ext.bitcast %__auto.blk.20.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1552 = tensor.expand_shape %3263 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1553 = tensor.extract_slice %expanded_1552[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3264 = iree_tensor_ext.bitcast %extracted_slice_1553 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1554 = tensor.extract_slice %expanded_1552[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3265 = iree_tensor_ext.bitcast %extracted_slice_1554 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %3266 = tensor.empty() : tensor<256x64x32xf16>
    %3267 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3264, %3265 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3266 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1555 = tensor.expand_shape %3252 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3268 = tensor.empty() : tensor<4x1x256xf32>
    %3269 = linalg.fill ins(%cst_5 : f32) outs(%3268 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %3270 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1555, %3267 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%3269 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %3271 = tensor.empty() : tensor<4x1x256xf16>
    %3272 = linalg.copy ins(%3270 : tensor<4x1x256xf32>) outs(%3271 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %3273 = iree_tensor_ext.bitcast %__auto.blk.20.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1556 = tensor.expand_shape %3273 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1557 = tensor.extract_slice %expanded_1556[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3274 = iree_tensor_ext.bitcast %extracted_slice_1557 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1558 = tensor.extract_slice %expanded_1556[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3275 = iree_tensor_ext.bitcast %extracted_slice_1558 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %3276 = tensor.empty() : tensor<256x64x32xf16>
    %3277 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3274, %3275 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3276 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1559 = tensor.expand_shape %3252 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3278 = tensor.empty() : tensor<4x1x256xf32>
    %3279 = linalg.fill ins(%cst_5 : f32) outs(%3278 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %3280 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1559, %3277 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%3279 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %3281 = tensor.empty() : tensor<4x1x256xf16>
    %3282 = linalg.copy ins(%3280 : tensor<4x1x256xf32>) outs(%3281 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1560 = tensor.expand_shape %3262 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1561 = tensor.expand_shape %3272 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1562 = tensor.expand_shape %3282 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %3283 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1563 = tensor.expand_shape %3283 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %3284 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1563 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %3285 = linalg.batch_matmul ins(%3284, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1564 = linalg.transpose ins(%3285 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %3286 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1564 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3287 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3286, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3288 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3287 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %3289 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1564 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3290 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3289, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3291 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3290 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1565 = tensor.expand_shape %3288 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1566 = tensor.expand_shape %3291 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1567 = tensor.extract_slice %expanded_1560[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1568 = tensor.extract_slice %expanded_1560[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %3292 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1567, %expanded_1565 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3293 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1568, %expanded_1566 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3294 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3292, %3293 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3295 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1568, %expanded_1565 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3296 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1567, %expanded_1566 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3297 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3295, %3296 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3298 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %3299 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3294, %3297 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%3298 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1569 = tensor.collapse_shape %3299 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %3300 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1570 = tensor.expand_shape %3300 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %3301 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1570 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %3302 = linalg.batch_matmul ins(%3301, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1571 = linalg.transpose ins(%3302 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %3303 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1571 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3304 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3303, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3305 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3304 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %3306 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1571 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3307 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3306, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3308 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3307 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1572 = tensor.expand_shape %3305 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1573 = tensor.expand_shape %3308 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1574 = tensor.extract_slice %expanded_1561[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1575 = tensor.extract_slice %expanded_1561[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %3309 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1574, %expanded_1572 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3310 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1575, %expanded_1573 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3311 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3309, %3310 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3312 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1575, %expanded_1572 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3313 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1574, %expanded_1573 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3314 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3312, %3313 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3315 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %3316 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3311, %3314 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%3315 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %3317 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1576 = tensor.expand_shape %3317 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %3318 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1576 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3319 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3318 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c20_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3320 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3319 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3321 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3320, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3322 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3321 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3323 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3322, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3324 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3323 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3325 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3324, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1577 = tensor.collapse_shape %3325 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1578 = tensor.expand_shape %collapsed_1577 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1579 = tensor.collapse_shape %3316 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %3326 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1579, %expanded_1578 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%3173 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %3327 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3320, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3328 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3327 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3329 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3328, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3330 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3329 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3331 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3330, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1580 = tensor.collapse_shape %3331 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1581 = tensor.expand_shape %collapsed_1580 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1582 = tensor.collapse_shape %expanded_1562 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %3332 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1582, %expanded_1581 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%3326 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1583 = tensor.dim %3332, %c0 : tensor<?x64xf16>
    %3333 = arith.divsi %dim_1583, %c5632 : index
    %expanded_1584 = tensor.expand_shape %3332 [[0, 1, 2, 3, 4], [5]] output_shape [%3333, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1585 = tensor.dim %expanded_1584, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1586 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1587 = tensor.extract_slice %expanded_1584[0, %c20, %c0, 0, 0, 0] [%dim_1585, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3334 = tensor.empty(%dim_1586) : tensor<4x?x4x32x64xf16>
    %3335 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1587, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3334 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1588 = tensor.dim %expanded_1584, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1589 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1590 = tensor.extract_slice %expanded_1584[0, %c20, %c1, 0, 0, 0] [%dim_1588, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3336 = tensor.empty(%dim_1589) : tensor<4x?x4x32x64xf16>
    %3337 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1590, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3336 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1591 = tensor.dim %3335, %c1 : tensor<4x?x4x32x64xf16>
    %3338 = tensor.empty(%dim_1591) : tensor<4x?x32x4x64xf16>
    %transposed_1592 = linalg.transpose ins(%3335 : tensor<4x?x4x32x64xf16>) outs(%3338 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1593 = tensor.collapse_shape %transposed_1592 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1594 = tensor.dim %3337, %c1 : tensor<4x?x4x32x64xf16>
    %3339 = tensor.empty(%dim_1594) : tensor<4x?x32x4x64xf16>
    %transposed_1595 = linalg.transpose ins(%3337 : tensor<4x?x4x32x64xf16>) outs(%3339 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1596 = tensor.collapse_shape %transposed_1595 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %3340 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1593 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1597 = tensor.collapse_shape %3340 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %3341 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1596 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1598 = tensor.collapse_shape %3341 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1599 = linalg.transpose ins(%collapsed_1569 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %3342 = affine.apply #map32()[%dim_1591]
    %3343 = tensor.empty(%3342) : tensor<4x32x?x64xf16>
    %transposed_1600 = linalg.transpose ins(%collapsed_1597 : tensor<4x?x32x64xf16>) outs(%3343 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3344 = affine.apply #map32()[%dim_1594]
    %3345 = tensor.empty(%3344) : tensor<4x32x?x64xf16>
    %transposed_1601 = linalg.transpose ins(%collapsed_1598 : tensor<4x?x32x64xf16>) outs(%3345 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1602 = tensor.collapse_shape %transposed_1599 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1603 = tensor.collapse_shape %transposed_1600 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1604 = tensor.collapse_shape %transposed_1601 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %3346 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1602, %collapsed_1603, %collapsed_1604, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1605 = tensor.expand_shape %3346 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1606 = linalg.transpose ins(%expanded_1605 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1607 = tensor.collapse_shape %transposed_1606 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %3347 = iree_tensor_ext.bitcast %__auto.blk.20.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1608 = tensor.expand_shape %3347 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1609 = tensor.extract_slice %expanded_1608[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3348 = iree_tensor_ext.bitcast %extracted_slice_1609 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1610 = tensor.extract_slice %expanded_1608[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3349 = iree_tensor_ext.bitcast %extracted_slice_1610 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %3350 = tensor.empty() : tensor<2048x64x32xf16>
    %3351 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3348, %3349 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3350 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1611 = tensor.expand_shape %collapsed_1607 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3352 = tensor.empty() : tensor<4x1x2048xf32>
    %3353 = linalg.fill ins(%cst_5 : f32) outs(%3352 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3354 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1611, %3351 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%3353 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3355 = tensor.empty() : tensor<4x1x2048xf16>
    %3356 = linalg.copy ins(%3354 : tensor<4x1x2048xf32>) outs(%3355 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3357 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3242, %3356 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3358 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3357 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3359 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3358 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3360 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3359 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3361 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3360 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3362 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3361 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3363 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3362 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3364 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3358, %3363 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3365 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3364 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3366 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.ffn_norm.weight, %3365 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3367 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3366 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3368 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1612 = tensor.expand_shape %3368 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1613 = tensor.extract_slice %expanded_1612[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3369 = iree_tensor_ext.bitcast %extracted_slice_1613 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1614 = tensor.extract_slice %expanded_1612[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3370 = iree_tensor_ext.bitcast %extracted_slice_1614 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3371 = tensor.empty() : tensor<5632x64x32xf16>
    %3372 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3369, %3370 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3371 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1615 = tensor.expand_shape %3367 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3373 = tensor.empty() : tensor<4x1x5632xf32>
    %3374 = linalg.fill ins(%cst_5 : f32) outs(%3373 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3375 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1615, %3372 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3374 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3376 = tensor.empty() : tensor<4x1x5632xf16>
    %3377 = linalg.copy ins(%3375 : tensor<4x1x5632xf32>) outs(%3376 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3378 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3377 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %3379 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3378, %3377 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3380 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1616 = tensor.expand_shape %3380 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1617 = tensor.extract_slice %expanded_1616[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3381 = iree_tensor_ext.bitcast %extracted_slice_1617 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1618 = tensor.extract_slice %expanded_1616[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3382 = iree_tensor_ext.bitcast %extracted_slice_1618 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3383 = tensor.empty() : tensor<5632x64x32xf16>
    %3384 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3381, %3382 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3383 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1619 = tensor.expand_shape %3367 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3385 = tensor.empty() : tensor<4x1x5632xf32>
    %3386 = linalg.fill ins(%cst_5 : f32) outs(%3385 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3387 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1619, %3384 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3386 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3388 = tensor.empty() : tensor<4x1x5632xf16>
    %3389 = linalg.copy ins(%3387 : tensor<4x1x5632xf32>) outs(%3388 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3390 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3379, %3389 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3391 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1620 = tensor.expand_shape %3391 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1621 = tensor.extract_slice %expanded_1620[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %3392 = iree_tensor_ext.bitcast %extracted_slice_1621 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1622 = tensor.extract_slice %expanded_1620[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %3393 = iree_tensor_ext.bitcast %extracted_slice_1622 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %3394 = tensor.empty() : tensor<2048x176x32xf16>
    %3395 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3392, %3393 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%3394 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1623 = tensor.expand_shape %3390 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %3396 = tensor.empty() : tensor<4x1x2048xf32>
    %3397 = linalg.fill ins(%cst_5 : f32) outs(%3396 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3398 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1623, %3395 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%3397 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3399 = tensor.empty() : tensor<4x1x2048xf16>
    %3400 = linalg.copy ins(%3398 : tensor<4x1x2048xf32>) outs(%3399 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3401 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3357, %3400 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3402 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3401 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3403 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3402 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3404 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3403 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3405 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3404 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3406 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3405 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3407 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3406 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3408 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3402, %3407 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3409 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3408 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3410 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.attn_norm.weight, %3409 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3411 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3410 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3412 = iree_tensor_ext.bitcast %__auto.blk.21.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1624 = tensor.expand_shape %3412 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1625 = tensor.extract_slice %expanded_1624[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3413 = iree_tensor_ext.bitcast %extracted_slice_1625 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1626 = tensor.extract_slice %expanded_1624[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3414 = iree_tensor_ext.bitcast %extracted_slice_1626 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %3415 = tensor.empty() : tensor<2048x64x32xf16>
    %3416 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3413, %3414 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3415 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1627 = tensor.expand_shape %3411 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3417 = tensor.empty() : tensor<4x1x2048xf32>
    %3418 = linalg.fill ins(%cst_5 : f32) outs(%3417 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3419 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1627, %3416 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%3418 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3420 = tensor.empty() : tensor<4x1x2048xf16>
    %3421 = linalg.copy ins(%3419 : tensor<4x1x2048xf32>) outs(%3420 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3422 = iree_tensor_ext.bitcast %__auto.blk.21.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1628 = tensor.expand_shape %3422 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1629 = tensor.extract_slice %expanded_1628[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3423 = iree_tensor_ext.bitcast %extracted_slice_1629 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1630 = tensor.extract_slice %expanded_1628[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3424 = iree_tensor_ext.bitcast %extracted_slice_1630 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %3425 = tensor.empty() : tensor<256x64x32xf16>
    %3426 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3423, %3424 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3425 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1631 = tensor.expand_shape %3411 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3427 = tensor.empty() : tensor<4x1x256xf32>
    %3428 = linalg.fill ins(%cst_5 : f32) outs(%3427 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %3429 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1631, %3426 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%3428 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %3430 = tensor.empty() : tensor<4x1x256xf16>
    %3431 = linalg.copy ins(%3429 : tensor<4x1x256xf32>) outs(%3430 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %3432 = iree_tensor_ext.bitcast %__auto.blk.21.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1632 = tensor.expand_shape %3432 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1633 = tensor.extract_slice %expanded_1632[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %3433 = iree_tensor_ext.bitcast %extracted_slice_1633 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1634 = tensor.extract_slice %expanded_1632[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %3434 = iree_tensor_ext.bitcast %extracted_slice_1634 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %3435 = tensor.empty() : tensor<256x64x32xf16>
    %3436 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3433, %3434 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%3435 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<256x64x32xf16>
    %expanded_1635 = tensor.expand_shape %3411 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3437 = tensor.empty() : tensor<4x1x256xf32>
    %3438 = linalg.fill ins(%cst_5 : f32) outs(%3437 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %3439 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1635, %3436 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%3438 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x256xf32>
    %3440 = tensor.empty() : tensor<4x1x256xf16>
    %3441 = linalg.copy ins(%3439 : tensor<4x1x256xf32>) outs(%3440 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1636 = tensor.expand_shape %3421 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1637 = tensor.expand_shape %3431 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1638 = tensor.expand_shape %3441 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %3442 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1639 = tensor.expand_shape %3442 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %3443 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1639 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %3444 = linalg.batch_matmul ins(%3443, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1640 = linalg.transpose ins(%3444 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %3445 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1640 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3446 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3445, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3447 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3446 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %3448 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1640 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3449 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3448, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3450 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3449 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1641 = tensor.expand_shape %3447 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1642 = tensor.expand_shape %3450 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1643 = tensor.extract_slice %expanded_1636[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1644 = tensor.extract_slice %expanded_1636[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %3451 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1643, %expanded_1641 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3452 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1644, %expanded_1642 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3453 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3451, %3452 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3454 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1644, %expanded_1641 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3455 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1643, %expanded_1642 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3456 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3454, %3455 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%88 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32x32xf16>
    %3457 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %3458 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3453, %3456 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%3457 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1645 = tensor.collapse_shape %3458 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %3459 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%72 : tensor<32xf32>) outs(%69 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %3584, "unimplemented: tensor with zero element"
      %3585 = arith.divf %cst_6, %in : f32
      linalg.yield %3585 : f32
    } -> tensor<32xf32>
    %expanded_1646 = tensor.expand_shape %3459 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %3460 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1646 : tensor<32x1xf32>) outs(%74 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %3461 = linalg.batch_matmul ins(%3460, %76 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%77 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1647 = linalg.transpose ins(%3461 : tensor<4x32x1xf32>) outs(%79 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %3462 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1647 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.cos %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3463 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3462, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3464 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3463 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %3465 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1647 : tensor<4x1x32xf32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.sin %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3466 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3465, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%79 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x32xf32>
    %3467 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3466 : tensor<4x1x32xf32>) outs(%82 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1648 = tensor.expand_shape %3464 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1649 = tensor.expand_shape %3467 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1650 = tensor.extract_slice %expanded_1637[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1651 = tensor.extract_slice %expanded_1637[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %3468 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1650, %expanded_1648 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3469 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1651, %expanded_1649 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3470 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3468, %3469 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.subf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3471 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1651, %expanded_1648 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3472 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1650, %expanded_1649 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3473 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%3471, %3472 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%106 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x4x32xf16>
    %3474 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %3475 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%3470, %3473 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%3474 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = linalg.index 3 : index
      %3585 = arith.cmpi eq, %3584, %c0 : index
      %3586 = arith.select %3585, %in, %in_1706 : f16
      linalg.yield %3586 : f16
    } -> tensor<4x1x4x2x32xf16>
    %3476 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_49 : tensor<4x1xi64>) outs(%117 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = linalg.index 0 : index
      %3585 = arith.index_cast %in : i64 to index
      %3586 = arith.cmpi slt, %3585, %dim_14 : index
      cf.assert %3586, "index must be smaller than dim size"
      %3587 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %3587, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%3584, %3585] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1652 = tensor.expand_shape %3476 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %3477 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1652 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c22_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3478 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3477 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.addi %in, %c21_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3479 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3478 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c2_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3480 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3479, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3481 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3480 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3482 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3481, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3483 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3482 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3484 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3483, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1653 = tensor.collapse_shape %3484 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1654 = tensor.expand_shape %collapsed_1653 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1655 = tensor.collapse_shape %3475 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %3485 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1655, %expanded_1654 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%3332 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %3486 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3479, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3487 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3486 : tensor<4x1x1xi64>) outs(%121 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c4_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x1xi64>
    %3488 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3487, %expanded_52 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3489 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3488 : tensor<4x1x4xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %3584 = arith.muli %in, %c32_i64 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %3490 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3489, %expanded_51 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%126 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1706: i64, %out: i64):
      %3584 = arith.addi %in, %in_1706 : i64
      linalg.yield %3584 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1656 = tensor.collapse_shape %3490 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1657 = tensor.expand_shape %collapsed_1656 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1658 = tensor.collapse_shape %expanded_1638 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %3491 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1658, %expanded_1657 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%3485 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim_1659 = tensor.dim %3491, %c0 : tensor<?x64xf16>
    %3492 = arith.divsi %dim_1659, %c5632 : index
    %expanded_1660 = tensor.expand_shape %3491 [[0, 1, 2, 3, 4], [5]] output_shape [%3492, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_1661 = tensor.collapse_shape %expanded_1660 [[0], [1, 2, 3, 4, 5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x360448xf16>
    %dim_1662 = tensor.dim %expanded_1660, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1663 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1664 = tensor.extract_slice %expanded_1660[0, %c21, %c0, 0, 0, 0] [%dim_1662, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3493 = tensor.empty(%dim_1663) : tensor<4x?x4x32x64xf16>
    %3494 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1664, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3493 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1665 = tensor.dim %expanded_1660, %c0 : tensor<?x22x2x4x32x64xf16>
    %dim_1666 = tensor.dim %8, %c1 : tensor<4x?xi64>
    %extracted_slice_1667 = tensor.extract_slice %expanded_1660[0, %c21, %c1, 0, 0, 0] [%dim_1665, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %3495 = tensor.empty(%dim_1666) : tensor<4x?x4x32x64xf16>
    %3496 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1667, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%3495 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %dim_1668 = tensor.dim %3494, %c1 : tensor<4x?x4x32x64xf16>
    %3497 = tensor.empty(%dim_1668) : tensor<4x?x32x4x64xf16>
    %transposed_1669 = linalg.transpose ins(%3494 : tensor<4x?x4x32x64xf16>) outs(%3497 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1670 = tensor.collapse_shape %transposed_1669 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %dim_1671 = tensor.dim %3496, %c1 : tensor<4x?x4x32x64xf16>
    %3498 = tensor.empty(%dim_1671) : tensor<4x?x32x4x64xf16>
    %transposed_1672 = linalg.transpose ins(%3496 : tensor<4x?x4x32x64xf16>) outs(%3498 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1673 = tensor.collapse_shape %transposed_1672 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %3499 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1670 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1674 = tensor.collapse_shape %3499 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %3500 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1673 : tensor<4x?x4x64xf16>) outs(%154 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1675 = tensor.collapse_shape %3500 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1676 = linalg.transpose ins(%collapsed_1645 : tensor<4x1x32x64xf16>) outs(%157 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %3501 = affine.apply #map32()[%dim_1668]
    %3502 = tensor.empty(%3501) : tensor<4x32x?x64xf16>
    %transposed_1677 = linalg.transpose ins(%collapsed_1674 : tensor<4x?x32x64xf16>) outs(%3502 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %3503 = affine.apply #map32()[%dim_1671]
    %3504 = tensor.empty(%3503) : tensor<4x32x?x64xf16>
    %transposed_1678 = linalg.transpose ins(%collapsed_1675 : tensor<4x?x32x64xf16>) outs(%3504 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1679 = tensor.collapse_shape %transposed_1676 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1680 = tensor.collapse_shape %transposed_1677 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1681 = tensor.collapse_shape %transposed_1678 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %3505 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1679, %collapsed_1680, %collapsed_1681, %cst, %collapsed_84 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%164 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1682 = tensor.expand_shape %3505 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1683 = linalg.transpose ins(%expanded_1682 : tensor<4x32x1x64xf16>) outs(%87 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1684 = tensor.collapse_shape %transposed_1683 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %3506 = iree_tensor_ext.bitcast %__auto.blk.21.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1685 = tensor.expand_shape %3506 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1686 = tensor.extract_slice %expanded_1685[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %3507 = iree_tensor_ext.bitcast %extracted_slice_1686 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1687 = tensor.extract_slice %expanded_1685[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %3508 = iree_tensor_ext.bitcast %extracted_slice_1687 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %3509 = tensor.empty() : tensor<2048x64x32xf16>
    %3510 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3507, %3508 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%3509 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1688 = tensor.expand_shape %collapsed_1684 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3511 = tensor.empty() : tensor<4x1x2048xf32>
    %3512 = linalg.fill ins(%cst_5 : f32) outs(%3511 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3513 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1688, %3510 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%3512 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3514 = tensor.empty() : tensor<4x1x2048xf16>
    %3515 = linalg.copy ins(%3513 : tensor<4x1x2048xf32>) outs(%3514 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3516 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3401, %3515 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3517 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3516 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3518 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3517 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3519 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3518 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3520 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3519 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3521 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3520 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3522 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3521 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3523 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3517, %3522 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3524 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3523 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3525 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.ffn_norm.weight, %3524 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3526 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3525 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3527 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1689 = tensor.expand_shape %3527 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1690 = tensor.extract_slice %expanded_1689[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3528 = iree_tensor_ext.bitcast %extracted_slice_1690 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1691 = tensor.extract_slice %expanded_1689[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3529 = iree_tensor_ext.bitcast %extracted_slice_1691 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3530 = tensor.empty() : tensor<5632x64x32xf16>
    %3531 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3528, %3529 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3530 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1692 = tensor.expand_shape %3526 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3532 = tensor.empty() : tensor<4x1x5632xf32>
    %3533 = linalg.fill ins(%cst_5 : f32) outs(%3532 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3534 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1692, %3531 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3533 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3535 = tensor.empty() : tensor<4x1x5632xf16>
    %3536 = linalg.copy ins(%3534 : tensor<4x1x5632xf32>) outs(%3535 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3537 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3536 : tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %3584 = arith.negf %in : f16
      %3585 = math.exp %3584 : f16
      %3586 = arith.addf %3585, %cst_7 : f16
      %3587 = arith.divf %cst_7, %3586 : f16
      linalg.yield %3587 : f16
    } -> tensor<4x1x5632xf16>
    %3538 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3537, %3536 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3539 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1693 = tensor.expand_shape %3539 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1694 = tensor.extract_slice %expanded_1693[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %3540 = iree_tensor_ext.bitcast %extracted_slice_1694 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1695 = tensor.extract_slice %expanded_1693[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %3541 = iree_tensor_ext.bitcast %extracted_slice_1695 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %3542 = tensor.empty() : tensor<5632x64x32xf16>
    %3543 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3540, %3541 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%3542 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1696 = tensor.expand_shape %3526 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3544 = tensor.empty() : tensor<4x1x5632xf32>
    %3545 = linalg.fill ins(%cst_5 : f32) outs(%3544 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %3546 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1696, %3543 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%3545 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x5632xf32>
    %3547 = tensor.empty() : tensor<4x1x5632xf16>
    %3548 = linalg.copy ins(%3546 : tensor<4x1x5632xf32>) outs(%3547 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %3549 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3538, %3548 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%197 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.mulf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x5632xf16>
    %3550 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1697 = tensor.expand_shape %3550 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1698 = tensor.extract_slice %expanded_1697[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %3551 = iree_tensor_ext.bitcast %extracted_slice_1698 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1699 = tensor.extract_slice %expanded_1697[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %3552 = iree_tensor_ext.bitcast %extracted_slice_1699 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %3553 = tensor.empty() : tensor<2048x176x32xf16>
    %3554 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3551, %3552 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%3553 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1700 = tensor.expand_shape %3549 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %3555 = tensor.empty() : tensor<4x1x2048xf32>
    %3556 = linalg.fill ins(%cst_5 : f32) outs(%3555 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %3557 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1700, %3554 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%3556 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x2048xf32>
    %3558 = tensor.empty() : tensor<4x1x2048xf16>
    %3559 = linalg.copy ins(%3557 : tensor<4x1x2048xf32>) outs(%3558 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %3560 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3516, %3559 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f16):
      %3584 = arith.addf %in, %in_1706 : f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3561 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3560 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %3584 = arith.extf %in : f16 to f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3562 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3561 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3563 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%3562 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %out : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3564 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3563 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.divf %in, %cst_8 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3565 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3564 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = arith.addf %in, %cst_9 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3566 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3565 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %3584 = math.rsqrt %in : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x1xf32>
    %3567 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3561, %3566 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f32, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f32
      linalg.yield %3584 : f32
    } -> tensor<4x1x2048xf32>
    %3568 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3567 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3569 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.output_norm.weight, %3568 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1706: f16, %out: f32):
      %3584 = arith.extf %in_1706 : f16 to f32
      %3585 = arith.mulf %in, %3584 : f32
      linalg.yield %3585 : f32
    } -> tensor<4x1x2048xf32>
    %3570 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3569 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %3584 = arith.truncf %in : f32 to f16
      linalg.yield %3584 : f16
    } -> tensor<4x1x2048xf16>
    %3571 = iree_tensor_ext.bitcast %__auto.output.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded_1701 = tensor.expand_shape %3571 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice_1702 = tensor.extract_slice %expanded_1701[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %3572 = iree_tensor_ext.bitcast %extracted_slice_1702 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_1703 = tensor.extract_slice %expanded_1701[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %3573 = iree_tensor_ext.bitcast %extracted_slice_1703 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %3574 = tensor.empty() : tensor<32000x64x32xf16>
    %3575 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%3572, %3573 : tensor<32000x64x1xf16>, tensor<32000x64x32xi8>) outs(%3574 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1706: i8, %out: f16):
      %3584 = arith.extsi %in_1706 : i8 to i32
      %3585 = arith.sitofp %3584 : i32 to f16
      %3586 = arith.mulf %3585, %in : f16
      linalg.yield %3586 : f16
    } -> tensor<32000x64x32xf16>
    %expanded_1704 = tensor.expand_shape %3570 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %3576 = tensor.empty() : tensor<4x1x32000xf32>
    %3577 = linalg.fill ins(%cst_5 : f32) outs(%3576 : tensor<4x1x32000xf32>) -> tensor<4x1x32000xf32>
    %3578 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1704, %3575 : tensor<4x1x64x32xf16>, tensor<32000x64x32xf16>) outs(%3577 : tensor<4x1x32000xf32>) {
    ^bb0(%in: f16, %in_1706: f16, %out: f32):
      %3584 = arith.mulf %in, %in_1706 : f16
      %3585 = arith.extf %3584 : f16 to f32
      %3586 = arith.addf %3585, %out : f32
      linalg.yield %3586 : f32
    } -> tensor<4x1x32000xf32>
    %3579 = tensor.empty() : tensor<4x1x32000xf16>
    %3580 = linalg.copy ins(%3578 : tensor<4x1x32000xf32>) outs(%3579 : tensor<4x1x32000xf16>) -> tensor<4x1x32000xf16>
    %dim_1705 = tensor.dim %collapsed_1661, %c0 : tensor<?x360448xf16>
    %3581 = hal.tensor.alias on(#hal.device.promise<@__device_0>) wait(%arg5) => %collapsed_1661 : tensor<?x360448xf16>{%dim_1705} to %arg4 : !hal.buffer_view
    %3582:2 = hal.tensor.barrier join(%3581, %3580 : tensor<?x360448xf16>, tensor<4x1x32000xf16>) => %arg6 : !hal.fence
    %3583 = hal.tensor.export %3582#1 : tensor<4x1x32000xf16> -> !hal.buffer_view
    util.return %3583 : !hal.buffer_view
  }
  util.func public @decode_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @decode_bs4$async(%arg0, %arg1, %arg2, %arg3, %arg4, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
}
