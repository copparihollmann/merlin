#map = affine_map<(d0, d1, d2) -> (d0, d1, d2)>
#map1 = affine_map<(d0, d1, d2) -> (d0, d1, 0)>
#map2 = affine_map<(d0, d1, d2) -> (d0, d1)>
#map3 = affine_map<(d0, d1, d2) -> (d2)>
#map4 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d3, d4)>
#map5 = affine_map<(d0, d1, d2, d3, d4) -> (d2, d3, d4)>
#map6 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2)>
#map7 = affine_map<(d0) -> (d0)>
#map8 = affine_map<(d0, d1, d2) -> ()>
#map9 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, d3)>
#map10 = affine_map<(d0, d1, d2, d3) -> (0, d1, 0, d3)>
#map11 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d4)>
#map12 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d3, d4)>
#map13 = affine_map<(d0, d1) -> (d0, d1)>
#map14 = affine_map<()[s0] -> (s0 * 4)>
#map15 = affine_map<(d0, d1) -> (d1)>
#map16 = affine_map<(d0, d1) -> (d0, 0)>
#map17 = affine_map<(d0, d1, d2, d3) -> (d0, d1, 0, d3)>
#map18 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, 0)>
#map19 = affine_map<(d0, d1, d2, d3) -> (0, d1, d2, d3)>
#map20 = affine_map<() -> ()>
#map21 = affine_map<(d0, d1, d2, d3) -> ()>
#map22 = affine_map<(d0, d1, d2, d3) -> (d0, 0, d2, d3)>
#map23 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d3)>
#map24 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d4, d3)>
#map25 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d4, d2)>
#map26 = affine_map<(d0, d1, d2, d3, d4) -> ()>
#map27 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d4)>
#map28 = affine_map<(d0, d1) -> (0, d1)>
#map29 = affine_map<(d0, d1, d2) -> (d1, d2)>
#map30 = affine_map<(d0, d1, d2) -> (0, d1, d2)>
#map31 = affine_map<(d0, d1) -> ()>
#map32 = affine_map<()[s0] -> (s0 * 32)>
module @module {
  util.global private @__auto.token_embd.weight = #flow.parameter.named<"model"::"token_embd.weight"> : tensor<32000x2176xi8>
  util.global private @__auto.blk.0.attn_norm.weight = #flow.parameter.named<"model"::"blk.0.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.0.attn_q.weight = #flow.parameter.named<"model"::"blk.0.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.0.attn_k.weight = #flow.parameter.named<"model"::"blk.0.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.0.attn_v.weight = #flow.parameter.named<"model"::"blk.0.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.0.attn_output.weight = #flow.parameter.named<"model"::"blk.0.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.0.ffn_norm.weight = #flow.parameter.named<"model"::"blk.0.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.0.ffn_gate.weight = #flow.parameter.named<"model"::"blk.0.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.0.ffn_up.weight = #flow.parameter.named<"model"::"blk.0.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.0.ffn_down.weight = #flow.parameter.named<"model"::"blk.0.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.1.attn_norm.weight = #flow.parameter.named<"model"::"blk.1.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.1.attn_q.weight = #flow.parameter.named<"model"::"blk.1.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.1.attn_k.weight = #flow.parameter.named<"model"::"blk.1.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.1.attn_v.weight = #flow.parameter.named<"model"::"blk.1.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.1.attn_output.weight = #flow.parameter.named<"model"::"blk.1.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.1.ffn_norm.weight = #flow.parameter.named<"model"::"blk.1.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.1.ffn_gate.weight = #flow.parameter.named<"model"::"blk.1.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.1.ffn_up.weight = #flow.parameter.named<"model"::"blk.1.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.1.ffn_down.weight = #flow.parameter.named<"model"::"blk.1.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.2.attn_norm.weight = #flow.parameter.named<"model"::"blk.2.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.2.attn_q.weight = #flow.parameter.named<"model"::"blk.2.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.2.attn_k.weight = #flow.parameter.named<"model"::"blk.2.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.2.attn_v.weight = #flow.parameter.named<"model"::"blk.2.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.2.attn_output.weight = #flow.parameter.named<"model"::"blk.2.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.2.ffn_norm.weight = #flow.parameter.named<"model"::"blk.2.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.2.ffn_gate.weight = #flow.parameter.named<"model"::"blk.2.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.2.ffn_up.weight = #flow.parameter.named<"model"::"blk.2.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.2.ffn_down.weight = #flow.parameter.named<"model"::"blk.2.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.3.attn_norm.weight = #flow.parameter.named<"model"::"blk.3.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.3.attn_q.weight = #flow.parameter.named<"model"::"blk.3.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.3.attn_k.weight = #flow.parameter.named<"model"::"blk.3.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.3.attn_v.weight = #flow.parameter.named<"model"::"blk.3.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.3.attn_output.weight = #flow.parameter.named<"model"::"blk.3.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.3.ffn_norm.weight = #flow.parameter.named<"model"::"blk.3.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.3.ffn_gate.weight = #flow.parameter.named<"model"::"blk.3.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.3.ffn_up.weight = #flow.parameter.named<"model"::"blk.3.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.3.ffn_down.weight = #flow.parameter.named<"model"::"blk.3.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.4.attn_norm.weight = #flow.parameter.named<"model"::"blk.4.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.4.attn_q.weight = #flow.parameter.named<"model"::"blk.4.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.4.attn_k.weight = #flow.parameter.named<"model"::"blk.4.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.4.attn_v.weight = #flow.parameter.named<"model"::"blk.4.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.4.attn_output.weight = #flow.parameter.named<"model"::"blk.4.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.4.ffn_norm.weight = #flow.parameter.named<"model"::"blk.4.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.4.ffn_gate.weight = #flow.parameter.named<"model"::"blk.4.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.4.ffn_up.weight = #flow.parameter.named<"model"::"blk.4.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.4.ffn_down.weight = #flow.parameter.named<"model"::"blk.4.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.5.attn_norm.weight = #flow.parameter.named<"model"::"blk.5.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.5.attn_q.weight = #flow.parameter.named<"model"::"blk.5.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.5.attn_k.weight = #flow.parameter.named<"model"::"blk.5.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.5.attn_v.weight = #flow.parameter.named<"model"::"blk.5.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.5.attn_output.weight = #flow.parameter.named<"model"::"blk.5.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.5.ffn_norm.weight = #flow.parameter.named<"model"::"blk.5.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.5.ffn_gate.weight = #flow.parameter.named<"model"::"blk.5.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.5.ffn_up.weight = #flow.parameter.named<"model"::"blk.5.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.5.ffn_down.weight = #flow.parameter.named<"model"::"blk.5.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.6.attn_norm.weight = #flow.parameter.named<"model"::"blk.6.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.6.attn_q.weight = #flow.parameter.named<"model"::"blk.6.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.6.attn_k.weight = #flow.parameter.named<"model"::"blk.6.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.6.attn_v.weight = #flow.parameter.named<"model"::"blk.6.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.6.attn_output.weight = #flow.parameter.named<"model"::"blk.6.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.6.ffn_norm.weight = #flow.parameter.named<"model"::"blk.6.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.6.ffn_gate.weight = #flow.parameter.named<"model"::"blk.6.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.6.ffn_up.weight = #flow.parameter.named<"model"::"blk.6.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.6.ffn_down.weight = #flow.parameter.named<"model"::"blk.6.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.7.attn_norm.weight = #flow.parameter.named<"model"::"blk.7.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.7.attn_q.weight = #flow.parameter.named<"model"::"blk.7.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.7.attn_k.weight = #flow.parameter.named<"model"::"blk.7.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.7.attn_v.weight = #flow.parameter.named<"model"::"blk.7.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.7.attn_output.weight = #flow.parameter.named<"model"::"blk.7.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.7.ffn_norm.weight = #flow.parameter.named<"model"::"blk.7.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.7.ffn_gate.weight = #flow.parameter.named<"model"::"blk.7.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.7.ffn_up.weight = #flow.parameter.named<"model"::"blk.7.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.7.ffn_down.weight = #flow.parameter.named<"model"::"blk.7.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.8.attn_norm.weight = #flow.parameter.named<"model"::"blk.8.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.8.attn_q.weight = #flow.parameter.named<"model"::"blk.8.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.8.attn_k.weight = #flow.parameter.named<"model"::"blk.8.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.8.attn_v.weight = #flow.parameter.named<"model"::"blk.8.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.8.attn_output.weight = #flow.parameter.named<"model"::"blk.8.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.8.ffn_norm.weight = #flow.parameter.named<"model"::"blk.8.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.8.ffn_gate.weight = #flow.parameter.named<"model"::"blk.8.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.8.ffn_up.weight = #flow.parameter.named<"model"::"blk.8.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.8.ffn_down.weight = #flow.parameter.named<"model"::"blk.8.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.9.attn_norm.weight = #flow.parameter.named<"model"::"blk.9.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.9.attn_q.weight = #flow.parameter.named<"model"::"blk.9.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.9.attn_k.weight = #flow.parameter.named<"model"::"blk.9.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.9.attn_v.weight = #flow.parameter.named<"model"::"blk.9.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.9.attn_output.weight = #flow.parameter.named<"model"::"blk.9.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.9.ffn_norm.weight = #flow.parameter.named<"model"::"blk.9.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.9.ffn_gate.weight = #flow.parameter.named<"model"::"blk.9.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.9.ffn_up.weight = #flow.parameter.named<"model"::"blk.9.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.9.ffn_down.weight = #flow.parameter.named<"model"::"blk.9.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.10.attn_norm.weight = #flow.parameter.named<"model"::"blk.10.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.10.attn_q.weight = #flow.parameter.named<"model"::"blk.10.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.10.attn_k.weight = #flow.parameter.named<"model"::"blk.10.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.10.attn_v.weight = #flow.parameter.named<"model"::"blk.10.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.10.attn_output.weight = #flow.parameter.named<"model"::"blk.10.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.10.ffn_norm.weight = #flow.parameter.named<"model"::"blk.10.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.10.ffn_gate.weight = #flow.parameter.named<"model"::"blk.10.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.10.ffn_up.weight = #flow.parameter.named<"model"::"blk.10.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.10.ffn_down.weight = #flow.parameter.named<"model"::"blk.10.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.11.attn_norm.weight = #flow.parameter.named<"model"::"blk.11.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.11.attn_q.weight = #flow.parameter.named<"model"::"blk.11.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.11.attn_k.weight = #flow.parameter.named<"model"::"blk.11.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.11.attn_v.weight = #flow.parameter.named<"model"::"blk.11.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.11.attn_output.weight = #flow.parameter.named<"model"::"blk.11.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.11.ffn_norm.weight = #flow.parameter.named<"model"::"blk.11.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.11.ffn_gate.weight = #flow.parameter.named<"model"::"blk.11.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.11.ffn_up.weight = #flow.parameter.named<"model"::"blk.11.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.11.ffn_down.weight = #flow.parameter.named<"model"::"blk.11.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.12.attn_norm.weight = #flow.parameter.named<"model"::"blk.12.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.12.attn_q.weight = #flow.parameter.named<"model"::"blk.12.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.12.attn_k.weight = #flow.parameter.named<"model"::"blk.12.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.12.attn_v.weight = #flow.parameter.named<"model"::"blk.12.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.12.attn_output.weight = #flow.parameter.named<"model"::"blk.12.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.12.ffn_norm.weight = #flow.parameter.named<"model"::"blk.12.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.12.ffn_gate.weight = #flow.parameter.named<"model"::"blk.12.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.12.ffn_up.weight = #flow.parameter.named<"model"::"blk.12.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.12.ffn_down.weight = #flow.parameter.named<"model"::"blk.12.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.13.attn_norm.weight = #flow.parameter.named<"model"::"blk.13.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.13.attn_q.weight = #flow.parameter.named<"model"::"blk.13.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.13.attn_k.weight = #flow.parameter.named<"model"::"blk.13.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.13.attn_v.weight = #flow.parameter.named<"model"::"blk.13.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.13.attn_output.weight = #flow.parameter.named<"model"::"blk.13.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.13.ffn_norm.weight = #flow.parameter.named<"model"::"blk.13.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.13.ffn_gate.weight = #flow.parameter.named<"model"::"blk.13.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.13.ffn_up.weight = #flow.parameter.named<"model"::"blk.13.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.13.ffn_down.weight = #flow.parameter.named<"model"::"blk.13.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.14.attn_norm.weight = #flow.parameter.named<"model"::"blk.14.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.14.attn_q.weight = #flow.parameter.named<"model"::"blk.14.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.14.attn_k.weight = #flow.parameter.named<"model"::"blk.14.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.14.attn_v.weight = #flow.parameter.named<"model"::"blk.14.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.14.attn_output.weight = #flow.parameter.named<"model"::"blk.14.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.14.ffn_norm.weight = #flow.parameter.named<"model"::"blk.14.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.14.ffn_gate.weight = #flow.parameter.named<"model"::"blk.14.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.14.ffn_up.weight = #flow.parameter.named<"model"::"blk.14.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.14.ffn_down.weight = #flow.parameter.named<"model"::"blk.14.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.15.attn_norm.weight = #flow.parameter.named<"model"::"blk.15.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.15.attn_q.weight = #flow.parameter.named<"model"::"blk.15.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.15.attn_k.weight = #flow.parameter.named<"model"::"blk.15.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.15.attn_v.weight = #flow.parameter.named<"model"::"blk.15.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.15.attn_output.weight = #flow.parameter.named<"model"::"blk.15.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.15.ffn_norm.weight = #flow.parameter.named<"model"::"blk.15.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.15.ffn_gate.weight = #flow.parameter.named<"model"::"blk.15.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.15.ffn_up.weight = #flow.parameter.named<"model"::"blk.15.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.15.ffn_down.weight = #flow.parameter.named<"model"::"blk.15.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.16.attn_norm.weight = #flow.parameter.named<"model"::"blk.16.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.16.attn_q.weight = #flow.parameter.named<"model"::"blk.16.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.16.attn_k.weight = #flow.parameter.named<"model"::"blk.16.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.16.attn_v.weight = #flow.parameter.named<"model"::"blk.16.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.16.attn_output.weight = #flow.parameter.named<"model"::"blk.16.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.16.ffn_norm.weight = #flow.parameter.named<"model"::"blk.16.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.16.ffn_gate.weight = #flow.parameter.named<"model"::"blk.16.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.16.ffn_up.weight = #flow.parameter.named<"model"::"blk.16.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.16.ffn_down.weight = #flow.parameter.named<"model"::"blk.16.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.17.attn_norm.weight = #flow.parameter.named<"model"::"blk.17.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.17.attn_q.weight = #flow.parameter.named<"model"::"blk.17.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.17.attn_k.weight = #flow.parameter.named<"model"::"blk.17.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.17.attn_v.weight = #flow.parameter.named<"model"::"blk.17.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.17.attn_output.weight = #flow.parameter.named<"model"::"blk.17.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.17.ffn_norm.weight = #flow.parameter.named<"model"::"blk.17.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.17.ffn_gate.weight = #flow.parameter.named<"model"::"blk.17.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.17.ffn_up.weight = #flow.parameter.named<"model"::"blk.17.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.17.ffn_down.weight = #flow.parameter.named<"model"::"blk.17.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.18.attn_norm.weight = #flow.parameter.named<"model"::"blk.18.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.18.attn_q.weight = #flow.parameter.named<"model"::"blk.18.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.18.attn_k.weight = #flow.parameter.named<"model"::"blk.18.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.18.attn_v.weight = #flow.parameter.named<"model"::"blk.18.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.18.attn_output.weight = #flow.parameter.named<"model"::"blk.18.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.18.ffn_norm.weight = #flow.parameter.named<"model"::"blk.18.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.18.ffn_gate.weight = #flow.parameter.named<"model"::"blk.18.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.18.ffn_up.weight = #flow.parameter.named<"model"::"blk.18.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.18.ffn_down.weight = #flow.parameter.named<"model"::"blk.18.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.19.attn_norm.weight = #flow.parameter.named<"model"::"blk.19.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.19.attn_q.weight = #flow.parameter.named<"model"::"blk.19.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.19.attn_k.weight = #flow.parameter.named<"model"::"blk.19.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.19.attn_v.weight = #flow.parameter.named<"model"::"blk.19.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.19.attn_output.weight = #flow.parameter.named<"model"::"blk.19.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.19.ffn_norm.weight = #flow.parameter.named<"model"::"blk.19.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.19.ffn_gate.weight = #flow.parameter.named<"model"::"blk.19.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.19.ffn_up.weight = #flow.parameter.named<"model"::"blk.19.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.19.ffn_down.weight = #flow.parameter.named<"model"::"blk.19.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.20.attn_norm.weight = #flow.parameter.named<"model"::"blk.20.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.20.attn_q.weight = #flow.parameter.named<"model"::"blk.20.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.20.attn_k.weight = #flow.parameter.named<"model"::"blk.20.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.20.attn_v.weight = #flow.parameter.named<"model"::"blk.20.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.20.attn_output.weight = #flow.parameter.named<"model"::"blk.20.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.20.ffn_norm.weight = #flow.parameter.named<"model"::"blk.20.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.20.ffn_gate.weight = #flow.parameter.named<"model"::"blk.20.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.20.ffn_up.weight = #flow.parameter.named<"model"::"blk.20.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.20.ffn_down.weight = #flow.parameter.named<"model"::"blk.20.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.blk.21.attn_norm.weight = #flow.parameter.named<"model"::"blk.21.attn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.21.attn_q.weight = #flow.parameter.named<"model"::"blk.21.attn_q.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.21.attn_k.weight = #flow.parameter.named<"model"::"blk.21.attn_k.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.21.attn_v.weight = #flow.parameter.named<"model"::"blk.21.attn_v.weight"> : tensor<256x2176xi8>
  util.global private @__auto.blk.21.attn_output.weight = #flow.parameter.named<"model"::"blk.21.attn_output.weight"> : tensor<2048x2176xi8>
  util.global private @__auto.blk.21.ffn_norm.weight = #flow.parameter.named<"model"::"blk.21.ffn_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.blk.21.ffn_gate.weight = #flow.parameter.named<"model"::"blk.21.ffn_gate.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.21.ffn_up.weight = #flow.parameter.named<"model"::"blk.21.ffn_up.weight"> : tensor<5632x2176xi8>
  util.global private @__auto.blk.21.ffn_down.weight = #flow.parameter.named<"model"::"blk.21.ffn_down.weight"> : tensor<2048x5984xi8>
  util.global private @__auto.output_norm.weight = #flow.parameter.named<"model"::"output_norm.weight"> : tensor<2048xf32>
  util.global private @__auto.output.weight = #flow.parameter.named<"model"::"output.weight"> : tensor<32000x2176xi8>
  util.func public @prefill_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.fence, %arg5: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %cst = arith.constant 1.250000e-01 : f16
    %c2 = arith.constant 2 : index
    %cst_0 = arith.constant dense<0> : tensor<i64>
    %c21_i64 = arith.constant 21 : i64
    %c20_i64 = arith.constant 20 : i64
    %c19_i64 = arith.constant 19 : i64
    %c18_i64 = arith.constant 18 : i64
    %c16_i64 = arith.constant 16 : i64
    %c15_i64 = arith.constant 15 : i64
    %c14_i64 = arith.constant 14 : i64
    %c13_i64 = arith.constant 13 : i64
    %c12_i64 = arith.constant 12 : i64
    %c11_i64 = arith.constant 11 : i64
    %c10_i64 = arith.constant 10 : i64
    %c9_i64 = arith.constant 9 : i64
    %c7_i64 = arith.constant 7 : i64
    %c8_i64 = arith.constant 8 : i64
    %c22_i64 = arith.constant 22 : i64
    %c3_i64 = arith.constant 3 : i64
    %c4_i64 = arith.constant 4 : i64
    %c6_i64 = arith.constant 6 : i64
    %c5_i64 = arith.constant 5 : i64
    %c17_i64 = arith.constant 17 : i64
    %c2_i64 = arith.constant 2 : i64
    %c0_i64 = arith.constant 0 : i64
    %c1_i64 = arith.constant 1 : i64
    %c32 = arith.constant 32 : index
    %c0 = arith.constant 0 : index
    %cst_1 = arith.constant dense<0xFC00> : tensor<f16>
    %cst_2 = arith.constant dense<1.000000e+00> : tensor<f32>
    %c1 = arith.constant 1 : index
    %c32000 = arith.constant 32000 : index
    %cst_3 = arith.constant 0.000000e+00 : f32
    %cst_4 = arith.constant 1.000000e+00 : f32
    %c44 = arith.constant 44 : index
    %cst_5 = arith.constant 1.000000e+00 : f16
    %cst_6 = arith.constant 2.048000e+03 : f32
    %cst_7 = arith.constant 9.99999974E-6 : f32
    %cst_8 = arith.constant 6.400000e+01 : f32
    %cst_9 = arith.constant 1.000000e+04 : f32
    %0 = hal.buffer_view.dim<%arg0 : !hal.buffer_view>[1] : index
    %1 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg0 : !hal.buffer_view -> tensor<4x?xi64>{%0}
    %2 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %3 = hal.buffer_view.dim<%arg2 : !hal.buffer_view>[1] : index
    %4 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg2 : !hal.buffer_view -> tensor<4x?xi64>{%3}
    %__auto.token_embd.weight = util.global.load @__auto.token_embd.weight : tensor<32000x2176xi8>
    %__auto.blk.0.attn_norm.weight = util.global.load @__auto.blk.0.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.attn_q.weight = util.global.load @__auto.blk.0.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.0.attn_k.weight = util.global.load @__auto.blk.0.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_v.weight = util.global.load @__auto.blk.0.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_output.weight = util.global.load @__auto.blk.0.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.0.ffn_norm.weight = util.global.load @__auto.blk.0.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.ffn_gate.weight = util.global.load @__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_up.weight = util.global.load @__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_down.weight = util.global.load @__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.1.attn_norm.weight = util.global.load @__auto.blk.1.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.attn_q.weight = util.global.load @__auto.blk.1.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.1.attn_k.weight = util.global.load @__auto.blk.1.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_v.weight = util.global.load @__auto.blk.1.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_output.weight = util.global.load @__auto.blk.1.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.1.ffn_norm.weight = util.global.load @__auto.blk.1.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.ffn_gate.weight = util.global.load @__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_up.weight = util.global.load @__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_down.weight = util.global.load @__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.2.attn_norm.weight = util.global.load @__auto.blk.2.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.attn_q.weight = util.global.load @__auto.blk.2.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.2.attn_k.weight = util.global.load @__auto.blk.2.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_v.weight = util.global.load @__auto.blk.2.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_output.weight = util.global.load @__auto.blk.2.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.2.ffn_norm.weight = util.global.load @__auto.blk.2.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.ffn_gate.weight = util.global.load @__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_up.weight = util.global.load @__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_down.weight = util.global.load @__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.3.attn_norm.weight = util.global.load @__auto.blk.3.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.attn_q.weight = util.global.load @__auto.blk.3.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.3.attn_k.weight = util.global.load @__auto.blk.3.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_v.weight = util.global.load @__auto.blk.3.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_output.weight = util.global.load @__auto.blk.3.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.3.ffn_norm.weight = util.global.load @__auto.blk.3.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.ffn_gate.weight = util.global.load @__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_up.weight = util.global.load @__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_down.weight = util.global.load @__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.4.attn_norm.weight = util.global.load @__auto.blk.4.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.attn_q.weight = util.global.load @__auto.blk.4.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.4.attn_k.weight = util.global.load @__auto.blk.4.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_v.weight = util.global.load @__auto.blk.4.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_output.weight = util.global.load @__auto.blk.4.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.4.ffn_norm.weight = util.global.load @__auto.blk.4.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.ffn_gate.weight = util.global.load @__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_up.weight = util.global.load @__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_down.weight = util.global.load @__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.5.attn_norm.weight = util.global.load @__auto.blk.5.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.attn_q.weight = util.global.load @__auto.blk.5.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.5.attn_k.weight = util.global.load @__auto.blk.5.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_v.weight = util.global.load @__auto.blk.5.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_output.weight = util.global.load @__auto.blk.5.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.5.ffn_norm.weight = util.global.load @__auto.blk.5.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.ffn_gate.weight = util.global.load @__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_up.weight = util.global.load @__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_down.weight = util.global.load @__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.6.attn_norm.weight = util.global.load @__auto.blk.6.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.attn_q.weight = util.global.load @__auto.blk.6.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.6.attn_k.weight = util.global.load @__auto.blk.6.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_v.weight = util.global.load @__auto.blk.6.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_output.weight = util.global.load @__auto.blk.6.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.6.ffn_norm.weight = util.global.load @__auto.blk.6.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.ffn_gate.weight = util.global.load @__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_up.weight = util.global.load @__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_down.weight = util.global.load @__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.7.attn_norm.weight = util.global.load @__auto.blk.7.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.attn_q.weight = util.global.load @__auto.blk.7.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.7.attn_k.weight = util.global.load @__auto.blk.7.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_v.weight = util.global.load @__auto.blk.7.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_output.weight = util.global.load @__auto.blk.7.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.7.ffn_norm.weight = util.global.load @__auto.blk.7.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.ffn_gate.weight = util.global.load @__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_up.weight = util.global.load @__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_down.weight = util.global.load @__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.8.attn_norm.weight = util.global.load @__auto.blk.8.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.attn_q.weight = util.global.load @__auto.blk.8.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.8.attn_k.weight = util.global.load @__auto.blk.8.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_v.weight = util.global.load @__auto.blk.8.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_output.weight = util.global.load @__auto.blk.8.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.8.ffn_norm.weight = util.global.load @__auto.blk.8.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.ffn_gate.weight = util.global.load @__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_up.weight = util.global.load @__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_down.weight = util.global.load @__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.9.attn_norm.weight = util.global.load @__auto.blk.9.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.attn_q.weight = util.global.load @__auto.blk.9.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.9.attn_k.weight = util.global.load @__auto.blk.9.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_v.weight = util.global.load @__auto.blk.9.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_output.weight = util.global.load @__auto.blk.9.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.9.ffn_norm.weight = util.global.load @__auto.blk.9.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.ffn_gate.weight = util.global.load @__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_up.weight = util.global.load @__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_down.weight = util.global.load @__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.10.attn_norm.weight = util.global.load @__auto.blk.10.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.attn_q.weight = util.global.load @__auto.blk.10.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.10.attn_k.weight = util.global.load @__auto.blk.10.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_v.weight = util.global.load @__auto.blk.10.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_output.weight = util.global.load @__auto.blk.10.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.10.ffn_norm.weight = util.global.load @__auto.blk.10.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.ffn_gate.weight = util.global.load @__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_up.weight = util.global.load @__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_down.weight = util.global.load @__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.11.attn_norm.weight = util.global.load @__auto.blk.11.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.attn_q.weight = util.global.load @__auto.blk.11.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.11.attn_k.weight = util.global.load @__auto.blk.11.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_v.weight = util.global.load @__auto.blk.11.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_output.weight = util.global.load @__auto.blk.11.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.11.ffn_norm.weight = util.global.load @__auto.blk.11.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.ffn_gate.weight = util.global.load @__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_up.weight = util.global.load @__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_down.weight = util.global.load @__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.12.attn_norm.weight = util.global.load @__auto.blk.12.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.attn_q.weight = util.global.load @__auto.blk.12.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.12.attn_k.weight = util.global.load @__auto.blk.12.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_v.weight = util.global.load @__auto.blk.12.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_output.weight = util.global.load @__auto.blk.12.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.12.ffn_norm.weight = util.global.load @__auto.blk.12.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.ffn_gate.weight = util.global.load @__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_up.weight = util.global.load @__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_down.weight = util.global.load @__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.13.attn_norm.weight = util.global.load @__auto.blk.13.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.attn_q.weight = util.global.load @__auto.blk.13.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.13.attn_k.weight = util.global.load @__auto.blk.13.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_v.weight = util.global.load @__auto.blk.13.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_output.weight = util.global.load @__auto.blk.13.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.13.ffn_norm.weight = util.global.load @__auto.blk.13.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.ffn_gate.weight = util.global.load @__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_up.weight = util.global.load @__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_down.weight = util.global.load @__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.14.attn_norm.weight = util.global.load @__auto.blk.14.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.attn_q.weight = util.global.load @__auto.blk.14.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.14.attn_k.weight = util.global.load @__auto.blk.14.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_v.weight = util.global.load @__auto.blk.14.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_output.weight = util.global.load @__auto.blk.14.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.14.ffn_norm.weight = util.global.load @__auto.blk.14.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.ffn_gate.weight = util.global.load @__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_up.weight = util.global.load @__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_down.weight = util.global.load @__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.15.attn_norm.weight = util.global.load @__auto.blk.15.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.attn_q.weight = util.global.load @__auto.blk.15.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.15.attn_k.weight = util.global.load @__auto.blk.15.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_v.weight = util.global.load @__auto.blk.15.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_output.weight = util.global.load @__auto.blk.15.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.15.ffn_norm.weight = util.global.load @__auto.blk.15.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.ffn_gate.weight = util.global.load @__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_up.weight = util.global.load @__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_down.weight = util.global.load @__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.16.attn_norm.weight = util.global.load @__auto.blk.16.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.attn_q.weight = util.global.load @__auto.blk.16.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.16.attn_k.weight = util.global.load @__auto.blk.16.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_v.weight = util.global.load @__auto.blk.16.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_output.weight = util.global.load @__auto.blk.16.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.16.ffn_norm.weight = util.global.load @__auto.blk.16.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.ffn_gate.weight = util.global.load @__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_up.weight = util.global.load @__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_down.weight = util.global.load @__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.17.attn_norm.weight = util.global.load @__auto.blk.17.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.attn_q.weight = util.global.load @__auto.blk.17.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.17.attn_k.weight = util.global.load @__auto.blk.17.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_v.weight = util.global.load @__auto.blk.17.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_output.weight = util.global.load @__auto.blk.17.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.17.ffn_norm.weight = util.global.load @__auto.blk.17.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.ffn_gate.weight = util.global.load @__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_up.weight = util.global.load @__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_down.weight = util.global.load @__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.18.attn_norm.weight = util.global.load @__auto.blk.18.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.attn_q.weight = util.global.load @__auto.blk.18.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.18.attn_k.weight = util.global.load @__auto.blk.18.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_v.weight = util.global.load @__auto.blk.18.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_output.weight = util.global.load @__auto.blk.18.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.18.ffn_norm.weight = util.global.load @__auto.blk.18.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.ffn_gate.weight = util.global.load @__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_up.weight = util.global.load @__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_down.weight = util.global.load @__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.19.attn_norm.weight = util.global.load @__auto.blk.19.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.attn_q.weight = util.global.load @__auto.blk.19.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.19.attn_k.weight = util.global.load @__auto.blk.19.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_v.weight = util.global.load @__auto.blk.19.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_output.weight = util.global.load @__auto.blk.19.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.19.ffn_norm.weight = util.global.load @__auto.blk.19.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.ffn_gate.weight = util.global.load @__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_up.weight = util.global.load @__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_down.weight = util.global.load @__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.20.attn_norm.weight = util.global.load @__auto.blk.20.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.attn_q.weight = util.global.load @__auto.blk.20.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.20.attn_k.weight = util.global.load @__auto.blk.20.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_v.weight = util.global.load @__auto.blk.20.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_output.weight = util.global.load @__auto.blk.20.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.20.ffn_norm.weight = util.global.load @__auto.blk.20.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.ffn_gate.weight = util.global.load @__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_up.weight = util.global.load @__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_down.weight = util.global.load @__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.21.attn_norm.weight = util.global.load @__auto.blk.21.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.attn_q.weight = util.global.load @__auto.blk.21.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.21.attn_k.weight = util.global.load @__auto.blk.21.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_v.weight = util.global.load @__auto.blk.21.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_output.weight = util.global.load @__auto.blk.21.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.21.ffn_norm.weight = util.global.load @__auto.blk.21.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.ffn_gate.weight = util.global.load @__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_up.weight = util.global.load @__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_down.weight = util.global.load @__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.output_norm.weight = util.global.load @__auto.output_norm.weight : tensor<2048xf32>
    %__auto.output.weight = util.global.load @__auto.output.weight : tensor<32000x2176xi8>
    %5 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[0] : index
    %6 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg4) => %arg3 : !hal.buffer_view -> tensor<?x360448xf16>{%5}
    %7 = arith.muli %3, %c32 : index
    %8 = util.assume.int %7<umin = 32, umax = 2016, udiv = 32> : index
    %9 = flow.tensor.tie_shape %1 : tensor<4x?xi64>{%8}
    %10 = util.assume.int %3<umin = 1, umax = 63> : index
    %11 = flow.tensor.tie_shape %4 : tensor<4x?xi64>{%10}
    %12 = util.assume.int %5<umin = 1, umax = 9007199254740991> : index
    %13 = flow.tensor.tie_shape %6 : tensor<?x360448xf16>{%12}
    %14 = iree_tensor_ext.bitcast %__auto.token_embd.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded = tensor.expand_shape %14 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice = tensor.extract_slice %expanded[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %15 = iree_tensor_ext.bitcast %extracted_slice : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_10 = tensor.extract_slice %expanded[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %16 = iree_tensor_ext.bitcast %extracted_slice_10 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %17 = tensor.empty() : tensor<32000x64x32xf16>
    %18 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%16 : tensor<32000x64x32xi8>) outs(%17 : tensor<32000x64x32xf16>) {
    ^bb0(%in: i8, %out: f16):
      %2495 = arith.sitofp %in : i8 to f16
      linalg.yield %2495 : f16
    } -> tensor<32000x64x32xf16>
    %19 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%15, %18 : tensor<32000x64x1xf16>, tensor<32000x64x32xf16>) outs(%17 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed = tensor.collapse_shape %19 [[0], [1, 2]] : tensor<32000x64x32xf16> into tensor<32000x2048xf16>
    %20 = tensor.empty(%8) : tensor<4x?x2048xf16>
    %21 = linalg.generic {indexing_maps = [#map2, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%9 : tensor<4x?xi64>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: i64, %out: f16):
      %2495 = arith.index_cast %in : i64 to index
      %2496 = linalg.index 2 : index
      %2497 = arith.cmpi slt, %2495, %c32000 : index
      cf.assert %2497, "index must be smaller than dim size"
      %2498 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2498, "index must be larger or equal to 0"
      %extracted = tensor.extract %collapsed[%2495, %2496] : tensor<32000x2048xf16>
      linalg.yield %extracted : f16
    } -> tensor<4x?x2048xf16>
    %22 = tensor.empty(%8) : tensor<4x?x2048xf32>
    %23 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%21 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %24 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%23 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %25 = tensor.empty(%8) : tensor<4x?x1xf32>
    %26 = linalg.fill ins(%cst_3 : f32) outs(%25 : tensor<4x?x1xf32>) -> tensor<4x?x1xf32>
    %27 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%24 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %28 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%27 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %29 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%28 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %30 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%29 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %31 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%23, %30 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %32 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%31 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %33 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.attn_norm.weight, %32 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %34 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%33 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %35 = iree_tensor_ext.bitcast %__auto.blk.0.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_11 = tensor.expand_shape %35 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_12 = tensor.extract_slice %expanded_11[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %36 = iree_tensor_ext.bitcast %extracted_slice_12 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_13 = tensor.extract_slice %expanded_11[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %37 = iree_tensor_ext.bitcast %extracted_slice_13 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %38 = tensor.empty() : tensor<2048x64x32xf16>
    %39 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%36, %37 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_14 = tensor.expand_shape %34 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %40 = linalg.fill ins(%cst_3 : f32) outs(%22 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %41 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_14, %39 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %42 = linalg.copy ins(%41 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %43 = iree_tensor_ext.bitcast %__auto.blk.0.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_15 = tensor.expand_shape %43 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_16 = tensor.extract_slice %expanded_15[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %44 = iree_tensor_ext.bitcast %extracted_slice_16 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_17 = tensor.extract_slice %expanded_15[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %45 = iree_tensor_ext.bitcast %extracted_slice_17 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %46 = tensor.empty() : tensor<256x64x32xf16>
    %47 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%44, %45 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %48 = tensor.empty(%8) : tensor<4x?x256xf32>
    %49 = linalg.fill ins(%cst_3 : f32) outs(%48 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %50 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_14, %47 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %51 = tensor.empty(%8) : tensor<4x?x256xf16>
    %52 = linalg.copy ins(%50 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %53 = iree_tensor_ext.bitcast %__auto.blk.0.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_18 = tensor.expand_shape %53 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_19 = tensor.extract_slice %expanded_18[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %54 = iree_tensor_ext.bitcast %extracted_slice_19 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_20 = tensor.extract_slice %expanded_18[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %55 = iree_tensor_ext.bitcast %extracted_slice_20 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %56 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%54, %55 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %57 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_14, %56 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %58 = linalg.copy ins(%57 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_21 = tensor.expand_shape %42 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_22 = tensor.expand_shape %52 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_23 = tensor.expand_shape %58 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %59 = tensor.empty(%8) : tensor<?xi64>
    %60 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%59 : tensor<?xi64>) {
    ^bb0(%out: i64):
      %2495 = linalg.index 0 : index
      %2496 = arith.index_cast %2495 : index to i64
      linalg.yield %2496 : i64
    } -> tensor<?xi64>
    %61 = tensor.empty() : tensor<32xi64>
    %62 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%61 : tensor<32xi64>) {
    ^bb0(%out: i64):
      %2495 = linalg.index 0 : index
      %2496 = arith.index_cast %2495 : index to i64
      %2497 = arith.muli %2496, %c2_i64 : i64
      linalg.yield %2497 : i64
    } -> tensor<32xi64>
    %63 = tensor.empty() : tensor<32xf32>
    %64 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%62 : tensor<32xi64>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: i64, %out: f32):
      %2495 = arith.sitofp %in : i64 to f32
      linalg.yield %2495 : f32
    } -> tensor<32xf32>
    %65 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%64 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_8 : f32
      linalg.yield %2495 : f32
    } -> tensor<32xf32>
    %66 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%65 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.powf %cst_9, %in : f32
      linalg.yield %2495 : f32
    } -> tensor<32xf32>
    %67 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_24 = tensor.expand_shape %67 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %expanded_25 = tensor.expand_shape %60 [[0, 1, 2]] output_shape [1, 1, %8] : tensor<?xi64> into tensor<1x1x?xi64>
    %68 = tensor.empty(%8) : tensor<1x1x?xf32>
    %69 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_25 : tensor<1x1x?xi64>) outs(%68 : tensor<1x1x?xf32>) {
    ^bb0(%in: i64, %out: f32):
      %2495 = arith.sitofp %in : i64 to f32
      linalg.yield %2495 : f32
    } -> tensor<1x1x?xf32>
    %70 = tensor.empty(%8) : tensor<1x32x?xf32>
    %71 = linalg.fill ins(%cst_3 : f32) outs(%70 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %72 = linalg.batch_matmul ins(%expanded_24, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %73 = tensor.empty(%8) : tensor<1x?x32xf32>
    %transposed = linalg.transpose ins(%72 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %74 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %75 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%74, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %76 = tensor.empty(%8) : tensor<1x?x32xf16>
    %77 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%75 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %78 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %79 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%78, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %80 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%79 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_26 = tensor.expand_shape %77 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_27 = tensor.expand_shape %80 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_28 = tensor.extract_slice %expanded_21[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_29 = tensor.extract_slice %expanded_21[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %81 = tensor.empty(%8) : tensor<4x?x32x32xf16>
    %82 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_28, %expanded_26 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %83 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_29, %expanded_27 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %84 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%82, %83 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %85 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_29, %expanded_26 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %86 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_28, %expanded_27 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %87 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%85, %86 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %88 = tensor.empty(%8) : tensor<4x?x32x2x32xf16>
    %89 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%84, %87 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_30 = tensor.collapse_shape %89 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %90 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_31 = tensor.expand_shape %90 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %91 = linalg.batch_matmul ins(%expanded_31, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_32 = linalg.transpose ins(%91 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %92 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_32 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %93 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%92, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %94 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%93 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %95 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_32 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %96 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%95, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %97 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%96 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_33 = tensor.expand_shape %94 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_34 = tensor.expand_shape %97 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_35 = tensor.extract_slice %expanded_22[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_36 = tensor.extract_slice %expanded_22[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %98 = tensor.empty(%8) : tensor<4x?x4x32xf16>
    %99 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_35, %expanded_33 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %100 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_36, %expanded_34 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %101 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%99, %100 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %102 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_36, %expanded_33 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %103 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_35, %expanded_34 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %104 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%102, %103 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %105 = tensor.empty(%8) : tensor<4x?x4x2x32xf16>
    %106 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%101, %104 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_37 = tensor.collapse_shape %106 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %expanded_38 = tensor.expand_shape %13 [[0], [1, 2, 3, 4, 5]] output_shape [%12, 22, 2, 4, 32, 64] : tensor<?x360448xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_39 = tensor.collapse_shape %expanded_38 [[0, 1, 2], [3], [4], [5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x4x32x64xf16>
    %107 = tensor.empty(%10) : tensor<4x?xi64>
    %108 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%11 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %109 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_40 = tensor.collapse_shape %109 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %110 = arith.divsi %8, %c32 : index
    %expanded_41 = tensor.expand_shape %collapsed_37 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_42 = tensor.collapse_shape %expanded_41 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %111 = affine.apply #map14()[%110]
    %112 = tensor.empty(%111) : tensor<?x4x32x64xf16>
    %transposed_43 = linalg.transpose ins(%collapsed_42 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %113 = affine.apply #map14()[%10]
    %expanded_44 = tensor.expand_shape %collapsed_40 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %114 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_43, %expanded_44 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%collapsed_39 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %115 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%109 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_45 = tensor.collapse_shape %115 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_46 = tensor.expand_shape %58 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_47 = tensor.collapse_shape %expanded_46 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_48 = linalg.transpose ins(%collapsed_47 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_49 = tensor.expand_shape %collapsed_45 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %116 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_48, %expanded_49 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%114 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %expanded_50 = tensor.expand_shape %2 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %117 = tensor.empty(%8) : tensor<4x?xi1>
    %118 = linalg.generic {indexing_maps = [#map15, #map16, #map13], iterator_types = ["parallel", "parallel"]} ins(%60, %expanded_50 : tensor<?xi64>, tensor<4x1xi64>) outs(%117 : tensor<4x?xi1>) {
    ^bb0(%in: i64, %in_1456: i64, %out: i1):
      %2495 = arith.cmpi sge, %in, %in_1456 : i64
      linalg.yield %2495 : i1
    } -> tensor<4x?xi1>
    %expanded_51 = tensor.expand_shape %60 [[0, 1, 2, 3]] output_shape [1, 1, 1, %8] : tensor<?xi64> into tensor<1x1x1x?xi64>
    %expanded_52 = tensor.expand_shape %60 [[0, 1, 2, 3]] output_shape [1, 1, %8, 1] : tensor<?xi64> into tensor<1x1x?x1xi64>
    %119 = tensor.empty(%8, %8) : tensor<1x1x?x?xi1>
    %120 = linalg.generic {indexing_maps = [#map17, #map18, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_51, %expanded_52 : tensor<1x1x1x?xi64>, tensor<1x1x?x1xi64>) outs(%119 : tensor<1x1x?x?xi1>) {
    ^bb0(%in: i64, %in_1456: i64, %out: i1):
      %2495 = arith.cmpi sgt, %in, %in_1456 : i64
      linalg.yield %2495 : i1
    } -> tensor<1x1x?x?xi1>
    %expanded_53 = tensor.expand_shape %118 [[0], [1, 2, 3]] output_shape [4, 1, 1, %8] : tensor<4x?xi1> into tensor<4x1x1x?xi1>
    %121 = tensor.empty(%8, %8) : tensor<4x1x?x?xi1>
    %122 = linalg.generic {indexing_maps = [#map19, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%120, %expanded_53 : tensor<1x1x?x?xi1>, tensor<4x1x1x?xi1>) outs(%121 : tensor<4x1x?x?xi1>) {
    ^bb0(%in: i1, %in_1456: i1, %out: i1):
      %2495 = arith.ori %in, %in_1456 : i1
      linalg.yield %2495 : i1
    } -> tensor<4x1x?x?xi1>
    %123 = tensor.empty() : tensor<f16>
    %124 = linalg.generic {indexing_maps = [#map20, #map20], iterator_types = []} ins(%cst_0 : tensor<i64>) outs(%123 : tensor<f16>) {
    ^bb0(%in: i64, %out: f16):
      %2495 = arith.sitofp %in : i64 to f16
      linalg.yield %2495 : f16
    } -> tensor<f16>
    %125 = tensor.empty(%8, %8) : tensor<4x1x?x?xf16>
    %126 = linalg.generic {indexing_maps = [#map9, #map21, #map21, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%122, %cst_1, %124 : tensor<4x1x?x?xi1>, tensor<f16>, tensor<f16>) outs(%125 : tensor<4x1x?x?xf16>) {
    ^bb0(%in: i1, %in_1456: f16, %in_1457: f16, %out: f16):
      %2495 = arith.select %in, %in_1456, %in_1457 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x1x?x?xf16>
    %127 = tensor.empty(%8) : tensor<4x?x4x8x64xf16>
    %128 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_37 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_54 = tensor.collapse_shape %128 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %129 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_23 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_55 = tensor.collapse_shape %129 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %130 = tensor.empty(%8) : tensor<4x32x?x64xf16>
    %transposed_56 = linalg.transpose ins(%collapsed_30 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_57 = linalg.transpose ins(%collapsed_54 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_58 = linalg.transpose ins(%collapsed_55 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %131 = tensor.empty(%8, %8) : tensor<4x32x?x?xf16>
    %132 = linalg.generic {indexing_maps = [#map22, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%126 : tensor<4x1x?x?xf16>) outs(%131 : tensor<4x32x?x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x32x?x?xf16>
    %collapsed_59 = tensor.collapse_shape %transposed_56 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_60 = tensor.collapse_shape %transposed_57 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_61 = tensor.collapse_shape %transposed_58 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_62 = tensor.collapse_shape %132 [[0, 1], [2], [3]] : tensor<4x32x?x?xf16> into tensor<128x?x?xf16>
    %133 = tensor.empty(%8) : tensor<128x?x64xf16>
    %134 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_59, %collapsed_60, %collapsed_61, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_63 = tensor.expand_shape %134 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim = tensor.dim %expanded_63, %c2 : tensor<4x32x?x64xf16>
    %135 = tensor.empty(%dim) : tensor<4x?x32x64xf16>
    %transposed_64 = linalg.transpose ins(%expanded_63 : tensor<4x32x?x64xf16>) outs(%135 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_65 = tensor.collapse_shape %transposed_64 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %136 = iree_tensor_ext.bitcast %__auto.blk.0.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_66 = tensor.expand_shape %136 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_67 = tensor.extract_slice %expanded_66[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %137 = iree_tensor_ext.bitcast %extracted_slice_67 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_68 = tensor.extract_slice %expanded_66[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %138 = iree_tensor_ext.bitcast %extracted_slice_68 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_69 = tensor.dim %collapsed_65, %c1 : tensor<4x?x2048xf16>
    %139 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%137, %138 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_70 = tensor.expand_shape %collapsed_65 [[0], [1], [2, 3]] output_shape [4, %dim_69, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %140 = tensor.empty(%dim_69) : tensor<4x?x2048xf32>
    %141 = linalg.fill ins(%cst_3 : f32) outs(%140 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %142 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_70, %139 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%141 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %143 = tensor.empty(%dim_69) : tensor<4x?x2048xf16>
    %144 = linalg.copy ins(%142 : tensor<4x?x2048xf32>) outs(%143 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %145 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%21, %144 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %146 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%145 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %147 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%146 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %148 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%147 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %149 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%148 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %150 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%149 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %151 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%150 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %152 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%146, %151 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %153 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%152 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %154 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.ffn_norm.weight, %153 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %155 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%154 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %156 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_71 = tensor.expand_shape %156 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_72 = tensor.extract_slice %expanded_71[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %157 = iree_tensor_ext.bitcast %extracted_slice_72 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_73 = tensor.extract_slice %expanded_71[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %158 = iree_tensor_ext.bitcast %extracted_slice_73 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %159 = tensor.empty() : tensor<5632x64x32xf16>
    %160 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%157, %158 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_74 = tensor.expand_shape %155 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %161 = tensor.empty(%8) : tensor<4x?x5632xf32>
    %162 = linalg.fill ins(%cst_3 : f32) outs(%161 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %163 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_74, %160 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %164 = tensor.empty(%8) : tensor<4x?x5632xf16>
    %165 = linalg.copy ins(%163 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %166 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%165 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %167 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%166, %165 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %168 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_75 = tensor.expand_shape %168 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_76 = tensor.extract_slice %expanded_75[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %169 = iree_tensor_ext.bitcast %extracted_slice_76 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_77 = tensor.extract_slice %expanded_75[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %170 = iree_tensor_ext.bitcast %extracted_slice_77 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %171 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%169, %170 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %172 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_74, %171 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %173 = linalg.copy ins(%172 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %174 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%167, %173 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %175 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_78 = tensor.expand_shape %175 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_79 = tensor.extract_slice %expanded_78[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %176 = iree_tensor_ext.bitcast %extracted_slice_79 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_80 = tensor.extract_slice %expanded_78[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %177 = iree_tensor_ext.bitcast %extracted_slice_80 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %178 = tensor.empty() : tensor<2048x176x32xf16>
    %179 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%176, %177 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_81 = tensor.expand_shape %174 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %180 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_81, %179 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %181 = linalg.copy ins(%180 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %182 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%145, %181 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %183 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%182 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %184 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%183 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %185 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%184 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %186 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%185 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %187 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%186 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %188 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%187 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %189 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%183, %188 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %190 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%189 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %191 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.attn_norm.weight, %190 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %192 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%191 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %193 = iree_tensor_ext.bitcast %__auto.blk.1.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_82 = tensor.expand_shape %193 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_83 = tensor.extract_slice %expanded_82[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %194 = iree_tensor_ext.bitcast %extracted_slice_83 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_84 = tensor.extract_slice %expanded_82[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %195 = iree_tensor_ext.bitcast %extracted_slice_84 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %196 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%194, %195 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_85 = tensor.expand_shape %192 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %197 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_85, %196 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %198 = linalg.copy ins(%197 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %199 = iree_tensor_ext.bitcast %__auto.blk.1.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_86 = tensor.expand_shape %199 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_87 = tensor.extract_slice %expanded_86[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %200 = iree_tensor_ext.bitcast %extracted_slice_87 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_88 = tensor.extract_slice %expanded_86[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %201 = iree_tensor_ext.bitcast %extracted_slice_88 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %202 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%200, %201 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %203 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_85, %202 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %204 = linalg.copy ins(%203 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %205 = iree_tensor_ext.bitcast %__auto.blk.1.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_89 = tensor.expand_shape %205 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_90 = tensor.extract_slice %expanded_89[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %206 = iree_tensor_ext.bitcast %extracted_slice_90 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_91 = tensor.extract_slice %expanded_89[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %207 = iree_tensor_ext.bitcast %extracted_slice_91 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %208 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%206, %207 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %209 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_85, %208 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %210 = linalg.copy ins(%209 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_92 = tensor.expand_shape %198 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_93 = tensor.expand_shape %204 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_94 = tensor.expand_shape %210 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %211 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_95 = tensor.expand_shape %211 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %212 = linalg.batch_matmul ins(%expanded_95, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_96 = linalg.transpose ins(%212 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %213 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_96 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %214 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%213, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %215 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%214 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %216 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_96 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %217 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%216, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %218 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%217 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_97 = tensor.expand_shape %215 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_98 = tensor.expand_shape %218 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_99 = tensor.extract_slice %expanded_92[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_100 = tensor.extract_slice %expanded_92[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %219 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_99, %expanded_97 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %220 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_100, %expanded_98 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %221 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%219, %220 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %222 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_100, %expanded_97 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %223 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_99, %expanded_98 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %224 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%222, %223 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %225 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%221, %224 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_101 = tensor.collapse_shape %225 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %226 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_102 = tensor.expand_shape %226 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %227 = linalg.batch_matmul ins(%expanded_102, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_103 = linalg.transpose ins(%227 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %228 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_103 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %229 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%228, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %230 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%229 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %231 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_103 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %232 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%231, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %233 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%232 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_104 = tensor.expand_shape %230 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_105 = tensor.expand_shape %233 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_106 = tensor.extract_slice %expanded_93[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_107 = tensor.extract_slice %expanded_93[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %234 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_106, %expanded_104 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %235 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_107, %expanded_105 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %236 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%234, %235 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %237 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_107, %expanded_104 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %238 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_106, %expanded_105 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %239 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%237, %238 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %240 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%236, %239 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_108 = tensor.collapse_shape %240 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %241 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %242 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%241 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_109 = tensor.collapse_shape %242 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_110 = tensor.expand_shape %collapsed_108 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_111 = tensor.collapse_shape %expanded_110 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_112 = linalg.transpose ins(%collapsed_111 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_113 = tensor.expand_shape %collapsed_109 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %243 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_112, %expanded_113 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%116 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %244 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%242 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_114 = tensor.collapse_shape %244 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_115 = tensor.expand_shape %210 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_116 = tensor.collapse_shape %expanded_115 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_117 = linalg.transpose ins(%collapsed_116 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_118 = tensor.expand_shape %collapsed_114 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %245 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_117, %expanded_118 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%243 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %246 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_108 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_119 = tensor.collapse_shape %246 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %247 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_94 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_120 = tensor.collapse_shape %247 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_121 = linalg.transpose ins(%collapsed_101 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_122 = linalg.transpose ins(%collapsed_119 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_123 = linalg.transpose ins(%collapsed_120 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_124 = tensor.collapse_shape %transposed_121 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_125 = tensor.collapse_shape %transposed_122 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_126 = tensor.collapse_shape %transposed_123 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %248 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_124, %collapsed_125, %collapsed_126, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_127 = tensor.expand_shape %248 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_128 = tensor.dim %expanded_127, %c2 : tensor<4x32x?x64xf16>
    %249 = tensor.empty(%dim_128) : tensor<4x?x32x64xf16>
    %transposed_129 = linalg.transpose ins(%expanded_127 : tensor<4x32x?x64xf16>) outs(%249 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_130 = tensor.collapse_shape %transposed_129 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %250 = iree_tensor_ext.bitcast %__auto.blk.1.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_131 = tensor.expand_shape %250 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_132 = tensor.extract_slice %expanded_131[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %251 = iree_tensor_ext.bitcast %extracted_slice_132 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_133 = tensor.extract_slice %expanded_131[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %252 = iree_tensor_ext.bitcast %extracted_slice_133 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_134 = tensor.dim %collapsed_130, %c1 : tensor<4x?x2048xf16>
    %253 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%251, %252 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_135 = tensor.expand_shape %collapsed_130 [[0], [1], [2, 3]] output_shape [4, %dim_134, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %254 = tensor.empty(%dim_134) : tensor<4x?x2048xf32>
    %255 = linalg.fill ins(%cst_3 : f32) outs(%254 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %256 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_135, %253 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%255 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %257 = tensor.empty(%dim_134) : tensor<4x?x2048xf16>
    %258 = linalg.copy ins(%256 : tensor<4x?x2048xf32>) outs(%257 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %259 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%182, %258 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %260 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%259 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %261 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%260 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %262 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%261 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %263 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%262 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %264 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%263 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %265 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%264 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %266 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%260, %265 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %267 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%266 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %268 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.ffn_norm.weight, %267 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %269 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%268 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %270 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_136 = tensor.expand_shape %270 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_137 = tensor.extract_slice %expanded_136[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %271 = iree_tensor_ext.bitcast %extracted_slice_137 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_138 = tensor.extract_slice %expanded_136[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %272 = iree_tensor_ext.bitcast %extracted_slice_138 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %273 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%271, %272 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_139 = tensor.expand_shape %269 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %274 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_139, %273 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %275 = linalg.copy ins(%274 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %276 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%275 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %277 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%276, %275 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %278 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_140 = tensor.expand_shape %278 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_141 = tensor.extract_slice %expanded_140[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %279 = iree_tensor_ext.bitcast %extracted_slice_141 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_142 = tensor.extract_slice %expanded_140[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %280 = iree_tensor_ext.bitcast %extracted_slice_142 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %281 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%279, %280 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %282 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_139, %281 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %283 = linalg.copy ins(%282 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %284 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%277, %283 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %285 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_143 = tensor.expand_shape %285 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_144 = tensor.extract_slice %expanded_143[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %286 = iree_tensor_ext.bitcast %extracted_slice_144 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_145 = tensor.extract_slice %expanded_143[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %287 = iree_tensor_ext.bitcast %extracted_slice_145 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %288 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%286, %287 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_146 = tensor.expand_shape %284 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %289 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_146, %288 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %290 = linalg.copy ins(%289 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %291 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%259, %290 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%291 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %293 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%292 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %294 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%293 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %295 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%294 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %296 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%295 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %297 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%296 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %298 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%292, %297 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %299 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%298 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %300 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.attn_norm.weight, %299 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %301 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%300 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %302 = iree_tensor_ext.bitcast %__auto.blk.2.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_147 = tensor.expand_shape %302 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_148 = tensor.extract_slice %expanded_147[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %303 = iree_tensor_ext.bitcast %extracted_slice_148 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_149 = tensor.extract_slice %expanded_147[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %304 = iree_tensor_ext.bitcast %extracted_slice_149 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %305 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%303, %304 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_150 = tensor.expand_shape %301 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %306 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_150, %305 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %307 = linalg.copy ins(%306 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %308 = iree_tensor_ext.bitcast %__auto.blk.2.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_151 = tensor.expand_shape %308 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_152 = tensor.extract_slice %expanded_151[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %309 = iree_tensor_ext.bitcast %extracted_slice_152 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_153 = tensor.extract_slice %expanded_151[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %310 = iree_tensor_ext.bitcast %extracted_slice_153 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %311 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%309, %310 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %312 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_150, %311 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %313 = linalg.copy ins(%312 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %314 = iree_tensor_ext.bitcast %__auto.blk.2.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_154 = tensor.expand_shape %314 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_155 = tensor.extract_slice %expanded_154[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %315 = iree_tensor_ext.bitcast %extracted_slice_155 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_156 = tensor.extract_slice %expanded_154[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %316 = iree_tensor_ext.bitcast %extracted_slice_156 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %317 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%315, %316 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %318 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_150, %317 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %319 = linalg.copy ins(%318 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_157 = tensor.expand_shape %307 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_158 = tensor.expand_shape %313 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_159 = tensor.expand_shape %319 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %320 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_160 = tensor.expand_shape %320 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %321 = linalg.batch_matmul ins(%expanded_160, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_161 = linalg.transpose ins(%321 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %322 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_161 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %323 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%322, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %324 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%323 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %325 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_161 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %326 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%325, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %327 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%326 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_162 = tensor.expand_shape %324 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_163 = tensor.expand_shape %327 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_164 = tensor.extract_slice %expanded_157[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_165 = tensor.extract_slice %expanded_157[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %328 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_164, %expanded_162 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %329 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_165, %expanded_163 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %330 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%328, %329 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %331 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_165, %expanded_162 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %332 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_164, %expanded_163 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %333 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%331, %332 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %334 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%330, %333 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_166 = tensor.collapse_shape %334 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %335 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_167 = tensor.expand_shape %335 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %336 = linalg.batch_matmul ins(%expanded_167, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_168 = linalg.transpose ins(%336 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %337 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_168 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %338 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%337, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %339 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%338 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_168 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %341 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%340, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %342 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%341 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_169 = tensor.expand_shape %339 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_170 = tensor.expand_shape %342 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_171 = tensor.extract_slice %expanded_158[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_172 = tensor.extract_slice %expanded_158[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %343 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_171, %expanded_169 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %344 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_172, %expanded_170 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %345 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%343, %344 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %346 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_172, %expanded_169 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %347 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_171, %expanded_170 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %348 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%346, %347 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %349 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%345, %348 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_173 = tensor.collapse_shape %349 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %350 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %351 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%350 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_174 = tensor.collapse_shape %351 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_175 = tensor.expand_shape %collapsed_173 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_176 = tensor.collapse_shape %expanded_175 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_177 = linalg.transpose ins(%collapsed_176 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_178 = tensor.expand_shape %collapsed_174 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %352 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_177, %expanded_178 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%245 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %353 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%351 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_179 = tensor.collapse_shape %353 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_180 = tensor.expand_shape %319 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_181 = tensor.collapse_shape %expanded_180 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_182 = linalg.transpose ins(%collapsed_181 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_183 = tensor.expand_shape %collapsed_179 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %354 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_182, %expanded_183 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%352 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %355 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_173 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_184 = tensor.collapse_shape %355 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %356 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_159 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_185 = tensor.collapse_shape %356 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_186 = linalg.transpose ins(%collapsed_166 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_187 = linalg.transpose ins(%collapsed_184 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_188 = linalg.transpose ins(%collapsed_185 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_189 = tensor.collapse_shape %transposed_186 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_190 = tensor.collapse_shape %transposed_187 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_191 = tensor.collapse_shape %transposed_188 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %357 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_189, %collapsed_190, %collapsed_191, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_192 = tensor.expand_shape %357 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_193 = tensor.dim %expanded_192, %c2 : tensor<4x32x?x64xf16>
    %358 = tensor.empty(%dim_193) : tensor<4x?x32x64xf16>
    %transposed_194 = linalg.transpose ins(%expanded_192 : tensor<4x32x?x64xf16>) outs(%358 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_195 = tensor.collapse_shape %transposed_194 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %359 = iree_tensor_ext.bitcast %__auto.blk.2.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_196 = tensor.expand_shape %359 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_197 = tensor.extract_slice %expanded_196[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %360 = iree_tensor_ext.bitcast %extracted_slice_197 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_198 = tensor.extract_slice %expanded_196[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %361 = iree_tensor_ext.bitcast %extracted_slice_198 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_199 = tensor.dim %collapsed_195, %c1 : tensor<4x?x2048xf16>
    %362 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%360, %361 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_200 = tensor.expand_shape %collapsed_195 [[0], [1], [2, 3]] output_shape [4, %dim_199, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %363 = tensor.empty(%dim_199) : tensor<4x?x2048xf32>
    %364 = linalg.fill ins(%cst_3 : f32) outs(%363 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %365 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_200, %362 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%364 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %366 = tensor.empty(%dim_199) : tensor<4x?x2048xf16>
    %367 = linalg.copy ins(%365 : tensor<4x?x2048xf32>) outs(%366 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %368 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%291, %367 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %369 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%368 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %370 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%369 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %371 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%370 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %372 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%371 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %373 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%372 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %374 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%373 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %375 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%369, %374 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %376 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%375 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %377 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.ffn_norm.weight, %376 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %378 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%377 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %379 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_201 = tensor.expand_shape %379 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_202 = tensor.extract_slice %expanded_201[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %380 = iree_tensor_ext.bitcast %extracted_slice_202 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_203 = tensor.extract_slice %expanded_201[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %381 = iree_tensor_ext.bitcast %extracted_slice_203 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %382 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%380, %381 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_204 = tensor.expand_shape %378 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %383 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_204, %382 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %384 = linalg.copy ins(%383 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %385 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%384 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %386 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%385, %384 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %387 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_205 = tensor.expand_shape %387 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_206 = tensor.extract_slice %expanded_205[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %388 = iree_tensor_ext.bitcast %extracted_slice_206 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_207 = tensor.extract_slice %expanded_205[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %389 = iree_tensor_ext.bitcast %extracted_slice_207 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %390 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%388, %389 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %391 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_204, %390 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %392 = linalg.copy ins(%391 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %393 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%386, %392 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %394 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_208 = tensor.expand_shape %394 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_209 = tensor.extract_slice %expanded_208[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %395 = iree_tensor_ext.bitcast %extracted_slice_209 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_210 = tensor.extract_slice %expanded_208[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %396 = iree_tensor_ext.bitcast %extracted_slice_210 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %397 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%395, %396 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_211 = tensor.expand_shape %393 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %398 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_211, %397 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %399 = linalg.copy ins(%398 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %400 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%368, %399 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %401 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%400 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %402 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%401 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %403 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%402 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %404 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%403 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %405 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%404 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %406 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%405 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %407 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%401, %406 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %408 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%407 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %409 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.attn_norm.weight, %408 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %410 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%409 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %411 = iree_tensor_ext.bitcast %__auto.blk.3.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_212 = tensor.expand_shape %411 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_213 = tensor.extract_slice %expanded_212[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %412 = iree_tensor_ext.bitcast %extracted_slice_213 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_214 = tensor.extract_slice %expanded_212[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %413 = iree_tensor_ext.bitcast %extracted_slice_214 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %414 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%412, %413 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_215 = tensor.expand_shape %410 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %415 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_215, %414 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %416 = linalg.copy ins(%415 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %417 = iree_tensor_ext.bitcast %__auto.blk.3.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_216 = tensor.expand_shape %417 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_217 = tensor.extract_slice %expanded_216[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %418 = iree_tensor_ext.bitcast %extracted_slice_217 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_218 = tensor.extract_slice %expanded_216[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %419 = iree_tensor_ext.bitcast %extracted_slice_218 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %420 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%418, %419 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %421 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_215, %420 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %422 = linalg.copy ins(%421 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %423 = iree_tensor_ext.bitcast %__auto.blk.3.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_219 = tensor.expand_shape %423 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_220 = tensor.extract_slice %expanded_219[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %424 = iree_tensor_ext.bitcast %extracted_slice_220 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_221 = tensor.extract_slice %expanded_219[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %425 = iree_tensor_ext.bitcast %extracted_slice_221 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %426 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%424, %425 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %427 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_215, %426 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %428 = linalg.copy ins(%427 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_222 = tensor.expand_shape %416 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_223 = tensor.expand_shape %422 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_224 = tensor.expand_shape %428 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %429 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_225 = tensor.expand_shape %429 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %430 = linalg.batch_matmul ins(%expanded_225, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_226 = linalg.transpose ins(%430 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %431 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_226 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %432 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%431, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %433 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%432 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %434 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_226 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %435 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%434, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %436 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%435 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_227 = tensor.expand_shape %433 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_228 = tensor.expand_shape %436 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_229 = tensor.extract_slice %expanded_222[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_230 = tensor.extract_slice %expanded_222[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %437 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_229, %expanded_227 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %438 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_230, %expanded_228 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %439 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%437, %438 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %440 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_230, %expanded_227 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %441 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_229, %expanded_228 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %442 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%440, %441 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %443 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%439, %442 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_231 = tensor.collapse_shape %443 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %444 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_232 = tensor.expand_shape %444 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %445 = linalg.batch_matmul ins(%expanded_232, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_233 = linalg.transpose ins(%445 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %446 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_233 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %447 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%446, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %448 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%447 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %449 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_233 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %450 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%449, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %451 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%450 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_234 = tensor.expand_shape %448 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_235 = tensor.expand_shape %451 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_236 = tensor.extract_slice %expanded_223[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_237 = tensor.extract_slice %expanded_223[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %452 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_236, %expanded_234 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %453 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_237, %expanded_235 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %454 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%452, %453 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %455 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_237, %expanded_234 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %456 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_236, %expanded_235 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %457 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%455, %456 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %458 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%454, %457 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_238 = tensor.collapse_shape %458 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %459 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c3_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %460 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%459 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_239 = tensor.collapse_shape %460 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_240 = tensor.expand_shape %collapsed_238 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_241 = tensor.collapse_shape %expanded_240 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_242 = linalg.transpose ins(%collapsed_241 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_243 = tensor.expand_shape %collapsed_239 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %461 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_242, %expanded_243 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%354 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %462 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%460 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_244 = tensor.collapse_shape %462 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_245 = tensor.expand_shape %428 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_246 = tensor.collapse_shape %expanded_245 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_247 = linalg.transpose ins(%collapsed_246 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_248 = tensor.expand_shape %collapsed_244 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %463 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_247, %expanded_248 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%461 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %464 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_238 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_249 = tensor.collapse_shape %464 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %465 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_224 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_250 = tensor.collapse_shape %465 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_251 = linalg.transpose ins(%collapsed_231 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_252 = linalg.transpose ins(%collapsed_249 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_253 = linalg.transpose ins(%collapsed_250 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_254 = tensor.collapse_shape %transposed_251 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_255 = tensor.collapse_shape %transposed_252 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_256 = tensor.collapse_shape %transposed_253 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %466 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_254, %collapsed_255, %collapsed_256, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_257 = tensor.expand_shape %466 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_258 = tensor.dim %expanded_257, %c2 : tensor<4x32x?x64xf16>
    %467 = tensor.empty(%dim_258) : tensor<4x?x32x64xf16>
    %transposed_259 = linalg.transpose ins(%expanded_257 : tensor<4x32x?x64xf16>) outs(%467 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_260 = tensor.collapse_shape %transposed_259 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %468 = iree_tensor_ext.bitcast %__auto.blk.3.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_261 = tensor.expand_shape %468 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_262 = tensor.extract_slice %expanded_261[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %469 = iree_tensor_ext.bitcast %extracted_slice_262 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_263 = tensor.extract_slice %expanded_261[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %470 = iree_tensor_ext.bitcast %extracted_slice_263 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_264 = tensor.dim %collapsed_260, %c1 : tensor<4x?x2048xf16>
    %471 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%469, %470 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_265 = tensor.expand_shape %collapsed_260 [[0], [1], [2, 3]] output_shape [4, %dim_264, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %472 = tensor.empty(%dim_264) : tensor<4x?x2048xf32>
    %473 = linalg.fill ins(%cst_3 : f32) outs(%472 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %474 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_265, %471 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%473 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %475 = tensor.empty(%dim_264) : tensor<4x?x2048xf16>
    %476 = linalg.copy ins(%474 : tensor<4x?x2048xf32>) outs(%475 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %477 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%400, %476 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %478 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%477 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %479 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%478 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %480 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%479 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %481 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%480 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %482 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%481 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %483 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%482 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %484 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%478, %483 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %485 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%484 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %486 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.ffn_norm.weight, %485 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %487 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%486 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %488 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_266 = tensor.expand_shape %488 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_267 = tensor.extract_slice %expanded_266[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %489 = iree_tensor_ext.bitcast %extracted_slice_267 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_268 = tensor.extract_slice %expanded_266[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %490 = iree_tensor_ext.bitcast %extracted_slice_268 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %491 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%489, %490 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_269 = tensor.expand_shape %487 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %492 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_269, %491 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %493 = linalg.copy ins(%492 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %494 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%493 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %495 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%494, %493 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %496 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_270 = tensor.expand_shape %496 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_271 = tensor.extract_slice %expanded_270[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %497 = iree_tensor_ext.bitcast %extracted_slice_271 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_272 = tensor.extract_slice %expanded_270[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %498 = iree_tensor_ext.bitcast %extracted_slice_272 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %499 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%497, %498 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %500 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_269, %499 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %501 = linalg.copy ins(%500 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %502 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%495, %501 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %503 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_273 = tensor.expand_shape %503 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_274 = tensor.extract_slice %expanded_273[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %504 = iree_tensor_ext.bitcast %extracted_slice_274 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_275 = tensor.extract_slice %expanded_273[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %505 = iree_tensor_ext.bitcast %extracted_slice_275 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %506 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%504, %505 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_276 = tensor.expand_shape %502 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %507 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_276, %506 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %508 = linalg.copy ins(%507 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %509 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%477, %508 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %510 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%509 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %511 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%510 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %512 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%511 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %513 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%512 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %514 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%513 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %515 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%514 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %516 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%510, %515 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %517 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%516 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %518 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.attn_norm.weight, %517 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %519 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%518 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %520 = iree_tensor_ext.bitcast %__auto.blk.4.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_277 = tensor.expand_shape %520 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_278 = tensor.extract_slice %expanded_277[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %521 = iree_tensor_ext.bitcast %extracted_slice_278 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_279 = tensor.extract_slice %expanded_277[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %522 = iree_tensor_ext.bitcast %extracted_slice_279 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %523 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%521, %522 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_280 = tensor.expand_shape %519 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %524 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_280, %523 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %525 = linalg.copy ins(%524 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %526 = iree_tensor_ext.bitcast %__auto.blk.4.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_281 = tensor.expand_shape %526 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_282 = tensor.extract_slice %expanded_281[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %527 = iree_tensor_ext.bitcast %extracted_slice_282 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_283 = tensor.extract_slice %expanded_281[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %528 = iree_tensor_ext.bitcast %extracted_slice_283 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %529 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%527, %528 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %530 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_280, %529 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %531 = linalg.copy ins(%530 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %532 = iree_tensor_ext.bitcast %__auto.blk.4.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_284 = tensor.expand_shape %532 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_285 = tensor.extract_slice %expanded_284[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %533 = iree_tensor_ext.bitcast %extracted_slice_285 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_286 = tensor.extract_slice %expanded_284[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %534 = iree_tensor_ext.bitcast %extracted_slice_286 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %535 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%533, %534 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %536 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_280, %535 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %537 = linalg.copy ins(%536 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_287 = tensor.expand_shape %525 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_288 = tensor.expand_shape %531 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_289 = tensor.expand_shape %537 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %538 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_290 = tensor.expand_shape %538 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %539 = linalg.batch_matmul ins(%expanded_290, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_291 = linalg.transpose ins(%539 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %540 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_291 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %541 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%540, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %542 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%541 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %543 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_291 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %544 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%543, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %545 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%544 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_292 = tensor.expand_shape %542 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_293 = tensor.expand_shape %545 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_294 = tensor.extract_slice %expanded_287[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_295 = tensor.extract_slice %expanded_287[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %546 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_294, %expanded_292 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %547 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_295, %expanded_293 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %548 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%546, %547 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %549 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_295, %expanded_292 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %550 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_294, %expanded_293 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %551 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%549, %550 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %552 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%548, %551 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_296 = tensor.collapse_shape %552 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %553 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_297 = tensor.expand_shape %553 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %554 = linalg.batch_matmul ins(%expanded_297, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_298 = linalg.transpose ins(%554 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %555 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_298 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %556 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%555, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %557 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%556 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %558 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_298 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %559 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%558, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %560 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%559 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_299 = tensor.expand_shape %557 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_300 = tensor.expand_shape %560 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_301 = tensor.extract_slice %expanded_288[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_302 = tensor.extract_slice %expanded_288[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %561 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_301, %expanded_299 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %562 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_302, %expanded_300 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %563 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%561, %562 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %564 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_302, %expanded_299 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %565 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_301, %expanded_300 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %566 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%564, %565 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %567 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%563, %566 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_303 = tensor.collapse_shape %567 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %568 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c4_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %569 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%568 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_304 = tensor.collapse_shape %569 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_305 = tensor.expand_shape %collapsed_303 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_306 = tensor.collapse_shape %expanded_305 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_307 = linalg.transpose ins(%collapsed_306 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_308 = tensor.expand_shape %collapsed_304 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %570 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_307, %expanded_308 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%463 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %571 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%569 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_309 = tensor.collapse_shape %571 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_310 = tensor.expand_shape %537 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_311 = tensor.collapse_shape %expanded_310 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_312 = linalg.transpose ins(%collapsed_311 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_313 = tensor.expand_shape %collapsed_309 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %572 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_312, %expanded_313 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%570 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %573 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_303 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_314 = tensor.collapse_shape %573 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %574 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_289 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_315 = tensor.collapse_shape %574 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_316 = linalg.transpose ins(%collapsed_296 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_317 = linalg.transpose ins(%collapsed_314 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_318 = linalg.transpose ins(%collapsed_315 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_319 = tensor.collapse_shape %transposed_316 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_320 = tensor.collapse_shape %transposed_317 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_321 = tensor.collapse_shape %transposed_318 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %575 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_319, %collapsed_320, %collapsed_321, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_322 = tensor.expand_shape %575 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_323 = tensor.dim %expanded_322, %c2 : tensor<4x32x?x64xf16>
    %576 = tensor.empty(%dim_323) : tensor<4x?x32x64xf16>
    %transposed_324 = linalg.transpose ins(%expanded_322 : tensor<4x32x?x64xf16>) outs(%576 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_325 = tensor.collapse_shape %transposed_324 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %577 = iree_tensor_ext.bitcast %__auto.blk.4.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_326 = tensor.expand_shape %577 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_327 = tensor.extract_slice %expanded_326[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %578 = iree_tensor_ext.bitcast %extracted_slice_327 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_328 = tensor.extract_slice %expanded_326[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %579 = iree_tensor_ext.bitcast %extracted_slice_328 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_329 = tensor.dim %collapsed_325, %c1 : tensor<4x?x2048xf16>
    %580 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%578, %579 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_330 = tensor.expand_shape %collapsed_325 [[0], [1], [2, 3]] output_shape [4, %dim_329, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %581 = tensor.empty(%dim_329) : tensor<4x?x2048xf32>
    %582 = linalg.fill ins(%cst_3 : f32) outs(%581 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %583 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_330, %580 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%582 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %584 = tensor.empty(%dim_329) : tensor<4x?x2048xf16>
    %585 = linalg.copy ins(%583 : tensor<4x?x2048xf32>) outs(%584 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %586 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%509, %585 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %587 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%586 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %588 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%587 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %589 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%588 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %590 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%589 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %591 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%590 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %592 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%591 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %593 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%587, %592 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %594 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%593 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %595 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.ffn_norm.weight, %594 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %596 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%595 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %597 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_331 = tensor.expand_shape %597 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_332 = tensor.extract_slice %expanded_331[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %598 = iree_tensor_ext.bitcast %extracted_slice_332 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_333 = tensor.extract_slice %expanded_331[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %599 = iree_tensor_ext.bitcast %extracted_slice_333 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %600 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%598, %599 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_334 = tensor.expand_shape %596 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %601 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_334, %600 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %602 = linalg.copy ins(%601 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %603 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%602 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %604 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%603, %602 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %605 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_335 = tensor.expand_shape %605 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_336 = tensor.extract_slice %expanded_335[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %606 = iree_tensor_ext.bitcast %extracted_slice_336 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_337 = tensor.extract_slice %expanded_335[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %607 = iree_tensor_ext.bitcast %extracted_slice_337 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %608 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%606, %607 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %609 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_334, %608 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %610 = linalg.copy ins(%609 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %611 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%604, %610 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %612 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_338 = tensor.expand_shape %612 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_339 = tensor.extract_slice %expanded_338[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %613 = iree_tensor_ext.bitcast %extracted_slice_339 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_340 = tensor.extract_slice %expanded_338[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %614 = iree_tensor_ext.bitcast %extracted_slice_340 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %615 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%613, %614 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_341 = tensor.expand_shape %611 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %616 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_341, %615 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %617 = linalg.copy ins(%616 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %618 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%586, %617 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %619 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%618 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %620 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%619 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %621 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%620 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %622 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%621 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %623 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%622 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %624 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%623 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %625 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%619, %624 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %626 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%625 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %627 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.attn_norm.weight, %626 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %628 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%627 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %629 = iree_tensor_ext.bitcast %__auto.blk.5.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_342 = tensor.expand_shape %629 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_343 = tensor.extract_slice %expanded_342[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %630 = iree_tensor_ext.bitcast %extracted_slice_343 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_344 = tensor.extract_slice %expanded_342[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %631 = iree_tensor_ext.bitcast %extracted_slice_344 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %632 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%630, %631 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_345 = tensor.expand_shape %628 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %633 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_345, %632 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %634 = linalg.copy ins(%633 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %635 = iree_tensor_ext.bitcast %__auto.blk.5.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_346 = tensor.expand_shape %635 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_347 = tensor.extract_slice %expanded_346[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %636 = iree_tensor_ext.bitcast %extracted_slice_347 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_348 = tensor.extract_slice %expanded_346[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %637 = iree_tensor_ext.bitcast %extracted_slice_348 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %638 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%636, %637 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %639 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_345, %638 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %640 = linalg.copy ins(%639 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %641 = iree_tensor_ext.bitcast %__auto.blk.5.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_349 = tensor.expand_shape %641 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_350 = tensor.extract_slice %expanded_349[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %642 = iree_tensor_ext.bitcast %extracted_slice_350 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_351 = tensor.extract_slice %expanded_349[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %643 = iree_tensor_ext.bitcast %extracted_slice_351 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %644 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%642, %643 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %645 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_345, %644 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %646 = linalg.copy ins(%645 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_352 = tensor.expand_shape %634 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_353 = tensor.expand_shape %640 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_354 = tensor.expand_shape %646 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %647 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_355 = tensor.expand_shape %647 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %648 = linalg.batch_matmul ins(%expanded_355, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_356 = linalg.transpose ins(%648 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %649 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_356 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %650 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%649, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %651 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%650 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %652 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_356 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %653 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%652, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %654 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%653 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_357 = tensor.expand_shape %651 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_358 = tensor.expand_shape %654 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_359 = tensor.extract_slice %expanded_352[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_360 = tensor.extract_slice %expanded_352[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %655 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_359, %expanded_357 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %656 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_360, %expanded_358 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %657 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%655, %656 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %658 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_360, %expanded_357 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %659 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_359, %expanded_358 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %660 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%658, %659 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %661 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%657, %660 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_361 = tensor.collapse_shape %661 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %662 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_362 = tensor.expand_shape %662 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %663 = linalg.batch_matmul ins(%expanded_362, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_363 = linalg.transpose ins(%663 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %664 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_363 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %665 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%664, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %666 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%665 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %667 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_363 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %668 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%667, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %669 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%668 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_364 = tensor.expand_shape %666 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_365 = tensor.expand_shape %669 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_366 = tensor.extract_slice %expanded_353[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_367 = tensor.extract_slice %expanded_353[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %670 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_366, %expanded_364 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %671 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_367, %expanded_365 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %672 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%670, %671 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %673 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_367, %expanded_364 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %674 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_366, %expanded_365 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %675 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%673, %674 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %676 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%672, %675 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_368 = tensor.collapse_shape %676 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %677 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c5_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %678 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%677 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_369 = tensor.collapse_shape %678 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_370 = tensor.expand_shape %collapsed_368 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_371 = tensor.collapse_shape %expanded_370 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_372 = linalg.transpose ins(%collapsed_371 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_373 = tensor.expand_shape %collapsed_369 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %679 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_372, %expanded_373 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%572 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %680 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%678 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_374 = tensor.collapse_shape %680 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_375 = tensor.expand_shape %646 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_376 = tensor.collapse_shape %expanded_375 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_377 = linalg.transpose ins(%collapsed_376 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_378 = tensor.expand_shape %collapsed_374 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %681 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_377, %expanded_378 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%679 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %682 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_368 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_379 = tensor.collapse_shape %682 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %683 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_354 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_380 = tensor.collapse_shape %683 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_381 = linalg.transpose ins(%collapsed_361 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_382 = linalg.transpose ins(%collapsed_379 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_383 = linalg.transpose ins(%collapsed_380 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_384 = tensor.collapse_shape %transposed_381 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_385 = tensor.collapse_shape %transposed_382 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_386 = tensor.collapse_shape %transposed_383 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %684 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_384, %collapsed_385, %collapsed_386, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_387 = tensor.expand_shape %684 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_388 = tensor.dim %expanded_387, %c2 : tensor<4x32x?x64xf16>
    %685 = tensor.empty(%dim_388) : tensor<4x?x32x64xf16>
    %transposed_389 = linalg.transpose ins(%expanded_387 : tensor<4x32x?x64xf16>) outs(%685 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_390 = tensor.collapse_shape %transposed_389 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %686 = iree_tensor_ext.bitcast %__auto.blk.5.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_391 = tensor.expand_shape %686 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_392 = tensor.extract_slice %expanded_391[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %687 = iree_tensor_ext.bitcast %extracted_slice_392 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_393 = tensor.extract_slice %expanded_391[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %688 = iree_tensor_ext.bitcast %extracted_slice_393 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_394 = tensor.dim %collapsed_390, %c1 : tensor<4x?x2048xf16>
    %689 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%687, %688 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_395 = tensor.expand_shape %collapsed_390 [[0], [1], [2, 3]] output_shape [4, %dim_394, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %690 = tensor.empty(%dim_394) : tensor<4x?x2048xf32>
    %691 = linalg.fill ins(%cst_3 : f32) outs(%690 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %692 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_395, %689 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%691 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %693 = tensor.empty(%dim_394) : tensor<4x?x2048xf16>
    %694 = linalg.copy ins(%692 : tensor<4x?x2048xf32>) outs(%693 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %695 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%618, %694 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %696 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%695 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %697 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%696 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %698 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%697 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %699 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%698 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %700 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%699 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %701 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%700 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %702 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%696, %701 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %703 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%702 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %704 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.ffn_norm.weight, %703 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %705 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%704 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %706 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_396 = tensor.expand_shape %706 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_397 = tensor.extract_slice %expanded_396[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %707 = iree_tensor_ext.bitcast %extracted_slice_397 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_398 = tensor.extract_slice %expanded_396[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %708 = iree_tensor_ext.bitcast %extracted_slice_398 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %709 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%707, %708 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_399 = tensor.expand_shape %705 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %710 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_399, %709 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %711 = linalg.copy ins(%710 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %712 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%711 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %713 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%712, %711 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %714 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_400 = tensor.expand_shape %714 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_401 = tensor.extract_slice %expanded_400[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %715 = iree_tensor_ext.bitcast %extracted_slice_401 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_402 = tensor.extract_slice %expanded_400[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %716 = iree_tensor_ext.bitcast %extracted_slice_402 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %717 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%715, %716 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %718 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_399, %717 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %719 = linalg.copy ins(%718 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %720 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%713, %719 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %721 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_403 = tensor.expand_shape %721 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_404 = tensor.extract_slice %expanded_403[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %722 = iree_tensor_ext.bitcast %extracted_slice_404 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_405 = tensor.extract_slice %expanded_403[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %723 = iree_tensor_ext.bitcast %extracted_slice_405 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %724 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%722, %723 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_406 = tensor.expand_shape %720 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %725 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_406, %724 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %726 = linalg.copy ins(%725 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %727 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%695, %726 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %728 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%727 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %729 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%728 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %730 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%729 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %731 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%730 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %732 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%731 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %733 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%732 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %734 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%728, %733 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %735 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%734 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %736 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.attn_norm.weight, %735 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %737 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%736 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %738 = iree_tensor_ext.bitcast %__auto.blk.6.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_407 = tensor.expand_shape %738 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_408 = tensor.extract_slice %expanded_407[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %739 = iree_tensor_ext.bitcast %extracted_slice_408 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_409 = tensor.extract_slice %expanded_407[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %740 = iree_tensor_ext.bitcast %extracted_slice_409 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %741 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%739, %740 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_410 = tensor.expand_shape %737 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %742 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_410, %741 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %743 = linalg.copy ins(%742 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %744 = iree_tensor_ext.bitcast %__auto.blk.6.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_411 = tensor.expand_shape %744 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_412 = tensor.extract_slice %expanded_411[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %745 = iree_tensor_ext.bitcast %extracted_slice_412 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_413 = tensor.extract_slice %expanded_411[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %746 = iree_tensor_ext.bitcast %extracted_slice_413 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %747 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%745, %746 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %748 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_410, %747 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %749 = linalg.copy ins(%748 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %750 = iree_tensor_ext.bitcast %__auto.blk.6.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_414 = tensor.expand_shape %750 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_415 = tensor.extract_slice %expanded_414[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %751 = iree_tensor_ext.bitcast %extracted_slice_415 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_416 = tensor.extract_slice %expanded_414[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %752 = iree_tensor_ext.bitcast %extracted_slice_416 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %753 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%751, %752 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %754 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_410, %753 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %755 = linalg.copy ins(%754 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_417 = tensor.expand_shape %743 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_418 = tensor.expand_shape %749 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_419 = tensor.expand_shape %755 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %756 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_420 = tensor.expand_shape %756 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %757 = linalg.batch_matmul ins(%expanded_420, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_421 = linalg.transpose ins(%757 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %758 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_421 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %759 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%758, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %760 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%759 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %761 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_421 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %762 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%761, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %763 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%762 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_422 = tensor.expand_shape %760 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_423 = tensor.expand_shape %763 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_424 = tensor.extract_slice %expanded_417[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_425 = tensor.extract_slice %expanded_417[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %764 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_424, %expanded_422 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %765 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_425, %expanded_423 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %766 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%764, %765 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %767 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_425, %expanded_422 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %768 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_424, %expanded_423 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %769 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%767, %768 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %770 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%766, %769 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_426 = tensor.collapse_shape %770 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %771 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_427 = tensor.expand_shape %771 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %772 = linalg.batch_matmul ins(%expanded_427, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_428 = linalg.transpose ins(%772 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %773 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_428 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %774 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%773, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %775 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%774 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %776 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_428 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %777 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%776, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %778 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%777 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_429 = tensor.expand_shape %775 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_430 = tensor.expand_shape %778 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_431 = tensor.extract_slice %expanded_418[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_432 = tensor.extract_slice %expanded_418[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %779 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_431, %expanded_429 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %780 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_432, %expanded_430 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %781 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%779, %780 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %782 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_432, %expanded_429 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %783 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_431, %expanded_430 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %784 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%782, %783 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %785 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%781, %784 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_433 = tensor.collapse_shape %785 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %786 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c6_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %787 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%786 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_434 = tensor.collapse_shape %787 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_435 = tensor.expand_shape %collapsed_433 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_436 = tensor.collapse_shape %expanded_435 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_437 = linalg.transpose ins(%collapsed_436 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_438 = tensor.expand_shape %collapsed_434 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %788 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_437, %expanded_438 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%681 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %789 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%787 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_439 = tensor.collapse_shape %789 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_440 = tensor.expand_shape %755 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_441 = tensor.collapse_shape %expanded_440 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_442 = linalg.transpose ins(%collapsed_441 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_443 = tensor.expand_shape %collapsed_439 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %790 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_442, %expanded_443 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%788 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %791 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_433 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_444 = tensor.collapse_shape %791 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %792 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_419 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_445 = tensor.collapse_shape %792 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_446 = linalg.transpose ins(%collapsed_426 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_447 = linalg.transpose ins(%collapsed_444 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_448 = linalg.transpose ins(%collapsed_445 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_449 = tensor.collapse_shape %transposed_446 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_450 = tensor.collapse_shape %transposed_447 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_451 = tensor.collapse_shape %transposed_448 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %793 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_449, %collapsed_450, %collapsed_451, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_452 = tensor.expand_shape %793 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_453 = tensor.dim %expanded_452, %c2 : tensor<4x32x?x64xf16>
    %794 = tensor.empty(%dim_453) : tensor<4x?x32x64xf16>
    %transposed_454 = linalg.transpose ins(%expanded_452 : tensor<4x32x?x64xf16>) outs(%794 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_455 = tensor.collapse_shape %transposed_454 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %795 = iree_tensor_ext.bitcast %__auto.blk.6.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_456 = tensor.expand_shape %795 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_457 = tensor.extract_slice %expanded_456[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %796 = iree_tensor_ext.bitcast %extracted_slice_457 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_458 = tensor.extract_slice %expanded_456[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %797 = iree_tensor_ext.bitcast %extracted_slice_458 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_459 = tensor.dim %collapsed_455, %c1 : tensor<4x?x2048xf16>
    %798 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%796, %797 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_460 = tensor.expand_shape %collapsed_455 [[0], [1], [2, 3]] output_shape [4, %dim_459, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %799 = tensor.empty(%dim_459) : tensor<4x?x2048xf32>
    %800 = linalg.fill ins(%cst_3 : f32) outs(%799 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %801 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_460, %798 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%800 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %802 = tensor.empty(%dim_459) : tensor<4x?x2048xf16>
    %803 = linalg.copy ins(%801 : tensor<4x?x2048xf32>) outs(%802 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %804 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%727, %803 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %805 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%804 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %806 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%805 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %807 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%806 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %808 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%807 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %809 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%808 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %810 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%809 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %811 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%805, %810 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %812 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%811 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %813 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.ffn_norm.weight, %812 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %814 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%813 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %815 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_461 = tensor.expand_shape %815 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_462 = tensor.extract_slice %expanded_461[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %816 = iree_tensor_ext.bitcast %extracted_slice_462 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_463 = tensor.extract_slice %expanded_461[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %817 = iree_tensor_ext.bitcast %extracted_slice_463 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %818 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%816, %817 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_464 = tensor.expand_shape %814 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %819 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_464, %818 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %820 = linalg.copy ins(%819 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %821 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%820 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %822 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%821, %820 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %823 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_465 = tensor.expand_shape %823 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_466 = tensor.extract_slice %expanded_465[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %824 = iree_tensor_ext.bitcast %extracted_slice_466 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_467 = tensor.extract_slice %expanded_465[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %825 = iree_tensor_ext.bitcast %extracted_slice_467 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %826 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%824, %825 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %827 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_464, %826 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %828 = linalg.copy ins(%827 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %829 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%822, %828 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %830 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_468 = tensor.expand_shape %830 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_469 = tensor.extract_slice %expanded_468[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %831 = iree_tensor_ext.bitcast %extracted_slice_469 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_470 = tensor.extract_slice %expanded_468[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %832 = iree_tensor_ext.bitcast %extracted_slice_470 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %833 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%831, %832 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_471 = tensor.expand_shape %829 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %834 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_471, %833 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %835 = linalg.copy ins(%834 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %836 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%804, %835 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %837 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%836 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %838 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%837 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %839 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%838 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %840 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%839 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %841 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%840 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %842 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%841 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %843 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%837, %842 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %844 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%843 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %845 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.attn_norm.weight, %844 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %846 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%845 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %847 = iree_tensor_ext.bitcast %__auto.blk.7.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_472 = tensor.expand_shape %847 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_473 = tensor.extract_slice %expanded_472[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %848 = iree_tensor_ext.bitcast %extracted_slice_473 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_474 = tensor.extract_slice %expanded_472[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %849 = iree_tensor_ext.bitcast %extracted_slice_474 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %850 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%848, %849 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_475 = tensor.expand_shape %846 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %851 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_475, %850 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %852 = linalg.copy ins(%851 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %853 = iree_tensor_ext.bitcast %__auto.blk.7.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_476 = tensor.expand_shape %853 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_477 = tensor.extract_slice %expanded_476[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %854 = iree_tensor_ext.bitcast %extracted_slice_477 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_478 = tensor.extract_slice %expanded_476[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %855 = iree_tensor_ext.bitcast %extracted_slice_478 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %856 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%854, %855 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %857 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_475, %856 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %858 = linalg.copy ins(%857 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %859 = iree_tensor_ext.bitcast %__auto.blk.7.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_479 = tensor.expand_shape %859 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_480 = tensor.extract_slice %expanded_479[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %860 = iree_tensor_ext.bitcast %extracted_slice_480 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_481 = tensor.extract_slice %expanded_479[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %861 = iree_tensor_ext.bitcast %extracted_slice_481 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %862 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%860, %861 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %863 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_475, %862 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %864 = linalg.copy ins(%863 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_482 = tensor.expand_shape %852 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_483 = tensor.expand_shape %858 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_484 = tensor.expand_shape %864 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %865 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_485 = tensor.expand_shape %865 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %866 = linalg.batch_matmul ins(%expanded_485, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_486 = linalg.transpose ins(%866 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %867 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_486 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %868 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%867, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %869 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%868 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %870 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_486 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %871 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%870, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %872 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%871 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_487 = tensor.expand_shape %869 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_488 = tensor.expand_shape %872 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_489 = tensor.extract_slice %expanded_482[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_490 = tensor.extract_slice %expanded_482[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %873 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_489, %expanded_487 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %874 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_490, %expanded_488 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %875 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%873, %874 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %876 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_490, %expanded_487 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %877 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_489, %expanded_488 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %878 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%876, %877 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %879 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%875, %878 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_491 = tensor.collapse_shape %879 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %880 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_492 = tensor.expand_shape %880 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %881 = linalg.batch_matmul ins(%expanded_492, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_493 = linalg.transpose ins(%881 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %882 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_493 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %883 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%882, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %884 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%883 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %885 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_493 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %886 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%885, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %887 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%886 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_494 = tensor.expand_shape %884 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_495 = tensor.expand_shape %887 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_496 = tensor.extract_slice %expanded_483[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_497 = tensor.extract_slice %expanded_483[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %888 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_496, %expanded_494 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %889 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_497, %expanded_495 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %890 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%888, %889 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %891 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_497, %expanded_494 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %892 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_496, %expanded_495 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %893 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%891, %892 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %894 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%890, %893 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_498 = tensor.collapse_shape %894 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %895 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c7_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %896 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%895 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_499 = tensor.collapse_shape %896 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_500 = tensor.expand_shape %collapsed_498 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_501 = tensor.collapse_shape %expanded_500 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_502 = linalg.transpose ins(%collapsed_501 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_503 = tensor.expand_shape %collapsed_499 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %897 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_502, %expanded_503 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%790 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %898 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%896 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_504 = tensor.collapse_shape %898 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_505 = tensor.expand_shape %864 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_506 = tensor.collapse_shape %expanded_505 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_507 = linalg.transpose ins(%collapsed_506 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_508 = tensor.expand_shape %collapsed_504 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %899 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_507, %expanded_508 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%897 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %900 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_498 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_509 = tensor.collapse_shape %900 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %901 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_484 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_510 = tensor.collapse_shape %901 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_511 = linalg.transpose ins(%collapsed_491 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_512 = linalg.transpose ins(%collapsed_509 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_513 = linalg.transpose ins(%collapsed_510 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_514 = tensor.collapse_shape %transposed_511 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_515 = tensor.collapse_shape %transposed_512 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_516 = tensor.collapse_shape %transposed_513 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %902 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_514, %collapsed_515, %collapsed_516, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_517 = tensor.expand_shape %902 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_518 = tensor.dim %expanded_517, %c2 : tensor<4x32x?x64xf16>
    %903 = tensor.empty(%dim_518) : tensor<4x?x32x64xf16>
    %transposed_519 = linalg.transpose ins(%expanded_517 : tensor<4x32x?x64xf16>) outs(%903 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_520 = tensor.collapse_shape %transposed_519 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %904 = iree_tensor_ext.bitcast %__auto.blk.7.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_521 = tensor.expand_shape %904 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_522 = tensor.extract_slice %expanded_521[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %905 = iree_tensor_ext.bitcast %extracted_slice_522 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_523 = tensor.extract_slice %expanded_521[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %906 = iree_tensor_ext.bitcast %extracted_slice_523 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_524 = tensor.dim %collapsed_520, %c1 : tensor<4x?x2048xf16>
    %907 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%905, %906 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_525 = tensor.expand_shape %collapsed_520 [[0], [1], [2, 3]] output_shape [4, %dim_524, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %908 = tensor.empty(%dim_524) : tensor<4x?x2048xf32>
    %909 = linalg.fill ins(%cst_3 : f32) outs(%908 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %910 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_525, %907 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%909 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %911 = tensor.empty(%dim_524) : tensor<4x?x2048xf16>
    %912 = linalg.copy ins(%910 : tensor<4x?x2048xf32>) outs(%911 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %913 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%836, %912 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %914 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%913 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %915 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%914 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %916 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%915 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %917 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%916 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %918 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%917 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %919 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%918 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %920 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%914, %919 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %921 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%920 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %922 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.ffn_norm.weight, %921 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %923 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%922 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %924 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_526 = tensor.expand_shape %924 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_527 = tensor.extract_slice %expanded_526[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %925 = iree_tensor_ext.bitcast %extracted_slice_527 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_528 = tensor.extract_slice %expanded_526[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %926 = iree_tensor_ext.bitcast %extracted_slice_528 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %927 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%925, %926 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_529 = tensor.expand_shape %923 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %928 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_529, %927 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %929 = linalg.copy ins(%928 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %930 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%929 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %931 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%930, %929 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %932 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_530 = tensor.expand_shape %932 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_531 = tensor.extract_slice %expanded_530[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %933 = iree_tensor_ext.bitcast %extracted_slice_531 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_532 = tensor.extract_slice %expanded_530[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %934 = iree_tensor_ext.bitcast %extracted_slice_532 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %935 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%933, %934 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %936 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_529, %935 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %937 = linalg.copy ins(%936 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %938 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%931, %937 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %939 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_533 = tensor.expand_shape %939 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_534 = tensor.extract_slice %expanded_533[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %940 = iree_tensor_ext.bitcast %extracted_slice_534 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_535 = tensor.extract_slice %expanded_533[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %941 = iree_tensor_ext.bitcast %extracted_slice_535 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %942 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%940, %941 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_536 = tensor.expand_shape %938 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %943 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_536, %942 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %944 = linalg.copy ins(%943 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %945 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%913, %944 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %946 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%945 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %947 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%946 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %948 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%947 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %949 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%948 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %950 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%949 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %951 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%950 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %952 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%946, %951 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %953 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%952 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %954 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.attn_norm.weight, %953 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %955 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%954 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %956 = iree_tensor_ext.bitcast %__auto.blk.8.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_537 = tensor.expand_shape %956 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_538 = tensor.extract_slice %expanded_537[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %957 = iree_tensor_ext.bitcast %extracted_slice_538 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_539 = tensor.extract_slice %expanded_537[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %958 = iree_tensor_ext.bitcast %extracted_slice_539 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %959 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%957, %958 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_540 = tensor.expand_shape %955 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %960 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_540, %959 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %961 = linalg.copy ins(%960 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %962 = iree_tensor_ext.bitcast %__auto.blk.8.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_541 = tensor.expand_shape %962 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_542 = tensor.extract_slice %expanded_541[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %963 = iree_tensor_ext.bitcast %extracted_slice_542 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_543 = tensor.extract_slice %expanded_541[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %964 = iree_tensor_ext.bitcast %extracted_slice_543 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %965 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%963, %964 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %966 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_540, %965 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %967 = linalg.copy ins(%966 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %968 = iree_tensor_ext.bitcast %__auto.blk.8.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_544 = tensor.expand_shape %968 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_545 = tensor.extract_slice %expanded_544[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %969 = iree_tensor_ext.bitcast %extracted_slice_545 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_546 = tensor.extract_slice %expanded_544[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %970 = iree_tensor_ext.bitcast %extracted_slice_546 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %971 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%969, %970 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %972 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_540, %971 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %973 = linalg.copy ins(%972 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_547 = tensor.expand_shape %961 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_548 = tensor.expand_shape %967 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_549 = tensor.expand_shape %973 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %974 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_550 = tensor.expand_shape %974 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %975 = linalg.batch_matmul ins(%expanded_550, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_551 = linalg.transpose ins(%975 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %976 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_551 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %977 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%976, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %978 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%977 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %979 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_551 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %980 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%979, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %981 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%980 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_552 = tensor.expand_shape %978 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_553 = tensor.expand_shape %981 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_554 = tensor.extract_slice %expanded_547[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_555 = tensor.extract_slice %expanded_547[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %982 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_554, %expanded_552 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %983 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_555, %expanded_553 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %984 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%982, %983 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %985 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_555, %expanded_552 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %986 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_554, %expanded_553 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %987 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%985, %986 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %988 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%984, %987 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_556 = tensor.collapse_shape %988 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %989 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_557 = tensor.expand_shape %989 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %990 = linalg.batch_matmul ins(%expanded_557, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_558 = linalg.transpose ins(%990 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %991 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_558 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %992 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%991, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %993 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%992 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %994 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_558 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %995 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%994, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %996 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%995 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_559 = tensor.expand_shape %993 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_560 = tensor.expand_shape %996 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_561 = tensor.extract_slice %expanded_548[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_562 = tensor.extract_slice %expanded_548[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %997 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_561, %expanded_559 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %998 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_562, %expanded_560 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %999 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%997, %998 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1000 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_562, %expanded_559 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1001 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_561, %expanded_560 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1002 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1000, %1001 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1003 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%999, %1002 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_563 = tensor.collapse_shape %1003 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1004 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c8_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1005 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1004 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_564 = tensor.collapse_shape %1005 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_565 = tensor.expand_shape %collapsed_563 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_566 = tensor.collapse_shape %expanded_565 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_567 = linalg.transpose ins(%collapsed_566 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_568 = tensor.expand_shape %collapsed_564 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1006 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_567, %expanded_568 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%899 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1007 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1005 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_569 = tensor.collapse_shape %1007 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_570 = tensor.expand_shape %973 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_571 = tensor.collapse_shape %expanded_570 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_572 = linalg.transpose ins(%collapsed_571 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_573 = tensor.expand_shape %collapsed_569 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1008 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_572, %expanded_573 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1006 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1009 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_563 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_574 = tensor.collapse_shape %1009 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1010 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_549 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_575 = tensor.collapse_shape %1010 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_576 = linalg.transpose ins(%collapsed_556 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_577 = linalg.transpose ins(%collapsed_574 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_578 = linalg.transpose ins(%collapsed_575 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_579 = tensor.collapse_shape %transposed_576 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_580 = tensor.collapse_shape %transposed_577 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_581 = tensor.collapse_shape %transposed_578 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1011 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_579, %collapsed_580, %collapsed_581, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_582 = tensor.expand_shape %1011 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_583 = tensor.dim %expanded_582, %c2 : tensor<4x32x?x64xf16>
    %1012 = tensor.empty(%dim_583) : tensor<4x?x32x64xf16>
    %transposed_584 = linalg.transpose ins(%expanded_582 : tensor<4x32x?x64xf16>) outs(%1012 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_585 = tensor.collapse_shape %transposed_584 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1013 = iree_tensor_ext.bitcast %__auto.blk.8.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_586 = tensor.expand_shape %1013 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_587 = tensor.extract_slice %expanded_586[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1014 = iree_tensor_ext.bitcast %extracted_slice_587 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_588 = tensor.extract_slice %expanded_586[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1015 = iree_tensor_ext.bitcast %extracted_slice_588 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_589 = tensor.dim %collapsed_585, %c1 : tensor<4x?x2048xf16>
    %1016 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1014, %1015 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_590 = tensor.expand_shape %collapsed_585 [[0], [1], [2, 3]] output_shape [4, %dim_589, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1017 = tensor.empty(%dim_589) : tensor<4x?x2048xf32>
    %1018 = linalg.fill ins(%cst_3 : f32) outs(%1017 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1019 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_590, %1016 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1018 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1020 = tensor.empty(%dim_589) : tensor<4x?x2048xf16>
    %1021 = linalg.copy ins(%1019 : tensor<4x?x2048xf32>) outs(%1020 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1022 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%945, %1021 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1023 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1022 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1024 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1023 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1025 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1024 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1026 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1025 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1027 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1026 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1028 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1027 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1029 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1023, %1028 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1030 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1029 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1031 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.ffn_norm.weight, %1030 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1032 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1031 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1033 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_591 = tensor.expand_shape %1033 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_592 = tensor.extract_slice %expanded_591[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1034 = iree_tensor_ext.bitcast %extracted_slice_592 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_593 = tensor.extract_slice %expanded_591[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1035 = iree_tensor_ext.bitcast %extracted_slice_593 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1036 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1034, %1035 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_594 = tensor.expand_shape %1032 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1037 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_594, %1036 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1038 = linalg.copy ins(%1037 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1039 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1038 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1040 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1039, %1038 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1041 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_595 = tensor.expand_shape %1041 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_596 = tensor.extract_slice %expanded_595[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1042 = iree_tensor_ext.bitcast %extracted_slice_596 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_597 = tensor.extract_slice %expanded_595[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1043 = iree_tensor_ext.bitcast %extracted_slice_597 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1044 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1042, %1043 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1045 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_594, %1044 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1046 = linalg.copy ins(%1045 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1047 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1040, %1046 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1048 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_598 = tensor.expand_shape %1048 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_599 = tensor.extract_slice %expanded_598[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1049 = iree_tensor_ext.bitcast %extracted_slice_599 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_600 = tensor.extract_slice %expanded_598[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1050 = iree_tensor_ext.bitcast %extracted_slice_600 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1051 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1049, %1050 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_601 = tensor.expand_shape %1047 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1052 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_601, %1051 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1053 = linalg.copy ins(%1052 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1054 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1022, %1053 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1055 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1054 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1056 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1055 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1057 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1056 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1058 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1057 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1059 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1058 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1060 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1059 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1061 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1055, %1060 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1062 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1061 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1063 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.attn_norm.weight, %1062 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1064 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1063 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1065 = iree_tensor_ext.bitcast %__auto.blk.9.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_602 = tensor.expand_shape %1065 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_603 = tensor.extract_slice %expanded_602[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1066 = iree_tensor_ext.bitcast %extracted_slice_603 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_604 = tensor.extract_slice %expanded_602[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1067 = iree_tensor_ext.bitcast %extracted_slice_604 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1068 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1066, %1067 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_605 = tensor.expand_shape %1064 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1069 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_605, %1068 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1070 = linalg.copy ins(%1069 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1071 = iree_tensor_ext.bitcast %__auto.blk.9.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_606 = tensor.expand_shape %1071 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_607 = tensor.extract_slice %expanded_606[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1072 = iree_tensor_ext.bitcast %extracted_slice_607 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_608 = tensor.extract_slice %expanded_606[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1073 = iree_tensor_ext.bitcast %extracted_slice_608 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1074 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1072, %1073 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1075 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_605, %1074 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1076 = linalg.copy ins(%1075 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1077 = iree_tensor_ext.bitcast %__auto.blk.9.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_609 = tensor.expand_shape %1077 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_610 = tensor.extract_slice %expanded_609[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1078 = iree_tensor_ext.bitcast %extracted_slice_610 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_611 = tensor.extract_slice %expanded_609[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1079 = iree_tensor_ext.bitcast %extracted_slice_611 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1080 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1078, %1079 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1081 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_605, %1080 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1082 = linalg.copy ins(%1081 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_612 = tensor.expand_shape %1070 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_613 = tensor.expand_shape %1076 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_614 = tensor.expand_shape %1082 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1083 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_615 = tensor.expand_shape %1083 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1084 = linalg.batch_matmul ins(%expanded_615, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_616 = linalg.transpose ins(%1084 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1085 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_616 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1086 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1085, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1087 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1086 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1088 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_616 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1089 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1088, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1090 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1089 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_617 = tensor.expand_shape %1087 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_618 = tensor.expand_shape %1090 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_619 = tensor.extract_slice %expanded_612[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_620 = tensor.extract_slice %expanded_612[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1091 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_619, %expanded_617 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1092 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_620, %expanded_618 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1093 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1091, %1092 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1094 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_620, %expanded_617 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1095 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_619, %expanded_618 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1096 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1094, %1095 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1097 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1093, %1096 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_621 = tensor.collapse_shape %1097 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1098 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_622 = tensor.expand_shape %1098 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1099 = linalg.batch_matmul ins(%expanded_622, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_623 = linalg.transpose ins(%1099 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1100 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_623 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1101 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1100, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1101 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1103 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_623 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1104 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1103, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1105 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1104 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_624 = tensor.expand_shape %1102 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_625 = tensor.expand_shape %1105 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_626 = tensor.extract_slice %expanded_613[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_627 = tensor.extract_slice %expanded_613[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1106 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_626, %expanded_624 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1107 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_627, %expanded_625 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1108 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1106, %1107 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1109 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_627, %expanded_624 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1110 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_626, %expanded_625 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1111 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1109, %1110 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1112 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1108, %1111 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_628 = tensor.collapse_shape %1112 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1113 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c9_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1114 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1113 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_629 = tensor.collapse_shape %1114 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_630 = tensor.expand_shape %collapsed_628 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_631 = tensor.collapse_shape %expanded_630 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_632 = linalg.transpose ins(%collapsed_631 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_633 = tensor.expand_shape %collapsed_629 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1115 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_632, %expanded_633 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1008 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1116 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1114 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_634 = tensor.collapse_shape %1116 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_635 = tensor.expand_shape %1082 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_636 = tensor.collapse_shape %expanded_635 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_637 = linalg.transpose ins(%collapsed_636 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_638 = tensor.expand_shape %collapsed_634 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1117 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_637, %expanded_638 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1115 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1118 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_628 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_639 = tensor.collapse_shape %1118 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1119 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_614 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_640 = tensor.collapse_shape %1119 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_641 = linalg.transpose ins(%collapsed_621 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_642 = linalg.transpose ins(%collapsed_639 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_643 = linalg.transpose ins(%collapsed_640 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_644 = tensor.collapse_shape %transposed_641 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_645 = tensor.collapse_shape %transposed_642 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_646 = tensor.collapse_shape %transposed_643 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1120 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_644, %collapsed_645, %collapsed_646, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_647 = tensor.expand_shape %1120 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_648 = tensor.dim %expanded_647, %c2 : tensor<4x32x?x64xf16>
    %1121 = tensor.empty(%dim_648) : tensor<4x?x32x64xf16>
    %transposed_649 = linalg.transpose ins(%expanded_647 : tensor<4x32x?x64xf16>) outs(%1121 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_650 = tensor.collapse_shape %transposed_649 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1122 = iree_tensor_ext.bitcast %__auto.blk.9.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_651 = tensor.expand_shape %1122 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_652 = tensor.extract_slice %expanded_651[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1123 = iree_tensor_ext.bitcast %extracted_slice_652 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_653 = tensor.extract_slice %expanded_651[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1124 = iree_tensor_ext.bitcast %extracted_slice_653 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_654 = tensor.dim %collapsed_650, %c1 : tensor<4x?x2048xf16>
    %1125 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1123, %1124 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_655 = tensor.expand_shape %collapsed_650 [[0], [1], [2, 3]] output_shape [4, %dim_654, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1126 = tensor.empty(%dim_654) : tensor<4x?x2048xf32>
    %1127 = linalg.fill ins(%cst_3 : f32) outs(%1126 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1128 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_655, %1125 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1127 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1129 = tensor.empty(%dim_654) : tensor<4x?x2048xf16>
    %1130 = linalg.copy ins(%1128 : tensor<4x?x2048xf32>) outs(%1129 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1131 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1054, %1130 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1132 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1131 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1133 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1132 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1134 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1133 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1135 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1134 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1136 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1135 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1137 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1136 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1138 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1132, %1137 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1139 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1138 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1140 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.ffn_norm.weight, %1139 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1141 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1140 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1142 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_656 = tensor.expand_shape %1142 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_657 = tensor.extract_slice %expanded_656[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1143 = iree_tensor_ext.bitcast %extracted_slice_657 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_658 = tensor.extract_slice %expanded_656[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1144 = iree_tensor_ext.bitcast %extracted_slice_658 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1145 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1143, %1144 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_659 = tensor.expand_shape %1141 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1146 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_659, %1145 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1147 = linalg.copy ins(%1146 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1148 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1147 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1149 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1148, %1147 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1150 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_660 = tensor.expand_shape %1150 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_661 = tensor.extract_slice %expanded_660[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1151 = iree_tensor_ext.bitcast %extracted_slice_661 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_662 = tensor.extract_slice %expanded_660[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1152 = iree_tensor_ext.bitcast %extracted_slice_662 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1153 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1151, %1152 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1154 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_659, %1153 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1155 = linalg.copy ins(%1154 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1156 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1149, %1155 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1157 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_663 = tensor.expand_shape %1157 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_664 = tensor.extract_slice %expanded_663[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1158 = iree_tensor_ext.bitcast %extracted_slice_664 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_665 = tensor.extract_slice %expanded_663[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1159 = iree_tensor_ext.bitcast %extracted_slice_665 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1160 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1158, %1159 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_666 = tensor.expand_shape %1156 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1161 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_666, %1160 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1162 = linalg.copy ins(%1161 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1163 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1131, %1162 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1164 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1163 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1165 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1164 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1166 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1165 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1167 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1166 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1168 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1167 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1169 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1168 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1170 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1164, %1169 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1171 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1170 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1172 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.attn_norm.weight, %1171 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1173 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1172 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1174 = iree_tensor_ext.bitcast %__auto.blk.10.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_667 = tensor.expand_shape %1174 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_668 = tensor.extract_slice %expanded_667[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1175 = iree_tensor_ext.bitcast %extracted_slice_668 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_669 = tensor.extract_slice %expanded_667[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1176 = iree_tensor_ext.bitcast %extracted_slice_669 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1177 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1175, %1176 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_670 = tensor.expand_shape %1173 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1178 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_670, %1177 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1179 = linalg.copy ins(%1178 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1180 = iree_tensor_ext.bitcast %__auto.blk.10.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_671 = tensor.expand_shape %1180 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_672 = tensor.extract_slice %expanded_671[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1181 = iree_tensor_ext.bitcast %extracted_slice_672 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_673 = tensor.extract_slice %expanded_671[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1182 = iree_tensor_ext.bitcast %extracted_slice_673 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1183 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1181, %1182 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1184 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_670, %1183 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1185 = linalg.copy ins(%1184 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1186 = iree_tensor_ext.bitcast %__auto.blk.10.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_674 = tensor.expand_shape %1186 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_675 = tensor.extract_slice %expanded_674[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1187 = iree_tensor_ext.bitcast %extracted_slice_675 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_676 = tensor.extract_slice %expanded_674[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1188 = iree_tensor_ext.bitcast %extracted_slice_676 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1189 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1187, %1188 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1190 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_670, %1189 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1191 = linalg.copy ins(%1190 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_677 = tensor.expand_shape %1179 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_678 = tensor.expand_shape %1185 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_679 = tensor.expand_shape %1191 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1192 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_680 = tensor.expand_shape %1192 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1193 = linalg.batch_matmul ins(%expanded_680, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_681 = linalg.transpose ins(%1193 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1194 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_681 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1195 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1194, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1196 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1195 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1197 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_681 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1198 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1197, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1199 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1198 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_682 = tensor.expand_shape %1196 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_683 = tensor.expand_shape %1199 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_684 = tensor.extract_slice %expanded_677[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_685 = tensor.extract_slice %expanded_677[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1200 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_684, %expanded_682 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1201 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_685, %expanded_683 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1202 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1200, %1201 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1203 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_685, %expanded_682 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1204 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_684, %expanded_683 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1205 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1203, %1204 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1206 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1202, %1205 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_686 = tensor.collapse_shape %1206 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1207 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_687 = tensor.expand_shape %1207 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1208 = linalg.batch_matmul ins(%expanded_687, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_688 = linalg.transpose ins(%1208 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1209 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_688 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1210 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1209, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1211 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1210 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1212 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_688 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1213 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1212, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1214 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1213 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_689 = tensor.expand_shape %1211 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_690 = tensor.expand_shape %1214 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_691 = tensor.extract_slice %expanded_678[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_692 = tensor.extract_slice %expanded_678[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1215 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_691, %expanded_689 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1216 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_692, %expanded_690 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1217 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1215, %1216 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1218 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_692, %expanded_689 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1219 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_691, %expanded_690 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1220 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1218, %1219 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1221 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1217, %1220 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_693 = tensor.collapse_shape %1221 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1222 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c10_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1223 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1222 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_694 = tensor.collapse_shape %1223 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_695 = tensor.expand_shape %collapsed_693 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_696 = tensor.collapse_shape %expanded_695 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_697 = linalg.transpose ins(%collapsed_696 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_698 = tensor.expand_shape %collapsed_694 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1224 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_697, %expanded_698 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1117 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1225 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1223 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_699 = tensor.collapse_shape %1225 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_700 = tensor.expand_shape %1191 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_701 = tensor.collapse_shape %expanded_700 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_702 = linalg.transpose ins(%collapsed_701 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_703 = tensor.expand_shape %collapsed_699 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1226 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_702, %expanded_703 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1224 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1227 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_693 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_704 = tensor.collapse_shape %1227 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1228 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_679 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_705 = tensor.collapse_shape %1228 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_706 = linalg.transpose ins(%collapsed_686 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_707 = linalg.transpose ins(%collapsed_704 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_708 = linalg.transpose ins(%collapsed_705 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_709 = tensor.collapse_shape %transposed_706 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_710 = tensor.collapse_shape %transposed_707 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_711 = tensor.collapse_shape %transposed_708 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1229 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_709, %collapsed_710, %collapsed_711, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_712 = tensor.expand_shape %1229 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_713 = tensor.dim %expanded_712, %c2 : tensor<4x32x?x64xf16>
    %1230 = tensor.empty(%dim_713) : tensor<4x?x32x64xf16>
    %transposed_714 = linalg.transpose ins(%expanded_712 : tensor<4x32x?x64xf16>) outs(%1230 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_715 = tensor.collapse_shape %transposed_714 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1231 = iree_tensor_ext.bitcast %__auto.blk.10.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_716 = tensor.expand_shape %1231 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_717 = tensor.extract_slice %expanded_716[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1232 = iree_tensor_ext.bitcast %extracted_slice_717 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_718 = tensor.extract_slice %expanded_716[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1233 = iree_tensor_ext.bitcast %extracted_slice_718 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_719 = tensor.dim %collapsed_715, %c1 : tensor<4x?x2048xf16>
    %1234 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1232, %1233 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_720 = tensor.expand_shape %collapsed_715 [[0], [1], [2, 3]] output_shape [4, %dim_719, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1235 = tensor.empty(%dim_719) : tensor<4x?x2048xf32>
    %1236 = linalg.fill ins(%cst_3 : f32) outs(%1235 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1237 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_720, %1234 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1236 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1238 = tensor.empty(%dim_719) : tensor<4x?x2048xf16>
    %1239 = linalg.copy ins(%1237 : tensor<4x?x2048xf32>) outs(%1238 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1240 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1163, %1239 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1241 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1240 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1242 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1241 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1243 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1242 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1244 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1243 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1245 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1244 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1246 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1245 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1247 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1241, %1246 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1248 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1247 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1249 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.ffn_norm.weight, %1248 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1250 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1249 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1251 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_721 = tensor.expand_shape %1251 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_722 = tensor.extract_slice %expanded_721[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1252 = iree_tensor_ext.bitcast %extracted_slice_722 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_723 = tensor.extract_slice %expanded_721[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1253 = iree_tensor_ext.bitcast %extracted_slice_723 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1254 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1252, %1253 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_724 = tensor.expand_shape %1250 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1255 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_724, %1254 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1256 = linalg.copy ins(%1255 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1256 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1258 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1257, %1256 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1259 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_725 = tensor.expand_shape %1259 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_726 = tensor.extract_slice %expanded_725[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1260 = iree_tensor_ext.bitcast %extracted_slice_726 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_727 = tensor.extract_slice %expanded_725[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1261 = iree_tensor_ext.bitcast %extracted_slice_727 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1262 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1260, %1261 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1263 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_724, %1262 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1264 = linalg.copy ins(%1263 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1265 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1258, %1264 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1266 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_728 = tensor.expand_shape %1266 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_729 = tensor.extract_slice %expanded_728[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1267 = iree_tensor_ext.bitcast %extracted_slice_729 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_730 = tensor.extract_slice %expanded_728[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1268 = iree_tensor_ext.bitcast %extracted_slice_730 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1269 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1267, %1268 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_731 = tensor.expand_shape %1265 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1270 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_731, %1269 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1271 = linalg.copy ins(%1270 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1272 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1240, %1271 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1273 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1272 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1274 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1273 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1275 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1274 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1276 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1275 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1277 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1276 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1278 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1277 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1279 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1273, %1278 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1280 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1279 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1281 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.attn_norm.weight, %1280 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1282 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1281 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1283 = iree_tensor_ext.bitcast %__auto.blk.11.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_732 = tensor.expand_shape %1283 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_733 = tensor.extract_slice %expanded_732[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1284 = iree_tensor_ext.bitcast %extracted_slice_733 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_734 = tensor.extract_slice %expanded_732[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1285 = iree_tensor_ext.bitcast %extracted_slice_734 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1286 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1284, %1285 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_735 = tensor.expand_shape %1282 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1287 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_735, %1286 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1288 = linalg.copy ins(%1287 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1289 = iree_tensor_ext.bitcast %__auto.blk.11.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_736 = tensor.expand_shape %1289 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_737 = tensor.extract_slice %expanded_736[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1290 = iree_tensor_ext.bitcast %extracted_slice_737 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_738 = tensor.extract_slice %expanded_736[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1291 = iree_tensor_ext.bitcast %extracted_slice_738 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1292 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1290, %1291 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1293 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_735, %1292 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1294 = linalg.copy ins(%1293 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1295 = iree_tensor_ext.bitcast %__auto.blk.11.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_739 = tensor.expand_shape %1295 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_740 = tensor.extract_slice %expanded_739[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1296 = iree_tensor_ext.bitcast %extracted_slice_740 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_741 = tensor.extract_slice %expanded_739[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1297 = iree_tensor_ext.bitcast %extracted_slice_741 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1298 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1296, %1297 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1299 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_735, %1298 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1300 = linalg.copy ins(%1299 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_742 = tensor.expand_shape %1288 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_743 = tensor.expand_shape %1294 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_744 = tensor.expand_shape %1300 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1301 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_745 = tensor.expand_shape %1301 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1302 = linalg.batch_matmul ins(%expanded_745, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_746 = linalg.transpose ins(%1302 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1303 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_746 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1304 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1303, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1305 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1304 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1306 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_746 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1307 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1306, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1308 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1307 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_747 = tensor.expand_shape %1305 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_748 = tensor.expand_shape %1308 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_749 = tensor.extract_slice %expanded_742[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_750 = tensor.extract_slice %expanded_742[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1309 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_749, %expanded_747 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1310 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_750, %expanded_748 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1311 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1309, %1310 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1312 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_750, %expanded_747 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1313 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_749, %expanded_748 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1314 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1312, %1313 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1315 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1311, %1314 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_751 = tensor.collapse_shape %1315 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1316 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_752 = tensor.expand_shape %1316 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1317 = linalg.batch_matmul ins(%expanded_752, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_753 = linalg.transpose ins(%1317 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1318 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_753 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1319 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1318, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1320 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1319 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1321 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_753 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1322 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1321, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1323 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1322 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_754 = tensor.expand_shape %1320 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_755 = tensor.expand_shape %1323 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_756 = tensor.extract_slice %expanded_743[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_757 = tensor.extract_slice %expanded_743[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1324 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_756, %expanded_754 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1325 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_757, %expanded_755 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1326 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1324, %1325 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1327 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_757, %expanded_754 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1328 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_756, %expanded_755 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1329 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1327, %1328 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1330 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1326, %1329 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_758 = tensor.collapse_shape %1330 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1331 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c11_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1332 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1331 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_759 = tensor.collapse_shape %1332 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_760 = tensor.expand_shape %collapsed_758 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_761 = tensor.collapse_shape %expanded_760 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_762 = linalg.transpose ins(%collapsed_761 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_763 = tensor.expand_shape %collapsed_759 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1333 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_762, %expanded_763 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1226 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1334 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1332 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_764 = tensor.collapse_shape %1334 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_765 = tensor.expand_shape %1300 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_766 = tensor.collapse_shape %expanded_765 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_767 = linalg.transpose ins(%collapsed_766 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_768 = tensor.expand_shape %collapsed_764 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1335 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_767, %expanded_768 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1333 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1336 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_758 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_769 = tensor.collapse_shape %1336 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1337 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_744 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_770 = tensor.collapse_shape %1337 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_771 = linalg.transpose ins(%collapsed_751 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_772 = linalg.transpose ins(%collapsed_769 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_773 = linalg.transpose ins(%collapsed_770 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_774 = tensor.collapse_shape %transposed_771 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_775 = tensor.collapse_shape %transposed_772 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_776 = tensor.collapse_shape %transposed_773 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1338 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_774, %collapsed_775, %collapsed_776, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_777 = tensor.expand_shape %1338 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_778 = tensor.dim %expanded_777, %c2 : tensor<4x32x?x64xf16>
    %1339 = tensor.empty(%dim_778) : tensor<4x?x32x64xf16>
    %transposed_779 = linalg.transpose ins(%expanded_777 : tensor<4x32x?x64xf16>) outs(%1339 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_780 = tensor.collapse_shape %transposed_779 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1340 = iree_tensor_ext.bitcast %__auto.blk.11.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_781 = tensor.expand_shape %1340 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_782 = tensor.extract_slice %expanded_781[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1341 = iree_tensor_ext.bitcast %extracted_slice_782 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_783 = tensor.extract_slice %expanded_781[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1342 = iree_tensor_ext.bitcast %extracted_slice_783 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_784 = tensor.dim %collapsed_780, %c1 : tensor<4x?x2048xf16>
    %1343 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1341, %1342 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_785 = tensor.expand_shape %collapsed_780 [[0], [1], [2, 3]] output_shape [4, %dim_784, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1344 = tensor.empty(%dim_784) : tensor<4x?x2048xf32>
    %1345 = linalg.fill ins(%cst_3 : f32) outs(%1344 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1346 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_785, %1343 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1345 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1347 = tensor.empty(%dim_784) : tensor<4x?x2048xf16>
    %1348 = linalg.copy ins(%1346 : tensor<4x?x2048xf32>) outs(%1347 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1349 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1272, %1348 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1350 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1349 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1351 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1350 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1352 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1351 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1353 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1352 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1354 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1353 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1355 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1354 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1356 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1350, %1355 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1357 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1356 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1358 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.ffn_norm.weight, %1357 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1359 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1358 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1360 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_786 = tensor.expand_shape %1360 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_787 = tensor.extract_slice %expanded_786[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1361 = iree_tensor_ext.bitcast %extracted_slice_787 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_788 = tensor.extract_slice %expanded_786[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1362 = iree_tensor_ext.bitcast %extracted_slice_788 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1363 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1361, %1362 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_789 = tensor.expand_shape %1359 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1364 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_789, %1363 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1365 = linalg.copy ins(%1364 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1366 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1365 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1367 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1366, %1365 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1368 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_790 = tensor.expand_shape %1368 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_791 = tensor.extract_slice %expanded_790[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1369 = iree_tensor_ext.bitcast %extracted_slice_791 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_792 = tensor.extract_slice %expanded_790[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1370 = iree_tensor_ext.bitcast %extracted_slice_792 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1371 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1369, %1370 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1372 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_789, %1371 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1373 = linalg.copy ins(%1372 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1374 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1367, %1373 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1375 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_793 = tensor.expand_shape %1375 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_794 = tensor.extract_slice %expanded_793[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1376 = iree_tensor_ext.bitcast %extracted_slice_794 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_795 = tensor.extract_slice %expanded_793[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1377 = iree_tensor_ext.bitcast %extracted_slice_795 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1378 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1376, %1377 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_796 = tensor.expand_shape %1374 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1379 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_796, %1378 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1380 = linalg.copy ins(%1379 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1381 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1349, %1380 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1382 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1381 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1383 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1382 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1384 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1383 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1385 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1384 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1386 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1385 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1387 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1386 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1388 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1382, %1387 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1389 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1388 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1390 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.attn_norm.weight, %1389 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1391 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1390 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1392 = iree_tensor_ext.bitcast %__auto.blk.12.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_797 = tensor.expand_shape %1392 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_798 = tensor.extract_slice %expanded_797[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1393 = iree_tensor_ext.bitcast %extracted_slice_798 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_799 = tensor.extract_slice %expanded_797[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1394 = iree_tensor_ext.bitcast %extracted_slice_799 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1395 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1393, %1394 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_800 = tensor.expand_shape %1391 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1396 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_800, %1395 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1397 = linalg.copy ins(%1396 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1398 = iree_tensor_ext.bitcast %__auto.blk.12.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_801 = tensor.expand_shape %1398 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_802 = tensor.extract_slice %expanded_801[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1399 = iree_tensor_ext.bitcast %extracted_slice_802 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_803 = tensor.extract_slice %expanded_801[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1400 = iree_tensor_ext.bitcast %extracted_slice_803 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1401 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1399, %1400 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1402 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_800, %1401 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1403 = linalg.copy ins(%1402 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1404 = iree_tensor_ext.bitcast %__auto.blk.12.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_804 = tensor.expand_shape %1404 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_805 = tensor.extract_slice %expanded_804[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1405 = iree_tensor_ext.bitcast %extracted_slice_805 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_806 = tensor.extract_slice %expanded_804[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1406 = iree_tensor_ext.bitcast %extracted_slice_806 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1407 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1405, %1406 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1408 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_800, %1407 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1409 = linalg.copy ins(%1408 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_807 = tensor.expand_shape %1397 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_808 = tensor.expand_shape %1403 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_809 = tensor.expand_shape %1409 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1410 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_810 = tensor.expand_shape %1410 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1411 = linalg.batch_matmul ins(%expanded_810, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_811 = linalg.transpose ins(%1411 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1412 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_811 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1413 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1412, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1414 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1413 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1415 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_811 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1416 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1415, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1417 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1416 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_812 = tensor.expand_shape %1414 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_813 = tensor.expand_shape %1417 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_814 = tensor.extract_slice %expanded_807[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_815 = tensor.extract_slice %expanded_807[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1418 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_814, %expanded_812 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1419 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_815, %expanded_813 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1420 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1418, %1419 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1421 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_815, %expanded_812 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1422 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_814, %expanded_813 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1423 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1421, %1422 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1424 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1420, %1423 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_816 = tensor.collapse_shape %1424 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1425 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_817 = tensor.expand_shape %1425 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1426 = linalg.batch_matmul ins(%expanded_817, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_818 = linalg.transpose ins(%1426 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1427 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_818 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1428 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1427, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1429 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1428 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1430 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_818 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1431 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1430, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1432 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1431 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_819 = tensor.expand_shape %1429 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_820 = tensor.expand_shape %1432 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_821 = tensor.extract_slice %expanded_808[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_822 = tensor.extract_slice %expanded_808[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1433 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_821, %expanded_819 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1434 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_822, %expanded_820 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1435 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1433, %1434 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1436 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_822, %expanded_819 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1437 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_821, %expanded_820 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1438 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1436, %1437 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1439 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1435, %1438 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_823 = tensor.collapse_shape %1439 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1440 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c12_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1441 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1440 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_824 = tensor.collapse_shape %1441 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_825 = tensor.expand_shape %collapsed_823 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_826 = tensor.collapse_shape %expanded_825 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_827 = linalg.transpose ins(%collapsed_826 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_828 = tensor.expand_shape %collapsed_824 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1442 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_827, %expanded_828 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1335 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1443 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1441 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_829 = tensor.collapse_shape %1443 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_830 = tensor.expand_shape %1409 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_831 = tensor.collapse_shape %expanded_830 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_832 = linalg.transpose ins(%collapsed_831 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_833 = tensor.expand_shape %collapsed_829 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1444 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_832, %expanded_833 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1442 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1445 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_823 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_834 = tensor.collapse_shape %1445 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1446 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_809 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_835 = tensor.collapse_shape %1446 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_836 = linalg.transpose ins(%collapsed_816 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_837 = linalg.transpose ins(%collapsed_834 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_838 = linalg.transpose ins(%collapsed_835 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_839 = tensor.collapse_shape %transposed_836 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_840 = tensor.collapse_shape %transposed_837 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_841 = tensor.collapse_shape %transposed_838 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1447 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_839, %collapsed_840, %collapsed_841, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_842 = tensor.expand_shape %1447 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_843 = tensor.dim %expanded_842, %c2 : tensor<4x32x?x64xf16>
    %1448 = tensor.empty(%dim_843) : tensor<4x?x32x64xf16>
    %transposed_844 = linalg.transpose ins(%expanded_842 : tensor<4x32x?x64xf16>) outs(%1448 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_845 = tensor.collapse_shape %transposed_844 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1449 = iree_tensor_ext.bitcast %__auto.blk.12.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_846 = tensor.expand_shape %1449 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_847 = tensor.extract_slice %expanded_846[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1450 = iree_tensor_ext.bitcast %extracted_slice_847 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_848 = tensor.extract_slice %expanded_846[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1451 = iree_tensor_ext.bitcast %extracted_slice_848 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_849 = tensor.dim %collapsed_845, %c1 : tensor<4x?x2048xf16>
    %1452 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1450, %1451 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_850 = tensor.expand_shape %collapsed_845 [[0], [1], [2, 3]] output_shape [4, %dim_849, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1453 = tensor.empty(%dim_849) : tensor<4x?x2048xf32>
    %1454 = linalg.fill ins(%cst_3 : f32) outs(%1453 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1455 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_850, %1452 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1454 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1456 = tensor.empty(%dim_849) : tensor<4x?x2048xf16>
    %1457 = linalg.copy ins(%1455 : tensor<4x?x2048xf32>) outs(%1456 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1458 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1381, %1457 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1459 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1458 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1460 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1459 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1461 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1460 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1462 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1461 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1463 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1462 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1464 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1463 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1465 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1459, %1464 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1466 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1465 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1467 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.ffn_norm.weight, %1466 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1468 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1467 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1469 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_851 = tensor.expand_shape %1469 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_852 = tensor.extract_slice %expanded_851[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1470 = iree_tensor_ext.bitcast %extracted_slice_852 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_853 = tensor.extract_slice %expanded_851[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1471 = iree_tensor_ext.bitcast %extracted_slice_853 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1472 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1470, %1471 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_854 = tensor.expand_shape %1468 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1473 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_854, %1472 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1474 = linalg.copy ins(%1473 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1475 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1474 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1476 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1475, %1474 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1477 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_855 = tensor.expand_shape %1477 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_856 = tensor.extract_slice %expanded_855[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1478 = iree_tensor_ext.bitcast %extracted_slice_856 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_857 = tensor.extract_slice %expanded_855[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1479 = iree_tensor_ext.bitcast %extracted_slice_857 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1480 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1478, %1479 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1481 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_854, %1480 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1482 = linalg.copy ins(%1481 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1483 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1476, %1482 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1484 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_858 = tensor.expand_shape %1484 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_859 = tensor.extract_slice %expanded_858[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1485 = iree_tensor_ext.bitcast %extracted_slice_859 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_860 = tensor.extract_slice %expanded_858[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1486 = iree_tensor_ext.bitcast %extracted_slice_860 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1487 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1485, %1486 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_861 = tensor.expand_shape %1483 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1488 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_861, %1487 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1489 = linalg.copy ins(%1488 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1490 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1458, %1489 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1491 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1490 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1492 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1491 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1493 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1492 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1494 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1493 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1495 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1494 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1496 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1495 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1497 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1491, %1496 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1498 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1497 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1499 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.attn_norm.weight, %1498 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1500 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1499 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1501 = iree_tensor_ext.bitcast %__auto.blk.13.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_862 = tensor.expand_shape %1501 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_863 = tensor.extract_slice %expanded_862[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1502 = iree_tensor_ext.bitcast %extracted_slice_863 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_864 = tensor.extract_slice %expanded_862[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1503 = iree_tensor_ext.bitcast %extracted_slice_864 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1504 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1502, %1503 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_865 = tensor.expand_shape %1500 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1505 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_865, %1504 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1506 = linalg.copy ins(%1505 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1507 = iree_tensor_ext.bitcast %__auto.blk.13.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_866 = tensor.expand_shape %1507 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_867 = tensor.extract_slice %expanded_866[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1508 = iree_tensor_ext.bitcast %extracted_slice_867 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_868 = tensor.extract_slice %expanded_866[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1509 = iree_tensor_ext.bitcast %extracted_slice_868 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1510 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1508, %1509 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1511 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_865, %1510 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1512 = linalg.copy ins(%1511 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1513 = iree_tensor_ext.bitcast %__auto.blk.13.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_869 = tensor.expand_shape %1513 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_870 = tensor.extract_slice %expanded_869[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1514 = iree_tensor_ext.bitcast %extracted_slice_870 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_871 = tensor.extract_slice %expanded_869[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1515 = iree_tensor_ext.bitcast %extracted_slice_871 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1516 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1514, %1515 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1517 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_865, %1516 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1518 = linalg.copy ins(%1517 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_872 = tensor.expand_shape %1506 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_873 = tensor.expand_shape %1512 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_874 = tensor.expand_shape %1518 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1519 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_875 = tensor.expand_shape %1519 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1520 = linalg.batch_matmul ins(%expanded_875, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_876 = linalg.transpose ins(%1520 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1521 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_876 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1522 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1521, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1523 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1522 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1524 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_876 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1525 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1524, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1526 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1525 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_877 = tensor.expand_shape %1523 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_878 = tensor.expand_shape %1526 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_879 = tensor.extract_slice %expanded_872[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_880 = tensor.extract_slice %expanded_872[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1527 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_879, %expanded_877 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1528 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_880, %expanded_878 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1529 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1527, %1528 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1530 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_880, %expanded_877 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1531 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_879, %expanded_878 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1532 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1530, %1531 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1533 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1529, %1532 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_881 = tensor.collapse_shape %1533 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1534 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_882 = tensor.expand_shape %1534 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1535 = linalg.batch_matmul ins(%expanded_882, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_883 = linalg.transpose ins(%1535 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1536 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_883 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1537 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1536, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1538 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1537 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1539 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_883 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1540 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1539, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1541 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1540 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_884 = tensor.expand_shape %1538 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_885 = tensor.expand_shape %1541 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_886 = tensor.extract_slice %expanded_873[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_887 = tensor.extract_slice %expanded_873[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1542 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_886, %expanded_884 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1543 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_887, %expanded_885 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1544 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1542, %1543 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1545 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_887, %expanded_884 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1546 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_886, %expanded_885 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1547 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1545, %1546 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1548 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1544, %1547 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_888 = tensor.collapse_shape %1548 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1549 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c13_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1550 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1549 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_889 = tensor.collapse_shape %1550 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_890 = tensor.expand_shape %collapsed_888 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_891 = tensor.collapse_shape %expanded_890 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_892 = linalg.transpose ins(%collapsed_891 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_893 = tensor.expand_shape %collapsed_889 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1551 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_892, %expanded_893 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1444 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1552 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1550 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_894 = tensor.collapse_shape %1552 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_895 = tensor.expand_shape %1518 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_896 = tensor.collapse_shape %expanded_895 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_897 = linalg.transpose ins(%collapsed_896 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_898 = tensor.expand_shape %collapsed_894 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1553 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_897, %expanded_898 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1551 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1554 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_888 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_899 = tensor.collapse_shape %1554 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1555 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_874 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_900 = tensor.collapse_shape %1555 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_901 = linalg.transpose ins(%collapsed_881 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_902 = linalg.transpose ins(%collapsed_899 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_903 = linalg.transpose ins(%collapsed_900 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_904 = tensor.collapse_shape %transposed_901 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_905 = tensor.collapse_shape %transposed_902 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_906 = tensor.collapse_shape %transposed_903 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1556 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_904, %collapsed_905, %collapsed_906, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_907 = tensor.expand_shape %1556 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_908 = tensor.dim %expanded_907, %c2 : tensor<4x32x?x64xf16>
    %1557 = tensor.empty(%dim_908) : tensor<4x?x32x64xf16>
    %transposed_909 = linalg.transpose ins(%expanded_907 : tensor<4x32x?x64xf16>) outs(%1557 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_910 = tensor.collapse_shape %transposed_909 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1558 = iree_tensor_ext.bitcast %__auto.blk.13.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_911 = tensor.expand_shape %1558 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_912 = tensor.extract_slice %expanded_911[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1559 = iree_tensor_ext.bitcast %extracted_slice_912 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_913 = tensor.extract_slice %expanded_911[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1560 = iree_tensor_ext.bitcast %extracted_slice_913 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_914 = tensor.dim %collapsed_910, %c1 : tensor<4x?x2048xf16>
    %1561 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1559, %1560 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_915 = tensor.expand_shape %collapsed_910 [[0], [1], [2, 3]] output_shape [4, %dim_914, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1562 = tensor.empty(%dim_914) : tensor<4x?x2048xf32>
    %1563 = linalg.fill ins(%cst_3 : f32) outs(%1562 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1564 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_915, %1561 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1563 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1565 = tensor.empty(%dim_914) : tensor<4x?x2048xf16>
    %1566 = linalg.copy ins(%1564 : tensor<4x?x2048xf32>) outs(%1565 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1567 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1490, %1566 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1568 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1567 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1569 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1568 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1570 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1569 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1571 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1570 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1572 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1571 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1573 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1572 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1574 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1568, %1573 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1575 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1574 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1576 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.ffn_norm.weight, %1575 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1577 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1576 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1578 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_916 = tensor.expand_shape %1578 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_917 = tensor.extract_slice %expanded_916[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1579 = iree_tensor_ext.bitcast %extracted_slice_917 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_918 = tensor.extract_slice %expanded_916[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1580 = iree_tensor_ext.bitcast %extracted_slice_918 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1581 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1579, %1580 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_919 = tensor.expand_shape %1577 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1582 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_919, %1581 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1583 = linalg.copy ins(%1582 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1584 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1583 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1585 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1584, %1583 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1586 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_920 = tensor.expand_shape %1586 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_921 = tensor.extract_slice %expanded_920[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1587 = iree_tensor_ext.bitcast %extracted_slice_921 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_922 = tensor.extract_slice %expanded_920[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1588 = iree_tensor_ext.bitcast %extracted_slice_922 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1589 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1587, %1588 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1590 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_919, %1589 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1591 = linalg.copy ins(%1590 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1592 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1585, %1591 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1593 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_923 = tensor.expand_shape %1593 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_924 = tensor.extract_slice %expanded_923[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1594 = iree_tensor_ext.bitcast %extracted_slice_924 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_925 = tensor.extract_slice %expanded_923[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1595 = iree_tensor_ext.bitcast %extracted_slice_925 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1596 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1594, %1595 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_926 = tensor.expand_shape %1592 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1597 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_926, %1596 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1598 = linalg.copy ins(%1597 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1599 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1567, %1598 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1600 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1599 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1601 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1600 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1602 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1601 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1603 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1602 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1604 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1603 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1605 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1604 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1606 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1600, %1605 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1607 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1606 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1608 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.attn_norm.weight, %1607 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1609 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1608 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1610 = iree_tensor_ext.bitcast %__auto.blk.14.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_927 = tensor.expand_shape %1610 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_928 = tensor.extract_slice %expanded_927[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1611 = iree_tensor_ext.bitcast %extracted_slice_928 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_929 = tensor.extract_slice %expanded_927[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1612 = iree_tensor_ext.bitcast %extracted_slice_929 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1613 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1611, %1612 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_930 = tensor.expand_shape %1609 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1614 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_930, %1613 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1615 = linalg.copy ins(%1614 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1616 = iree_tensor_ext.bitcast %__auto.blk.14.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_931 = tensor.expand_shape %1616 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_932 = tensor.extract_slice %expanded_931[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1617 = iree_tensor_ext.bitcast %extracted_slice_932 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_933 = tensor.extract_slice %expanded_931[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1618 = iree_tensor_ext.bitcast %extracted_slice_933 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1619 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1617, %1618 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1620 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_930, %1619 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1621 = linalg.copy ins(%1620 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1622 = iree_tensor_ext.bitcast %__auto.blk.14.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_934 = tensor.expand_shape %1622 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_935 = tensor.extract_slice %expanded_934[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1623 = iree_tensor_ext.bitcast %extracted_slice_935 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_936 = tensor.extract_slice %expanded_934[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1624 = iree_tensor_ext.bitcast %extracted_slice_936 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1625 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1623, %1624 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1626 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_930, %1625 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1627 = linalg.copy ins(%1626 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_937 = tensor.expand_shape %1615 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_938 = tensor.expand_shape %1621 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_939 = tensor.expand_shape %1627 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1628 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_940 = tensor.expand_shape %1628 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1629 = linalg.batch_matmul ins(%expanded_940, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_941 = linalg.transpose ins(%1629 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1630 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_941 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1631 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1630, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1632 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1631 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1633 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_941 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1634 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1633, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1635 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1634 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_942 = tensor.expand_shape %1632 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_943 = tensor.expand_shape %1635 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_944 = tensor.extract_slice %expanded_937[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_945 = tensor.extract_slice %expanded_937[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1636 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_944, %expanded_942 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1637 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_945, %expanded_943 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1638 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1636, %1637 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1639 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_945, %expanded_942 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1640 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_944, %expanded_943 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1641 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1639, %1640 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1642 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1638, %1641 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_946 = tensor.collapse_shape %1642 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1643 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_947 = tensor.expand_shape %1643 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1644 = linalg.batch_matmul ins(%expanded_947, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_948 = linalg.transpose ins(%1644 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1645 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_948 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1646 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1645, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1647 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1646 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1648 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_948 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1649 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1648, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1650 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1649 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_949 = tensor.expand_shape %1647 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_950 = tensor.expand_shape %1650 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_951 = tensor.extract_slice %expanded_938[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_952 = tensor.extract_slice %expanded_938[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1651 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_951, %expanded_949 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1652 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_952, %expanded_950 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1653 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1651, %1652 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1654 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_952, %expanded_949 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1655 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_951, %expanded_950 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1656 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1654, %1655 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1657 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1653, %1656 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_953 = tensor.collapse_shape %1657 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1658 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c14_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1659 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1658 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_954 = tensor.collapse_shape %1659 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_955 = tensor.expand_shape %collapsed_953 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_956 = tensor.collapse_shape %expanded_955 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_957 = linalg.transpose ins(%collapsed_956 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_958 = tensor.expand_shape %collapsed_954 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1660 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_957, %expanded_958 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1553 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1661 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1659 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_959 = tensor.collapse_shape %1661 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_960 = tensor.expand_shape %1627 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_961 = tensor.collapse_shape %expanded_960 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_962 = linalg.transpose ins(%collapsed_961 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_963 = tensor.expand_shape %collapsed_959 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1662 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_962, %expanded_963 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1660 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1663 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_953 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_964 = tensor.collapse_shape %1663 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1664 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_939 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_965 = tensor.collapse_shape %1664 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_966 = linalg.transpose ins(%collapsed_946 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_967 = linalg.transpose ins(%collapsed_964 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_968 = linalg.transpose ins(%collapsed_965 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_969 = tensor.collapse_shape %transposed_966 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_970 = tensor.collapse_shape %transposed_967 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_971 = tensor.collapse_shape %transposed_968 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1665 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_969, %collapsed_970, %collapsed_971, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_972 = tensor.expand_shape %1665 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_973 = tensor.dim %expanded_972, %c2 : tensor<4x32x?x64xf16>
    %1666 = tensor.empty(%dim_973) : tensor<4x?x32x64xf16>
    %transposed_974 = linalg.transpose ins(%expanded_972 : tensor<4x32x?x64xf16>) outs(%1666 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_975 = tensor.collapse_shape %transposed_974 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1667 = iree_tensor_ext.bitcast %__auto.blk.14.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_976 = tensor.expand_shape %1667 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_977 = tensor.extract_slice %expanded_976[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1668 = iree_tensor_ext.bitcast %extracted_slice_977 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_978 = tensor.extract_slice %expanded_976[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1669 = iree_tensor_ext.bitcast %extracted_slice_978 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_979 = tensor.dim %collapsed_975, %c1 : tensor<4x?x2048xf16>
    %1670 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1668, %1669 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_980 = tensor.expand_shape %collapsed_975 [[0], [1], [2, 3]] output_shape [4, %dim_979, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1671 = tensor.empty(%dim_979) : tensor<4x?x2048xf32>
    %1672 = linalg.fill ins(%cst_3 : f32) outs(%1671 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1673 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_980, %1670 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1672 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1674 = tensor.empty(%dim_979) : tensor<4x?x2048xf16>
    %1675 = linalg.copy ins(%1673 : tensor<4x?x2048xf32>) outs(%1674 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1676 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1599, %1675 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1677 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1676 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1678 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1677 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1679 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1678 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1680 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1679 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1681 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1680 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1682 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1681 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1683 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1677, %1682 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1684 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1683 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1685 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.ffn_norm.weight, %1684 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1686 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1685 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1687 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_981 = tensor.expand_shape %1687 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_982 = tensor.extract_slice %expanded_981[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1688 = iree_tensor_ext.bitcast %extracted_slice_982 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_983 = tensor.extract_slice %expanded_981[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1689 = iree_tensor_ext.bitcast %extracted_slice_983 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1690 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1688, %1689 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_984 = tensor.expand_shape %1686 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1691 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_984, %1690 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1692 = linalg.copy ins(%1691 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1693 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1692 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1694 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1693, %1692 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1695 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_985 = tensor.expand_shape %1695 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_986 = tensor.extract_slice %expanded_985[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1696 = iree_tensor_ext.bitcast %extracted_slice_986 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_987 = tensor.extract_slice %expanded_985[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1697 = iree_tensor_ext.bitcast %extracted_slice_987 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1698 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1696, %1697 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1699 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_984, %1698 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1700 = linalg.copy ins(%1699 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1701 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1694, %1700 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1702 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_988 = tensor.expand_shape %1702 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_989 = tensor.extract_slice %expanded_988[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1703 = iree_tensor_ext.bitcast %extracted_slice_989 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_990 = tensor.extract_slice %expanded_988[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1704 = iree_tensor_ext.bitcast %extracted_slice_990 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1705 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1703, %1704 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_991 = tensor.expand_shape %1701 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1706 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_991, %1705 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1707 = linalg.copy ins(%1706 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1708 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1676, %1707 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1709 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1708 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1710 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1709 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1711 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1710 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1712 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1711 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1713 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1712 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1714 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1713 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1715 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1709, %1714 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1716 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1715 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1717 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.attn_norm.weight, %1716 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1718 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1717 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1719 = iree_tensor_ext.bitcast %__auto.blk.15.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_992 = tensor.expand_shape %1719 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_993 = tensor.extract_slice %expanded_992[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1720 = iree_tensor_ext.bitcast %extracted_slice_993 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_994 = tensor.extract_slice %expanded_992[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1721 = iree_tensor_ext.bitcast %extracted_slice_994 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1722 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1720, %1721 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_995 = tensor.expand_shape %1718 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1723 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_995, %1722 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1724 = linalg.copy ins(%1723 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1725 = iree_tensor_ext.bitcast %__auto.blk.15.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_996 = tensor.expand_shape %1725 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_997 = tensor.extract_slice %expanded_996[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1726 = iree_tensor_ext.bitcast %extracted_slice_997 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_998 = tensor.extract_slice %expanded_996[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1727 = iree_tensor_ext.bitcast %extracted_slice_998 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1728 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1726, %1727 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1729 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_995, %1728 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1730 = linalg.copy ins(%1729 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1731 = iree_tensor_ext.bitcast %__auto.blk.15.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_999 = tensor.expand_shape %1731 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1000 = tensor.extract_slice %expanded_999[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1732 = iree_tensor_ext.bitcast %extracted_slice_1000 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1001 = tensor.extract_slice %expanded_999[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1733 = iree_tensor_ext.bitcast %extracted_slice_1001 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1734 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1732, %1733 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1735 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_995, %1734 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1736 = linalg.copy ins(%1735 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_1002 = tensor.expand_shape %1724 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1003 = tensor.expand_shape %1730 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1004 = tensor.expand_shape %1736 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1737 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1005 = tensor.expand_shape %1737 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1738 = linalg.batch_matmul ins(%expanded_1005, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1006 = linalg.transpose ins(%1738 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1739 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1006 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1740 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1739, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1741 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1740 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1742 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1006 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1743 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1742, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1744 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1743 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1007 = tensor.expand_shape %1741 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1008 = tensor.expand_shape %1744 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1009 = tensor.extract_slice %expanded_1002[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1010 = tensor.extract_slice %expanded_1002[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1745 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1009, %expanded_1007 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1746 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1010, %expanded_1008 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1747 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1745, %1746 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1748 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1010, %expanded_1007 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1749 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1009, %expanded_1008 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1750 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1748, %1749 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1751 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1747, %1750 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1011 = tensor.collapse_shape %1751 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1752 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1012 = tensor.expand_shape %1752 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1753 = linalg.batch_matmul ins(%expanded_1012, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1013 = linalg.transpose ins(%1753 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1754 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1013 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1755 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1754, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1756 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1755 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1757 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1013 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1758 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1757, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1759 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1758 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1014 = tensor.expand_shape %1756 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1015 = tensor.expand_shape %1759 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1016 = tensor.extract_slice %expanded_1003[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1017 = tensor.extract_slice %expanded_1003[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1760 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1016, %expanded_1014 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1761 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1017, %expanded_1015 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1762 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1760, %1761 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1763 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1017, %expanded_1014 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1764 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1016, %expanded_1015 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1765 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1763, %1764 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1766 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1762, %1765 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1018 = tensor.collapse_shape %1766 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1767 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c15_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1768 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1767 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1019 = tensor.collapse_shape %1768 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1020 = tensor.expand_shape %collapsed_1018 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1021 = tensor.collapse_shape %expanded_1020 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1022 = linalg.transpose ins(%collapsed_1021 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1023 = tensor.expand_shape %collapsed_1019 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1769 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1022, %expanded_1023 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1662 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1770 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1768 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1024 = tensor.collapse_shape %1770 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1025 = tensor.expand_shape %1736 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1026 = tensor.collapse_shape %expanded_1025 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1027 = linalg.transpose ins(%collapsed_1026 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1028 = tensor.expand_shape %collapsed_1024 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1771 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1027, %expanded_1028 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1769 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1772 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1018 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1029 = tensor.collapse_shape %1772 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1773 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1004 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1030 = tensor.collapse_shape %1773 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1031 = linalg.transpose ins(%collapsed_1011 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1032 = linalg.transpose ins(%collapsed_1029 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1033 = linalg.transpose ins(%collapsed_1030 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1034 = tensor.collapse_shape %transposed_1031 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1035 = tensor.collapse_shape %transposed_1032 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1036 = tensor.collapse_shape %transposed_1033 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1774 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1034, %collapsed_1035, %collapsed_1036, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1037 = tensor.expand_shape %1774 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1038 = tensor.dim %expanded_1037, %c2 : tensor<4x32x?x64xf16>
    %1775 = tensor.empty(%dim_1038) : tensor<4x?x32x64xf16>
    %transposed_1039 = linalg.transpose ins(%expanded_1037 : tensor<4x32x?x64xf16>) outs(%1775 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1040 = tensor.collapse_shape %transposed_1039 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1776 = iree_tensor_ext.bitcast %__auto.blk.15.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1041 = tensor.expand_shape %1776 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1042 = tensor.extract_slice %expanded_1041[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1777 = iree_tensor_ext.bitcast %extracted_slice_1042 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1043 = tensor.extract_slice %expanded_1041[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1778 = iree_tensor_ext.bitcast %extracted_slice_1043 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1044 = tensor.dim %collapsed_1040, %c1 : tensor<4x?x2048xf16>
    %1779 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1777, %1778 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1045 = tensor.expand_shape %collapsed_1040 [[0], [1], [2, 3]] output_shape [4, %dim_1044, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1780 = tensor.empty(%dim_1044) : tensor<4x?x2048xf32>
    %1781 = linalg.fill ins(%cst_3 : f32) outs(%1780 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1782 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1045, %1779 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1781 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1783 = tensor.empty(%dim_1044) : tensor<4x?x2048xf16>
    %1784 = linalg.copy ins(%1782 : tensor<4x?x2048xf32>) outs(%1783 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1785 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1708, %1784 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1786 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1785 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1787 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1786 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1788 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1787 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1789 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1788 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1790 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1789 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1791 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1790 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1792 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1786, %1791 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1793 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1792 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1794 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.ffn_norm.weight, %1793 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1795 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1794 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1796 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1046 = tensor.expand_shape %1796 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1047 = tensor.extract_slice %expanded_1046[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1797 = iree_tensor_ext.bitcast %extracted_slice_1047 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1048 = tensor.extract_slice %expanded_1046[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1798 = iree_tensor_ext.bitcast %extracted_slice_1048 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1799 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1797, %1798 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1049 = tensor.expand_shape %1795 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1800 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1049, %1799 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1801 = linalg.copy ins(%1800 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1802 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1801 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1803 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1802, %1801 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1804 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1050 = tensor.expand_shape %1804 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1051 = tensor.extract_slice %expanded_1050[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1805 = iree_tensor_ext.bitcast %extracted_slice_1051 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1052 = tensor.extract_slice %expanded_1050[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1806 = iree_tensor_ext.bitcast %extracted_slice_1052 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1807 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1805, %1806 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1808 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1049, %1807 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1809 = linalg.copy ins(%1808 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1810 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1803, %1809 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1811 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1053 = tensor.expand_shape %1811 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1054 = tensor.extract_slice %expanded_1053[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1812 = iree_tensor_ext.bitcast %extracted_slice_1054 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1055 = tensor.extract_slice %expanded_1053[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1813 = iree_tensor_ext.bitcast %extracted_slice_1055 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1814 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1812, %1813 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1056 = tensor.expand_shape %1810 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1815 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1056, %1814 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1816 = linalg.copy ins(%1815 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1817 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1785, %1816 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1818 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1817 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1819 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1818 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1820 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1819 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1821 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1820 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1822 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1821 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1823 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1822 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1824 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1818, %1823 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1825 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1824 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1826 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.attn_norm.weight, %1825 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1827 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1826 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1828 = iree_tensor_ext.bitcast %__auto.blk.16.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1057 = tensor.expand_shape %1828 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1058 = tensor.extract_slice %expanded_1057[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1829 = iree_tensor_ext.bitcast %extracted_slice_1058 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1059 = tensor.extract_slice %expanded_1057[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1830 = iree_tensor_ext.bitcast %extracted_slice_1059 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1831 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1829, %1830 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1060 = tensor.expand_shape %1827 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1832 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1060, %1831 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1833 = linalg.copy ins(%1832 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1834 = iree_tensor_ext.bitcast %__auto.blk.16.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1061 = tensor.expand_shape %1834 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1062 = tensor.extract_slice %expanded_1061[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1835 = iree_tensor_ext.bitcast %extracted_slice_1062 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1063 = tensor.extract_slice %expanded_1061[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1836 = iree_tensor_ext.bitcast %extracted_slice_1063 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1837 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1835, %1836 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1838 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1060, %1837 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1839 = linalg.copy ins(%1838 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1840 = iree_tensor_ext.bitcast %__auto.blk.16.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1064 = tensor.expand_shape %1840 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1065 = tensor.extract_slice %expanded_1064[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1841 = iree_tensor_ext.bitcast %extracted_slice_1065 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1066 = tensor.extract_slice %expanded_1064[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1842 = iree_tensor_ext.bitcast %extracted_slice_1066 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1843 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1841, %1842 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1844 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1060, %1843 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1845 = linalg.copy ins(%1844 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_1067 = tensor.expand_shape %1833 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1068 = tensor.expand_shape %1839 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1069 = tensor.expand_shape %1845 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1846 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1070 = tensor.expand_shape %1846 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1847 = linalg.batch_matmul ins(%expanded_1070, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1071 = linalg.transpose ins(%1847 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1848 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1071 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1849 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1848, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1850 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1849 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1851 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1071 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1852 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1851, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1853 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1852 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1072 = tensor.expand_shape %1850 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1073 = tensor.expand_shape %1853 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1074 = tensor.extract_slice %expanded_1067[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1075 = tensor.extract_slice %expanded_1067[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1854 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1074, %expanded_1072 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1855 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1075, %expanded_1073 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1856 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1854, %1855 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1857 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1075, %expanded_1072 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1858 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1074, %expanded_1073 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1859 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1857, %1858 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1860 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1856, %1859 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1076 = tensor.collapse_shape %1860 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1861 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1077 = tensor.expand_shape %1861 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1862 = linalg.batch_matmul ins(%expanded_1077, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1078 = linalg.transpose ins(%1862 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1863 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1078 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1864 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1863, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1865 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1864 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1866 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1078 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1867 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1866, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1868 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1867 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1079 = tensor.expand_shape %1865 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1080 = tensor.expand_shape %1868 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1081 = tensor.extract_slice %expanded_1068[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1082 = tensor.extract_slice %expanded_1068[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1869 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1081, %expanded_1079 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1870 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1082, %expanded_1080 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1871 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1869, %1870 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1872 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1082, %expanded_1079 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1873 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1081, %expanded_1080 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1874 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1872, %1873 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1875 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1871, %1874 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1083 = tensor.collapse_shape %1875 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1876 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c16_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1877 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1876 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1084 = tensor.collapse_shape %1877 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1085 = tensor.expand_shape %collapsed_1083 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1086 = tensor.collapse_shape %expanded_1085 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1087 = linalg.transpose ins(%collapsed_1086 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1088 = tensor.expand_shape %collapsed_1084 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1878 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1087, %expanded_1088 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1771 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1879 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1877 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1089 = tensor.collapse_shape %1879 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1090 = tensor.expand_shape %1845 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1091 = tensor.collapse_shape %expanded_1090 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1092 = linalg.transpose ins(%collapsed_1091 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1093 = tensor.expand_shape %collapsed_1089 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1880 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1092, %expanded_1093 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1878 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1881 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1083 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1094 = tensor.collapse_shape %1881 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1882 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1069 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1095 = tensor.collapse_shape %1882 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1096 = linalg.transpose ins(%collapsed_1076 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1097 = linalg.transpose ins(%collapsed_1094 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1098 = linalg.transpose ins(%collapsed_1095 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1099 = tensor.collapse_shape %transposed_1096 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1100 = tensor.collapse_shape %transposed_1097 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1101 = tensor.collapse_shape %transposed_1098 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1883 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1099, %collapsed_1100, %collapsed_1101, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1102 = tensor.expand_shape %1883 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1103 = tensor.dim %expanded_1102, %c2 : tensor<4x32x?x64xf16>
    %1884 = tensor.empty(%dim_1103) : tensor<4x?x32x64xf16>
    %transposed_1104 = linalg.transpose ins(%expanded_1102 : tensor<4x32x?x64xf16>) outs(%1884 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1105 = tensor.collapse_shape %transposed_1104 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1885 = iree_tensor_ext.bitcast %__auto.blk.16.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1106 = tensor.expand_shape %1885 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1107 = tensor.extract_slice %expanded_1106[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1886 = iree_tensor_ext.bitcast %extracted_slice_1107 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1108 = tensor.extract_slice %expanded_1106[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1887 = iree_tensor_ext.bitcast %extracted_slice_1108 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1109 = tensor.dim %collapsed_1105, %c1 : tensor<4x?x2048xf16>
    %1888 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1886, %1887 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1110 = tensor.expand_shape %collapsed_1105 [[0], [1], [2, 3]] output_shape [4, %dim_1109, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1889 = tensor.empty(%dim_1109) : tensor<4x?x2048xf32>
    %1890 = linalg.fill ins(%cst_3 : f32) outs(%1889 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %1891 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1110, %1888 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1890 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1892 = tensor.empty(%dim_1109) : tensor<4x?x2048xf16>
    %1893 = linalg.copy ins(%1891 : tensor<4x?x2048xf32>) outs(%1892 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1894 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1817, %1893 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1895 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1894 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1896 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1895 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1897 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1896 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1898 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1897 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1899 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1898 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1900 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1899 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1901 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1895, %1900 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1902 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1901 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1903 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.ffn_norm.weight, %1902 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1904 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1903 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1905 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1111 = tensor.expand_shape %1905 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1112 = tensor.extract_slice %expanded_1111[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1906 = iree_tensor_ext.bitcast %extracted_slice_1112 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1113 = tensor.extract_slice %expanded_1111[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1907 = iree_tensor_ext.bitcast %extracted_slice_1113 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1908 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1906, %1907 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1114 = tensor.expand_shape %1904 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1909 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1114, %1908 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1910 = linalg.copy ins(%1909 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1911 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1910 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %1912 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1911, %1910 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1913 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1115 = tensor.expand_shape %1913 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1116 = tensor.extract_slice %expanded_1115[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1914 = iree_tensor_ext.bitcast %extracted_slice_1116 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1117 = tensor.extract_slice %expanded_1115[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1915 = iree_tensor_ext.bitcast %extracted_slice_1117 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1916 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1914, %1915 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %1917 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1114, %1916 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %1918 = linalg.copy ins(%1917 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %1919 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1912, %1918 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %1920 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1118 = tensor.expand_shape %1920 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1119 = tensor.extract_slice %expanded_1118[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1921 = iree_tensor_ext.bitcast %extracted_slice_1119 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1120 = tensor.extract_slice %expanded_1118[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1922 = iree_tensor_ext.bitcast %extracted_slice_1120 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1923 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1921, %1922 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1121 = tensor.expand_shape %1919 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1924 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1121, %1923 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1925 = linalg.copy ins(%1924 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1926 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1894, %1925 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1927 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1926 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1928 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1927 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1929 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1928 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1930 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1929 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1931 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1930 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1932 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1931 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %1933 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1927, %1932 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %1934 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1933 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1935 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.attn_norm.weight, %1934 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %1936 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1935 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %1937 = iree_tensor_ext.bitcast %__auto.blk.17.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1122 = tensor.expand_shape %1937 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1123 = tensor.extract_slice %expanded_1122[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1938 = iree_tensor_ext.bitcast %extracted_slice_1123 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1124 = tensor.extract_slice %expanded_1122[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1939 = iree_tensor_ext.bitcast %extracted_slice_1124 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1940 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1938, %1939 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1125 = tensor.expand_shape %1936 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1941 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1125, %1940 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %1942 = linalg.copy ins(%1941 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %1943 = iree_tensor_ext.bitcast %__auto.blk.17.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1126 = tensor.expand_shape %1943 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1127 = tensor.extract_slice %expanded_1126[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1944 = iree_tensor_ext.bitcast %extracted_slice_1127 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1128 = tensor.extract_slice %expanded_1126[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1945 = iree_tensor_ext.bitcast %extracted_slice_1128 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1946 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1944, %1945 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1947 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1125, %1946 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1948 = linalg.copy ins(%1947 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %1949 = iree_tensor_ext.bitcast %__auto.blk.17.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1129 = tensor.expand_shape %1949 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1130 = tensor.extract_slice %expanded_1129[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1950 = iree_tensor_ext.bitcast %extracted_slice_1130 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1131 = tensor.extract_slice %expanded_1129[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1951 = iree_tensor_ext.bitcast %extracted_slice_1131 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1952 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1950, %1951 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %1953 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1125, %1952 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %1954 = linalg.copy ins(%1953 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_1132 = tensor.expand_shape %1942 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1133 = tensor.expand_shape %1948 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1134 = tensor.expand_shape %1954 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %1955 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1135 = tensor.expand_shape %1955 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1956 = linalg.batch_matmul ins(%expanded_1135, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1136 = linalg.transpose ins(%1956 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1957 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1136 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1958 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1957, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1959 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1958 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1960 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1136 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1961 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1960, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1962 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1961 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1137 = tensor.expand_shape %1959 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1138 = tensor.expand_shape %1962 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1139 = tensor.extract_slice %expanded_1132[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1140 = tensor.extract_slice %expanded_1132[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1963 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1139, %expanded_1137 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1964 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1140, %expanded_1138 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1965 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1963, %1964 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1966 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1140, %expanded_1137 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1967 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1139, %expanded_1138 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1968 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1966, %1967 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %1969 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1965, %1968 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1141 = tensor.collapse_shape %1969 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %1970 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1142 = tensor.expand_shape %1970 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %1971 = linalg.batch_matmul ins(%expanded_1142, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1143 = linalg.transpose ins(%1971 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %1972 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1143 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1973 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1972, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1974 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1973 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %1975 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1143 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1976 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1975, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %1977 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1976 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1144 = tensor.expand_shape %1974 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1145 = tensor.expand_shape %1977 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1146 = tensor.extract_slice %expanded_1133[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1147 = tensor.extract_slice %expanded_1133[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1978 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1146, %expanded_1144 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1979 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1147, %expanded_1145 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1980 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1978, %1979 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1981 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1147, %expanded_1144 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1982 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1146, %expanded_1145 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1983 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1981, %1982 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %1984 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1980, %1983 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1148 = tensor.collapse_shape %1984 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1985 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c17_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %1986 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1985 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1149 = tensor.collapse_shape %1986 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1150 = tensor.expand_shape %collapsed_1148 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1151 = tensor.collapse_shape %expanded_1150 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1152 = linalg.transpose ins(%collapsed_1151 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1153 = tensor.expand_shape %collapsed_1149 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1987 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1152, %expanded_1153 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1880 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1988 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%1986 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1154 = tensor.collapse_shape %1988 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1155 = tensor.expand_shape %1954 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1156 = tensor.collapse_shape %expanded_1155 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1157 = linalg.transpose ins(%collapsed_1156 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1158 = tensor.expand_shape %collapsed_1154 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %1989 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1157, %expanded_1158 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1987 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1990 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1148 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1159 = tensor.collapse_shape %1990 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1991 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1134 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1160 = tensor.collapse_shape %1991 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1161 = linalg.transpose ins(%collapsed_1141 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1162 = linalg.transpose ins(%collapsed_1159 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1163 = linalg.transpose ins(%collapsed_1160 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1164 = tensor.collapse_shape %transposed_1161 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1165 = tensor.collapse_shape %transposed_1162 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1166 = tensor.collapse_shape %transposed_1163 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1992 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1164, %collapsed_1165, %collapsed_1166, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1167 = tensor.expand_shape %1992 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1168 = tensor.dim %expanded_1167, %c2 : tensor<4x32x?x64xf16>
    %1993 = tensor.empty(%dim_1168) : tensor<4x?x32x64xf16>
    %transposed_1169 = linalg.transpose ins(%expanded_1167 : tensor<4x32x?x64xf16>) outs(%1993 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1170 = tensor.collapse_shape %transposed_1169 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1994 = iree_tensor_ext.bitcast %__auto.blk.17.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1171 = tensor.expand_shape %1994 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1172 = tensor.extract_slice %expanded_1171[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1995 = iree_tensor_ext.bitcast %extracted_slice_1172 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1173 = tensor.extract_slice %expanded_1171[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1996 = iree_tensor_ext.bitcast %extracted_slice_1173 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1174 = tensor.dim %collapsed_1170, %c1 : tensor<4x?x2048xf16>
    %1997 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1995, %1996 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1175 = tensor.expand_shape %collapsed_1170 [[0], [1], [2, 3]] output_shape [4, %dim_1174, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1998 = tensor.empty(%dim_1174) : tensor<4x?x2048xf32>
    %1999 = linalg.fill ins(%cst_3 : f32) outs(%1998 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2000 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1175, %1997 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%1999 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2001 = tensor.empty(%dim_1174) : tensor<4x?x2048xf16>
    %2002 = linalg.copy ins(%2000 : tensor<4x?x2048xf32>) outs(%2001 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2003 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1926, %2002 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2004 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2003 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2005 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2004 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2006 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2005 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2007 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2006 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2008 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2007 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2009 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2008 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2010 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2004, %2009 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2011 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2010 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2012 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.ffn_norm.weight, %2011 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2013 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2012 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2014 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1176 = tensor.expand_shape %2014 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1177 = tensor.extract_slice %expanded_1176[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2015 = iree_tensor_ext.bitcast %extracted_slice_1177 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1178 = tensor.extract_slice %expanded_1176[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2016 = iree_tensor_ext.bitcast %extracted_slice_1178 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2017 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2015, %2016 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1179 = tensor.expand_shape %2013 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2018 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1179, %2017 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2019 = linalg.copy ins(%2018 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2020 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2019 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %2021 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2020, %2019 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2022 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1180 = tensor.expand_shape %2022 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1181 = tensor.extract_slice %expanded_1180[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2023 = iree_tensor_ext.bitcast %extracted_slice_1181 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1182 = tensor.extract_slice %expanded_1180[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2024 = iree_tensor_ext.bitcast %extracted_slice_1182 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2025 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2023, %2024 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %2026 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1179, %2025 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2027 = linalg.copy ins(%2026 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2028 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2021, %2027 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2029 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1183 = tensor.expand_shape %2029 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1184 = tensor.extract_slice %expanded_1183[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2030 = iree_tensor_ext.bitcast %extracted_slice_1184 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1185 = tensor.extract_slice %expanded_1183[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2031 = iree_tensor_ext.bitcast %extracted_slice_1185 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2032 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2030, %2031 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1186 = tensor.expand_shape %2028 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2033 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1186, %2032 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2034 = linalg.copy ins(%2033 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2035 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2003, %2034 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2036 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2035 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2037 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2036 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2038 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2037 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2039 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2038 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2040 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2039 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2041 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2040 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2042 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2036, %2041 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2043 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2042 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2044 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.attn_norm.weight, %2043 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2045 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2044 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2046 = iree_tensor_ext.bitcast %__auto.blk.18.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1187 = tensor.expand_shape %2046 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1188 = tensor.extract_slice %expanded_1187[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2047 = iree_tensor_ext.bitcast %extracted_slice_1188 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1189 = tensor.extract_slice %expanded_1187[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2048 = iree_tensor_ext.bitcast %extracted_slice_1189 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2049 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2047, %2048 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1190 = tensor.expand_shape %2045 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2050 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1190, %2049 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2051 = linalg.copy ins(%2050 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2052 = iree_tensor_ext.bitcast %__auto.blk.18.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1191 = tensor.expand_shape %2052 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1192 = tensor.extract_slice %expanded_1191[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2053 = iree_tensor_ext.bitcast %extracted_slice_1192 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1193 = tensor.extract_slice %expanded_1191[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2054 = iree_tensor_ext.bitcast %extracted_slice_1193 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2055 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2053, %2054 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2056 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1190, %2055 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2057 = linalg.copy ins(%2056 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2058 = iree_tensor_ext.bitcast %__auto.blk.18.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1194 = tensor.expand_shape %2058 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1195 = tensor.extract_slice %expanded_1194[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2059 = iree_tensor_ext.bitcast %extracted_slice_1195 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1196 = tensor.extract_slice %expanded_1194[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2060 = iree_tensor_ext.bitcast %extracted_slice_1196 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2061 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2059, %2060 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2062 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1190, %2061 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2063 = linalg.copy ins(%2062 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_1197 = tensor.expand_shape %2051 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1198 = tensor.expand_shape %2057 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1199 = tensor.expand_shape %2063 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2064 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1200 = tensor.expand_shape %2064 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2065 = linalg.batch_matmul ins(%expanded_1200, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1201 = linalg.transpose ins(%2065 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2066 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1201 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2067 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2066, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2068 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2067 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2069 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1201 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2070 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2069, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2071 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2070 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1202 = tensor.expand_shape %2068 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1203 = tensor.expand_shape %2071 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1204 = tensor.extract_slice %expanded_1197[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1205 = tensor.extract_slice %expanded_1197[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2072 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1204, %expanded_1202 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2073 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1205, %expanded_1203 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2074 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2072, %2073 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2075 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1205, %expanded_1202 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2076 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1204, %expanded_1203 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2077 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2075, %2076 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2078 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2074, %2077 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1206 = tensor.collapse_shape %2078 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2079 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1207 = tensor.expand_shape %2079 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2080 = linalg.batch_matmul ins(%expanded_1207, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1208 = linalg.transpose ins(%2080 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2081 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1208 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2082 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2081, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2083 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2082 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2084 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1208 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2085 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2084, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2086 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2085 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1209 = tensor.expand_shape %2083 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1210 = tensor.expand_shape %2086 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1211 = tensor.extract_slice %expanded_1198[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1212 = tensor.extract_slice %expanded_1198[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2087 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1211, %expanded_1209 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2088 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1212, %expanded_1210 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2089 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2087, %2088 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2090 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1212, %expanded_1209 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2091 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1211, %expanded_1210 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2092 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2090, %2091 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2093 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2089, %2092 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1213 = tensor.collapse_shape %2093 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2094 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c18_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %2095 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2094 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1214 = tensor.collapse_shape %2095 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1215 = tensor.expand_shape %collapsed_1213 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1216 = tensor.collapse_shape %expanded_1215 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1217 = linalg.transpose ins(%collapsed_1216 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1218 = tensor.expand_shape %collapsed_1214 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2096 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1217, %expanded_1218 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%1989 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2097 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2095 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1219 = tensor.collapse_shape %2097 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1220 = tensor.expand_shape %2063 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1221 = tensor.collapse_shape %expanded_1220 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1222 = linalg.transpose ins(%collapsed_1221 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1223 = tensor.expand_shape %collapsed_1219 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2098 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1222, %expanded_1223 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2096 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2099 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1213 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1224 = tensor.collapse_shape %2099 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2100 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1199 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1225 = tensor.collapse_shape %2100 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1226 = linalg.transpose ins(%collapsed_1206 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1227 = linalg.transpose ins(%collapsed_1224 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1228 = linalg.transpose ins(%collapsed_1225 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1229 = tensor.collapse_shape %transposed_1226 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1230 = tensor.collapse_shape %transposed_1227 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1231 = tensor.collapse_shape %transposed_1228 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2101 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1229, %collapsed_1230, %collapsed_1231, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1232 = tensor.expand_shape %2101 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1233 = tensor.dim %expanded_1232, %c2 : tensor<4x32x?x64xf16>
    %2102 = tensor.empty(%dim_1233) : tensor<4x?x32x64xf16>
    %transposed_1234 = linalg.transpose ins(%expanded_1232 : tensor<4x32x?x64xf16>) outs(%2102 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1235 = tensor.collapse_shape %transposed_1234 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2103 = iree_tensor_ext.bitcast %__auto.blk.18.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1236 = tensor.expand_shape %2103 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1237 = tensor.extract_slice %expanded_1236[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2104 = iree_tensor_ext.bitcast %extracted_slice_1237 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1238 = tensor.extract_slice %expanded_1236[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2105 = iree_tensor_ext.bitcast %extracted_slice_1238 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1239 = tensor.dim %collapsed_1235, %c1 : tensor<4x?x2048xf16>
    %2106 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2104, %2105 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1240 = tensor.expand_shape %collapsed_1235 [[0], [1], [2, 3]] output_shape [4, %dim_1239, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2107 = tensor.empty(%dim_1239) : tensor<4x?x2048xf32>
    %2108 = linalg.fill ins(%cst_3 : f32) outs(%2107 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2109 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1240, %2106 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2108 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2110 = tensor.empty(%dim_1239) : tensor<4x?x2048xf16>
    %2111 = linalg.copy ins(%2109 : tensor<4x?x2048xf32>) outs(%2110 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2112 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2035, %2111 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2113 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2112 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2114 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2113 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2115 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2114 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2116 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2115 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2117 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2116 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2118 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2117 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2119 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2113, %2118 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2120 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2119 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2121 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.ffn_norm.weight, %2120 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2122 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2121 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2123 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1241 = tensor.expand_shape %2123 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1242 = tensor.extract_slice %expanded_1241[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2124 = iree_tensor_ext.bitcast %extracted_slice_1242 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1243 = tensor.extract_slice %expanded_1241[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2125 = iree_tensor_ext.bitcast %extracted_slice_1243 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2126 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2124, %2125 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1244 = tensor.expand_shape %2122 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2127 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1244, %2126 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2128 = linalg.copy ins(%2127 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2129 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2128 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %2130 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2129, %2128 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2131 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1245 = tensor.expand_shape %2131 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1246 = tensor.extract_slice %expanded_1245[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2132 = iree_tensor_ext.bitcast %extracted_slice_1246 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1247 = tensor.extract_slice %expanded_1245[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2133 = iree_tensor_ext.bitcast %extracted_slice_1247 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2134 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2132, %2133 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %2135 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1244, %2134 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2136 = linalg.copy ins(%2135 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2137 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2130, %2136 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2138 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1248 = tensor.expand_shape %2138 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1249 = tensor.extract_slice %expanded_1248[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2139 = iree_tensor_ext.bitcast %extracted_slice_1249 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1250 = tensor.extract_slice %expanded_1248[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2140 = iree_tensor_ext.bitcast %extracted_slice_1250 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2141 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2139, %2140 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1251 = tensor.expand_shape %2137 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2142 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1251, %2141 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2143 = linalg.copy ins(%2142 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2144 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2112, %2143 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2145 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2144 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2146 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2145 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2147 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2146 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2148 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2147 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2149 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2148 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2150 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2149 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2151 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2145, %2150 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2152 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2151 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2153 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.attn_norm.weight, %2152 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2154 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2153 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2155 = iree_tensor_ext.bitcast %__auto.blk.19.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1252 = tensor.expand_shape %2155 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1253 = tensor.extract_slice %expanded_1252[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2156 = iree_tensor_ext.bitcast %extracted_slice_1253 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1254 = tensor.extract_slice %expanded_1252[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2157 = iree_tensor_ext.bitcast %extracted_slice_1254 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2158 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2156, %2157 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1255 = tensor.expand_shape %2154 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2159 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1255, %2158 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2160 = linalg.copy ins(%2159 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2161 = iree_tensor_ext.bitcast %__auto.blk.19.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1256 = tensor.expand_shape %2161 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1257 = tensor.extract_slice %expanded_1256[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2162 = iree_tensor_ext.bitcast %extracted_slice_1257 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1258 = tensor.extract_slice %expanded_1256[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2163 = iree_tensor_ext.bitcast %extracted_slice_1258 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2164 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2162, %2163 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2165 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1255, %2164 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2166 = linalg.copy ins(%2165 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2167 = iree_tensor_ext.bitcast %__auto.blk.19.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1259 = tensor.expand_shape %2167 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1260 = tensor.extract_slice %expanded_1259[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2168 = iree_tensor_ext.bitcast %extracted_slice_1260 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1261 = tensor.extract_slice %expanded_1259[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2169 = iree_tensor_ext.bitcast %extracted_slice_1261 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2170 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2168, %2169 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2171 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1255, %2170 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2172 = linalg.copy ins(%2171 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_1262 = tensor.expand_shape %2160 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1263 = tensor.expand_shape %2166 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1264 = tensor.expand_shape %2172 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2173 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1265 = tensor.expand_shape %2173 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2174 = linalg.batch_matmul ins(%expanded_1265, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1266 = linalg.transpose ins(%2174 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2175 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1266 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2176 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2175, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2177 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2176 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2178 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1266 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2179 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2178, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2180 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2179 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1267 = tensor.expand_shape %2177 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1268 = tensor.expand_shape %2180 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1269 = tensor.extract_slice %expanded_1262[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1270 = tensor.extract_slice %expanded_1262[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2181 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1269, %expanded_1267 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2182 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1270, %expanded_1268 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2183 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2181, %2182 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2184 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1270, %expanded_1267 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2185 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1269, %expanded_1268 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2186 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2184, %2185 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2187 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2183, %2186 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1271 = tensor.collapse_shape %2187 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2188 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1272 = tensor.expand_shape %2188 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2189 = linalg.batch_matmul ins(%expanded_1272, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1273 = linalg.transpose ins(%2189 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2190 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1273 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2191 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2190, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2192 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2191 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2193 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1273 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2194 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2193, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2195 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2194 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1274 = tensor.expand_shape %2192 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1275 = tensor.expand_shape %2195 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1276 = tensor.extract_slice %expanded_1263[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1277 = tensor.extract_slice %expanded_1263[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2196 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1276, %expanded_1274 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2197 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1277, %expanded_1275 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2198 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2196, %2197 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2199 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1277, %expanded_1274 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2200 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1276, %expanded_1275 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2201 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2199, %2200 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2202 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2198, %2201 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1278 = tensor.collapse_shape %2202 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2203 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c19_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %2204 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2203 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1279 = tensor.collapse_shape %2204 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1280 = tensor.expand_shape %collapsed_1278 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1281 = tensor.collapse_shape %expanded_1280 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1282 = linalg.transpose ins(%collapsed_1281 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1283 = tensor.expand_shape %collapsed_1279 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2205 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1282, %expanded_1283 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2098 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2206 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2204 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1284 = tensor.collapse_shape %2206 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1285 = tensor.expand_shape %2172 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1286 = tensor.collapse_shape %expanded_1285 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1287 = linalg.transpose ins(%collapsed_1286 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1288 = tensor.expand_shape %collapsed_1284 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2207 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1287, %expanded_1288 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2205 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2208 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1278 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1289 = tensor.collapse_shape %2208 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2209 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1264 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1290 = tensor.collapse_shape %2209 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1291 = linalg.transpose ins(%collapsed_1271 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1292 = linalg.transpose ins(%collapsed_1289 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1293 = linalg.transpose ins(%collapsed_1290 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1294 = tensor.collapse_shape %transposed_1291 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1295 = tensor.collapse_shape %transposed_1292 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1296 = tensor.collapse_shape %transposed_1293 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2210 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1294, %collapsed_1295, %collapsed_1296, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1297 = tensor.expand_shape %2210 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1298 = tensor.dim %expanded_1297, %c2 : tensor<4x32x?x64xf16>
    %2211 = tensor.empty(%dim_1298) : tensor<4x?x32x64xf16>
    %transposed_1299 = linalg.transpose ins(%expanded_1297 : tensor<4x32x?x64xf16>) outs(%2211 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1300 = tensor.collapse_shape %transposed_1299 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2212 = iree_tensor_ext.bitcast %__auto.blk.19.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1301 = tensor.expand_shape %2212 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1302 = tensor.extract_slice %expanded_1301[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2213 = iree_tensor_ext.bitcast %extracted_slice_1302 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1303 = tensor.extract_slice %expanded_1301[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2214 = iree_tensor_ext.bitcast %extracted_slice_1303 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1304 = tensor.dim %collapsed_1300, %c1 : tensor<4x?x2048xf16>
    %2215 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2213, %2214 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1305 = tensor.expand_shape %collapsed_1300 [[0], [1], [2, 3]] output_shape [4, %dim_1304, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2216 = tensor.empty(%dim_1304) : tensor<4x?x2048xf32>
    %2217 = linalg.fill ins(%cst_3 : f32) outs(%2216 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2218 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1305, %2215 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2217 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2219 = tensor.empty(%dim_1304) : tensor<4x?x2048xf16>
    %2220 = linalg.copy ins(%2218 : tensor<4x?x2048xf32>) outs(%2219 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2221 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2144, %2220 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2222 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2221 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2223 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2222 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2224 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2223 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2225 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2224 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2226 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2225 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2227 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2226 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2228 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2222, %2227 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2229 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2228 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2230 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.ffn_norm.weight, %2229 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2231 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2230 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2232 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1306 = tensor.expand_shape %2232 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1307 = tensor.extract_slice %expanded_1306[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2233 = iree_tensor_ext.bitcast %extracted_slice_1307 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1308 = tensor.extract_slice %expanded_1306[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2234 = iree_tensor_ext.bitcast %extracted_slice_1308 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2235 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2233, %2234 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1309 = tensor.expand_shape %2231 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2236 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1309, %2235 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2237 = linalg.copy ins(%2236 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2238 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2237 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %2239 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2238, %2237 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2240 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1310 = tensor.expand_shape %2240 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1311 = tensor.extract_slice %expanded_1310[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2241 = iree_tensor_ext.bitcast %extracted_slice_1311 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1312 = tensor.extract_slice %expanded_1310[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2242 = iree_tensor_ext.bitcast %extracted_slice_1312 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2243 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2241, %2242 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %2244 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1309, %2243 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2245 = linalg.copy ins(%2244 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2246 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2239, %2245 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2247 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1313 = tensor.expand_shape %2247 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1314 = tensor.extract_slice %expanded_1313[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2248 = iree_tensor_ext.bitcast %extracted_slice_1314 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1315 = tensor.extract_slice %expanded_1313[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2249 = iree_tensor_ext.bitcast %extracted_slice_1315 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2250 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2248, %2249 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1316 = tensor.expand_shape %2246 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2251 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1316, %2250 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2252 = linalg.copy ins(%2251 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2253 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2221, %2252 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2254 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2253 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2255 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2254 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2256 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2255 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2256 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2258 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2257 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2259 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2258 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2260 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2254, %2259 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2261 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2260 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2262 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.attn_norm.weight, %2261 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2263 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2262 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2264 = iree_tensor_ext.bitcast %__auto.blk.20.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1317 = tensor.expand_shape %2264 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1318 = tensor.extract_slice %expanded_1317[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2265 = iree_tensor_ext.bitcast %extracted_slice_1318 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1319 = tensor.extract_slice %expanded_1317[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2266 = iree_tensor_ext.bitcast %extracted_slice_1319 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2267 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2265, %2266 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1320 = tensor.expand_shape %2263 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2268 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1320, %2267 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2269 = linalg.copy ins(%2268 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2270 = iree_tensor_ext.bitcast %__auto.blk.20.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1321 = tensor.expand_shape %2270 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1322 = tensor.extract_slice %expanded_1321[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2271 = iree_tensor_ext.bitcast %extracted_slice_1322 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1323 = tensor.extract_slice %expanded_1321[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2272 = iree_tensor_ext.bitcast %extracted_slice_1323 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2273 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2271, %2272 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2274 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1320, %2273 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2275 = linalg.copy ins(%2274 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2276 = iree_tensor_ext.bitcast %__auto.blk.20.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1324 = tensor.expand_shape %2276 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1325 = tensor.extract_slice %expanded_1324[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2277 = iree_tensor_ext.bitcast %extracted_slice_1325 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1326 = tensor.extract_slice %expanded_1324[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2278 = iree_tensor_ext.bitcast %extracted_slice_1326 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2279 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2277, %2278 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2280 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1320, %2279 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2281 = linalg.copy ins(%2280 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_1327 = tensor.expand_shape %2269 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1328 = tensor.expand_shape %2275 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1329 = tensor.expand_shape %2281 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2282 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1330 = tensor.expand_shape %2282 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2283 = linalg.batch_matmul ins(%expanded_1330, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1331 = linalg.transpose ins(%2283 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2284 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1331 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2285 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2284, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2286 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2285 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2287 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1331 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2288 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2287, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2289 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2288 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1332 = tensor.expand_shape %2286 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1333 = tensor.expand_shape %2289 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1334 = tensor.extract_slice %expanded_1327[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1335 = tensor.extract_slice %expanded_1327[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2290 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1334, %expanded_1332 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2291 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1335, %expanded_1333 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2292 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2290, %2291 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2293 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1335, %expanded_1332 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2294 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1334, %expanded_1333 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2295 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2293, %2294 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2296 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2292, %2295 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1336 = tensor.collapse_shape %2296 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2297 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1337 = tensor.expand_shape %2297 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2298 = linalg.batch_matmul ins(%expanded_1337, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1338 = linalg.transpose ins(%2298 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2299 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1338 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2300 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2299, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2301 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2300 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2302 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1338 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2303 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2302, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2304 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2303 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1339 = tensor.expand_shape %2301 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1340 = tensor.expand_shape %2304 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1341 = tensor.extract_slice %expanded_1328[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1342 = tensor.extract_slice %expanded_1328[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2305 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1341, %expanded_1339 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2306 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1342, %expanded_1340 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2307 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2305, %2306 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2308 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1342, %expanded_1339 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2309 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1341, %expanded_1340 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2310 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2308, %2309 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2311 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2307, %2310 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1343 = tensor.collapse_shape %2311 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2312 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c20_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %2313 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2312 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1344 = tensor.collapse_shape %2313 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1345 = tensor.expand_shape %collapsed_1343 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1346 = tensor.collapse_shape %expanded_1345 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1347 = linalg.transpose ins(%collapsed_1346 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1348 = tensor.expand_shape %collapsed_1344 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2314 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1347, %expanded_1348 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2207 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2315 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2313 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1349 = tensor.collapse_shape %2315 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1350 = tensor.expand_shape %2281 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1351 = tensor.collapse_shape %expanded_1350 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1352 = linalg.transpose ins(%collapsed_1351 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1353 = tensor.expand_shape %collapsed_1349 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2316 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1352, %expanded_1353 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2314 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2317 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1343 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1354 = tensor.collapse_shape %2317 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2318 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1329 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1355 = tensor.collapse_shape %2318 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1356 = linalg.transpose ins(%collapsed_1336 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1357 = linalg.transpose ins(%collapsed_1354 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1358 = linalg.transpose ins(%collapsed_1355 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1359 = tensor.collapse_shape %transposed_1356 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1360 = tensor.collapse_shape %transposed_1357 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1361 = tensor.collapse_shape %transposed_1358 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2319 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1359, %collapsed_1360, %collapsed_1361, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1362 = tensor.expand_shape %2319 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1363 = tensor.dim %expanded_1362, %c2 : tensor<4x32x?x64xf16>
    %2320 = tensor.empty(%dim_1363) : tensor<4x?x32x64xf16>
    %transposed_1364 = linalg.transpose ins(%expanded_1362 : tensor<4x32x?x64xf16>) outs(%2320 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1365 = tensor.collapse_shape %transposed_1364 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2321 = iree_tensor_ext.bitcast %__auto.blk.20.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1366 = tensor.expand_shape %2321 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1367 = tensor.extract_slice %expanded_1366[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2322 = iree_tensor_ext.bitcast %extracted_slice_1367 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1368 = tensor.extract_slice %expanded_1366[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2323 = iree_tensor_ext.bitcast %extracted_slice_1368 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1369 = tensor.dim %collapsed_1365, %c1 : tensor<4x?x2048xf16>
    %2324 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2322, %2323 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1370 = tensor.expand_shape %collapsed_1365 [[0], [1], [2, 3]] output_shape [4, %dim_1369, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2325 = tensor.empty(%dim_1369) : tensor<4x?x2048xf32>
    %2326 = linalg.fill ins(%cst_3 : f32) outs(%2325 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2327 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1370, %2324 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2326 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2328 = tensor.empty(%dim_1369) : tensor<4x?x2048xf16>
    %2329 = linalg.copy ins(%2327 : tensor<4x?x2048xf32>) outs(%2328 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2330 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2253, %2329 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2331 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2330 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2332 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2331 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2333 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2332 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2334 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2333 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2335 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2334 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2336 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2335 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2337 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2331, %2336 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2338 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2337 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2339 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.ffn_norm.weight, %2338 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2339 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2341 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1371 = tensor.expand_shape %2341 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1372 = tensor.extract_slice %expanded_1371[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2342 = iree_tensor_ext.bitcast %extracted_slice_1372 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1373 = tensor.extract_slice %expanded_1371[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2343 = iree_tensor_ext.bitcast %extracted_slice_1373 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2344 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2342, %2343 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1374 = tensor.expand_shape %2340 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2345 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1374, %2344 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2346 = linalg.copy ins(%2345 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2347 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2346 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %2348 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2347, %2346 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2349 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1375 = tensor.expand_shape %2349 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1376 = tensor.extract_slice %expanded_1375[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2350 = iree_tensor_ext.bitcast %extracted_slice_1376 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1377 = tensor.extract_slice %expanded_1375[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2351 = iree_tensor_ext.bitcast %extracted_slice_1377 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2352 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2350, %2351 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %2353 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1374, %2352 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2354 = linalg.copy ins(%2353 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2355 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2348, %2354 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2356 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1378 = tensor.expand_shape %2356 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1379 = tensor.extract_slice %expanded_1378[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2357 = iree_tensor_ext.bitcast %extracted_slice_1379 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1380 = tensor.extract_slice %expanded_1378[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2358 = iree_tensor_ext.bitcast %extracted_slice_1380 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2359 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2357, %2358 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1381 = tensor.expand_shape %2355 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2360 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1381, %2359 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2361 = linalg.copy ins(%2360 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2362 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2330, %2361 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2363 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2362 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2364 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2363 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2365 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2364 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2366 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2365 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2367 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2366 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2368 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2367 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2369 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2363, %2368 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2370 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2369 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2371 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.attn_norm.weight, %2370 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2372 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2371 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2373 = iree_tensor_ext.bitcast %__auto.blk.21.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1382 = tensor.expand_shape %2373 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1383 = tensor.extract_slice %expanded_1382[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2374 = iree_tensor_ext.bitcast %extracted_slice_1383 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1384 = tensor.extract_slice %expanded_1382[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2375 = iree_tensor_ext.bitcast %extracted_slice_1384 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2376 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2374, %2375 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1385 = tensor.expand_shape %2372 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2377 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1385, %2376 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2378 = linalg.copy ins(%2377 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2379 = iree_tensor_ext.bitcast %__auto.blk.21.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1386 = tensor.expand_shape %2379 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1387 = tensor.extract_slice %expanded_1386[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2380 = iree_tensor_ext.bitcast %extracted_slice_1387 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1388 = tensor.extract_slice %expanded_1386[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2381 = iree_tensor_ext.bitcast %extracted_slice_1388 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2382 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2380, %2381 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2383 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1385, %2382 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2384 = linalg.copy ins(%2383 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %2385 = iree_tensor_ext.bitcast %__auto.blk.21.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1389 = tensor.expand_shape %2385 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1390 = tensor.extract_slice %expanded_1389[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2386 = iree_tensor_ext.bitcast %extracted_slice_1390 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1391 = tensor.extract_slice %expanded_1389[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2387 = iree_tensor_ext.bitcast %extracted_slice_1391 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2388 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2386, %2387 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%46 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<256x64x32xf16>
    %2389 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1385, %2388 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%49 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x256xf32>
    %2390 = linalg.copy ins(%2389 : tensor<4x?x256xf32>) outs(%51 : tensor<4x?x256xf16>) -> tensor<4x?x256xf16>
    %expanded_1392 = tensor.expand_shape %2378 [[0], [1], [2, 3]] output_shape [4, %8, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1393 = tensor.expand_shape %2384 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1394 = tensor.expand_shape %2390 [[0], [1], [2, 3]] output_shape [4, %8, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %2391 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1395 = tensor.expand_shape %2391 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2392 = linalg.batch_matmul ins(%expanded_1395, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1396 = linalg.transpose ins(%2392 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2393 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1396 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2394 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2393, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2395 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2394 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2396 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1396 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2397 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2396, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2398 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2397 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1397 = tensor.expand_shape %2395 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1398 = tensor.expand_shape %2398 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1399 = tensor.extract_slice %expanded_1392[0, 0, 0, 0] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1400 = tensor.extract_slice %expanded_1392[0, 0, 0, 1] [4, %8, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2399 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1399, %expanded_1397 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2400 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1400, %expanded_1398 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2401 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2399, %2400 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2402 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1400, %expanded_1397 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2403 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1399, %expanded_1398 : tensor<4x?x32x32xf16>, tensor<1x?x1x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2404 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2402, %2403 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%81 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x32x32xf16>
    %2405 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2401, %2404 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%88 : tensor<4x?x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x32x2x32xf16>
    %collapsed_1401 = tensor.collapse_shape %2405 [[0], [1], [2], [3, 4]] : tensor<4x?x32x2x32xf16> into tensor<4x?x32x64xf16>
    %2406 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.cmpf one, %in, %cst_3 : f32
      cf.assert %2495, "unimplemented: tensor with zero element"
      %2496 = arith.divf %cst_4, %in : f32
      linalg.yield %2496 : f32
    } -> tensor<32xf32>
    %expanded_1402 = tensor.expand_shape %2406 [[0, 1, 2]] output_shape [1, 32, 1] : tensor<32xf32> into tensor<1x32x1xf32>
    %2407 = linalg.batch_matmul ins(%expanded_1402, %69 : tensor<1x32x1xf32>, tensor<1x1x?xf32>) outs(%71 : tensor<1x32x?xf32>) -> tensor<1x32x?xf32>
    %transposed_1403 = linalg.transpose ins(%2407 : tensor<1x32x?xf32>) outs(%73 : tensor<1x?x32xf32>) permutation = [0, 2, 1] 
    %2408 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1403 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.cos %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2409 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2408, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2410 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2409 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %2411 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1403 : tensor<1x?x32xf32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.sin %in : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2412 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2411, %cst_2 : tensor<1x?x32xf32>, tensor<f32>) outs(%73 : tensor<1x?x32xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<1x?x32xf32>
    %2413 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2412 : tensor<1x?x32xf32>) outs(%76 : tensor<1x?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<1x?x32xf16>
    %expanded_1404 = tensor.expand_shape %2410 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %expanded_1405 = tensor.expand_shape %2413 [[0], [1], [2, 3]] output_shape [1, %8, 1, 32] : tensor<1x?x32xf16> into tensor<1x?x1x32xf16>
    %extracted_slice_1406 = tensor.extract_slice %expanded_1393[0, 0, 0, 0] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1407 = tensor.extract_slice %expanded_1393[0, 0, 0, 1] [4, %8, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2414 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1406, %expanded_1404 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2415 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1407, %expanded_1405 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2416 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2414, %2415 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.subf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2417 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1407, %expanded_1404 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2418 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1406, %expanded_1405 : tensor<4x?x4x32xf16>, tensor<1x?x1x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2419 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2417, %2418 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%98 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x4x32xf16>
    %2420 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2416, %2419 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%105 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = linalg.index 3 : index
      %2496 = arith.cmpi eq, %2495, %c0 : index
      %2497 = arith.select %2496, %in, %in_1456 : f16
      linalg.yield %2497 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1408 = tensor.collapse_shape %2420 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2421 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%108 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c21_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %2422 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2421 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1409 = tensor.collapse_shape %2422 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1410 = tensor.expand_shape %collapsed_1408 [[0], [1, 2], [3], [4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1411 = tensor.collapse_shape %expanded_1410 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1412 = linalg.transpose ins(%collapsed_1411 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1413 = tensor.expand_shape %collapsed_1409 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2423 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1412, %expanded_1413 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2316 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2424 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%2422 : tensor<4x?xi64>) outs(%107 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2495 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2495 : i64
    } -> tensor<4x?xi64>
    %collapsed_1414 = tensor.collapse_shape %2424 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1415 = tensor.expand_shape %2390 [[0], [1, 2], [3, 4]] output_shape [4, %110, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %collapsed_1416 = tensor.collapse_shape %expanded_1415 [[0, 1], [2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<?x32x4x64xf16>
    %transposed_1417 = linalg.transpose ins(%collapsed_1416 : tensor<?x32x4x64xf16>) outs(%112 : tensor<?x4x32x64xf16>) permutation = [0, 2, 1, 3] 
    %expanded_1418 = tensor.expand_shape %collapsed_1414 [[0, 1]] output_shape [%113, 1] : tensor<?xi64> into tensor<?x1xi64>
    %2425 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%transposed_1417, %expanded_1418 : tensor<?x4x32x64xf16>, tensor<?x1xi64>) outs(%2423 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %dim_1419 = tensor.dim %collapsed_39, %c0 : tensor<?x4x32x64xf16>
    %2426 = arith.divsi %dim_1419, %c44 : index
    %expanded_1420 = tensor.expand_shape %2425 [[0, 1, 2], [3], [4], [5]] output_shape [%2426, 22, 2, 4, 32, 64] : tensor<?x4x32x64xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_1421 = tensor.collapse_shape %expanded_1420 [[0], [1, 2, 3, 4, 5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x360448xf16>
    %2427 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1408 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1422 = tensor.collapse_shape %2427 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2428 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1394 : tensor<4x?x4x64xf16>) outs(%127 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1423 = tensor.collapse_shape %2428 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1424 = linalg.transpose ins(%collapsed_1401 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1425 = linalg.transpose ins(%collapsed_1422 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1426 = linalg.transpose ins(%collapsed_1423 : tensor<4x?x32x64xf16>) outs(%130 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1427 = tensor.collapse_shape %transposed_1424 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1428 = tensor.collapse_shape %transposed_1425 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1429 = tensor.collapse_shape %transposed_1426 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2429 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1427, %collapsed_1428, %collapsed_1429, %cst, %collapsed_62 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x?x?xf16>) outs(%133 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1430 = tensor.expand_shape %2429 [[0, 1], [2], [3]] output_shape [4, 32, %8, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %dim_1431 = tensor.dim %expanded_1430, %c2 : tensor<4x32x?x64xf16>
    %2430 = tensor.empty(%dim_1431) : tensor<4x?x32x64xf16>
    %transposed_1432 = linalg.transpose ins(%expanded_1430 : tensor<4x32x?x64xf16>) outs(%2430 : tensor<4x?x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1433 = tensor.collapse_shape %transposed_1432 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2431 = iree_tensor_ext.bitcast %__auto.blk.21.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1434 = tensor.expand_shape %2431 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1435 = tensor.extract_slice %expanded_1434[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2432 = iree_tensor_ext.bitcast %extracted_slice_1435 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1436 = tensor.extract_slice %expanded_1434[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2433 = iree_tensor_ext.bitcast %extracted_slice_1436 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %dim_1437 = tensor.dim %collapsed_1433, %c1 : tensor<4x?x2048xf16>
    %2434 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2432, %2433 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%38 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1438 = tensor.expand_shape %collapsed_1433 [[0], [1], [2, 3]] output_shape [4, %dim_1437, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2435 = tensor.empty(%dim_1437) : tensor<4x?x2048xf32>
    %2436 = linalg.fill ins(%cst_3 : f32) outs(%2435 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %2437 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1438, %2434 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%2436 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2438 = tensor.empty(%dim_1437) : tensor<4x?x2048xf16>
    %2439 = linalg.copy ins(%2437 : tensor<4x?x2048xf32>) outs(%2438 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2440 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2362, %2439 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2441 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2440 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2442 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2441 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2443 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2442 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2444 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2443 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2445 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2444 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2446 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2445 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2447 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2441, %2446 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2448 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2447 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2449 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.ffn_norm.weight, %2448 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2450 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2449 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2451 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1439 = tensor.expand_shape %2451 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1440 = tensor.extract_slice %expanded_1439[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2452 = iree_tensor_ext.bitcast %extracted_slice_1440 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1441 = tensor.extract_slice %expanded_1439[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2453 = iree_tensor_ext.bitcast %extracted_slice_1441 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2454 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2452, %2453 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1442 = tensor.expand_shape %2450 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2455 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1442, %2454 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2456 = linalg.copy ins(%2455 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2457 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2456 : tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2495 = arith.negf %in : f16
      %2496 = math.exp %2495 : f16
      %2497 = arith.addf %2496, %cst_5 : f16
      %2498 = arith.divf %cst_5, %2497 : f16
      linalg.yield %2498 : f16
    } -> tensor<4x?x5632xf16>
    %2458 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2457, %2456 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2459 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1443 = tensor.expand_shape %2459 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1444 = tensor.extract_slice %expanded_1443[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2460 = iree_tensor_ext.bitcast %extracted_slice_1444 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1445 = tensor.extract_slice %expanded_1443[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2461 = iree_tensor_ext.bitcast %extracted_slice_1445 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2462 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2460, %2461 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%159 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<5632x64x32xf16>
    %2463 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1442, %2462 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%162 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x5632xf32>
    %2464 = linalg.copy ins(%2463 : tensor<4x?x5632xf32>) outs(%164 : tensor<4x?x5632xf16>) -> tensor<4x?x5632xf16>
    %2465 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2458, %2464 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%164 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.mulf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x5632xf16>
    %2466 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1446 = tensor.expand_shape %2466 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1447 = tensor.extract_slice %expanded_1446[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2467 = iree_tensor_ext.bitcast %extracted_slice_1447 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1448 = tensor.extract_slice %expanded_1446[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2468 = iree_tensor_ext.bitcast %extracted_slice_1448 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2469 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2467, %2468 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%178 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1449 = tensor.expand_shape %2465 [[0], [1], [2, 3]] output_shape [4, %8, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2470 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1449, %2469 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%40 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x2048xf32>
    %2471 = linalg.copy ins(%2470 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) -> tensor<4x?x2048xf16>
    %2472 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2440, %2471 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f16):
      %2495 = arith.addf %in, %in_1456 : f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2473 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2472 : tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2495 = arith.extf %in : f16 to f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2474 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2473 : tensor<4x?x2048xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2475 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2474 : tensor<4x?x2048xf32>) outs(%26 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %out : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2476 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2475 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.divf %in, %cst_6 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2477 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2476 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = arith.addf %in, %cst_7 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2478 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2477 : tensor<4x?x1xf32>) outs(%25 : tensor<4x?x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2495 = math.rsqrt %in : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x1xf32>
    %2479 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2473, %2478 : tensor<4x?x2048xf32>, tensor<4x?x1xf32>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f32, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f32
      linalg.yield %2495 : f32
    } -> tensor<4x?x2048xf32>
    %2480 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2479 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2481 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.output_norm.weight, %2480 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%22 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1456: f16, %out: f32):
      %2495 = arith.extf %in_1456 : f16 to f32
      %2496 = arith.mulf %in, %2495 : f32
      linalg.yield %2496 : f32
    } -> tensor<4x?x2048xf32>
    %2482 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2481 : tensor<4x?x2048xf32>) outs(%20 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2495 = arith.truncf %in : f32 to f16
      linalg.yield %2495 : f16
    } -> tensor<4x?x2048xf16>
    %2483 = iree_tensor_ext.bitcast %__auto.output.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded_1450 = tensor.expand_shape %2483 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice_1451 = tensor.extract_slice %expanded_1450[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %2484 = iree_tensor_ext.bitcast %extracted_slice_1451 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_1452 = tensor.extract_slice %expanded_1450[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %2485 = iree_tensor_ext.bitcast %extracted_slice_1452 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %2486 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2484, %2485 : tensor<32000x64x1xf16>, tensor<32000x64x32xi8>) outs(%17 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1456: i8, %out: f16):
      %2495 = arith.extsi %in_1456 : i8 to i32
      %2496 = arith.sitofp %2495 : i32 to f16
      %2497 = arith.mulf %2496, %in : f16
      linalg.yield %2497 : f16
    } -> tensor<32000x64x32xf16>
    %expanded_1453 = tensor.expand_shape %2482 [[0], [1], [2, 3]] output_shape [4, %8, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2487 = tensor.empty(%8) : tensor<4x?x32000xf32>
    %2488 = linalg.fill ins(%cst_3 : f32) outs(%2487 : tensor<4x?x32000xf32>) -> tensor<4x?x32000xf32>
    %2489 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1453, %2486 : tensor<4x?x64x32xf16>, tensor<32000x64x32xf16>) outs(%2488 : tensor<4x?x32000xf32>) {
    ^bb0(%in: f16, %in_1456: f16, %out: f32):
      %2495 = arith.mulf %in, %in_1456 : f16
      %2496 = arith.extf %2495 : f16 to f32
      %2497 = arith.addf %2496, %out : f32
      linalg.yield %2497 : f32
    } -> tensor<4x?x32000xf32>
    %2490 = tensor.empty(%8) : tensor<4x?x32000xf16>
    %2491 = linalg.copy ins(%2489 : tensor<4x?x32000xf32>) outs(%2490 : tensor<4x?x32000xf16>) -> tensor<4x?x32000xf16>
    %dim_1454 = tensor.dim %collapsed_1421, %c0 : tensor<?x360448xf16>
    %2492 = hal.tensor.alias on(#hal.device.promise<@__device_0>) wait(%arg4) => %collapsed_1421 : tensor<?x360448xf16>{%dim_1454} to %arg3 : !hal.buffer_view
    %2493:2 = hal.tensor.barrier join(%2492, %2491 : tensor<?x360448xf16>, tensor<4x?x32000xf16>) => %arg5 : !hal.fence
    %dim_1455 = tensor.dim %2493#1, %c1 : tensor<4x?x32000xf16>
    %2494 = hal.tensor.export %2493#1 : tensor<4x?x32000xf16>{%dim_1455} -> !hal.buffer_view
    util.return %2494 : !hal.buffer_view
  }
  util.func public @prefill_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @prefill_bs4$async(%arg0, %arg1, %arg2, %arg3, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
  util.func public @decode_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view, %arg5: !hal.fence, %arg6: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %cst = arith.constant 1.250000e-01 : f16
    %c3 = arith.constant 3 : index
    %cst_0 = arith.constant dense<1> : tensor<1x1x1xi64>
    %cst_1 = arith.constant dense<0> : tensor<1x1x1xi64>
    %c21_i64 = arith.constant 21 : i64
    %c20_i64 = arith.constant 20 : i64
    %c19_i64 = arith.constant 19 : i64
    %c18_i64 = arith.constant 18 : i64
    %c16_i64 = arith.constant 16 : i64
    %c15_i64 = arith.constant 15 : i64
    %c14_i64 = arith.constant 14 : i64
    %c13_i64 = arith.constant 13 : i64
    %c12_i64 = arith.constant 12 : i64
    %c11_i64 = arith.constant 11 : i64
    %c10_i64 = arith.constant 10 : i64
    %c9_i64 = arith.constant 9 : i64
    %c7_i64 = arith.constant 7 : i64
    %c8_i64 = arith.constant 8 : i64
    %c22_i64 = arith.constant 22 : i64
    %c3_i64 = arith.constant 3 : i64
    %c32_i64 = arith.constant 32 : i64
    %c4_i64 = arith.constant 4 : i64
    %c6_i64 = arith.constant 6 : i64
    %c5_i64 = arith.constant 5 : i64
    %c17_i64 = arith.constant 17 : i64
    %c2_i64 = arith.constant 2 : i64
    %c0_i64 = arith.constant 0 : i64
    %c1_i64 = arith.constant 1 : i64
    %c0 = arith.constant 0 : index
    %cst_2 = arith.constant dense<0xFC00> : tensor<f16>
    %cst_3 = arith.constant dense<0> : tensor<i64>
    %cst_4 = arith.constant dense<1.000000e+00> : tensor<f32>
    %c32000 = arith.constant 32000 : index
    %cst_5 = arith.constant 0.000000e+00 : f32
    %cst_6 = arith.constant 1.000000e+00 : f32
    %c5632 = arith.constant 5632 : index
    %cst_7 = arith.constant 1.000000e+00 : f16
    %cst_8 = arith.constant 2.048000e+03 : f32
    %cst_9 = arith.constant 9.99999974E-6 : f32
    %cst_10 = arith.constant 6.400000e+01 : f32
    %cst_11 = arith.constant 1.000000e+04 : f32
    %cst_12 = arith.constant 3.200000e+01 : f32
    %0 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg0 : !hal.buffer_view -> tensor<4x1xi64>
    %1 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %2 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg2 : !hal.buffer_view -> tensor<4xi64>
    %3 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[1] : index
    %4 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg3 : !hal.buffer_view -> tensor<4x?xi64>{%3}
    %__auto.token_embd.weight = util.global.load @__auto.token_embd.weight : tensor<32000x2176xi8>
    %__auto.blk.0.attn_norm.weight = util.global.load @__auto.blk.0.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.attn_q.weight = util.global.load @__auto.blk.0.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.0.attn_k.weight = util.global.load @__auto.blk.0.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_v.weight = util.global.load @__auto.blk.0.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.0.attn_output.weight = util.global.load @__auto.blk.0.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.0.ffn_norm.weight = util.global.load @__auto.blk.0.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.0.ffn_gate.weight = util.global.load @__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_up.weight = util.global.load @__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.0.ffn_down.weight = util.global.load @__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.1.attn_norm.weight = util.global.load @__auto.blk.1.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.attn_q.weight = util.global.load @__auto.blk.1.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.1.attn_k.weight = util.global.load @__auto.blk.1.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_v.weight = util.global.load @__auto.blk.1.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.1.attn_output.weight = util.global.load @__auto.blk.1.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.1.ffn_norm.weight = util.global.load @__auto.blk.1.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.1.ffn_gate.weight = util.global.load @__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_up.weight = util.global.load @__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.1.ffn_down.weight = util.global.load @__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.2.attn_norm.weight = util.global.load @__auto.blk.2.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.attn_q.weight = util.global.load @__auto.blk.2.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.2.attn_k.weight = util.global.load @__auto.blk.2.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_v.weight = util.global.load @__auto.blk.2.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.2.attn_output.weight = util.global.load @__auto.blk.2.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.2.ffn_norm.weight = util.global.load @__auto.blk.2.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.2.ffn_gate.weight = util.global.load @__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_up.weight = util.global.load @__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.2.ffn_down.weight = util.global.load @__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.3.attn_norm.weight = util.global.load @__auto.blk.3.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.attn_q.weight = util.global.load @__auto.blk.3.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.3.attn_k.weight = util.global.load @__auto.blk.3.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_v.weight = util.global.load @__auto.blk.3.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.3.attn_output.weight = util.global.load @__auto.blk.3.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.3.ffn_norm.weight = util.global.load @__auto.blk.3.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.3.ffn_gate.weight = util.global.load @__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_up.weight = util.global.load @__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.3.ffn_down.weight = util.global.load @__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.4.attn_norm.weight = util.global.load @__auto.blk.4.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.attn_q.weight = util.global.load @__auto.blk.4.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.4.attn_k.weight = util.global.load @__auto.blk.4.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_v.weight = util.global.load @__auto.blk.4.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.4.attn_output.weight = util.global.load @__auto.blk.4.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.4.ffn_norm.weight = util.global.load @__auto.blk.4.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.4.ffn_gate.weight = util.global.load @__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_up.weight = util.global.load @__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.4.ffn_down.weight = util.global.load @__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.5.attn_norm.weight = util.global.load @__auto.blk.5.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.attn_q.weight = util.global.load @__auto.blk.5.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.5.attn_k.weight = util.global.load @__auto.blk.5.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_v.weight = util.global.load @__auto.blk.5.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.5.attn_output.weight = util.global.load @__auto.blk.5.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.5.ffn_norm.weight = util.global.load @__auto.blk.5.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.5.ffn_gate.weight = util.global.load @__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_up.weight = util.global.load @__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.5.ffn_down.weight = util.global.load @__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.6.attn_norm.weight = util.global.load @__auto.blk.6.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.attn_q.weight = util.global.load @__auto.blk.6.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.6.attn_k.weight = util.global.load @__auto.blk.6.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_v.weight = util.global.load @__auto.blk.6.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.6.attn_output.weight = util.global.load @__auto.blk.6.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.6.ffn_norm.weight = util.global.load @__auto.blk.6.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.6.ffn_gate.weight = util.global.load @__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_up.weight = util.global.load @__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.6.ffn_down.weight = util.global.load @__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.7.attn_norm.weight = util.global.load @__auto.blk.7.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.attn_q.weight = util.global.load @__auto.blk.7.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.7.attn_k.weight = util.global.load @__auto.blk.7.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_v.weight = util.global.load @__auto.blk.7.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.7.attn_output.weight = util.global.load @__auto.blk.7.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.7.ffn_norm.weight = util.global.load @__auto.blk.7.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.7.ffn_gate.weight = util.global.load @__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_up.weight = util.global.load @__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.7.ffn_down.weight = util.global.load @__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.8.attn_norm.weight = util.global.load @__auto.blk.8.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.attn_q.weight = util.global.load @__auto.blk.8.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.8.attn_k.weight = util.global.load @__auto.blk.8.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_v.weight = util.global.load @__auto.blk.8.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.8.attn_output.weight = util.global.load @__auto.blk.8.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.8.ffn_norm.weight = util.global.load @__auto.blk.8.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.8.ffn_gate.weight = util.global.load @__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_up.weight = util.global.load @__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.8.ffn_down.weight = util.global.load @__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.9.attn_norm.weight = util.global.load @__auto.blk.9.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.attn_q.weight = util.global.load @__auto.blk.9.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.9.attn_k.weight = util.global.load @__auto.blk.9.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_v.weight = util.global.load @__auto.blk.9.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.9.attn_output.weight = util.global.load @__auto.blk.9.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.9.ffn_norm.weight = util.global.load @__auto.blk.9.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.9.ffn_gate.weight = util.global.load @__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_up.weight = util.global.load @__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.9.ffn_down.weight = util.global.load @__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.10.attn_norm.weight = util.global.load @__auto.blk.10.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.attn_q.weight = util.global.load @__auto.blk.10.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.10.attn_k.weight = util.global.load @__auto.blk.10.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_v.weight = util.global.load @__auto.blk.10.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.10.attn_output.weight = util.global.load @__auto.blk.10.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.10.ffn_norm.weight = util.global.load @__auto.blk.10.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.10.ffn_gate.weight = util.global.load @__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_up.weight = util.global.load @__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.10.ffn_down.weight = util.global.load @__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.11.attn_norm.weight = util.global.load @__auto.blk.11.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.attn_q.weight = util.global.load @__auto.blk.11.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.11.attn_k.weight = util.global.load @__auto.blk.11.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_v.weight = util.global.load @__auto.blk.11.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.11.attn_output.weight = util.global.load @__auto.blk.11.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.11.ffn_norm.weight = util.global.load @__auto.blk.11.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.11.ffn_gate.weight = util.global.load @__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_up.weight = util.global.load @__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.11.ffn_down.weight = util.global.load @__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.12.attn_norm.weight = util.global.load @__auto.blk.12.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.attn_q.weight = util.global.load @__auto.blk.12.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.12.attn_k.weight = util.global.load @__auto.blk.12.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_v.weight = util.global.load @__auto.blk.12.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.12.attn_output.weight = util.global.load @__auto.blk.12.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.12.ffn_norm.weight = util.global.load @__auto.blk.12.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.12.ffn_gate.weight = util.global.load @__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_up.weight = util.global.load @__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.12.ffn_down.weight = util.global.load @__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.13.attn_norm.weight = util.global.load @__auto.blk.13.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.attn_q.weight = util.global.load @__auto.blk.13.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.13.attn_k.weight = util.global.load @__auto.blk.13.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_v.weight = util.global.load @__auto.blk.13.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.13.attn_output.weight = util.global.load @__auto.blk.13.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.13.ffn_norm.weight = util.global.load @__auto.blk.13.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.13.ffn_gate.weight = util.global.load @__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_up.weight = util.global.load @__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.13.ffn_down.weight = util.global.load @__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.14.attn_norm.weight = util.global.load @__auto.blk.14.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.attn_q.weight = util.global.load @__auto.blk.14.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.14.attn_k.weight = util.global.load @__auto.blk.14.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_v.weight = util.global.load @__auto.blk.14.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.14.attn_output.weight = util.global.load @__auto.blk.14.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.14.ffn_norm.weight = util.global.load @__auto.blk.14.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.14.ffn_gate.weight = util.global.load @__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_up.weight = util.global.load @__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.14.ffn_down.weight = util.global.load @__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.15.attn_norm.weight = util.global.load @__auto.blk.15.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.attn_q.weight = util.global.load @__auto.blk.15.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.15.attn_k.weight = util.global.load @__auto.blk.15.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_v.weight = util.global.load @__auto.blk.15.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.15.attn_output.weight = util.global.load @__auto.blk.15.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.15.ffn_norm.weight = util.global.load @__auto.blk.15.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.15.ffn_gate.weight = util.global.load @__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_up.weight = util.global.load @__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.15.ffn_down.weight = util.global.load @__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.16.attn_norm.weight = util.global.load @__auto.blk.16.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.attn_q.weight = util.global.load @__auto.blk.16.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.16.attn_k.weight = util.global.load @__auto.blk.16.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_v.weight = util.global.load @__auto.blk.16.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.16.attn_output.weight = util.global.load @__auto.blk.16.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.16.ffn_norm.weight = util.global.load @__auto.blk.16.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.16.ffn_gate.weight = util.global.load @__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_up.weight = util.global.load @__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.16.ffn_down.weight = util.global.load @__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.17.attn_norm.weight = util.global.load @__auto.blk.17.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.attn_q.weight = util.global.load @__auto.blk.17.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.17.attn_k.weight = util.global.load @__auto.blk.17.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_v.weight = util.global.load @__auto.blk.17.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.17.attn_output.weight = util.global.load @__auto.blk.17.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.17.ffn_norm.weight = util.global.load @__auto.blk.17.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.17.ffn_gate.weight = util.global.load @__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_up.weight = util.global.load @__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.17.ffn_down.weight = util.global.load @__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.18.attn_norm.weight = util.global.load @__auto.blk.18.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.attn_q.weight = util.global.load @__auto.blk.18.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.18.attn_k.weight = util.global.load @__auto.blk.18.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_v.weight = util.global.load @__auto.blk.18.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.18.attn_output.weight = util.global.load @__auto.blk.18.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.18.ffn_norm.weight = util.global.load @__auto.blk.18.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.18.ffn_gate.weight = util.global.load @__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_up.weight = util.global.load @__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.18.ffn_down.weight = util.global.load @__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.19.attn_norm.weight = util.global.load @__auto.blk.19.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.attn_q.weight = util.global.load @__auto.blk.19.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.19.attn_k.weight = util.global.load @__auto.blk.19.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_v.weight = util.global.load @__auto.blk.19.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.19.attn_output.weight = util.global.load @__auto.blk.19.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.19.ffn_norm.weight = util.global.load @__auto.blk.19.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.19.ffn_gate.weight = util.global.load @__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_up.weight = util.global.load @__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.19.ffn_down.weight = util.global.load @__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.20.attn_norm.weight = util.global.load @__auto.blk.20.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.attn_q.weight = util.global.load @__auto.blk.20.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.20.attn_k.weight = util.global.load @__auto.blk.20.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_v.weight = util.global.load @__auto.blk.20.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.20.attn_output.weight = util.global.load @__auto.blk.20.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.20.ffn_norm.weight = util.global.load @__auto.blk.20.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.20.ffn_gate.weight = util.global.load @__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_up.weight = util.global.load @__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.20.ffn_down.weight = util.global.load @__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.blk.21.attn_norm.weight = util.global.load @__auto.blk.21.attn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.attn_q.weight = util.global.load @__auto.blk.21.attn_q.weight : tensor<2048x2176xi8>
    %__auto.blk.21.attn_k.weight = util.global.load @__auto.blk.21.attn_k.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_v.weight = util.global.load @__auto.blk.21.attn_v.weight : tensor<256x2176xi8>
    %__auto.blk.21.attn_output.weight = util.global.load @__auto.blk.21.attn_output.weight : tensor<2048x2176xi8>
    %__auto.blk.21.ffn_norm.weight = util.global.load @__auto.blk.21.ffn_norm.weight : tensor<2048xf32>
    %__auto.blk.21.ffn_gate.weight = util.global.load @__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_up.weight = util.global.load @__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8>
    %__auto.blk.21.ffn_down.weight = util.global.load @__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8>
    %__auto.output_norm.weight = util.global.load @__auto.output_norm.weight : tensor<2048xf32>
    %__auto.output.weight = util.global.load @__auto.output.weight : tensor<32000x2176xi8>
    %5 = hal.buffer_view.dim<%arg4 : !hal.buffer_view>[0] : index
    %6 = hal.tensor.import on(#hal.device.promise<@__device_0>) wait(%arg5) => %arg4 : !hal.buffer_view -> tensor<?x360448xf16>{%5}
    %7 = util.assume.int %3<umin = 1, umax = 63> : index
    %8 = flow.tensor.tie_shape %4 : tensor<4x?xi64>{%7}
    %9 = util.assume.int %5<umin = 1, umax = 9007199254740991> : index
    %10 = flow.tensor.tie_shape %6 : tensor<?x360448xf16>{%9}
    %11 = arith.index_cast %7 : index to i64
    %12 = iree_tensor_ext.bitcast %__auto.token_embd.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded = tensor.expand_shape %12 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice = tensor.extract_slice %expanded[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %13 = iree_tensor_ext.bitcast %extracted_slice : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_13 = tensor.extract_slice %expanded[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %14 = iree_tensor_ext.bitcast %extracted_slice_13 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %15 = tensor.empty() : tensor<32000x64x32xf16>
    %16 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%14 : tensor<32000x64x32xi8>) outs(%15 : tensor<32000x64x32xf16>) {
    ^bb0(%in: i8, %out: f16):
      %2742 = arith.sitofp %in : i8 to f16
      linalg.yield %2742 : f16
    } -> tensor<32000x64x32xf16>
    %17 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%13, %16 : tensor<32000x64x1xf16>, tensor<32000x64x32xf16>) outs(%15 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed = tensor.collapse_shape %17 [[0], [1, 2]] : tensor<32000x64x32xf16> into tensor<32000x2048xf16>
    %18 = tensor.empty() : tensor<4x1x2048xf16>
    %19 = linalg.generic {indexing_maps = [#map2, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%0 : tensor<4x1xi64>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: i64, %out: f16):
      %2742 = arith.index_cast %in : i64 to index
      %2743 = linalg.index 2 : index
      %2744 = arith.cmpi slt, %2742, %c32000 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %collapsed[%2742, %2743] : tensor<32000x2048xf16>
      linalg.yield %extracted : f16
    } -> tensor<4x1x2048xf16>
    %20 = tensor.empty() : tensor<4x1x2048xf32>
    %21 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%19 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %22 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%21 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %23 = tensor.empty() : tensor<4x1x1xf32>
    %24 = linalg.fill ins(%cst_5 : f32) outs(%23 : tensor<4x1x1xf32>) -> tensor<4x1x1xf32>
    %25 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%22 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %26 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%25 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %27 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%26 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %28 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%27 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %29 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%21, %28 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %30 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%29 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %31 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.attn_norm.weight, %30 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %32 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%31 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %33 = iree_tensor_ext.bitcast %__auto.blk.0.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_14 = tensor.expand_shape %33 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_15 = tensor.extract_slice %expanded_14[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %34 = iree_tensor_ext.bitcast %extracted_slice_15 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_16 = tensor.extract_slice %expanded_14[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %35 = iree_tensor_ext.bitcast %extracted_slice_16 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %36 = tensor.empty() : tensor<2048x64x32xf16>
    %37 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%34, %35 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_17 = tensor.expand_shape %32 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %38 = linalg.fill ins(%cst_5 : f32) outs(%20 : tensor<4x1x2048xf32>) -> tensor<4x1x2048xf32>
    %39 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_17, %37 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %40 = linalg.copy ins(%39 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %41 = iree_tensor_ext.bitcast %__auto.blk.0.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_18 = tensor.expand_shape %41 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_19 = tensor.extract_slice %expanded_18[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %42 = iree_tensor_ext.bitcast %extracted_slice_19 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_20 = tensor.extract_slice %expanded_18[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %43 = iree_tensor_ext.bitcast %extracted_slice_20 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %44 = tensor.empty() : tensor<256x64x32xf16>
    %45 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%42, %43 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %46 = tensor.empty() : tensor<4x1x256xf32>
    %47 = linalg.fill ins(%cst_5 : f32) outs(%46 : tensor<4x1x256xf32>) -> tensor<4x1x256xf32>
    %48 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_17, %45 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %49 = tensor.empty() : tensor<4x1x256xf16>
    %50 = linalg.copy ins(%48 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %51 = iree_tensor_ext.bitcast %__auto.blk.0.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_21 = tensor.expand_shape %51 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_22 = tensor.extract_slice %expanded_21[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %52 = iree_tensor_ext.bitcast %extracted_slice_22 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_23 = tensor.extract_slice %expanded_21[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %53 = iree_tensor_ext.bitcast %extracted_slice_23 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %54 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%52, %53 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %55 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_17, %54 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %56 = linalg.copy ins(%55 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_24 = tensor.expand_shape %40 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_25 = tensor.expand_shape %50 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_26 = tensor.expand_shape %56 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %57 = tensor.empty() : tensor<1xi64>
    %58 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%57 : tensor<1xi64>) {
    ^bb0(%out: i64):
      linalg.yield %c0_i64 : i64
    } -> tensor<1xi64>
    %expanded_27 = tensor.expand_shape %58 [[0, 1]] output_shape [1, 1] : tensor<1xi64> into tensor<1x1xi64>
    %expanded_28 = tensor.expand_shape %2 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %59 = tensor.empty() : tensor<4x1xi64>
    %60 = linalg.generic {indexing_maps = [#map28, #map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_27, %expanded_28 : tensor<1x1xi64>, tensor<4x1xi64>) outs(%59 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1xi64>
    %61 = tensor.empty() : tensor<32xi64>
    %62 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%61 : tensor<32xi64>) {
    ^bb0(%out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %2742 : index to i64
      %2744 = arith.muli %2743, %c2_i64 : i64
      linalg.yield %2744 : i64
    } -> tensor<32xi64>
    %63 = tensor.empty() : tensor<32xf32>
    %64 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%62 : tensor<32xi64>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: i64, %out: f32):
      %2742 = arith.sitofp %in : i64 to f32
      linalg.yield %2742 : f32
    } -> tensor<32xf32>
    %65 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%64 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_10 : f32
      linalg.yield %2742 : f32
    } -> tensor<32xf32>
    %66 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%65 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.powf %cst_11, %in : f32
      linalg.yield %2742 : f32
    } -> tensor<32xf32>
    %67 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %68 = tensor.empty() : tensor<4x32x1xf32>
    %expanded_29 = tensor.expand_shape %67 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %69 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_29 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %expanded_30 = tensor.expand_shape %60 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %70 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_30 : tensor<4x1x1xi64>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: i64, %out: f32):
      %2742 = arith.sitofp %in : i64 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %71 = linalg.fill ins(%cst_5 : f32) outs(%68 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %72 = linalg.batch_matmul ins(%69, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %73 = tensor.empty() : tensor<4x1x32xf32>
    %transposed = linalg.transpose ins(%72 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %74 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %75 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%74, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %76 = tensor.empty() : tensor<4x1x32xf16>
    %77 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%75 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %78 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %79 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%78, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %80 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%79 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_31 = tensor.expand_shape %77 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_32 = tensor.expand_shape %80 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %81 = tensor.empty() : tensor<4x1x32x64xf16>
    %extracted_slice_33 = tensor.extract_slice %expanded_24[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_34 = tensor.extract_slice %expanded_24[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %82 = tensor.empty() : tensor<4x1x32x32xf16>
    %83 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_33, %expanded_31 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %84 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_34, %expanded_32 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %85 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%83, %84 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %86 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_34, %expanded_31 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %87 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_33, %expanded_32 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %88 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%86, %87 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %89 = tensor.empty() : tensor<4x1x32x2x32xf16>
    %90 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%85, %88 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_35 = tensor.collapse_shape %90 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %91 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_36 = tensor.expand_shape %91 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %92 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_36 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %93 = linalg.batch_matmul ins(%92, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_37 = linalg.transpose ins(%93 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %94 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_37 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %95 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%94, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %96 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%95 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %97 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_37 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %98 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%97, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %99 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%98 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_38 = tensor.expand_shape %96 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_39 = tensor.expand_shape %99 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_40 = tensor.extract_slice %expanded_25[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_41 = tensor.extract_slice %expanded_25[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %100 = tensor.empty() : tensor<4x1x4x32xf16>
    %101 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_40, %expanded_38 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %102 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_41, %expanded_39 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %103 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%101, %102 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %104 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_41, %expanded_38 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %105 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_40, %expanded_39 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %106 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%104, %105 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %107 = tensor.empty() : tensor<4x1x4x2x32xf16>
    %108 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%103, %106 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %expanded_42 = tensor.expand_shape %10 [[0], [1, 2, 3, 4, 5]] output_shape [%9, 22, 2, 4, 32, 64] : tensor<?x360448xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_43 = tensor.collapse_shape %expanded_42 [[0, 1, 2, 3, 4], [5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x64xf16>
    %109 = tensor.empty() : tensor<4xi64>
    %110 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2 : tensor<4xi64>) outs(%109 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.sitofp %in : i64 to f32
      %2743 = arith.divf %2742, %cst_12 : f32
      %2744 = math.floor %2743 : f32
      %2745 = arith.fptosi %2744 : f32 to i64
      linalg.yield %2745 : i64
    } -> tensor<4xi64>
    %expanded_44 = tensor.expand_shape %110 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %111 = linalg.fill ins(%c0_i64 : i64) outs(%59 : tensor<4x1xi64>) -> tensor<4x1xi64>
    %112 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_45 = tensor.expand_shape %112 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %113 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2 : tensor<4xi64>) outs(%109 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.remsi %in, %c32_i64 : i64
      %2743 = arith.cmpi ne, %2742, %c0_i64 : i64
      %2744 = arith.cmpi slt, %2742, %c0_i64 : i64
      %2745 = arith.andi %2743, %2744 : i1
      %2746 = arith.addi %2742, %c32_i64 : i64
      %2747 = arith.select %2745, %2746, %2742 : i64
      linalg.yield %2747 : i64
    } -> tensor<4xi64>
    %expanded_46 = tensor.expand_shape %113 [[0, 1, 2]] output_shape [4, 1, 1] : tensor<4xi64> into tensor<4x1x1xi64>
    %114 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%109 : tensor<4xi64>) {
    ^bb0(%out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %2742 : index to i64
      linalg.yield %2743 : i64
    } -> tensor<4xi64>
    %expanded_47 = tensor.expand_shape %114 [[0, 1, 2]] output_shape [1, 1, 4] : tensor<4xi64> into tensor<1x1x4xi64>
    %115 = tensor.empty() : tensor<4x1x1xi64>
    %116 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_45 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %117 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%116 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %118 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%117, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %119 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%118 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %120 = tensor.empty() : tensor<4x1x4xi64>
    %121 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%119, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %122 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%121 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %123 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%122, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_48 = tensor.collapse_shape %123 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_49 = tensor.expand_shape %collapsed_48 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_50 = tensor.collapse_shape %108 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %124 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_50, %expanded_49 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%collapsed_43 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %125 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%117, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %126 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%125 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %127 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%126, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %128 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%127 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %129 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%128, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_51 = tensor.collapse_shape %129 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_52 = tensor.expand_shape %collapsed_51 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_53 = tensor.collapse_shape %expanded_26 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %130 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_53, %expanded_52 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%124 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %dim = tensor.dim %collapsed_43, %c0 : tensor<?x64xf16>
    %131 = arith.divsi %dim, %c5632 : index
    %expanded_54 = tensor.expand_shape %130 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_55 = tensor.dim %expanded_54, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_56 = tensor.extract_slice %expanded_54[0, 0, 0, 0, 0, 0] [%dim_55, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %132 = tensor.empty(%7) : tensor<4x?x4x32x64xf16>
    %133 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_56, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_57 = tensor.extract_slice %expanded_54[0, 0, 1, 0, 0, 0] [%dim_55, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %134 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_57, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %135 = tensor.empty(%7) : tensor<4x?x32x4x64xf16>
    %transposed_58 = linalg.transpose ins(%133 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %136 = arith.muli %11, %c32_i64 : i64
    %collapsed_59 = tensor.collapse_shape %transposed_58 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_60 = linalg.transpose ins(%134 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_61 = tensor.collapse_shape %transposed_60 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %137 = arith.index_cast %136 : i64 to index
    %138 = tensor.empty(%137) : tensor<?xi64>
    %139 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%138 : tensor<?xi64>) {
    ^bb0(%out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %2742 : index to i64
      linalg.yield %2743 : i64
    } -> tensor<?xi64>
    %expanded_62 = tensor.expand_shape %1 [[0, 1]] output_shape [4, 1] : tensor<4xi64> into tensor<4x1xi64>
    %140 = tensor.empty(%137) : tensor<4x?xi1>
    %141 = linalg.generic {indexing_maps = [#map15, #map16, #map13], iterator_types = ["parallel", "parallel"]} ins(%139, %expanded_62 : tensor<?xi64>, tensor<4x1xi64>) outs(%140 : tensor<4x?xi1>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i1):
      %2742 = arith.cmpi sge, %in, %in_1505 : i64
      linalg.yield %2742 : i1
    } -> tensor<4x?xi1>
    %142 = tensor.empty() : tensor<f16>
    %143 = linalg.generic {indexing_maps = [#map20, #map20], iterator_types = []} ins(%cst_3 : tensor<i64>) outs(%142 : tensor<f16>) {
    ^bb0(%in: i64, %out: f16):
      %2742 = arith.sitofp %in : i64 to f16
      linalg.yield %2742 : f16
    } -> tensor<f16>
    %144 = tensor.empty(%137) : tensor<4x?xf16>
    %145 = linalg.generic {indexing_maps = [#map13, #map31, #map31, #map13], iterator_types = ["parallel", "parallel"]} ins(%141, %cst_2, %143 : tensor<4x?xi1>, tensor<f16>, tensor<f16>) outs(%144 : tensor<4x?xf16>) {
    ^bb0(%in: i1, %in_1505: f16, %in_1506: f16, %out: f16):
      %2742 = arith.select %in, %in_1505, %in_1506 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x?xf16>
    %expanded_63 = tensor.expand_shape %145 [[0], [1, 2, 3]] output_shape [4, 1, 1, %137] : tensor<4x?xf16> into tensor<4x1x1x?xf16>
    %146 = tensor.empty(%137) : tensor<4x?x4x8x64xf16>
    %147 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_59 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_64 = tensor.collapse_shape %147 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %148 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_61 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_65 = tensor.collapse_shape %148 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %149 = tensor.empty() : tensor<4x32x1x64xf16>
    %transposed_66 = linalg.transpose ins(%collapsed_35 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %150 = affine.apply #map32()[%7]
    %151 = tensor.empty(%150) : tensor<4x32x?x64xf16>
    %transposed_67 = linalg.transpose ins(%collapsed_64 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_68 = linalg.transpose ins(%collapsed_65 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %dim_69 = tensor.dim %expanded_63, %c3 : tensor<4x1x1x?xf16>
    %152 = tensor.empty(%dim_69) : tensor<4x32x1x?xf16>
    %153 = linalg.generic {indexing_maps = [#map22, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_63 : tensor<4x1x1x?xf16>) outs(%152 : tensor<4x32x1x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x32x1x?xf16>
    %collapsed_70 = tensor.collapse_shape %transposed_66 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_71 = tensor.collapse_shape %transposed_67 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_72 = tensor.collapse_shape %transposed_68 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_73 = tensor.collapse_shape %153 [[0, 1], [2], [3]] : tensor<4x32x1x?xf16> into tensor<128x1x?xf16>
    %154 = tensor.empty() : tensor<128x1x64xf16>
    %155 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_70, %collapsed_71, %collapsed_72, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_74 = tensor.expand_shape %155 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_75 = linalg.transpose ins(%expanded_74 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_76 = tensor.collapse_shape %transposed_75 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %156 = iree_tensor_ext.bitcast %__auto.blk.0.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_77 = tensor.expand_shape %156 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_78 = tensor.extract_slice %expanded_77[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %157 = iree_tensor_ext.bitcast %extracted_slice_78 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_79 = tensor.extract_slice %expanded_77[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %158 = iree_tensor_ext.bitcast %extracted_slice_79 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %159 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%157, %158 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_80 = tensor.expand_shape %collapsed_76 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %160 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_80, %159 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %161 = linalg.copy ins(%160 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %162 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%19, %161 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %163 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%162 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %164 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%163 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %165 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%164 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %166 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%165 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %167 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%166 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %168 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%167 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %169 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%163, %168 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %170 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%169 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %171 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.0.ffn_norm.weight, %170 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %172 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%171 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %173 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_81 = tensor.expand_shape %173 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_82 = tensor.extract_slice %expanded_81[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %174 = iree_tensor_ext.bitcast %extracted_slice_82 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_83 = tensor.extract_slice %expanded_81[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %175 = iree_tensor_ext.bitcast %extracted_slice_83 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %176 = tensor.empty() : tensor<5632x64x32xf16>
    %177 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%174, %175 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_84 = tensor.expand_shape %172 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %178 = tensor.empty() : tensor<4x1x5632xf32>
    %179 = linalg.fill ins(%cst_5 : f32) outs(%178 : tensor<4x1x5632xf32>) -> tensor<4x1x5632xf32>
    %180 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_84, %177 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %181 = tensor.empty() : tensor<4x1x5632xf16>
    %182 = linalg.copy ins(%180 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %183 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%182 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %184 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%183, %182 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %185 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_85 = tensor.expand_shape %185 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_86 = tensor.extract_slice %expanded_85[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %186 = iree_tensor_ext.bitcast %extracted_slice_86 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_87 = tensor.extract_slice %expanded_85[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %187 = iree_tensor_ext.bitcast %extracted_slice_87 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %188 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%186, %187 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %189 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_84, %188 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %190 = linalg.copy ins(%189 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %191 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%184, %190 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %192 = iree_tensor_ext.bitcast %__auto.blk.0.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_88 = tensor.expand_shape %192 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_89 = tensor.extract_slice %expanded_88[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %193 = iree_tensor_ext.bitcast %extracted_slice_89 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_90 = tensor.extract_slice %expanded_88[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %194 = iree_tensor_ext.bitcast %extracted_slice_90 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %195 = tensor.empty() : tensor<2048x176x32xf16>
    %196 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%193, %194 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_91 = tensor.expand_shape %191 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %197 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_91, %196 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %198 = linalg.copy ins(%197 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %199 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%162, %198 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %200 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%199 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %201 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%200 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %202 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%201 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %203 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%202 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %204 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%203 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %205 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%204 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %206 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%200, %205 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %207 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%206 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %208 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.attn_norm.weight, %207 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %209 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%208 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %210 = iree_tensor_ext.bitcast %__auto.blk.1.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_92 = tensor.expand_shape %210 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_93 = tensor.extract_slice %expanded_92[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %211 = iree_tensor_ext.bitcast %extracted_slice_93 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_94 = tensor.extract_slice %expanded_92[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %212 = iree_tensor_ext.bitcast %extracted_slice_94 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %213 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%211, %212 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_95 = tensor.expand_shape %209 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %214 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_95, %213 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %215 = linalg.copy ins(%214 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %216 = iree_tensor_ext.bitcast %__auto.blk.1.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_96 = tensor.expand_shape %216 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_97 = tensor.extract_slice %expanded_96[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %217 = iree_tensor_ext.bitcast %extracted_slice_97 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_98 = tensor.extract_slice %expanded_96[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %218 = iree_tensor_ext.bitcast %extracted_slice_98 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %219 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%217, %218 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %220 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_95, %219 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %221 = linalg.copy ins(%220 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %222 = iree_tensor_ext.bitcast %__auto.blk.1.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_99 = tensor.expand_shape %222 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_100 = tensor.extract_slice %expanded_99[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %223 = iree_tensor_ext.bitcast %extracted_slice_100 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_101 = tensor.extract_slice %expanded_99[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %224 = iree_tensor_ext.bitcast %extracted_slice_101 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %225 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%223, %224 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %226 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_95, %225 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %227 = linalg.copy ins(%226 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_102 = tensor.expand_shape %215 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_103 = tensor.expand_shape %221 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_104 = tensor.expand_shape %227 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %228 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_105 = tensor.expand_shape %228 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %229 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_105 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %230 = linalg.batch_matmul ins(%229, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_106 = linalg.transpose ins(%230 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %231 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_106 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %232 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%231, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %233 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%232 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %234 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_106 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %235 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%234, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %236 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%235 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_107 = tensor.expand_shape %233 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_108 = tensor.expand_shape %236 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_109 = tensor.extract_slice %expanded_102[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_110 = tensor.extract_slice %expanded_102[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %237 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_109, %expanded_107 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %238 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_110, %expanded_108 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %239 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%237, %238 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %240 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_110, %expanded_107 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %241 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_109, %expanded_108 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %242 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%240, %241 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %243 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%239, %242 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_111 = tensor.collapse_shape %243 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %244 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_112 = tensor.expand_shape %244 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %245 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_112 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %246 = linalg.batch_matmul ins(%245, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_113 = linalg.transpose ins(%246 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %247 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_113 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %248 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%247, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%248 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %250 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_113 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %251 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%250, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%251 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_114 = tensor.expand_shape %249 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_115 = tensor.expand_shape %252 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_116 = tensor.extract_slice %expanded_103[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_117 = tensor.extract_slice %expanded_103[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %253 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_116, %expanded_114 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %254 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_117, %expanded_115 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %255 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%253, %254 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %256 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_117, %expanded_114 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %257 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_116, %expanded_115 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %258 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%256, %257 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %259 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%255, %258 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %260 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_118 = tensor.expand_shape %260 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %261 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_118 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %262 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%261 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %263 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%262 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %264 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%263, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %265 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%264 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %266 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%265, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %267 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%266 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %268 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%267, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_119 = tensor.collapse_shape %268 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_120 = tensor.expand_shape %collapsed_119 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_121 = tensor.collapse_shape %259 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %269 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_121, %expanded_120 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%130 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %270 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%263, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %271 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%270 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %272 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%271, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %273 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%272 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %274 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%273, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_122 = tensor.collapse_shape %274 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_123 = tensor.expand_shape %collapsed_122 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_124 = tensor.collapse_shape %expanded_104 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %275 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_124, %expanded_123 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%269 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_125 = tensor.expand_shape %275 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_126 = tensor.dim %expanded_125, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_127 = tensor.extract_slice %expanded_125[0, 1, 0, 0, 0, 0] [%dim_126, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %276 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_127, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_128 = tensor.extract_slice %expanded_125[0, 1, 1, 0, 0, 0] [%dim_126, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %277 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_128, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_129 = linalg.transpose ins(%276 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_130 = tensor.collapse_shape %transposed_129 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_131 = linalg.transpose ins(%277 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_132 = tensor.collapse_shape %transposed_131 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %278 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_130 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_133 = tensor.collapse_shape %278 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %279 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_132 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_134 = tensor.collapse_shape %279 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_135 = linalg.transpose ins(%collapsed_111 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_136 = linalg.transpose ins(%collapsed_133 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_137 = linalg.transpose ins(%collapsed_134 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_138 = tensor.collapse_shape %transposed_135 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_139 = tensor.collapse_shape %transposed_136 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_140 = tensor.collapse_shape %transposed_137 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %280 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_138, %collapsed_139, %collapsed_140, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_141 = tensor.expand_shape %280 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_142 = linalg.transpose ins(%expanded_141 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_143 = tensor.collapse_shape %transposed_142 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %281 = iree_tensor_ext.bitcast %__auto.blk.1.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_144 = tensor.expand_shape %281 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_145 = tensor.extract_slice %expanded_144[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %282 = iree_tensor_ext.bitcast %extracted_slice_145 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_146 = tensor.extract_slice %expanded_144[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %283 = iree_tensor_ext.bitcast %extracted_slice_146 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %284 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%282, %283 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_147 = tensor.expand_shape %collapsed_143 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %285 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_147, %284 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %286 = linalg.copy ins(%285 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %287 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%199, %286 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %288 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%287 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %289 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%288 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %290 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%289 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %291 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%290 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%291 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %293 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%292 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %294 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%288, %293 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %295 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%294 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %296 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.1.ffn_norm.weight, %295 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %297 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%296 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %298 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_148 = tensor.expand_shape %298 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_149 = tensor.extract_slice %expanded_148[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %299 = iree_tensor_ext.bitcast %extracted_slice_149 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_150 = tensor.extract_slice %expanded_148[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %300 = iree_tensor_ext.bitcast %extracted_slice_150 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %301 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%299, %300 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_151 = tensor.expand_shape %297 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %302 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_151, %301 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %303 = linalg.copy ins(%302 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %304 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%303 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %305 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%304, %303 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %306 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_152 = tensor.expand_shape %306 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_153 = tensor.extract_slice %expanded_152[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %307 = iree_tensor_ext.bitcast %extracted_slice_153 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_154 = tensor.extract_slice %expanded_152[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %308 = iree_tensor_ext.bitcast %extracted_slice_154 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %309 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%307, %308 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %310 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_151, %309 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %311 = linalg.copy ins(%310 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %312 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%305, %311 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %313 = iree_tensor_ext.bitcast %__auto.blk.1.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_155 = tensor.expand_shape %313 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_156 = tensor.extract_slice %expanded_155[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %314 = iree_tensor_ext.bitcast %extracted_slice_156 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_157 = tensor.extract_slice %expanded_155[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %315 = iree_tensor_ext.bitcast %extracted_slice_157 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %316 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%314, %315 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_158 = tensor.expand_shape %312 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %317 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_158, %316 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %318 = linalg.copy ins(%317 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %319 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%287, %318 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %320 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%319 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %321 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%320 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %322 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%321 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %323 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%322 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %324 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%323 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %325 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%324 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %326 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%320, %325 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %327 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%326 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %328 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.attn_norm.weight, %327 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %329 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%328 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %330 = iree_tensor_ext.bitcast %__auto.blk.2.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_159 = tensor.expand_shape %330 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_160 = tensor.extract_slice %expanded_159[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %331 = iree_tensor_ext.bitcast %extracted_slice_160 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_161 = tensor.extract_slice %expanded_159[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %332 = iree_tensor_ext.bitcast %extracted_slice_161 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %333 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%331, %332 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_162 = tensor.expand_shape %329 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %334 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_162, %333 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %335 = linalg.copy ins(%334 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %336 = iree_tensor_ext.bitcast %__auto.blk.2.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_163 = tensor.expand_shape %336 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_164 = tensor.extract_slice %expanded_163[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %337 = iree_tensor_ext.bitcast %extracted_slice_164 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_165 = tensor.extract_slice %expanded_163[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %338 = iree_tensor_ext.bitcast %extracted_slice_165 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %339 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%337, %338 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %340 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_162, %339 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %341 = linalg.copy ins(%340 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %342 = iree_tensor_ext.bitcast %__auto.blk.2.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_166 = tensor.expand_shape %342 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_167 = tensor.extract_slice %expanded_166[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %343 = iree_tensor_ext.bitcast %extracted_slice_167 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_168 = tensor.extract_slice %expanded_166[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %344 = iree_tensor_ext.bitcast %extracted_slice_168 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %345 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%343, %344 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %346 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_162, %345 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %347 = linalg.copy ins(%346 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_169 = tensor.expand_shape %335 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_170 = tensor.expand_shape %341 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_171 = tensor.expand_shape %347 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %348 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_172 = tensor.expand_shape %348 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %349 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_172 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %350 = linalg.batch_matmul ins(%349, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_173 = linalg.transpose ins(%350 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %351 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_173 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %352 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%351, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %353 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%352 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %354 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_173 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %355 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%354, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %356 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%355 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_174 = tensor.expand_shape %353 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_175 = tensor.expand_shape %356 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_176 = tensor.extract_slice %expanded_169[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_177 = tensor.extract_slice %expanded_169[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %357 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_176, %expanded_174 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %358 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_177, %expanded_175 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %359 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%357, %358 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %360 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_177, %expanded_174 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %361 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_176, %expanded_175 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %362 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%360, %361 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %363 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%359, %362 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_178 = tensor.collapse_shape %363 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %364 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_179 = tensor.expand_shape %364 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %365 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_179 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %366 = linalg.batch_matmul ins(%365, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_180 = linalg.transpose ins(%366 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %367 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_180 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %368 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%367, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %369 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%368 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %370 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_180 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %371 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%370, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %372 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%371 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_181 = tensor.expand_shape %369 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_182 = tensor.expand_shape %372 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_183 = tensor.extract_slice %expanded_170[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_184 = tensor.extract_slice %expanded_170[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %373 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_183, %expanded_181 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %374 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_184, %expanded_182 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %375 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%373, %374 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %376 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_184, %expanded_181 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %377 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_183, %expanded_182 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %378 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%376, %377 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %379 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%375, %378 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %380 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_185 = tensor.expand_shape %380 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %381 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_185 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %382 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%381 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %383 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%382 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %384 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%383, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %385 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%384 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %386 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%385, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %387 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%386 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %388 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%387, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_186 = tensor.collapse_shape %388 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_187 = tensor.expand_shape %collapsed_186 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_188 = tensor.collapse_shape %379 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %389 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_188, %expanded_187 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%275 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %390 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%383, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %391 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%390 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %392 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%391, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %393 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%392 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %394 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%393, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_189 = tensor.collapse_shape %394 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_190 = tensor.expand_shape %collapsed_189 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_191 = tensor.collapse_shape %expanded_171 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %395 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_191, %expanded_190 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%389 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_192 = tensor.expand_shape %395 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_193 = tensor.dim %expanded_192, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_194 = tensor.extract_slice %expanded_192[0, 2, 0, 0, 0, 0] [%dim_193, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %396 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_194, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_195 = tensor.extract_slice %expanded_192[0, 2, 1, 0, 0, 0] [%dim_193, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %397 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_195, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_196 = linalg.transpose ins(%396 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_197 = tensor.collapse_shape %transposed_196 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_198 = linalg.transpose ins(%397 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_199 = tensor.collapse_shape %transposed_198 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %398 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_197 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_200 = tensor.collapse_shape %398 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %399 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_199 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_201 = tensor.collapse_shape %399 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_202 = linalg.transpose ins(%collapsed_178 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_203 = linalg.transpose ins(%collapsed_200 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_204 = linalg.transpose ins(%collapsed_201 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_205 = tensor.collapse_shape %transposed_202 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_206 = tensor.collapse_shape %transposed_203 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_207 = tensor.collapse_shape %transposed_204 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %400 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_205, %collapsed_206, %collapsed_207, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_208 = tensor.expand_shape %400 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_209 = linalg.transpose ins(%expanded_208 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_210 = tensor.collapse_shape %transposed_209 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %401 = iree_tensor_ext.bitcast %__auto.blk.2.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_211 = tensor.expand_shape %401 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_212 = tensor.extract_slice %expanded_211[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %402 = iree_tensor_ext.bitcast %extracted_slice_212 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_213 = tensor.extract_slice %expanded_211[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %403 = iree_tensor_ext.bitcast %extracted_slice_213 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %404 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%402, %403 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_214 = tensor.expand_shape %collapsed_210 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %405 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_214, %404 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %406 = linalg.copy ins(%405 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %407 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%319, %406 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %408 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%407 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %409 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%408 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %410 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%409 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %411 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%410 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %412 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%411 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %413 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%412 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %414 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%408, %413 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %415 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%414 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %416 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.2.ffn_norm.weight, %415 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %417 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%416 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %418 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_215 = tensor.expand_shape %418 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_216 = tensor.extract_slice %expanded_215[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %419 = iree_tensor_ext.bitcast %extracted_slice_216 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_217 = tensor.extract_slice %expanded_215[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %420 = iree_tensor_ext.bitcast %extracted_slice_217 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %421 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%419, %420 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_218 = tensor.expand_shape %417 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %422 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_218, %421 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %423 = linalg.copy ins(%422 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %424 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%423 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %425 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%424, %423 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %426 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_219 = tensor.expand_shape %426 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_220 = tensor.extract_slice %expanded_219[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %427 = iree_tensor_ext.bitcast %extracted_slice_220 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_221 = tensor.extract_slice %expanded_219[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %428 = iree_tensor_ext.bitcast %extracted_slice_221 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %429 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%427, %428 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %430 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_218, %429 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %431 = linalg.copy ins(%430 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %432 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%425, %431 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %433 = iree_tensor_ext.bitcast %__auto.blk.2.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_222 = tensor.expand_shape %433 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_223 = tensor.extract_slice %expanded_222[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %434 = iree_tensor_ext.bitcast %extracted_slice_223 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_224 = tensor.extract_slice %expanded_222[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %435 = iree_tensor_ext.bitcast %extracted_slice_224 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %436 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%434, %435 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_225 = tensor.expand_shape %432 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %437 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_225, %436 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %438 = linalg.copy ins(%437 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %439 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%407, %438 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %440 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%439 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %441 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%440 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %442 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%441 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %443 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%442 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %444 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%443 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %445 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%444 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %446 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%440, %445 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %447 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%446 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %448 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.attn_norm.weight, %447 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %449 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%448 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %450 = iree_tensor_ext.bitcast %__auto.blk.3.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_226 = tensor.expand_shape %450 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_227 = tensor.extract_slice %expanded_226[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %451 = iree_tensor_ext.bitcast %extracted_slice_227 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_228 = tensor.extract_slice %expanded_226[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %452 = iree_tensor_ext.bitcast %extracted_slice_228 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %453 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%451, %452 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_229 = tensor.expand_shape %449 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %454 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_229, %453 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %455 = linalg.copy ins(%454 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %456 = iree_tensor_ext.bitcast %__auto.blk.3.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_230 = tensor.expand_shape %456 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_231 = tensor.extract_slice %expanded_230[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %457 = iree_tensor_ext.bitcast %extracted_slice_231 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_232 = tensor.extract_slice %expanded_230[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %458 = iree_tensor_ext.bitcast %extracted_slice_232 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %459 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%457, %458 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %460 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_229, %459 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %461 = linalg.copy ins(%460 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %462 = iree_tensor_ext.bitcast %__auto.blk.3.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_233 = tensor.expand_shape %462 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_234 = tensor.extract_slice %expanded_233[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %463 = iree_tensor_ext.bitcast %extracted_slice_234 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_235 = tensor.extract_slice %expanded_233[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %464 = iree_tensor_ext.bitcast %extracted_slice_235 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %465 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%463, %464 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %466 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_229, %465 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %467 = linalg.copy ins(%466 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_236 = tensor.expand_shape %455 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_237 = tensor.expand_shape %461 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_238 = tensor.expand_shape %467 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %468 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_239 = tensor.expand_shape %468 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %469 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_239 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %470 = linalg.batch_matmul ins(%469, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_240 = linalg.transpose ins(%470 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %471 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_240 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %472 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%471, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %473 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%472 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %474 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_240 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %475 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%474, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %476 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%475 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_241 = tensor.expand_shape %473 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_242 = tensor.expand_shape %476 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_243 = tensor.extract_slice %expanded_236[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_244 = tensor.extract_slice %expanded_236[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %477 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_243, %expanded_241 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %478 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_244, %expanded_242 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %479 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%477, %478 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %480 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_244, %expanded_241 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %481 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_243, %expanded_242 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %482 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%480, %481 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %483 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%479, %482 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_245 = tensor.collapse_shape %483 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %484 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_246 = tensor.expand_shape %484 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %485 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_246 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %486 = linalg.batch_matmul ins(%485, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_247 = linalg.transpose ins(%486 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %487 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_247 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %488 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%487, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %489 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%488 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %490 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_247 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %491 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%490, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %492 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%491 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_248 = tensor.expand_shape %489 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_249 = tensor.expand_shape %492 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_250 = tensor.extract_slice %expanded_237[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_251 = tensor.extract_slice %expanded_237[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %493 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_250, %expanded_248 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %494 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_251, %expanded_249 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %495 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%493, %494 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %496 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_251, %expanded_248 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %497 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_250, %expanded_249 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %498 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%496, %497 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %499 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%495, %498 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %500 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_252 = tensor.expand_shape %500 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %501 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_252 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %502 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%501 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c3_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %503 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%502 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %504 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%503, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %505 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%504 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %506 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%505, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %507 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%506 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %508 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%507, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_253 = tensor.collapse_shape %508 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_254 = tensor.expand_shape %collapsed_253 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_255 = tensor.collapse_shape %499 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %509 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_255, %expanded_254 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%395 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %510 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%503, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %511 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%510 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %512 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%511, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %513 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%512 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %514 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%513, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_256 = tensor.collapse_shape %514 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_257 = tensor.expand_shape %collapsed_256 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_258 = tensor.collapse_shape %expanded_238 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %515 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_258, %expanded_257 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%509 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_259 = tensor.expand_shape %515 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_260 = tensor.dim %expanded_259, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_261 = tensor.extract_slice %expanded_259[0, 3, 0, 0, 0, 0] [%dim_260, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %516 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_261, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_262 = tensor.extract_slice %expanded_259[0, 3, 1, 0, 0, 0] [%dim_260, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %517 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_262, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_263 = linalg.transpose ins(%516 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_264 = tensor.collapse_shape %transposed_263 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_265 = linalg.transpose ins(%517 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_266 = tensor.collapse_shape %transposed_265 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %518 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_264 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_267 = tensor.collapse_shape %518 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %519 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_266 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_268 = tensor.collapse_shape %519 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_269 = linalg.transpose ins(%collapsed_245 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_270 = linalg.transpose ins(%collapsed_267 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_271 = linalg.transpose ins(%collapsed_268 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_272 = tensor.collapse_shape %transposed_269 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_273 = tensor.collapse_shape %transposed_270 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_274 = tensor.collapse_shape %transposed_271 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %520 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_272, %collapsed_273, %collapsed_274, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_275 = tensor.expand_shape %520 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_276 = linalg.transpose ins(%expanded_275 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_277 = tensor.collapse_shape %transposed_276 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %521 = iree_tensor_ext.bitcast %__auto.blk.3.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_278 = tensor.expand_shape %521 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_279 = tensor.extract_slice %expanded_278[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %522 = iree_tensor_ext.bitcast %extracted_slice_279 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_280 = tensor.extract_slice %expanded_278[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %523 = iree_tensor_ext.bitcast %extracted_slice_280 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %524 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%522, %523 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_281 = tensor.expand_shape %collapsed_277 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %525 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_281, %524 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %526 = linalg.copy ins(%525 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %527 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%439, %526 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %528 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%527 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %529 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%528 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %530 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%529 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %531 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%530 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %532 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%531 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %533 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%532 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %534 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%528, %533 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %535 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%534 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %536 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.3.ffn_norm.weight, %535 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %537 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%536 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %538 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_282 = tensor.expand_shape %538 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_283 = tensor.extract_slice %expanded_282[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %539 = iree_tensor_ext.bitcast %extracted_slice_283 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_284 = tensor.extract_slice %expanded_282[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %540 = iree_tensor_ext.bitcast %extracted_slice_284 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %541 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%539, %540 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_285 = tensor.expand_shape %537 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %542 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_285, %541 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %543 = linalg.copy ins(%542 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %544 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%543 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %545 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%544, %543 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %546 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_286 = tensor.expand_shape %546 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_287 = tensor.extract_slice %expanded_286[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %547 = iree_tensor_ext.bitcast %extracted_slice_287 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_288 = tensor.extract_slice %expanded_286[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %548 = iree_tensor_ext.bitcast %extracted_slice_288 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %549 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%547, %548 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %550 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_285, %549 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %551 = linalg.copy ins(%550 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %552 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%545, %551 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %553 = iree_tensor_ext.bitcast %__auto.blk.3.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_289 = tensor.expand_shape %553 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_290 = tensor.extract_slice %expanded_289[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %554 = iree_tensor_ext.bitcast %extracted_slice_290 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_291 = tensor.extract_slice %expanded_289[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %555 = iree_tensor_ext.bitcast %extracted_slice_291 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %556 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%554, %555 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_292 = tensor.expand_shape %552 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %557 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_292, %556 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %558 = linalg.copy ins(%557 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %559 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%527, %558 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %560 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%559 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %561 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%560 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %562 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%561 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %563 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%562 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %564 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%563 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %565 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%564 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %566 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%560, %565 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %567 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%566 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %568 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.attn_norm.weight, %567 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %569 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%568 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %570 = iree_tensor_ext.bitcast %__auto.blk.4.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_293 = tensor.expand_shape %570 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_294 = tensor.extract_slice %expanded_293[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %571 = iree_tensor_ext.bitcast %extracted_slice_294 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_295 = tensor.extract_slice %expanded_293[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %572 = iree_tensor_ext.bitcast %extracted_slice_295 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %573 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%571, %572 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_296 = tensor.expand_shape %569 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %574 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_296, %573 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %575 = linalg.copy ins(%574 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %576 = iree_tensor_ext.bitcast %__auto.blk.4.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_297 = tensor.expand_shape %576 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_298 = tensor.extract_slice %expanded_297[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %577 = iree_tensor_ext.bitcast %extracted_slice_298 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_299 = tensor.extract_slice %expanded_297[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %578 = iree_tensor_ext.bitcast %extracted_slice_299 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %579 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%577, %578 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %580 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_296, %579 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %581 = linalg.copy ins(%580 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %582 = iree_tensor_ext.bitcast %__auto.blk.4.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_300 = tensor.expand_shape %582 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_301 = tensor.extract_slice %expanded_300[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %583 = iree_tensor_ext.bitcast %extracted_slice_301 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_302 = tensor.extract_slice %expanded_300[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %584 = iree_tensor_ext.bitcast %extracted_slice_302 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %585 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%583, %584 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %586 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_296, %585 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %587 = linalg.copy ins(%586 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_303 = tensor.expand_shape %575 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_304 = tensor.expand_shape %581 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_305 = tensor.expand_shape %587 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %588 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_306 = tensor.expand_shape %588 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %589 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_306 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %590 = linalg.batch_matmul ins(%589, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_307 = linalg.transpose ins(%590 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %591 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_307 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %592 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%591, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %593 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%592 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %594 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_307 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %595 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%594, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %596 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%595 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_308 = tensor.expand_shape %593 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_309 = tensor.expand_shape %596 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_310 = tensor.extract_slice %expanded_303[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_311 = tensor.extract_slice %expanded_303[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %597 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_310, %expanded_308 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %598 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_311, %expanded_309 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %599 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%597, %598 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %600 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_311, %expanded_308 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %601 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_310, %expanded_309 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %602 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%600, %601 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %603 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%599, %602 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_312 = tensor.collapse_shape %603 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %604 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_313 = tensor.expand_shape %604 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %605 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_313 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %606 = linalg.batch_matmul ins(%605, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_314 = linalg.transpose ins(%606 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %607 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_314 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %608 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%607, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %609 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%608 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %610 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_314 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %611 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%610, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %612 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%611 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_315 = tensor.expand_shape %609 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_316 = tensor.expand_shape %612 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_317 = tensor.extract_slice %expanded_304[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_318 = tensor.extract_slice %expanded_304[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %613 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_317, %expanded_315 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %614 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_318, %expanded_316 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %615 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%613, %614 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %616 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_318, %expanded_315 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %617 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_317, %expanded_316 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %618 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%616, %617 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %619 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%615, %618 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %620 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_319 = tensor.expand_shape %620 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %621 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_319 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %622 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%621 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %623 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%622 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %624 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%623, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %625 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%624 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %626 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%625, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %627 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%626 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %628 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%627, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_320 = tensor.collapse_shape %628 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_321 = tensor.expand_shape %collapsed_320 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_322 = tensor.collapse_shape %619 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %629 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_322, %expanded_321 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%515 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %630 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%623, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %631 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%630 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %632 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%631, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %633 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%632 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %634 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%633, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_323 = tensor.collapse_shape %634 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_324 = tensor.expand_shape %collapsed_323 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_325 = tensor.collapse_shape %expanded_305 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %635 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_325, %expanded_324 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%629 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_326 = tensor.expand_shape %635 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_327 = tensor.dim %expanded_326, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_328 = tensor.extract_slice %expanded_326[0, 4, 0, 0, 0, 0] [%dim_327, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %636 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_328, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_329 = tensor.extract_slice %expanded_326[0, 4, 1, 0, 0, 0] [%dim_327, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %637 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_329, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_330 = linalg.transpose ins(%636 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_331 = tensor.collapse_shape %transposed_330 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_332 = linalg.transpose ins(%637 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_333 = tensor.collapse_shape %transposed_332 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %638 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_331 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_334 = tensor.collapse_shape %638 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %639 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_333 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_335 = tensor.collapse_shape %639 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_336 = linalg.transpose ins(%collapsed_312 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_337 = linalg.transpose ins(%collapsed_334 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_338 = linalg.transpose ins(%collapsed_335 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_339 = tensor.collapse_shape %transposed_336 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_340 = tensor.collapse_shape %transposed_337 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_341 = tensor.collapse_shape %transposed_338 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %640 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_339, %collapsed_340, %collapsed_341, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_342 = tensor.expand_shape %640 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_343 = linalg.transpose ins(%expanded_342 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_344 = tensor.collapse_shape %transposed_343 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %641 = iree_tensor_ext.bitcast %__auto.blk.4.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_345 = tensor.expand_shape %641 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_346 = tensor.extract_slice %expanded_345[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %642 = iree_tensor_ext.bitcast %extracted_slice_346 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_347 = tensor.extract_slice %expanded_345[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %643 = iree_tensor_ext.bitcast %extracted_slice_347 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %644 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%642, %643 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_348 = tensor.expand_shape %collapsed_344 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %645 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_348, %644 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %646 = linalg.copy ins(%645 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %647 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%559, %646 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %648 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%647 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %649 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%648 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %650 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%649 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %651 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%650 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %652 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%651 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %653 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%652 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %654 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%648, %653 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %655 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%654 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %656 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.4.ffn_norm.weight, %655 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %657 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%656 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %658 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_349 = tensor.expand_shape %658 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_350 = tensor.extract_slice %expanded_349[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %659 = iree_tensor_ext.bitcast %extracted_slice_350 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_351 = tensor.extract_slice %expanded_349[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %660 = iree_tensor_ext.bitcast %extracted_slice_351 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %661 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%659, %660 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_352 = tensor.expand_shape %657 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %662 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_352, %661 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %663 = linalg.copy ins(%662 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %664 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%663 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %665 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%664, %663 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %666 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_353 = tensor.expand_shape %666 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_354 = tensor.extract_slice %expanded_353[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %667 = iree_tensor_ext.bitcast %extracted_slice_354 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_355 = tensor.extract_slice %expanded_353[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %668 = iree_tensor_ext.bitcast %extracted_slice_355 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %669 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%667, %668 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %670 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_352, %669 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %671 = linalg.copy ins(%670 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %672 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%665, %671 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %673 = iree_tensor_ext.bitcast %__auto.blk.4.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_356 = tensor.expand_shape %673 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_357 = tensor.extract_slice %expanded_356[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %674 = iree_tensor_ext.bitcast %extracted_slice_357 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_358 = tensor.extract_slice %expanded_356[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %675 = iree_tensor_ext.bitcast %extracted_slice_358 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %676 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%674, %675 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_359 = tensor.expand_shape %672 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %677 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_359, %676 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %678 = linalg.copy ins(%677 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %679 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%647, %678 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %680 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%679 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %681 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%680 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %682 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%681 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %683 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%682 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %684 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%683 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %685 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%684 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %686 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%680, %685 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %687 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%686 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %688 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.attn_norm.weight, %687 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %689 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%688 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %690 = iree_tensor_ext.bitcast %__auto.blk.5.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_360 = tensor.expand_shape %690 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_361 = tensor.extract_slice %expanded_360[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %691 = iree_tensor_ext.bitcast %extracted_slice_361 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_362 = tensor.extract_slice %expanded_360[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %692 = iree_tensor_ext.bitcast %extracted_slice_362 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %693 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%691, %692 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_363 = tensor.expand_shape %689 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %694 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_363, %693 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %695 = linalg.copy ins(%694 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %696 = iree_tensor_ext.bitcast %__auto.blk.5.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_364 = tensor.expand_shape %696 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_365 = tensor.extract_slice %expanded_364[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %697 = iree_tensor_ext.bitcast %extracted_slice_365 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_366 = tensor.extract_slice %expanded_364[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %698 = iree_tensor_ext.bitcast %extracted_slice_366 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %699 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%697, %698 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %700 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_363, %699 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %701 = linalg.copy ins(%700 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %702 = iree_tensor_ext.bitcast %__auto.blk.5.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_367 = tensor.expand_shape %702 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_368 = tensor.extract_slice %expanded_367[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %703 = iree_tensor_ext.bitcast %extracted_slice_368 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_369 = tensor.extract_slice %expanded_367[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %704 = iree_tensor_ext.bitcast %extracted_slice_369 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %705 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%703, %704 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %706 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_363, %705 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %707 = linalg.copy ins(%706 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_370 = tensor.expand_shape %695 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_371 = tensor.expand_shape %701 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_372 = tensor.expand_shape %707 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %708 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_373 = tensor.expand_shape %708 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %709 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_373 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %710 = linalg.batch_matmul ins(%709, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_374 = linalg.transpose ins(%710 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %711 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_374 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %712 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%711, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %713 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%712 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %714 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_374 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %715 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%714, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %716 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%715 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_375 = tensor.expand_shape %713 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_376 = tensor.expand_shape %716 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_377 = tensor.extract_slice %expanded_370[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_378 = tensor.extract_slice %expanded_370[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %717 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_377, %expanded_375 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %718 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_378, %expanded_376 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %719 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%717, %718 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %720 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_378, %expanded_375 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %721 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_377, %expanded_376 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %722 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%720, %721 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %723 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%719, %722 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_379 = tensor.collapse_shape %723 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %724 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_380 = tensor.expand_shape %724 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %725 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_380 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %726 = linalg.batch_matmul ins(%725, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_381 = linalg.transpose ins(%726 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %727 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_381 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %728 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%727, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %729 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%728 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %730 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_381 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %731 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%730, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %732 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%731 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_382 = tensor.expand_shape %729 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_383 = tensor.expand_shape %732 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_384 = tensor.extract_slice %expanded_371[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_385 = tensor.extract_slice %expanded_371[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %733 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_384, %expanded_382 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %734 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_385, %expanded_383 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %735 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%733, %734 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %736 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_385, %expanded_382 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %737 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_384, %expanded_383 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %738 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%736, %737 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %739 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%735, %738 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %740 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_386 = tensor.expand_shape %740 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %741 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_386 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %742 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%741 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c5_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %743 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%742 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %744 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%743, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %745 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%744 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %746 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%745, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %747 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%746 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %748 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%747, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_387 = tensor.collapse_shape %748 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_388 = tensor.expand_shape %collapsed_387 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_389 = tensor.collapse_shape %739 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %749 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_389, %expanded_388 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%635 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %750 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%743, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %751 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%750 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %752 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%751, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %753 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%752 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %754 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%753, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_390 = tensor.collapse_shape %754 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_391 = tensor.expand_shape %collapsed_390 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_392 = tensor.collapse_shape %expanded_372 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %755 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_392, %expanded_391 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%749 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_393 = tensor.expand_shape %755 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_394 = tensor.dim %expanded_393, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_395 = tensor.extract_slice %expanded_393[0, 5, 0, 0, 0, 0] [%dim_394, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %756 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_395, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_396 = tensor.extract_slice %expanded_393[0, 5, 1, 0, 0, 0] [%dim_394, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %757 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_396, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_397 = linalg.transpose ins(%756 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_398 = tensor.collapse_shape %transposed_397 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_399 = linalg.transpose ins(%757 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_400 = tensor.collapse_shape %transposed_399 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %758 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_398 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_401 = tensor.collapse_shape %758 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %759 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_400 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_402 = tensor.collapse_shape %759 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_403 = linalg.transpose ins(%collapsed_379 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_404 = linalg.transpose ins(%collapsed_401 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_405 = linalg.transpose ins(%collapsed_402 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_406 = tensor.collapse_shape %transposed_403 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_407 = tensor.collapse_shape %transposed_404 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_408 = tensor.collapse_shape %transposed_405 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %760 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_406, %collapsed_407, %collapsed_408, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_409 = tensor.expand_shape %760 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_410 = linalg.transpose ins(%expanded_409 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_411 = tensor.collapse_shape %transposed_410 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %761 = iree_tensor_ext.bitcast %__auto.blk.5.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_412 = tensor.expand_shape %761 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_413 = tensor.extract_slice %expanded_412[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %762 = iree_tensor_ext.bitcast %extracted_slice_413 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_414 = tensor.extract_slice %expanded_412[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %763 = iree_tensor_ext.bitcast %extracted_slice_414 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %764 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%762, %763 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_415 = tensor.expand_shape %collapsed_411 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %765 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_415, %764 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %766 = linalg.copy ins(%765 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %767 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%679, %766 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %768 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%767 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %769 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%768 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %770 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%769 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %771 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%770 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %772 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%771 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %773 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%772 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %774 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%768, %773 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %775 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%774 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %776 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.5.ffn_norm.weight, %775 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %777 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%776 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %778 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_416 = tensor.expand_shape %778 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_417 = tensor.extract_slice %expanded_416[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %779 = iree_tensor_ext.bitcast %extracted_slice_417 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_418 = tensor.extract_slice %expanded_416[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %780 = iree_tensor_ext.bitcast %extracted_slice_418 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %781 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%779, %780 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_419 = tensor.expand_shape %777 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %782 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_419, %781 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %783 = linalg.copy ins(%782 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %784 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%783 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %785 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%784, %783 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %786 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_420 = tensor.expand_shape %786 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_421 = tensor.extract_slice %expanded_420[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %787 = iree_tensor_ext.bitcast %extracted_slice_421 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_422 = tensor.extract_slice %expanded_420[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %788 = iree_tensor_ext.bitcast %extracted_slice_422 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %789 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%787, %788 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %790 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_419, %789 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %791 = linalg.copy ins(%790 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %792 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%785, %791 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %793 = iree_tensor_ext.bitcast %__auto.blk.5.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_423 = tensor.expand_shape %793 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_424 = tensor.extract_slice %expanded_423[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %794 = iree_tensor_ext.bitcast %extracted_slice_424 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_425 = tensor.extract_slice %expanded_423[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %795 = iree_tensor_ext.bitcast %extracted_slice_425 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %796 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%794, %795 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_426 = tensor.expand_shape %792 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %797 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_426, %796 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %798 = linalg.copy ins(%797 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %799 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%767, %798 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %800 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%799 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %801 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%800 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %802 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%801 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %803 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%802 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %804 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%803 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %805 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%804 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %806 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%800, %805 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %807 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%806 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %808 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.attn_norm.weight, %807 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %809 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%808 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %810 = iree_tensor_ext.bitcast %__auto.blk.6.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_427 = tensor.expand_shape %810 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_428 = tensor.extract_slice %expanded_427[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %811 = iree_tensor_ext.bitcast %extracted_slice_428 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_429 = tensor.extract_slice %expanded_427[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %812 = iree_tensor_ext.bitcast %extracted_slice_429 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %813 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%811, %812 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_430 = tensor.expand_shape %809 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %814 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_430, %813 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %815 = linalg.copy ins(%814 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %816 = iree_tensor_ext.bitcast %__auto.blk.6.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_431 = tensor.expand_shape %816 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_432 = tensor.extract_slice %expanded_431[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %817 = iree_tensor_ext.bitcast %extracted_slice_432 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_433 = tensor.extract_slice %expanded_431[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %818 = iree_tensor_ext.bitcast %extracted_slice_433 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %819 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%817, %818 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %820 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_430, %819 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %821 = linalg.copy ins(%820 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %822 = iree_tensor_ext.bitcast %__auto.blk.6.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_434 = tensor.expand_shape %822 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_435 = tensor.extract_slice %expanded_434[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %823 = iree_tensor_ext.bitcast %extracted_slice_435 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_436 = tensor.extract_slice %expanded_434[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %824 = iree_tensor_ext.bitcast %extracted_slice_436 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %825 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%823, %824 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %826 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_430, %825 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %827 = linalg.copy ins(%826 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_437 = tensor.expand_shape %815 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_438 = tensor.expand_shape %821 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_439 = tensor.expand_shape %827 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %828 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_440 = tensor.expand_shape %828 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %829 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_440 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %830 = linalg.batch_matmul ins(%829, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_441 = linalg.transpose ins(%830 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %831 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_441 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %832 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%831, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %833 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%832 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %834 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_441 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %835 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%834, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %836 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%835 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_442 = tensor.expand_shape %833 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_443 = tensor.expand_shape %836 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_444 = tensor.extract_slice %expanded_437[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_445 = tensor.extract_slice %expanded_437[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %837 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_444, %expanded_442 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %838 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_445, %expanded_443 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %839 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%837, %838 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %840 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_445, %expanded_442 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %841 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_444, %expanded_443 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %842 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%840, %841 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %843 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%839, %842 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_446 = tensor.collapse_shape %843 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %844 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_447 = tensor.expand_shape %844 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %845 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_447 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %846 = linalg.batch_matmul ins(%845, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_448 = linalg.transpose ins(%846 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %847 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_448 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %848 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%847, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %849 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%848 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %850 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_448 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %851 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%850, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %852 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%851 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_449 = tensor.expand_shape %849 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_450 = tensor.expand_shape %852 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_451 = tensor.extract_slice %expanded_438[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_452 = tensor.extract_slice %expanded_438[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %853 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_451, %expanded_449 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %854 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_452, %expanded_450 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %855 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%853, %854 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %856 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_452, %expanded_449 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %857 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_451, %expanded_450 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %858 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%856, %857 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %859 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%855, %858 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %860 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_453 = tensor.expand_shape %860 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %861 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_453 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %862 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%861 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c6_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %863 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%862 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %864 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%863, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %865 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%864 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %866 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%865, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %867 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%866 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %868 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%867, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_454 = tensor.collapse_shape %868 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_455 = tensor.expand_shape %collapsed_454 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_456 = tensor.collapse_shape %859 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %869 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_456, %expanded_455 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%755 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %870 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%863, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %871 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%870 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %872 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%871, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %873 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%872 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %874 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%873, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_457 = tensor.collapse_shape %874 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_458 = tensor.expand_shape %collapsed_457 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_459 = tensor.collapse_shape %expanded_439 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %875 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_459, %expanded_458 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%869 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_460 = tensor.expand_shape %875 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_461 = tensor.dim %expanded_460, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_462 = tensor.extract_slice %expanded_460[0, 6, 0, 0, 0, 0] [%dim_461, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %876 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_462, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_463 = tensor.extract_slice %expanded_460[0, 6, 1, 0, 0, 0] [%dim_461, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %877 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_463, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_464 = linalg.transpose ins(%876 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_465 = tensor.collapse_shape %transposed_464 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_466 = linalg.transpose ins(%877 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_467 = tensor.collapse_shape %transposed_466 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %878 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_465 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_468 = tensor.collapse_shape %878 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %879 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_467 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_469 = tensor.collapse_shape %879 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_470 = linalg.transpose ins(%collapsed_446 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_471 = linalg.transpose ins(%collapsed_468 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_472 = linalg.transpose ins(%collapsed_469 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_473 = tensor.collapse_shape %transposed_470 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_474 = tensor.collapse_shape %transposed_471 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_475 = tensor.collapse_shape %transposed_472 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %880 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_473, %collapsed_474, %collapsed_475, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_476 = tensor.expand_shape %880 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_477 = linalg.transpose ins(%expanded_476 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_478 = tensor.collapse_shape %transposed_477 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %881 = iree_tensor_ext.bitcast %__auto.blk.6.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_479 = tensor.expand_shape %881 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_480 = tensor.extract_slice %expanded_479[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %882 = iree_tensor_ext.bitcast %extracted_slice_480 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_481 = tensor.extract_slice %expanded_479[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %883 = iree_tensor_ext.bitcast %extracted_slice_481 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %884 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%882, %883 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_482 = tensor.expand_shape %collapsed_478 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %885 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_482, %884 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %886 = linalg.copy ins(%885 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %887 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%799, %886 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %888 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%887 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %889 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%888 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %890 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%889 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %891 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%890 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %892 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%891 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %893 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%892 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %894 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%888, %893 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %895 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%894 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %896 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.6.ffn_norm.weight, %895 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %897 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%896 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %898 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_483 = tensor.expand_shape %898 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_484 = tensor.extract_slice %expanded_483[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %899 = iree_tensor_ext.bitcast %extracted_slice_484 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_485 = tensor.extract_slice %expanded_483[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %900 = iree_tensor_ext.bitcast %extracted_slice_485 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %901 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%899, %900 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_486 = tensor.expand_shape %897 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %902 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_486, %901 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %903 = linalg.copy ins(%902 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %904 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%903 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %905 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%904, %903 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %906 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_487 = tensor.expand_shape %906 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_488 = tensor.extract_slice %expanded_487[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %907 = iree_tensor_ext.bitcast %extracted_slice_488 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_489 = tensor.extract_slice %expanded_487[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %908 = iree_tensor_ext.bitcast %extracted_slice_489 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %909 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%907, %908 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %910 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_486, %909 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %911 = linalg.copy ins(%910 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %912 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%905, %911 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %913 = iree_tensor_ext.bitcast %__auto.blk.6.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_490 = tensor.expand_shape %913 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_491 = tensor.extract_slice %expanded_490[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %914 = iree_tensor_ext.bitcast %extracted_slice_491 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_492 = tensor.extract_slice %expanded_490[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %915 = iree_tensor_ext.bitcast %extracted_slice_492 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %916 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%914, %915 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_493 = tensor.expand_shape %912 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %917 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_493, %916 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %918 = linalg.copy ins(%917 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %919 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%887, %918 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %920 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%919 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %921 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%920 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %922 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%921 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %923 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%922 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %924 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%923 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %925 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%924 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %926 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%920, %925 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %927 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%926 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %928 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.attn_norm.weight, %927 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %929 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%928 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %930 = iree_tensor_ext.bitcast %__auto.blk.7.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_494 = tensor.expand_shape %930 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_495 = tensor.extract_slice %expanded_494[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %931 = iree_tensor_ext.bitcast %extracted_slice_495 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_496 = tensor.extract_slice %expanded_494[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %932 = iree_tensor_ext.bitcast %extracted_slice_496 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %933 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%931, %932 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_497 = tensor.expand_shape %929 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %934 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_497, %933 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %935 = linalg.copy ins(%934 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %936 = iree_tensor_ext.bitcast %__auto.blk.7.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_498 = tensor.expand_shape %936 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_499 = tensor.extract_slice %expanded_498[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %937 = iree_tensor_ext.bitcast %extracted_slice_499 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_500 = tensor.extract_slice %expanded_498[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %938 = iree_tensor_ext.bitcast %extracted_slice_500 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %939 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%937, %938 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %940 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_497, %939 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %941 = linalg.copy ins(%940 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %942 = iree_tensor_ext.bitcast %__auto.blk.7.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_501 = tensor.expand_shape %942 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_502 = tensor.extract_slice %expanded_501[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %943 = iree_tensor_ext.bitcast %extracted_slice_502 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_503 = tensor.extract_slice %expanded_501[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %944 = iree_tensor_ext.bitcast %extracted_slice_503 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %945 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%943, %944 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %946 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_497, %945 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %947 = linalg.copy ins(%946 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_504 = tensor.expand_shape %935 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_505 = tensor.expand_shape %941 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_506 = tensor.expand_shape %947 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %948 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_507 = tensor.expand_shape %948 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %949 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_507 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %950 = linalg.batch_matmul ins(%949, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_508 = linalg.transpose ins(%950 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %951 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_508 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %952 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%951, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %953 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%952 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %954 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_508 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %955 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%954, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %956 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%955 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_509 = tensor.expand_shape %953 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_510 = tensor.expand_shape %956 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_511 = tensor.extract_slice %expanded_504[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_512 = tensor.extract_slice %expanded_504[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %957 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_511, %expanded_509 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %958 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_512, %expanded_510 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %959 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%957, %958 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %960 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_512, %expanded_509 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %961 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_511, %expanded_510 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %962 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%960, %961 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %963 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%959, %962 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_513 = tensor.collapse_shape %963 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %964 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_514 = tensor.expand_shape %964 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %965 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_514 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %966 = linalg.batch_matmul ins(%965, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_515 = linalg.transpose ins(%966 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %967 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_515 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %968 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%967, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %969 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%968 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %970 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_515 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %971 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%970, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %972 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%971 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_516 = tensor.expand_shape %969 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_517 = tensor.expand_shape %972 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_518 = tensor.extract_slice %expanded_505[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_519 = tensor.extract_slice %expanded_505[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %973 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_518, %expanded_516 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %974 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_519, %expanded_517 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %975 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%973, %974 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %976 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_519, %expanded_516 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %977 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_518, %expanded_517 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %978 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%976, %977 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %979 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%975, %978 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %980 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_520 = tensor.expand_shape %980 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %981 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_520 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %982 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%981 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c7_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %983 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%982 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %984 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%983, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %985 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%984 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %986 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%985, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %987 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%986 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %988 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%987, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_521 = tensor.collapse_shape %988 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_522 = tensor.expand_shape %collapsed_521 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_523 = tensor.collapse_shape %979 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %989 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_523, %expanded_522 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%875 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %990 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%983, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %991 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%990 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %992 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%991, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %993 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%992 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %994 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%993, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_524 = tensor.collapse_shape %994 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_525 = tensor.expand_shape %collapsed_524 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_526 = tensor.collapse_shape %expanded_506 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %995 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_526, %expanded_525 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%989 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_527 = tensor.expand_shape %995 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_528 = tensor.dim %expanded_527, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_529 = tensor.extract_slice %expanded_527[0, 7, 0, 0, 0, 0] [%dim_528, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %996 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_529, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_530 = tensor.extract_slice %expanded_527[0, 7, 1, 0, 0, 0] [%dim_528, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %997 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_530, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_531 = linalg.transpose ins(%996 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_532 = tensor.collapse_shape %transposed_531 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_533 = linalg.transpose ins(%997 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_534 = tensor.collapse_shape %transposed_533 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %998 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_532 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_535 = tensor.collapse_shape %998 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %999 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_534 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_536 = tensor.collapse_shape %999 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_537 = linalg.transpose ins(%collapsed_513 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_538 = linalg.transpose ins(%collapsed_535 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_539 = linalg.transpose ins(%collapsed_536 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_540 = tensor.collapse_shape %transposed_537 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_541 = tensor.collapse_shape %transposed_538 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_542 = tensor.collapse_shape %transposed_539 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1000 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_540, %collapsed_541, %collapsed_542, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_543 = tensor.expand_shape %1000 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_544 = linalg.transpose ins(%expanded_543 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_545 = tensor.collapse_shape %transposed_544 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1001 = iree_tensor_ext.bitcast %__auto.blk.7.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_546 = tensor.expand_shape %1001 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_547 = tensor.extract_slice %expanded_546[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1002 = iree_tensor_ext.bitcast %extracted_slice_547 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_548 = tensor.extract_slice %expanded_546[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1003 = iree_tensor_ext.bitcast %extracted_slice_548 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1004 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1002, %1003 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_549 = tensor.expand_shape %collapsed_545 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1005 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_549, %1004 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1006 = linalg.copy ins(%1005 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1007 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%919, %1006 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1008 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1007 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1009 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1008 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1010 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1009 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1011 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1010 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1012 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1011 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1013 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1012 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1014 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1008, %1013 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1015 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1014 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1016 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.7.ffn_norm.weight, %1015 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1017 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1016 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1018 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_550 = tensor.expand_shape %1018 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_551 = tensor.extract_slice %expanded_550[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1019 = iree_tensor_ext.bitcast %extracted_slice_551 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_552 = tensor.extract_slice %expanded_550[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1020 = iree_tensor_ext.bitcast %extracted_slice_552 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1021 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1019, %1020 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_553 = tensor.expand_shape %1017 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1022 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_553, %1021 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1023 = linalg.copy ins(%1022 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1024 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1023 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1025 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1024, %1023 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1026 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_554 = tensor.expand_shape %1026 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_555 = tensor.extract_slice %expanded_554[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1027 = iree_tensor_ext.bitcast %extracted_slice_555 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_556 = tensor.extract_slice %expanded_554[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1028 = iree_tensor_ext.bitcast %extracted_slice_556 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1029 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1027, %1028 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1030 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_553, %1029 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1031 = linalg.copy ins(%1030 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1032 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1025, %1031 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1033 = iree_tensor_ext.bitcast %__auto.blk.7.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_557 = tensor.expand_shape %1033 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_558 = tensor.extract_slice %expanded_557[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1034 = iree_tensor_ext.bitcast %extracted_slice_558 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_559 = tensor.extract_slice %expanded_557[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1035 = iree_tensor_ext.bitcast %extracted_slice_559 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1036 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1034, %1035 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_560 = tensor.expand_shape %1032 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1037 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_560, %1036 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1038 = linalg.copy ins(%1037 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1039 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1007, %1038 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1040 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1039 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1041 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1040 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1042 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1041 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1043 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1042 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1044 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1043 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1045 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1044 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1046 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1040, %1045 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1047 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1046 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1048 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.attn_norm.weight, %1047 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1049 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1048 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1050 = iree_tensor_ext.bitcast %__auto.blk.8.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_561 = tensor.expand_shape %1050 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_562 = tensor.extract_slice %expanded_561[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1051 = iree_tensor_ext.bitcast %extracted_slice_562 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_563 = tensor.extract_slice %expanded_561[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1052 = iree_tensor_ext.bitcast %extracted_slice_563 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1053 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1051, %1052 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_564 = tensor.expand_shape %1049 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1054 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_564, %1053 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1055 = linalg.copy ins(%1054 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1056 = iree_tensor_ext.bitcast %__auto.blk.8.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_565 = tensor.expand_shape %1056 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_566 = tensor.extract_slice %expanded_565[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1057 = iree_tensor_ext.bitcast %extracted_slice_566 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_567 = tensor.extract_slice %expanded_565[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1058 = iree_tensor_ext.bitcast %extracted_slice_567 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1059 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1057, %1058 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1060 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_564, %1059 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1061 = linalg.copy ins(%1060 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1062 = iree_tensor_ext.bitcast %__auto.blk.8.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_568 = tensor.expand_shape %1062 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_569 = tensor.extract_slice %expanded_568[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1063 = iree_tensor_ext.bitcast %extracted_slice_569 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_570 = tensor.extract_slice %expanded_568[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1064 = iree_tensor_ext.bitcast %extracted_slice_570 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1065 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1063, %1064 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1066 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_564, %1065 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1067 = linalg.copy ins(%1066 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_571 = tensor.expand_shape %1055 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_572 = tensor.expand_shape %1061 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_573 = tensor.expand_shape %1067 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1068 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_574 = tensor.expand_shape %1068 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1069 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_574 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1070 = linalg.batch_matmul ins(%1069, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_575 = linalg.transpose ins(%1070 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1071 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_575 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1072 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1071, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1073 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1072 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1074 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_575 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1075 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1074, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1076 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1075 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_576 = tensor.expand_shape %1073 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_577 = tensor.expand_shape %1076 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_578 = tensor.extract_slice %expanded_571[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_579 = tensor.extract_slice %expanded_571[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1077 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_578, %expanded_576 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1078 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_579, %expanded_577 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1079 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1077, %1078 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1080 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_579, %expanded_576 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1081 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_578, %expanded_577 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1082 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1080, %1081 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1083 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1079, %1082 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_580 = tensor.collapse_shape %1083 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1084 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_581 = tensor.expand_shape %1084 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1085 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_581 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1086 = linalg.batch_matmul ins(%1085, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_582 = linalg.transpose ins(%1086 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1087 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_582 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1088 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1087, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1089 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1088 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1090 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_582 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1091 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1090, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1092 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1091 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_583 = tensor.expand_shape %1089 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_584 = tensor.expand_shape %1092 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_585 = tensor.extract_slice %expanded_572[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_586 = tensor.extract_slice %expanded_572[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1093 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_585, %expanded_583 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1094 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_586, %expanded_584 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1095 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1093, %1094 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1096 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_586, %expanded_583 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1097 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_585, %expanded_584 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1098 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1096, %1097 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1099 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1095, %1098 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1100 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_587 = tensor.expand_shape %1100 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1101 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_587 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1101 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c8_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1103 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1102 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1104 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1103, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1105 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1104 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1106 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1105, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1107 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1106 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1108 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1107, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_588 = tensor.collapse_shape %1108 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_589 = tensor.expand_shape %collapsed_588 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_590 = tensor.collapse_shape %1099 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1109 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_590, %expanded_589 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%995 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1110 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1103, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1111 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1110 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1112 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1111, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1113 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1112 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1114 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1113, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_591 = tensor.collapse_shape %1114 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_592 = tensor.expand_shape %collapsed_591 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_593 = tensor.collapse_shape %expanded_573 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1115 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_593, %expanded_592 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1109 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_594 = tensor.expand_shape %1115 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_595 = tensor.dim %expanded_594, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_596 = tensor.extract_slice %expanded_594[0, 8, 0, 0, 0, 0] [%dim_595, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1116 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_596, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_597 = tensor.extract_slice %expanded_594[0, 8, 1, 0, 0, 0] [%dim_595, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1117 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_597, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_598 = linalg.transpose ins(%1116 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_599 = tensor.collapse_shape %transposed_598 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_600 = linalg.transpose ins(%1117 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_601 = tensor.collapse_shape %transposed_600 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1118 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_599 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_602 = tensor.collapse_shape %1118 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1119 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_601 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_603 = tensor.collapse_shape %1119 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_604 = linalg.transpose ins(%collapsed_580 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_605 = linalg.transpose ins(%collapsed_602 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_606 = linalg.transpose ins(%collapsed_603 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_607 = tensor.collapse_shape %transposed_604 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_608 = tensor.collapse_shape %transposed_605 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_609 = tensor.collapse_shape %transposed_606 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1120 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_607, %collapsed_608, %collapsed_609, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_610 = tensor.expand_shape %1120 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_611 = linalg.transpose ins(%expanded_610 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_612 = tensor.collapse_shape %transposed_611 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1121 = iree_tensor_ext.bitcast %__auto.blk.8.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_613 = tensor.expand_shape %1121 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_614 = tensor.extract_slice %expanded_613[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1122 = iree_tensor_ext.bitcast %extracted_slice_614 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_615 = tensor.extract_slice %expanded_613[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1123 = iree_tensor_ext.bitcast %extracted_slice_615 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1124 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1122, %1123 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_616 = tensor.expand_shape %collapsed_612 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1125 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_616, %1124 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1126 = linalg.copy ins(%1125 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1127 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1039, %1126 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1128 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1127 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1129 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1128 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1130 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1129 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1131 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1130 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1132 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1131 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1133 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1132 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1134 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1128, %1133 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1135 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1134 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1136 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.8.ffn_norm.weight, %1135 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1137 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1136 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1138 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_617 = tensor.expand_shape %1138 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_618 = tensor.extract_slice %expanded_617[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1139 = iree_tensor_ext.bitcast %extracted_slice_618 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_619 = tensor.extract_slice %expanded_617[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1140 = iree_tensor_ext.bitcast %extracted_slice_619 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1141 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1139, %1140 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_620 = tensor.expand_shape %1137 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1142 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_620, %1141 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1143 = linalg.copy ins(%1142 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1144 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1143 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1145 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1144, %1143 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1146 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_621 = tensor.expand_shape %1146 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_622 = tensor.extract_slice %expanded_621[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1147 = iree_tensor_ext.bitcast %extracted_slice_622 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_623 = tensor.extract_slice %expanded_621[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1148 = iree_tensor_ext.bitcast %extracted_slice_623 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1149 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1147, %1148 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1150 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_620, %1149 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1151 = linalg.copy ins(%1150 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1152 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1145, %1151 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1153 = iree_tensor_ext.bitcast %__auto.blk.8.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_624 = tensor.expand_shape %1153 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_625 = tensor.extract_slice %expanded_624[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1154 = iree_tensor_ext.bitcast %extracted_slice_625 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_626 = tensor.extract_slice %expanded_624[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1155 = iree_tensor_ext.bitcast %extracted_slice_626 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1156 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1154, %1155 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_627 = tensor.expand_shape %1152 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1157 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_627, %1156 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1158 = linalg.copy ins(%1157 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1159 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1127, %1158 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1160 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1159 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1161 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1160 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1162 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1161 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1163 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1162 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1164 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1163 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1165 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1164 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1166 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1160, %1165 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1167 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1166 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1168 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.attn_norm.weight, %1167 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1169 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1168 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1170 = iree_tensor_ext.bitcast %__auto.blk.9.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_628 = tensor.expand_shape %1170 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_629 = tensor.extract_slice %expanded_628[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1171 = iree_tensor_ext.bitcast %extracted_slice_629 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_630 = tensor.extract_slice %expanded_628[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1172 = iree_tensor_ext.bitcast %extracted_slice_630 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1173 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1171, %1172 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_631 = tensor.expand_shape %1169 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1174 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_631, %1173 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1175 = linalg.copy ins(%1174 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1176 = iree_tensor_ext.bitcast %__auto.blk.9.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_632 = tensor.expand_shape %1176 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_633 = tensor.extract_slice %expanded_632[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1177 = iree_tensor_ext.bitcast %extracted_slice_633 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_634 = tensor.extract_slice %expanded_632[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1178 = iree_tensor_ext.bitcast %extracted_slice_634 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1179 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1177, %1178 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1180 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_631, %1179 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1181 = linalg.copy ins(%1180 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1182 = iree_tensor_ext.bitcast %__auto.blk.9.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_635 = tensor.expand_shape %1182 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_636 = tensor.extract_slice %expanded_635[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1183 = iree_tensor_ext.bitcast %extracted_slice_636 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_637 = tensor.extract_slice %expanded_635[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1184 = iree_tensor_ext.bitcast %extracted_slice_637 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1185 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1183, %1184 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1186 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_631, %1185 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1187 = linalg.copy ins(%1186 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_638 = tensor.expand_shape %1175 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_639 = tensor.expand_shape %1181 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_640 = tensor.expand_shape %1187 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1188 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_641 = tensor.expand_shape %1188 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1189 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_641 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1190 = linalg.batch_matmul ins(%1189, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_642 = linalg.transpose ins(%1190 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1191 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_642 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1192 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1191, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1193 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1192 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1194 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_642 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1195 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1194, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1196 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1195 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_643 = tensor.expand_shape %1193 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_644 = tensor.expand_shape %1196 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_645 = tensor.extract_slice %expanded_638[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_646 = tensor.extract_slice %expanded_638[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1197 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_645, %expanded_643 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1198 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_646, %expanded_644 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1199 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1197, %1198 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1200 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_646, %expanded_643 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1201 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_645, %expanded_644 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1202 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1200, %1201 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1203 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1199, %1202 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_647 = tensor.collapse_shape %1203 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1204 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_648 = tensor.expand_shape %1204 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1205 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_648 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1206 = linalg.batch_matmul ins(%1205, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_649 = linalg.transpose ins(%1206 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1207 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_649 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1208 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1207, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1209 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1208 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1210 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_649 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1211 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1210, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1212 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1211 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_650 = tensor.expand_shape %1209 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_651 = tensor.expand_shape %1212 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_652 = tensor.extract_slice %expanded_639[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_653 = tensor.extract_slice %expanded_639[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1213 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_652, %expanded_650 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1214 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_653, %expanded_651 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1215 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1213, %1214 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1216 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_653, %expanded_650 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1217 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_652, %expanded_651 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1218 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1216, %1217 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1219 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1215, %1218 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1220 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_654 = tensor.expand_shape %1220 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1221 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_654 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1222 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1221 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c9_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1223 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1222 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1224 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1223, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1225 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1224 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1226 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1225, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1227 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1226 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1228 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1227, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_655 = tensor.collapse_shape %1228 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_656 = tensor.expand_shape %collapsed_655 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_657 = tensor.collapse_shape %1219 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1229 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_657, %expanded_656 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1115 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1230 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1223, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1231 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1230 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1232 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1231, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1233 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1232 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1234 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1233, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_658 = tensor.collapse_shape %1234 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_659 = tensor.expand_shape %collapsed_658 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_660 = tensor.collapse_shape %expanded_640 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1235 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_660, %expanded_659 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1229 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_661 = tensor.expand_shape %1235 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_662 = tensor.dim %expanded_661, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_663 = tensor.extract_slice %expanded_661[0, 9, 0, 0, 0, 0] [%dim_662, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1236 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_663, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_664 = tensor.extract_slice %expanded_661[0, 9, 1, 0, 0, 0] [%dim_662, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1237 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_664, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_665 = linalg.transpose ins(%1236 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_666 = tensor.collapse_shape %transposed_665 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_667 = linalg.transpose ins(%1237 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_668 = tensor.collapse_shape %transposed_667 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1238 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_666 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_669 = tensor.collapse_shape %1238 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1239 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_668 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_670 = tensor.collapse_shape %1239 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_671 = linalg.transpose ins(%collapsed_647 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_672 = linalg.transpose ins(%collapsed_669 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_673 = linalg.transpose ins(%collapsed_670 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_674 = tensor.collapse_shape %transposed_671 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_675 = tensor.collapse_shape %transposed_672 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_676 = tensor.collapse_shape %transposed_673 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1240 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_674, %collapsed_675, %collapsed_676, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_677 = tensor.expand_shape %1240 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_678 = linalg.transpose ins(%expanded_677 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_679 = tensor.collapse_shape %transposed_678 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1241 = iree_tensor_ext.bitcast %__auto.blk.9.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_680 = tensor.expand_shape %1241 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_681 = tensor.extract_slice %expanded_680[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1242 = iree_tensor_ext.bitcast %extracted_slice_681 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_682 = tensor.extract_slice %expanded_680[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1243 = iree_tensor_ext.bitcast %extracted_slice_682 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1244 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1242, %1243 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_683 = tensor.expand_shape %collapsed_679 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1245 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_683, %1244 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1246 = linalg.copy ins(%1245 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1247 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1159, %1246 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1248 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1247 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1248 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1250 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1249 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1251 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1250 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1251 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1253 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1252 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1254 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1248, %1253 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1255 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1254 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1256 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.9.ffn_norm.weight, %1255 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1256 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1258 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_684 = tensor.expand_shape %1258 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_685 = tensor.extract_slice %expanded_684[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1259 = iree_tensor_ext.bitcast %extracted_slice_685 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_686 = tensor.extract_slice %expanded_684[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1260 = iree_tensor_ext.bitcast %extracted_slice_686 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1261 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1259, %1260 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_687 = tensor.expand_shape %1257 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1262 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_687, %1261 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1263 = linalg.copy ins(%1262 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1264 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1263 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1265 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1264, %1263 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1266 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_688 = tensor.expand_shape %1266 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_689 = tensor.extract_slice %expanded_688[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1267 = iree_tensor_ext.bitcast %extracted_slice_689 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_690 = tensor.extract_slice %expanded_688[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1268 = iree_tensor_ext.bitcast %extracted_slice_690 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1269 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1267, %1268 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1270 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_687, %1269 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1271 = linalg.copy ins(%1270 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1272 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1265, %1271 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1273 = iree_tensor_ext.bitcast %__auto.blk.9.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_691 = tensor.expand_shape %1273 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_692 = tensor.extract_slice %expanded_691[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1274 = iree_tensor_ext.bitcast %extracted_slice_692 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_693 = tensor.extract_slice %expanded_691[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1275 = iree_tensor_ext.bitcast %extracted_slice_693 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1276 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1274, %1275 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_694 = tensor.expand_shape %1272 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1277 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_694, %1276 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1278 = linalg.copy ins(%1277 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1279 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1247, %1278 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1280 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1279 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1281 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1280 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1282 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1281 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1283 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1282 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1284 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1283 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1285 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1284 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1286 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1280, %1285 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1287 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1286 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1288 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.attn_norm.weight, %1287 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1289 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1288 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1290 = iree_tensor_ext.bitcast %__auto.blk.10.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_695 = tensor.expand_shape %1290 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_696 = tensor.extract_slice %expanded_695[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1291 = iree_tensor_ext.bitcast %extracted_slice_696 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_697 = tensor.extract_slice %expanded_695[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1292 = iree_tensor_ext.bitcast %extracted_slice_697 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1293 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1291, %1292 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_698 = tensor.expand_shape %1289 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1294 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_698, %1293 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1295 = linalg.copy ins(%1294 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1296 = iree_tensor_ext.bitcast %__auto.blk.10.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_699 = tensor.expand_shape %1296 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_700 = tensor.extract_slice %expanded_699[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1297 = iree_tensor_ext.bitcast %extracted_slice_700 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_701 = tensor.extract_slice %expanded_699[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1298 = iree_tensor_ext.bitcast %extracted_slice_701 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1299 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1297, %1298 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1300 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_698, %1299 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1301 = linalg.copy ins(%1300 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1302 = iree_tensor_ext.bitcast %__auto.blk.10.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_702 = tensor.expand_shape %1302 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_703 = tensor.extract_slice %expanded_702[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1303 = iree_tensor_ext.bitcast %extracted_slice_703 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_704 = tensor.extract_slice %expanded_702[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1304 = iree_tensor_ext.bitcast %extracted_slice_704 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1305 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1303, %1304 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1306 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_698, %1305 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1307 = linalg.copy ins(%1306 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_705 = tensor.expand_shape %1295 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_706 = tensor.expand_shape %1301 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_707 = tensor.expand_shape %1307 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1308 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_708 = tensor.expand_shape %1308 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1309 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_708 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1310 = linalg.batch_matmul ins(%1309, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_709 = linalg.transpose ins(%1310 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1311 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_709 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1312 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1311, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1313 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1312 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1314 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_709 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1315 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1314, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1316 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1315 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_710 = tensor.expand_shape %1313 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_711 = tensor.expand_shape %1316 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_712 = tensor.extract_slice %expanded_705[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_713 = tensor.extract_slice %expanded_705[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1317 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_712, %expanded_710 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1318 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_713, %expanded_711 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1319 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1317, %1318 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1320 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_713, %expanded_710 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1321 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_712, %expanded_711 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1322 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1320, %1321 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1323 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1319, %1322 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_714 = tensor.collapse_shape %1323 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1324 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_715 = tensor.expand_shape %1324 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1325 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_715 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1326 = linalg.batch_matmul ins(%1325, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_716 = linalg.transpose ins(%1326 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1327 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_716 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1328 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1327, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1329 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1328 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1330 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_716 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1331 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1330, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1332 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1331 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_717 = tensor.expand_shape %1329 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_718 = tensor.expand_shape %1332 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_719 = tensor.extract_slice %expanded_706[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_720 = tensor.extract_slice %expanded_706[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1333 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_719, %expanded_717 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1334 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_720, %expanded_718 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1335 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1333, %1334 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1336 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_720, %expanded_717 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1337 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_719, %expanded_718 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1338 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1336, %1337 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1339 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1335, %1338 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1340 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_721 = tensor.expand_shape %1340 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1341 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_721 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1342 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1341 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c10_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1343 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1342 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1344 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1343, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1345 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1344 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1346 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1345, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1347 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1346 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1348 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1347, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_722 = tensor.collapse_shape %1348 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_723 = tensor.expand_shape %collapsed_722 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_724 = tensor.collapse_shape %1339 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1349 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_724, %expanded_723 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1235 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1350 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1343, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1351 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1350 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1352 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1351, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1353 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1352 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1354 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1353, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_725 = tensor.collapse_shape %1354 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_726 = tensor.expand_shape %collapsed_725 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_727 = tensor.collapse_shape %expanded_707 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1355 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_727, %expanded_726 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1349 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_728 = tensor.expand_shape %1355 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_729 = tensor.dim %expanded_728, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_730 = tensor.extract_slice %expanded_728[0, 10, 0, 0, 0, 0] [%dim_729, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1356 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_730, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_731 = tensor.extract_slice %expanded_728[0, 10, 1, 0, 0, 0] [%dim_729, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1357 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_731, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_732 = linalg.transpose ins(%1356 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_733 = tensor.collapse_shape %transposed_732 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_734 = linalg.transpose ins(%1357 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_735 = tensor.collapse_shape %transposed_734 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1358 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_733 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_736 = tensor.collapse_shape %1358 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1359 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_735 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_737 = tensor.collapse_shape %1359 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_738 = linalg.transpose ins(%collapsed_714 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_739 = linalg.transpose ins(%collapsed_736 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_740 = linalg.transpose ins(%collapsed_737 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_741 = tensor.collapse_shape %transposed_738 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_742 = tensor.collapse_shape %transposed_739 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_743 = tensor.collapse_shape %transposed_740 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1360 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_741, %collapsed_742, %collapsed_743, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_744 = tensor.expand_shape %1360 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_745 = linalg.transpose ins(%expanded_744 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_746 = tensor.collapse_shape %transposed_745 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1361 = iree_tensor_ext.bitcast %__auto.blk.10.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_747 = tensor.expand_shape %1361 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_748 = tensor.extract_slice %expanded_747[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1362 = iree_tensor_ext.bitcast %extracted_slice_748 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_749 = tensor.extract_slice %expanded_747[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1363 = iree_tensor_ext.bitcast %extracted_slice_749 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1364 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1362, %1363 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_750 = tensor.expand_shape %collapsed_746 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1365 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_750, %1364 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1366 = linalg.copy ins(%1365 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1367 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1279, %1366 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1368 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1367 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1369 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1368 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1370 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1369 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1371 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1370 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1372 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1371 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1373 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1372 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1374 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1368, %1373 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1375 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1374 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1376 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.10.ffn_norm.weight, %1375 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1377 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1376 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1378 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_751 = tensor.expand_shape %1378 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_752 = tensor.extract_slice %expanded_751[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1379 = iree_tensor_ext.bitcast %extracted_slice_752 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_753 = tensor.extract_slice %expanded_751[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1380 = iree_tensor_ext.bitcast %extracted_slice_753 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1381 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1379, %1380 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_754 = tensor.expand_shape %1377 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1382 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_754, %1381 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1383 = linalg.copy ins(%1382 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1384 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1383 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1385 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1384, %1383 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1386 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_755 = tensor.expand_shape %1386 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_756 = tensor.extract_slice %expanded_755[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1387 = iree_tensor_ext.bitcast %extracted_slice_756 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_757 = tensor.extract_slice %expanded_755[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1388 = iree_tensor_ext.bitcast %extracted_slice_757 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1389 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1387, %1388 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1390 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_754, %1389 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1391 = linalg.copy ins(%1390 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1392 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1385, %1391 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1393 = iree_tensor_ext.bitcast %__auto.blk.10.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_758 = tensor.expand_shape %1393 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_759 = tensor.extract_slice %expanded_758[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1394 = iree_tensor_ext.bitcast %extracted_slice_759 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_760 = tensor.extract_slice %expanded_758[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1395 = iree_tensor_ext.bitcast %extracted_slice_760 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1396 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1394, %1395 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_761 = tensor.expand_shape %1392 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1397 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_761, %1396 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1398 = linalg.copy ins(%1397 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1399 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1367, %1398 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1400 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1399 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1401 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1400 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1402 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1401 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1403 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1402 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1404 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1403 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1405 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1404 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1406 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1400, %1405 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1407 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1406 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1408 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.attn_norm.weight, %1407 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1409 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1408 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1410 = iree_tensor_ext.bitcast %__auto.blk.11.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_762 = tensor.expand_shape %1410 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_763 = tensor.extract_slice %expanded_762[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1411 = iree_tensor_ext.bitcast %extracted_slice_763 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_764 = tensor.extract_slice %expanded_762[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1412 = iree_tensor_ext.bitcast %extracted_slice_764 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1413 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1411, %1412 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_765 = tensor.expand_shape %1409 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1414 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_765, %1413 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1415 = linalg.copy ins(%1414 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1416 = iree_tensor_ext.bitcast %__auto.blk.11.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_766 = tensor.expand_shape %1416 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_767 = tensor.extract_slice %expanded_766[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1417 = iree_tensor_ext.bitcast %extracted_slice_767 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_768 = tensor.extract_slice %expanded_766[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1418 = iree_tensor_ext.bitcast %extracted_slice_768 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1419 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1417, %1418 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1420 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_765, %1419 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1421 = linalg.copy ins(%1420 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1422 = iree_tensor_ext.bitcast %__auto.blk.11.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_769 = tensor.expand_shape %1422 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_770 = tensor.extract_slice %expanded_769[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1423 = iree_tensor_ext.bitcast %extracted_slice_770 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_771 = tensor.extract_slice %expanded_769[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1424 = iree_tensor_ext.bitcast %extracted_slice_771 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1425 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1423, %1424 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1426 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_765, %1425 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1427 = linalg.copy ins(%1426 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_772 = tensor.expand_shape %1415 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_773 = tensor.expand_shape %1421 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_774 = tensor.expand_shape %1427 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1428 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_775 = tensor.expand_shape %1428 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1429 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_775 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1430 = linalg.batch_matmul ins(%1429, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_776 = linalg.transpose ins(%1430 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1431 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_776 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1432 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1431, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1433 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1432 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1434 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_776 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1435 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1434, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1436 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1435 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_777 = tensor.expand_shape %1433 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_778 = tensor.expand_shape %1436 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_779 = tensor.extract_slice %expanded_772[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_780 = tensor.extract_slice %expanded_772[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1437 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_779, %expanded_777 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1438 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_780, %expanded_778 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1439 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1437, %1438 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1440 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_780, %expanded_777 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1441 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_779, %expanded_778 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1442 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1440, %1441 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1443 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1439, %1442 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_781 = tensor.collapse_shape %1443 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1444 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_782 = tensor.expand_shape %1444 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1445 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_782 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1446 = linalg.batch_matmul ins(%1445, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_783 = linalg.transpose ins(%1446 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1447 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_783 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1448 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1447, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1449 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1448 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1450 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_783 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1451 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1450, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1452 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1451 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_784 = tensor.expand_shape %1449 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_785 = tensor.expand_shape %1452 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_786 = tensor.extract_slice %expanded_773[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_787 = tensor.extract_slice %expanded_773[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1453 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_786, %expanded_784 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1454 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_787, %expanded_785 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1455 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1453, %1454 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1456 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_787, %expanded_784 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1457 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_786, %expanded_785 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1458 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1456, %1457 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1459 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1455, %1458 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1460 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_788 = tensor.expand_shape %1460 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1461 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_788 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1462 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1461 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c11_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1463 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1462 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1464 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1463, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1465 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1464 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1466 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1465, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1467 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1466 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1468 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1467, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_789 = tensor.collapse_shape %1468 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_790 = tensor.expand_shape %collapsed_789 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_791 = tensor.collapse_shape %1459 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1469 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_791, %expanded_790 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1355 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1470 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1463, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1471 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1470 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1472 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1471, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1473 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1472 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1474 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1473, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_792 = tensor.collapse_shape %1474 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_793 = tensor.expand_shape %collapsed_792 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_794 = tensor.collapse_shape %expanded_774 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1475 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_794, %expanded_793 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1469 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_795 = tensor.expand_shape %1475 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_796 = tensor.dim %expanded_795, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_797 = tensor.extract_slice %expanded_795[0, 11, 0, 0, 0, 0] [%dim_796, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1476 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_797, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_798 = tensor.extract_slice %expanded_795[0, 11, 1, 0, 0, 0] [%dim_796, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1477 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_798, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_799 = linalg.transpose ins(%1476 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_800 = tensor.collapse_shape %transposed_799 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_801 = linalg.transpose ins(%1477 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_802 = tensor.collapse_shape %transposed_801 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1478 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_800 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_803 = tensor.collapse_shape %1478 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1479 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_802 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_804 = tensor.collapse_shape %1479 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_805 = linalg.transpose ins(%collapsed_781 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_806 = linalg.transpose ins(%collapsed_803 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_807 = linalg.transpose ins(%collapsed_804 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_808 = tensor.collapse_shape %transposed_805 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_809 = tensor.collapse_shape %transposed_806 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_810 = tensor.collapse_shape %transposed_807 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1480 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_808, %collapsed_809, %collapsed_810, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_811 = tensor.expand_shape %1480 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_812 = linalg.transpose ins(%expanded_811 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_813 = tensor.collapse_shape %transposed_812 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1481 = iree_tensor_ext.bitcast %__auto.blk.11.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_814 = tensor.expand_shape %1481 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_815 = tensor.extract_slice %expanded_814[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1482 = iree_tensor_ext.bitcast %extracted_slice_815 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_816 = tensor.extract_slice %expanded_814[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1483 = iree_tensor_ext.bitcast %extracted_slice_816 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1484 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1482, %1483 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_817 = tensor.expand_shape %collapsed_813 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1485 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_817, %1484 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1486 = linalg.copy ins(%1485 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1487 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1399, %1486 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1488 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1487 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1489 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1488 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1490 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1489 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1491 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1490 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1492 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1491 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1493 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1492 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1494 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1488, %1493 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1495 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1494 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1496 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.11.ffn_norm.weight, %1495 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1497 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1496 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1498 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_818 = tensor.expand_shape %1498 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_819 = tensor.extract_slice %expanded_818[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1499 = iree_tensor_ext.bitcast %extracted_slice_819 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_820 = tensor.extract_slice %expanded_818[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1500 = iree_tensor_ext.bitcast %extracted_slice_820 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1501 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1499, %1500 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_821 = tensor.expand_shape %1497 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1502 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_821, %1501 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1503 = linalg.copy ins(%1502 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1504 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1503 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1505 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1504, %1503 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1506 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_822 = tensor.expand_shape %1506 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_823 = tensor.extract_slice %expanded_822[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1507 = iree_tensor_ext.bitcast %extracted_slice_823 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_824 = tensor.extract_slice %expanded_822[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1508 = iree_tensor_ext.bitcast %extracted_slice_824 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1509 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1507, %1508 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1510 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_821, %1509 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1511 = linalg.copy ins(%1510 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1512 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1505, %1511 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1513 = iree_tensor_ext.bitcast %__auto.blk.11.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_825 = tensor.expand_shape %1513 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_826 = tensor.extract_slice %expanded_825[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1514 = iree_tensor_ext.bitcast %extracted_slice_826 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_827 = tensor.extract_slice %expanded_825[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1515 = iree_tensor_ext.bitcast %extracted_slice_827 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1516 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1514, %1515 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_828 = tensor.expand_shape %1512 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1517 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_828, %1516 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1518 = linalg.copy ins(%1517 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1519 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1487, %1518 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1520 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1519 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1521 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1520 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1522 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1521 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1523 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1522 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1524 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1523 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1525 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1524 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1526 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1520, %1525 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1527 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1526 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1528 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.attn_norm.weight, %1527 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1529 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1528 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1530 = iree_tensor_ext.bitcast %__auto.blk.12.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_829 = tensor.expand_shape %1530 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_830 = tensor.extract_slice %expanded_829[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1531 = iree_tensor_ext.bitcast %extracted_slice_830 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_831 = tensor.extract_slice %expanded_829[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1532 = iree_tensor_ext.bitcast %extracted_slice_831 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1533 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1531, %1532 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_832 = tensor.expand_shape %1529 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1534 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_832, %1533 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1535 = linalg.copy ins(%1534 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1536 = iree_tensor_ext.bitcast %__auto.blk.12.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_833 = tensor.expand_shape %1536 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_834 = tensor.extract_slice %expanded_833[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1537 = iree_tensor_ext.bitcast %extracted_slice_834 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_835 = tensor.extract_slice %expanded_833[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1538 = iree_tensor_ext.bitcast %extracted_slice_835 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1539 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1537, %1538 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1540 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_832, %1539 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1541 = linalg.copy ins(%1540 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1542 = iree_tensor_ext.bitcast %__auto.blk.12.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_836 = tensor.expand_shape %1542 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_837 = tensor.extract_slice %expanded_836[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1543 = iree_tensor_ext.bitcast %extracted_slice_837 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_838 = tensor.extract_slice %expanded_836[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1544 = iree_tensor_ext.bitcast %extracted_slice_838 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1545 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1543, %1544 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1546 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_832, %1545 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1547 = linalg.copy ins(%1546 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_839 = tensor.expand_shape %1535 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_840 = tensor.expand_shape %1541 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_841 = tensor.expand_shape %1547 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1548 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_842 = tensor.expand_shape %1548 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1549 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_842 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1550 = linalg.batch_matmul ins(%1549, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_843 = linalg.transpose ins(%1550 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1551 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_843 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1552 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1551, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1553 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1552 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1554 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_843 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1555 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1554, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1556 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1555 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_844 = tensor.expand_shape %1553 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_845 = tensor.expand_shape %1556 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_846 = tensor.extract_slice %expanded_839[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_847 = tensor.extract_slice %expanded_839[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1557 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_846, %expanded_844 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1558 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_847, %expanded_845 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1559 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1557, %1558 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1560 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_847, %expanded_844 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1561 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_846, %expanded_845 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1562 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1560, %1561 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1563 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1559, %1562 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_848 = tensor.collapse_shape %1563 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1564 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_849 = tensor.expand_shape %1564 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1565 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_849 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1566 = linalg.batch_matmul ins(%1565, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_850 = linalg.transpose ins(%1566 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1567 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_850 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1568 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1567, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1569 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1568 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1570 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_850 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1571 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1570, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1572 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1571 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_851 = tensor.expand_shape %1569 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_852 = tensor.expand_shape %1572 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_853 = tensor.extract_slice %expanded_840[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_854 = tensor.extract_slice %expanded_840[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1573 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_853, %expanded_851 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1574 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_854, %expanded_852 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1575 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1573, %1574 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1576 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_854, %expanded_851 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1577 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_853, %expanded_852 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1578 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1576, %1577 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1579 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1575, %1578 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1580 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_855 = tensor.expand_shape %1580 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1581 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_855 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1582 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1581 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c12_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1583 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1582 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1584 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1583, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1585 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1584 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1586 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1585, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1587 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1586 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1588 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1587, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_856 = tensor.collapse_shape %1588 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_857 = tensor.expand_shape %collapsed_856 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_858 = tensor.collapse_shape %1579 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1589 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_858, %expanded_857 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1475 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1590 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1583, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1591 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1590 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1592 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1591, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1593 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1592 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1594 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1593, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_859 = tensor.collapse_shape %1594 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_860 = tensor.expand_shape %collapsed_859 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_861 = tensor.collapse_shape %expanded_841 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1595 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_861, %expanded_860 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1589 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_862 = tensor.expand_shape %1595 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_863 = tensor.dim %expanded_862, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_864 = tensor.extract_slice %expanded_862[0, 12, 0, 0, 0, 0] [%dim_863, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1596 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_864, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_865 = tensor.extract_slice %expanded_862[0, 12, 1, 0, 0, 0] [%dim_863, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1597 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_865, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_866 = linalg.transpose ins(%1596 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_867 = tensor.collapse_shape %transposed_866 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_868 = linalg.transpose ins(%1597 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_869 = tensor.collapse_shape %transposed_868 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1598 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_867 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_870 = tensor.collapse_shape %1598 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1599 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_869 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_871 = tensor.collapse_shape %1599 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_872 = linalg.transpose ins(%collapsed_848 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_873 = linalg.transpose ins(%collapsed_870 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_874 = linalg.transpose ins(%collapsed_871 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_875 = tensor.collapse_shape %transposed_872 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_876 = tensor.collapse_shape %transposed_873 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_877 = tensor.collapse_shape %transposed_874 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1600 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_875, %collapsed_876, %collapsed_877, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_878 = tensor.expand_shape %1600 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_879 = linalg.transpose ins(%expanded_878 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_880 = tensor.collapse_shape %transposed_879 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1601 = iree_tensor_ext.bitcast %__auto.blk.12.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_881 = tensor.expand_shape %1601 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_882 = tensor.extract_slice %expanded_881[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1602 = iree_tensor_ext.bitcast %extracted_slice_882 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_883 = tensor.extract_slice %expanded_881[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1603 = iree_tensor_ext.bitcast %extracted_slice_883 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1604 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1602, %1603 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_884 = tensor.expand_shape %collapsed_880 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1605 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_884, %1604 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1606 = linalg.copy ins(%1605 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1607 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1519, %1606 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1608 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1607 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1609 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1608 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1610 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1609 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1611 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1610 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1612 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1611 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1613 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1612 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1614 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1608, %1613 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1615 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1614 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1616 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.12.ffn_norm.weight, %1615 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1617 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1616 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1618 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_885 = tensor.expand_shape %1618 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_886 = tensor.extract_slice %expanded_885[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1619 = iree_tensor_ext.bitcast %extracted_slice_886 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_887 = tensor.extract_slice %expanded_885[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1620 = iree_tensor_ext.bitcast %extracted_slice_887 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1621 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1619, %1620 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_888 = tensor.expand_shape %1617 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1622 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_888, %1621 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1623 = linalg.copy ins(%1622 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1624 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1623 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1625 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1624, %1623 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1626 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_889 = tensor.expand_shape %1626 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_890 = tensor.extract_slice %expanded_889[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1627 = iree_tensor_ext.bitcast %extracted_slice_890 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_891 = tensor.extract_slice %expanded_889[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1628 = iree_tensor_ext.bitcast %extracted_slice_891 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1629 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1627, %1628 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1630 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_888, %1629 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1631 = linalg.copy ins(%1630 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1632 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1625, %1631 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1633 = iree_tensor_ext.bitcast %__auto.blk.12.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_892 = tensor.expand_shape %1633 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_893 = tensor.extract_slice %expanded_892[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1634 = iree_tensor_ext.bitcast %extracted_slice_893 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_894 = tensor.extract_slice %expanded_892[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1635 = iree_tensor_ext.bitcast %extracted_slice_894 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1636 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1634, %1635 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_895 = tensor.expand_shape %1632 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1637 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_895, %1636 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1638 = linalg.copy ins(%1637 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1639 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1607, %1638 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1640 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1639 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1641 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1640 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1642 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1641 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1643 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1642 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1644 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1643 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1645 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1644 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1646 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1640, %1645 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1647 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1646 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1648 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.attn_norm.weight, %1647 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1649 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1648 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1650 = iree_tensor_ext.bitcast %__auto.blk.13.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_896 = tensor.expand_shape %1650 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_897 = tensor.extract_slice %expanded_896[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1651 = iree_tensor_ext.bitcast %extracted_slice_897 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_898 = tensor.extract_slice %expanded_896[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1652 = iree_tensor_ext.bitcast %extracted_slice_898 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1653 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1651, %1652 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_899 = tensor.expand_shape %1649 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1654 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_899, %1653 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1655 = linalg.copy ins(%1654 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1656 = iree_tensor_ext.bitcast %__auto.blk.13.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_900 = tensor.expand_shape %1656 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_901 = tensor.extract_slice %expanded_900[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1657 = iree_tensor_ext.bitcast %extracted_slice_901 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_902 = tensor.extract_slice %expanded_900[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1658 = iree_tensor_ext.bitcast %extracted_slice_902 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1659 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1657, %1658 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1660 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_899, %1659 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1661 = linalg.copy ins(%1660 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1662 = iree_tensor_ext.bitcast %__auto.blk.13.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_903 = tensor.expand_shape %1662 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_904 = tensor.extract_slice %expanded_903[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1663 = iree_tensor_ext.bitcast %extracted_slice_904 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_905 = tensor.extract_slice %expanded_903[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1664 = iree_tensor_ext.bitcast %extracted_slice_905 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1665 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1663, %1664 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1666 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_899, %1665 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1667 = linalg.copy ins(%1666 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_906 = tensor.expand_shape %1655 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_907 = tensor.expand_shape %1661 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_908 = tensor.expand_shape %1667 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1668 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_909 = tensor.expand_shape %1668 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1669 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_909 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1670 = linalg.batch_matmul ins(%1669, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_910 = linalg.transpose ins(%1670 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1671 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_910 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1672 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1671, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1673 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1672 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1674 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_910 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1675 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1674, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1676 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1675 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_911 = tensor.expand_shape %1673 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_912 = tensor.expand_shape %1676 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_913 = tensor.extract_slice %expanded_906[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_914 = tensor.extract_slice %expanded_906[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1677 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_913, %expanded_911 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1678 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_914, %expanded_912 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1679 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1677, %1678 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1680 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_914, %expanded_911 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1681 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_913, %expanded_912 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1682 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1680, %1681 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1683 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1679, %1682 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_915 = tensor.collapse_shape %1683 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1684 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_916 = tensor.expand_shape %1684 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1685 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_916 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1686 = linalg.batch_matmul ins(%1685, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_917 = linalg.transpose ins(%1686 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1687 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_917 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1688 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1687, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1689 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1688 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1690 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_917 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1691 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1690, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1692 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1691 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_918 = tensor.expand_shape %1689 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_919 = tensor.expand_shape %1692 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_920 = tensor.extract_slice %expanded_907[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_921 = tensor.extract_slice %expanded_907[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1693 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_920, %expanded_918 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1694 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_921, %expanded_919 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1695 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1693, %1694 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1696 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_921, %expanded_918 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1697 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_920, %expanded_919 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1698 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1696, %1697 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1699 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1695, %1698 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1700 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_922 = tensor.expand_shape %1700 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1701 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_922 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1702 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1701 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c13_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1703 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1702 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1704 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1703, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1705 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1704 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1706 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1705, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1707 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1706 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1708 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1707, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_923 = tensor.collapse_shape %1708 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_924 = tensor.expand_shape %collapsed_923 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_925 = tensor.collapse_shape %1699 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1709 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_925, %expanded_924 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1595 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1710 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1703, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1711 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1710 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1712 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1711, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1713 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1712 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1714 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1713, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_926 = tensor.collapse_shape %1714 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_927 = tensor.expand_shape %collapsed_926 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_928 = tensor.collapse_shape %expanded_908 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1715 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_928, %expanded_927 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1709 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_929 = tensor.expand_shape %1715 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_930 = tensor.dim %expanded_929, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_931 = tensor.extract_slice %expanded_929[0, 13, 0, 0, 0, 0] [%dim_930, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1716 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_931, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_932 = tensor.extract_slice %expanded_929[0, 13, 1, 0, 0, 0] [%dim_930, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1717 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_932, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_933 = linalg.transpose ins(%1716 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_934 = tensor.collapse_shape %transposed_933 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_935 = linalg.transpose ins(%1717 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_936 = tensor.collapse_shape %transposed_935 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1718 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_934 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_937 = tensor.collapse_shape %1718 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1719 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_936 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_938 = tensor.collapse_shape %1719 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_939 = linalg.transpose ins(%collapsed_915 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_940 = linalg.transpose ins(%collapsed_937 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_941 = linalg.transpose ins(%collapsed_938 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_942 = tensor.collapse_shape %transposed_939 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_943 = tensor.collapse_shape %transposed_940 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_944 = tensor.collapse_shape %transposed_941 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1720 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_942, %collapsed_943, %collapsed_944, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_945 = tensor.expand_shape %1720 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_946 = linalg.transpose ins(%expanded_945 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_947 = tensor.collapse_shape %transposed_946 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1721 = iree_tensor_ext.bitcast %__auto.blk.13.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_948 = tensor.expand_shape %1721 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_949 = tensor.extract_slice %expanded_948[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1722 = iree_tensor_ext.bitcast %extracted_slice_949 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_950 = tensor.extract_slice %expanded_948[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1723 = iree_tensor_ext.bitcast %extracted_slice_950 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1724 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1722, %1723 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_951 = tensor.expand_shape %collapsed_947 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1725 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_951, %1724 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1726 = linalg.copy ins(%1725 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1727 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1639, %1726 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1728 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1727 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1729 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1728 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1730 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1729 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1731 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1730 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1732 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1731 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1733 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1732 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1734 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1728, %1733 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1735 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1734 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1736 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.13.ffn_norm.weight, %1735 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1737 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1736 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1738 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_952 = tensor.expand_shape %1738 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_953 = tensor.extract_slice %expanded_952[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1739 = iree_tensor_ext.bitcast %extracted_slice_953 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_954 = tensor.extract_slice %expanded_952[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1740 = iree_tensor_ext.bitcast %extracted_slice_954 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1741 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1739, %1740 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_955 = tensor.expand_shape %1737 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1742 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_955, %1741 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1743 = linalg.copy ins(%1742 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1744 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1743 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1745 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1744, %1743 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1746 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_956 = tensor.expand_shape %1746 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_957 = tensor.extract_slice %expanded_956[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1747 = iree_tensor_ext.bitcast %extracted_slice_957 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_958 = tensor.extract_slice %expanded_956[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1748 = iree_tensor_ext.bitcast %extracted_slice_958 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1749 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1747, %1748 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1750 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_955, %1749 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1751 = linalg.copy ins(%1750 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1752 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1745, %1751 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1753 = iree_tensor_ext.bitcast %__auto.blk.13.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_959 = tensor.expand_shape %1753 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_960 = tensor.extract_slice %expanded_959[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1754 = iree_tensor_ext.bitcast %extracted_slice_960 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_961 = tensor.extract_slice %expanded_959[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1755 = iree_tensor_ext.bitcast %extracted_slice_961 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1756 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1754, %1755 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_962 = tensor.expand_shape %1752 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1757 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_962, %1756 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1758 = linalg.copy ins(%1757 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1759 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1727, %1758 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1760 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1759 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1761 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1760 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1762 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1761 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1763 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1762 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1764 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1763 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1765 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1764 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1766 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1760, %1765 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1767 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1766 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1768 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.attn_norm.weight, %1767 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1769 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1768 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1770 = iree_tensor_ext.bitcast %__auto.blk.14.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_963 = tensor.expand_shape %1770 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_964 = tensor.extract_slice %expanded_963[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1771 = iree_tensor_ext.bitcast %extracted_slice_964 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_965 = tensor.extract_slice %expanded_963[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1772 = iree_tensor_ext.bitcast %extracted_slice_965 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1773 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1771, %1772 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_966 = tensor.expand_shape %1769 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1774 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_966, %1773 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1775 = linalg.copy ins(%1774 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1776 = iree_tensor_ext.bitcast %__auto.blk.14.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_967 = tensor.expand_shape %1776 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_968 = tensor.extract_slice %expanded_967[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1777 = iree_tensor_ext.bitcast %extracted_slice_968 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_969 = tensor.extract_slice %expanded_967[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1778 = iree_tensor_ext.bitcast %extracted_slice_969 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1779 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1777, %1778 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1780 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_966, %1779 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1781 = linalg.copy ins(%1780 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1782 = iree_tensor_ext.bitcast %__auto.blk.14.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_970 = tensor.expand_shape %1782 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_971 = tensor.extract_slice %expanded_970[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1783 = iree_tensor_ext.bitcast %extracted_slice_971 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_972 = tensor.extract_slice %expanded_970[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1784 = iree_tensor_ext.bitcast %extracted_slice_972 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1785 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1783, %1784 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1786 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_966, %1785 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1787 = linalg.copy ins(%1786 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_973 = tensor.expand_shape %1775 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_974 = tensor.expand_shape %1781 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_975 = tensor.expand_shape %1787 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1788 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_976 = tensor.expand_shape %1788 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1789 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_976 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1790 = linalg.batch_matmul ins(%1789, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_977 = linalg.transpose ins(%1790 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1791 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_977 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1792 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1791, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1793 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1792 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1794 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_977 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1795 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1794, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1796 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1795 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_978 = tensor.expand_shape %1793 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_979 = tensor.expand_shape %1796 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_980 = tensor.extract_slice %expanded_973[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_981 = tensor.extract_slice %expanded_973[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1797 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_980, %expanded_978 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1798 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_981, %expanded_979 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1799 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1797, %1798 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1800 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_981, %expanded_978 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1801 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_980, %expanded_979 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1802 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1800, %1801 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1803 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1799, %1802 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_982 = tensor.collapse_shape %1803 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1804 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_983 = tensor.expand_shape %1804 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1805 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_983 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1806 = linalg.batch_matmul ins(%1805, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_984 = linalg.transpose ins(%1806 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1807 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_984 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1808 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1807, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1809 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1808 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1810 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_984 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1811 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1810, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1812 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1811 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_985 = tensor.expand_shape %1809 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_986 = tensor.expand_shape %1812 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_987 = tensor.extract_slice %expanded_974[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_988 = tensor.extract_slice %expanded_974[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1813 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_987, %expanded_985 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1814 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_988, %expanded_986 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1815 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1813, %1814 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1816 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_988, %expanded_985 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1817 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_987, %expanded_986 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1818 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1816, %1817 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1819 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1815, %1818 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1820 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_989 = tensor.expand_shape %1820 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1821 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_989 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1822 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1821 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c14_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1823 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1822 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1824 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1823, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1825 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1824 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1826 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1825, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1827 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1826 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1828 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1827, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_990 = tensor.collapse_shape %1828 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_991 = tensor.expand_shape %collapsed_990 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_992 = tensor.collapse_shape %1819 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1829 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_992, %expanded_991 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1715 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1830 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1823, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1831 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1830 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1832 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1831, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1833 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1832 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1834 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1833, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_993 = tensor.collapse_shape %1834 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_994 = tensor.expand_shape %collapsed_993 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_995 = tensor.collapse_shape %expanded_975 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1835 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_995, %expanded_994 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1829 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_996 = tensor.expand_shape %1835 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_997 = tensor.dim %expanded_996, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_998 = tensor.extract_slice %expanded_996[0, 14, 0, 0, 0, 0] [%dim_997, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1836 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_998, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_999 = tensor.extract_slice %expanded_996[0, 14, 1, 0, 0, 0] [%dim_997, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1837 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_999, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1000 = linalg.transpose ins(%1836 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1001 = tensor.collapse_shape %transposed_1000 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1002 = linalg.transpose ins(%1837 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1003 = tensor.collapse_shape %transposed_1002 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1838 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1001 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1004 = tensor.collapse_shape %1838 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1839 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1003 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1005 = tensor.collapse_shape %1839 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1006 = linalg.transpose ins(%collapsed_982 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1007 = linalg.transpose ins(%collapsed_1004 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1008 = linalg.transpose ins(%collapsed_1005 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1009 = tensor.collapse_shape %transposed_1006 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1010 = tensor.collapse_shape %transposed_1007 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1011 = tensor.collapse_shape %transposed_1008 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1840 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1009, %collapsed_1010, %collapsed_1011, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1012 = tensor.expand_shape %1840 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1013 = linalg.transpose ins(%expanded_1012 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1014 = tensor.collapse_shape %transposed_1013 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1841 = iree_tensor_ext.bitcast %__auto.blk.14.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1015 = tensor.expand_shape %1841 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1016 = tensor.extract_slice %expanded_1015[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1842 = iree_tensor_ext.bitcast %extracted_slice_1016 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1017 = tensor.extract_slice %expanded_1015[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1843 = iree_tensor_ext.bitcast %extracted_slice_1017 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1844 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1842, %1843 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1018 = tensor.expand_shape %collapsed_1014 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1845 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1018, %1844 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1846 = linalg.copy ins(%1845 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1847 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1759, %1846 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1848 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1847 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1849 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1848 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1850 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1849 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1851 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1850 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1852 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1851 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1853 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1852 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1854 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1848, %1853 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1855 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1854 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1856 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.14.ffn_norm.weight, %1855 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1857 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1856 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1858 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1019 = tensor.expand_shape %1858 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1020 = tensor.extract_slice %expanded_1019[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1859 = iree_tensor_ext.bitcast %extracted_slice_1020 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1021 = tensor.extract_slice %expanded_1019[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1860 = iree_tensor_ext.bitcast %extracted_slice_1021 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1861 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1859, %1860 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1022 = tensor.expand_shape %1857 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1862 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1022, %1861 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1863 = linalg.copy ins(%1862 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1864 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1863 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1865 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1864, %1863 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1866 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1023 = tensor.expand_shape %1866 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1024 = tensor.extract_slice %expanded_1023[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1867 = iree_tensor_ext.bitcast %extracted_slice_1024 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1025 = tensor.extract_slice %expanded_1023[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1868 = iree_tensor_ext.bitcast %extracted_slice_1025 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1869 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1867, %1868 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1870 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1022, %1869 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1871 = linalg.copy ins(%1870 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1872 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1865, %1871 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1873 = iree_tensor_ext.bitcast %__auto.blk.14.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1026 = tensor.expand_shape %1873 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1027 = tensor.extract_slice %expanded_1026[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1874 = iree_tensor_ext.bitcast %extracted_slice_1027 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1028 = tensor.extract_slice %expanded_1026[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1875 = iree_tensor_ext.bitcast %extracted_slice_1028 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1876 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1874, %1875 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1029 = tensor.expand_shape %1872 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1877 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1029, %1876 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1878 = linalg.copy ins(%1877 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1879 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1847, %1878 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1880 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1879 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1881 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1880 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1882 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1881 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1883 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1882 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1884 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1883 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1885 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1884 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1886 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1880, %1885 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1887 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1886 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1888 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.attn_norm.weight, %1887 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1889 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1888 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1890 = iree_tensor_ext.bitcast %__auto.blk.15.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1030 = tensor.expand_shape %1890 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1031 = tensor.extract_slice %expanded_1030[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1891 = iree_tensor_ext.bitcast %extracted_slice_1031 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1032 = tensor.extract_slice %expanded_1030[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1892 = iree_tensor_ext.bitcast %extracted_slice_1032 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1893 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1891, %1892 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1033 = tensor.expand_shape %1889 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1894 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1033, %1893 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1895 = linalg.copy ins(%1894 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1896 = iree_tensor_ext.bitcast %__auto.blk.15.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1034 = tensor.expand_shape %1896 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1035 = tensor.extract_slice %expanded_1034[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1897 = iree_tensor_ext.bitcast %extracted_slice_1035 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1036 = tensor.extract_slice %expanded_1034[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1898 = iree_tensor_ext.bitcast %extracted_slice_1036 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1899 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1897, %1898 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1900 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1033, %1899 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1901 = linalg.copy ins(%1900 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %1902 = iree_tensor_ext.bitcast %__auto.blk.15.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1037 = tensor.expand_shape %1902 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1038 = tensor.extract_slice %expanded_1037[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %1903 = iree_tensor_ext.bitcast %extracted_slice_1038 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1039 = tensor.extract_slice %expanded_1037[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1904 = iree_tensor_ext.bitcast %extracted_slice_1039 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %1905 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1903, %1904 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %1906 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1033, %1905 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %1907 = linalg.copy ins(%1906 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1040 = tensor.expand_shape %1895 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1041 = tensor.expand_shape %1901 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1042 = tensor.expand_shape %1907 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %1908 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1043 = tensor.expand_shape %1908 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1909 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1043 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1910 = linalg.batch_matmul ins(%1909, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1044 = linalg.transpose ins(%1910 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1911 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1044 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1912 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1911, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1913 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1912 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1914 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1044 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1915 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1914, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1916 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1915 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1045 = tensor.expand_shape %1913 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1046 = tensor.expand_shape %1916 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1047 = tensor.extract_slice %expanded_1040[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1048 = tensor.extract_slice %expanded_1040[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %1917 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1047, %expanded_1045 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1918 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1048, %expanded_1046 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1919 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1917, %1918 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1920 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1048, %expanded_1045 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1921 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1047, %expanded_1046 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1922 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1920, %1921 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %1923 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1919, %1922 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1049 = tensor.collapse_shape %1923 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %1924 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1050 = tensor.expand_shape %1924 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %1925 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1050 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %1926 = linalg.batch_matmul ins(%1925, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1051 = linalg.transpose ins(%1926 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %1927 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1051 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1928 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1927, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1929 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1928 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %1930 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1051 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1931 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1930, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %1932 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1931 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1052 = tensor.expand_shape %1929 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1053 = tensor.expand_shape %1932 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1054 = tensor.extract_slice %expanded_1041[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1055 = tensor.extract_slice %expanded_1041[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %1933 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1054, %expanded_1052 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1934 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1055, %expanded_1053 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1935 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1933, %1934 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1936 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1055, %expanded_1052 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1937 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1054, %expanded_1053 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1938 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1936, %1937 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %1939 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1935, %1938 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %1940 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1056 = tensor.expand_shape %1940 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %1941 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1056 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1942 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1941 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c15_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1943 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1942 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1944 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1943, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1945 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1944 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1946 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1945, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1947 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1946 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1948 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1947, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1057 = tensor.collapse_shape %1948 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1058 = tensor.expand_shape %collapsed_1057 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1059 = tensor.collapse_shape %1939 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %1949 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1059, %expanded_1058 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1835 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1950 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1943, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1951 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1950 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %1952 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1951, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1953 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1952 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %1954 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1953, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1060 = tensor.collapse_shape %1954 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1061 = tensor.expand_shape %collapsed_1060 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1062 = tensor.collapse_shape %expanded_1042 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %1955 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1062, %expanded_1061 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1949 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1063 = tensor.expand_shape %1955 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1064 = tensor.dim %expanded_1063, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1065 = tensor.extract_slice %expanded_1063[0, 15, 0, 0, 0, 0] [%dim_1064, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1956 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1065, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1066 = tensor.extract_slice %expanded_1063[0, 15, 1, 0, 0, 0] [%dim_1064, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1957 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1066, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1067 = linalg.transpose ins(%1956 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1068 = tensor.collapse_shape %transposed_1067 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1069 = linalg.transpose ins(%1957 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1070 = tensor.collapse_shape %transposed_1069 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %1958 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1068 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1071 = tensor.collapse_shape %1958 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %1959 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1070 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1072 = tensor.collapse_shape %1959 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1073 = linalg.transpose ins(%collapsed_1049 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1074 = linalg.transpose ins(%collapsed_1071 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1075 = linalg.transpose ins(%collapsed_1072 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1076 = tensor.collapse_shape %transposed_1073 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1077 = tensor.collapse_shape %transposed_1074 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1078 = tensor.collapse_shape %transposed_1075 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %1960 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1076, %collapsed_1077, %collapsed_1078, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1079 = tensor.expand_shape %1960 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1080 = linalg.transpose ins(%expanded_1079 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1081 = tensor.collapse_shape %transposed_1080 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1961 = iree_tensor_ext.bitcast %__auto.blk.15.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1082 = tensor.expand_shape %1961 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1083 = tensor.extract_slice %expanded_1082[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %1962 = iree_tensor_ext.bitcast %extracted_slice_1083 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1084 = tensor.extract_slice %expanded_1082[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1963 = iree_tensor_ext.bitcast %extracted_slice_1084 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %1964 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1962, %1963 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1085 = tensor.expand_shape %collapsed_1081 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1965 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1085, %1964 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1966 = linalg.copy ins(%1965 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1967 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1879, %1966 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1968 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1967 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1969 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1968 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1970 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1969 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1971 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1970 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1972 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1971 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1973 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1972 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %1974 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1968, %1973 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %1975 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1974 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1976 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.15.ffn_norm.weight, %1975 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %1977 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1976 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %1978 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1086 = tensor.expand_shape %1978 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1087 = tensor.extract_slice %expanded_1086[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1979 = iree_tensor_ext.bitcast %extracted_slice_1087 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1088 = tensor.extract_slice %expanded_1086[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1980 = iree_tensor_ext.bitcast %extracted_slice_1088 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1981 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1979, %1980 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1089 = tensor.expand_shape %1977 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %1982 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1089, %1981 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1983 = linalg.copy ins(%1982 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1984 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1983 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %1985 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1984, %1983 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1986 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1090 = tensor.expand_shape %1986 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1091 = tensor.extract_slice %expanded_1090[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %1987 = iree_tensor_ext.bitcast %extracted_slice_1091 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1092 = tensor.extract_slice %expanded_1090[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1988 = iree_tensor_ext.bitcast %extracted_slice_1092 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %1989 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1987, %1988 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %1990 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1089, %1989 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %1991 = linalg.copy ins(%1990 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %1992 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1985, %1991 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %1993 = iree_tensor_ext.bitcast %__auto.blk.15.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1093 = tensor.expand_shape %1993 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1094 = tensor.extract_slice %expanded_1093[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %1994 = iree_tensor_ext.bitcast %extracted_slice_1094 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1095 = tensor.extract_slice %expanded_1093[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1995 = iree_tensor_ext.bitcast %extracted_slice_1095 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %1996 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1994, %1995 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1096 = tensor.expand_shape %1992 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %1997 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1096, %1996 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %1998 = linalg.copy ins(%1997 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %1999 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1967, %1998 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2000 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1999 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2001 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2000 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2002 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2001 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2003 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2002 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2004 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2003 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2005 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2004 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2006 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2000, %2005 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2007 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2006 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2008 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.attn_norm.weight, %2007 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2009 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2008 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2010 = iree_tensor_ext.bitcast %__auto.blk.16.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1097 = tensor.expand_shape %2010 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1098 = tensor.extract_slice %expanded_1097[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2011 = iree_tensor_ext.bitcast %extracted_slice_1098 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1099 = tensor.extract_slice %expanded_1097[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2012 = iree_tensor_ext.bitcast %extracted_slice_1099 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2013 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2011, %2012 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1100 = tensor.expand_shape %2009 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2014 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1100, %2013 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2015 = linalg.copy ins(%2014 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2016 = iree_tensor_ext.bitcast %__auto.blk.16.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1101 = tensor.expand_shape %2016 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1102 = tensor.extract_slice %expanded_1101[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2017 = iree_tensor_ext.bitcast %extracted_slice_1102 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1103 = tensor.extract_slice %expanded_1101[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2018 = iree_tensor_ext.bitcast %extracted_slice_1103 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2019 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2017, %2018 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2020 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1100, %2019 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2021 = linalg.copy ins(%2020 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2022 = iree_tensor_ext.bitcast %__auto.blk.16.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1104 = tensor.expand_shape %2022 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1105 = tensor.extract_slice %expanded_1104[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2023 = iree_tensor_ext.bitcast %extracted_slice_1105 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1106 = tensor.extract_slice %expanded_1104[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2024 = iree_tensor_ext.bitcast %extracted_slice_1106 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2025 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2023, %2024 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2026 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1100, %2025 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2027 = linalg.copy ins(%2026 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1107 = tensor.expand_shape %2015 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1108 = tensor.expand_shape %2021 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1109 = tensor.expand_shape %2027 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2028 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1110 = tensor.expand_shape %2028 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2029 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1110 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2030 = linalg.batch_matmul ins(%2029, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1111 = linalg.transpose ins(%2030 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2031 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1111 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2032 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2031, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2033 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2032 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2034 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1111 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2035 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2034, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2036 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2035 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1112 = tensor.expand_shape %2033 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1113 = tensor.expand_shape %2036 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1114 = tensor.extract_slice %expanded_1107[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1115 = tensor.extract_slice %expanded_1107[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2037 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1114, %expanded_1112 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2038 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1115, %expanded_1113 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2039 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2037, %2038 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2040 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1115, %expanded_1112 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2041 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1114, %expanded_1113 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2042 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2040, %2041 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2043 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2039, %2042 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1116 = tensor.collapse_shape %2043 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2044 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1117 = tensor.expand_shape %2044 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2045 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1117 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2046 = linalg.batch_matmul ins(%2045, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1118 = linalg.transpose ins(%2046 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2047 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1118 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2048 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2047, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2049 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2048 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2050 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1118 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2051 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2050, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2052 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2051 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1119 = tensor.expand_shape %2049 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1120 = tensor.expand_shape %2052 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1121 = tensor.extract_slice %expanded_1108[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1122 = tensor.extract_slice %expanded_1108[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2053 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1121, %expanded_1119 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2054 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1122, %expanded_1120 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2055 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2053, %2054 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2056 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1122, %expanded_1119 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2057 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1121, %expanded_1120 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2058 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2056, %2057 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2059 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2055, %2058 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2060 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1123 = tensor.expand_shape %2060 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2061 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1123 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2062 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2061 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c16_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2063 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2062 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2064 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2063, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2065 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2064 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2066 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2065, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2067 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2066 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2068 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2067, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1124 = tensor.collapse_shape %2068 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1125 = tensor.expand_shape %collapsed_1124 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1126 = tensor.collapse_shape %2059 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2069 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1126, %expanded_1125 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%1955 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2070 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2063, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2071 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2070 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2072 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2071, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2073 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2072 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2074 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2073, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1127 = tensor.collapse_shape %2074 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1128 = tensor.expand_shape %collapsed_1127 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1129 = tensor.collapse_shape %expanded_1109 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2075 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1129, %expanded_1128 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2069 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1130 = tensor.expand_shape %2075 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1131 = tensor.dim %expanded_1130, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1132 = tensor.extract_slice %expanded_1130[0, 16, 0, 0, 0, 0] [%dim_1131, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2076 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1132, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1133 = tensor.extract_slice %expanded_1130[0, 16, 1, 0, 0, 0] [%dim_1131, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2077 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1133, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1134 = linalg.transpose ins(%2076 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1135 = tensor.collapse_shape %transposed_1134 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1136 = linalg.transpose ins(%2077 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1137 = tensor.collapse_shape %transposed_1136 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2078 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1135 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1138 = tensor.collapse_shape %2078 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2079 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1137 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1139 = tensor.collapse_shape %2079 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1140 = linalg.transpose ins(%collapsed_1116 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1141 = linalg.transpose ins(%collapsed_1138 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1142 = linalg.transpose ins(%collapsed_1139 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1143 = tensor.collapse_shape %transposed_1140 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1144 = tensor.collapse_shape %transposed_1141 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1145 = tensor.collapse_shape %transposed_1142 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2080 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1143, %collapsed_1144, %collapsed_1145, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1146 = tensor.expand_shape %2080 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1147 = linalg.transpose ins(%expanded_1146 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1148 = tensor.collapse_shape %transposed_1147 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2081 = iree_tensor_ext.bitcast %__auto.blk.16.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1149 = tensor.expand_shape %2081 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1150 = tensor.extract_slice %expanded_1149[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2082 = iree_tensor_ext.bitcast %extracted_slice_1150 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1151 = tensor.extract_slice %expanded_1149[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2083 = iree_tensor_ext.bitcast %extracted_slice_1151 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2084 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2082, %2083 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1152 = tensor.expand_shape %collapsed_1148 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2085 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1152, %2084 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2086 = linalg.copy ins(%2085 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2087 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1999, %2086 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2088 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2087 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2089 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2088 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2090 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2089 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2091 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2090 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2092 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2091 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2093 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2092 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2094 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2088, %2093 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2095 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2094 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2096 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.16.ffn_norm.weight, %2095 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2097 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2096 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2098 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1153 = tensor.expand_shape %2098 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1154 = tensor.extract_slice %expanded_1153[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2099 = iree_tensor_ext.bitcast %extracted_slice_1154 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1155 = tensor.extract_slice %expanded_1153[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2100 = iree_tensor_ext.bitcast %extracted_slice_1155 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2101 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2099, %2100 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1156 = tensor.expand_shape %2097 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2102 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1156, %2101 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2103 = linalg.copy ins(%2102 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2104 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2103 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %2105 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2104, %2103 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2106 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1157 = tensor.expand_shape %2106 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1158 = tensor.extract_slice %expanded_1157[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2107 = iree_tensor_ext.bitcast %extracted_slice_1158 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1159 = tensor.extract_slice %expanded_1157[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2108 = iree_tensor_ext.bitcast %extracted_slice_1159 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2109 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2107, %2108 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %2110 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1156, %2109 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2111 = linalg.copy ins(%2110 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2112 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2105, %2111 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2113 = iree_tensor_ext.bitcast %__auto.blk.16.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1160 = tensor.expand_shape %2113 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1161 = tensor.extract_slice %expanded_1160[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2114 = iree_tensor_ext.bitcast %extracted_slice_1161 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1162 = tensor.extract_slice %expanded_1160[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2115 = iree_tensor_ext.bitcast %extracted_slice_1162 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2116 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2114, %2115 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1163 = tensor.expand_shape %2112 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2117 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1163, %2116 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2118 = linalg.copy ins(%2117 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2119 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2087, %2118 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2120 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2119 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2121 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2120 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2122 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2121 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2123 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2122 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2124 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2123 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2125 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2124 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2126 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2120, %2125 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2127 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2126 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2128 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.attn_norm.weight, %2127 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2129 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2128 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2130 = iree_tensor_ext.bitcast %__auto.blk.17.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1164 = tensor.expand_shape %2130 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1165 = tensor.extract_slice %expanded_1164[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2131 = iree_tensor_ext.bitcast %extracted_slice_1165 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1166 = tensor.extract_slice %expanded_1164[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2132 = iree_tensor_ext.bitcast %extracted_slice_1166 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2133 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2131, %2132 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1167 = tensor.expand_shape %2129 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2134 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1167, %2133 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2135 = linalg.copy ins(%2134 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2136 = iree_tensor_ext.bitcast %__auto.blk.17.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1168 = tensor.expand_shape %2136 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1169 = tensor.extract_slice %expanded_1168[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2137 = iree_tensor_ext.bitcast %extracted_slice_1169 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1170 = tensor.extract_slice %expanded_1168[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2138 = iree_tensor_ext.bitcast %extracted_slice_1170 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2139 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2137, %2138 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2140 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1167, %2139 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2141 = linalg.copy ins(%2140 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2142 = iree_tensor_ext.bitcast %__auto.blk.17.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1171 = tensor.expand_shape %2142 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1172 = tensor.extract_slice %expanded_1171[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2143 = iree_tensor_ext.bitcast %extracted_slice_1172 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1173 = tensor.extract_slice %expanded_1171[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2144 = iree_tensor_ext.bitcast %extracted_slice_1173 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2145 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2143, %2144 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2146 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1167, %2145 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2147 = linalg.copy ins(%2146 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1174 = tensor.expand_shape %2135 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1175 = tensor.expand_shape %2141 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1176 = tensor.expand_shape %2147 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2148 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1177 = tensor.expand_shape %2148 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2149 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1177 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2150 = linalg.batch_matmul ins(%2149, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1178 = linalg.transpose ins(%2150 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2151 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1178 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2152 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2151, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2153 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2152 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2154 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1178 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2155 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2154, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2156 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2155 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1179 = tensor.expand_shape %2153 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1180 = tensor.expand_shape %2156 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1181 = tensor.extract_slice %expanded_1174[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1182 = tensor.extract_slice %expanded_1174[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2157 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1181, %expanded_1179 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2158 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1182, %expanded_1180 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2159 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2157, %2158 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2160 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1182, %expanded_1179 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2161 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1181, %expanded_1180 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2162 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2160, %2161 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2163 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2159, %2162 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1183 = tensor.collapse_shape %2163 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2164 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1184 = tensor.expand_shape %2164 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2165 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1184 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2166 = linalg.batch_matmul ins(%2165, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1185 = linalg.transpose ins(%2166 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2167 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1185 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2168 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2167, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2169 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2168 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2170 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1185 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2171 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2170, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2172 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2171 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1186 = tensor.expand_shape %2169 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1187 = tensor.expand_shape %2172 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1188 = tensor.extract_slice %expanded_1175[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1189 = tensor.extract_slice %expanded_1175[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2173 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1188, %expanded_1186 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2174 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1189, %expanded_1187 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2175 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2176 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1189, %expanded_1186 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2177 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1188, %expanded_1187 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2178 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2176, %2177 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2179 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2175, %2178 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2180 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1190 = tensor.expand_shape %2180 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2181 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1190 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2182 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2181 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c17_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2183 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2182 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2184 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2183, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2185 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2184 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2186 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2185, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2187 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2186 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2188 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2187, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1191 = tensor.collapse_shape %2188 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1192 = tensor.expand_shape %collapsed_1191 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1193 = tensor.collapse_shape %2179 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2189 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1193, %expanded_1192 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2075 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2190 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2183, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2191 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2190 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2192 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2191, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2193 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2192 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2194 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2193, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1194 = tensor.collapse_shape %2194 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1195 = tensor.expand_shape %collapsed_1194 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1196 = tensor.collapse_shape %expanded_1176 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2195 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1196, %expanded_1195 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2189 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1197 = tensor.expand_shape %2195 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1198 = tensor.dim %expanded_1197, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1199 = tensor.extract_slice %expanded_1197[0, 17, 0, 0, 0, 0] [%dim_1198, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2196 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1199, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1200 = tensor.extract_slice %expanded_1197[0, 17, 1, 0, 0, 0] [%dim_1198, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2197 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1200, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1201 = linalg.transpose ins(%2196 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1202 = tensor.collapse_shape %transposed_1201 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1203 = linalg.transpose ins(%2197 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1204 = tensor.collapse_shape %transposed_1203 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2198 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1202 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1205 = tensor.collapse_shape %2198 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2199 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1204 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1206 = tensor.collapse_shape %2199 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1207 = linalg.transpose ins(%collapsed_1183 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1208 = linalg.transpose ins(%collapsed_1205 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1209 = linalg.transpose ins(%collapsed_1206 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1210 = tensor.collapse_shape %transposed_1207 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1211 = tensor.collapse_shape %transposed_1208 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1212 = tensor.collapse_shape %transposed_1209 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2200 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1210, %collapsed_1211, %collapsed_1212, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1213 = tensor.expand_shape %2200 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1214 = linalg.transpose ins(%expanded_1213 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1215 = tensor.collapse_shape %transposed_1214 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2201 = iree_tensor_ext.bitcast %__auto.blk.17.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1216 = tensor.expand_shape %2201 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1217 = tensor.extract_slice %expanded_1216[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2202 = iree_tensor_ext.bitcast %extracted_slice_1217 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1218 = tensor.extract_slice %expanded_1216[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2203 = iree_tensor_ext.bitcast %extracted_slice_1218 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2204 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2202, %2203 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1219 = tensor.expand_shape %collapsed_1215 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2205 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1219, %2204 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2206 = linalg.copy ins(%2205 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2207 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2119, %2206 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2208 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2207 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2209 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2208 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2210 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2209 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2211 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2210 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2212 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2211 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2213 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2212 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2214 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2208, %2213 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2215 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2214 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2216 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.17.ffn_norm.weight, %2215 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2217 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2216 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2218 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1220 = tensor.expand_shape %2218 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1221 = tensor.extract_slice %expanded_1220[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2219 = iree_tensor_ext.bitcast %extracted_slice_1221 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1222 = tensor.extract_slice %expanded_1220[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2220 = iree_tensor_ext.bitcast %extracted_slice_1222 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2221 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2219, %2220 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1223 = tensor.expand_shape %2217 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2222 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1223, %2221 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2223 = linalg.copy ins(%2222 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2224 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2223 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %2225 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2224, %2223 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2226 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1224 = tensor.expand_shape %2226 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1225 = tensor.extract_slice %expanded_1224[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2227 = iree_tensor_ext.bitcast %extracted_slice_1225 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1226 = tensor.extract_slice %expanded_1224[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2228 = iree_tensor_ext.bitcast %extracted_slice_1226 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2229 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2227, %2228 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %2230 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1223, %2229 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2231 = linalg.copy ins(%2230 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2232 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2225, %2231 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2233 = iree_tensor_ext.bitcast %__auto.blk.17.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1227 = tensor.expand_shape %2233 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1228 = tensor.extract_slice %expanded_1227[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2234 = iree_tensor_ext.bitcast %extracted_slice_1228 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1229 = tensor.extract_slice %expanded_1227[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2235 = iree_tensor_ext.bitcast %extracted_slice_1229 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2236 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2234, %2235 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1230 = tensor.expand_shape %2232 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2237 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1230, %2236 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2238 = linalg.copy ins(%2237 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2239 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2207, %2238 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2240 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2239 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2241 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2240 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2242 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2241 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2243 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2242 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2244 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2243 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2245 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2244 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2246 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2240, %2245 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2247 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2246 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2248 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.attn_norm.weight, %2247 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2249 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2248 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2250 = iree_tensor_ext.bitcast %__auto.blk.18.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1231 = tensor.expand_shape %2250 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1232 = tensor.extract_slice %expanded_1231[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2251 = iree_tensor_ext.bitcast %extracted_slice_1232 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1233 = tensor.extract_slice %expanded_1231[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2252 = iree_tensor_ext.bitcast %extracted_slice_1233 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2253 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2251, %2252 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1234 = tensor.expand_shape %2249 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2254 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1234, %2253 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2255 = linalg.copy ins(%2254 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2256 = iree_tensor_ext.bitcast %__auto.blk.18.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1235 = tensor.expand_shape %2256 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1236 = tensor.extract_slice %expanded_1235[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2257 = iree_tensor_ext.bitcast %extracted_slice_1236 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1237 = tensor.extract_slice %expanded_1235[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2258 = iree_tensor_ext.bitcast %extracted_slice_1237 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2259 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2257, %2258 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2260 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1234, %2259 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2261 = linalg.copy ins(%2260 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2262 = iree_tensor_ext.bitcast %__auto.blk.18.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1238 = tensor.expand_shape %2262 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1239 = tensor.extract_slice %expanded_1238[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2263 = iree_tensor_ext.bitcast %extracted_slice_1239 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1240 = tensor.extract_slice %expanded_1238[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2264 = iree_tensor_ext.bitcast %extracted_slice_1240 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2265 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2263, %2264 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2266 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1234, %2265 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2267 = linalg.copy ins(%2266 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1241 = tensor.expand_shape %2255 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1242 = tensor.expand_shape %2261 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1243 = tensor.expand_shape %2267 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2268 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1244 = tensor.expand_shape %2268 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2269 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1244 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2270 = linalg.batch_matmul ins(%2269, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1245 = linalg.transpose ins(%2270 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2271 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1245 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2272 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2271, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2273 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2272 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2274 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1245 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2275 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2274, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2276 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2275 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1246 = tensor.expand_shape %2273 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1247 = tensor.expand_shape %2276 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1248 = tensor.extract_slice %expanded_1241[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1249 = tensor.extract_slice %expanded_1241[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2277 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1248, %expanded_1246 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2278 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1249, %expanded_1247 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2279 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2277, %2278 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2280 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1249, %expanded_1246 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2281 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1248, %expanded_1247 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2282 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2280, %2281 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2283 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2279, %2282 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1250 = tensor.collapse_shape %2283 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2284 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1251 = tensor.expand_shape %2284 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2285 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1251 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2286 = linalg.batch_matmul ins(%2285, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1252 = linalg.transpose ins(%2286 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2287 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1252 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2288 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2287, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2289 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2288 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2290 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1252 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2291 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2290, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2291 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1253 = tensor.expand_shape %2289 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1254 = tensor.expand_shape %2292 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1255 = tensor.extract_slice %expanded_1242[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1256 = tensor.extract_slice %expanded_1242[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2293 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1255, %expanded_1253 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2294 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1256, %expanded_1254 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2295 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2293, %2294 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2296 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1256, %expanded_1253 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2297 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1255, %expanded_1254 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2298 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2296, %2297 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2299 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2295, %2298 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2300 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1257 = tensor.expand_shape %2300 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2301 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1257 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2302 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2301 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c18_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2303 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2302 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2304 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2303, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2305 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2304 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2306 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2305, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2307 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2306 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2308 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2307, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1258 = tensor.collapse_shape %2308 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1259 = tensor.expand_shape %collapsed_1258 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1260 = tensor.collapse_shape %2299 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2309 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1260, %expanded_1259 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2195 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2310 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2303, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2311 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2310 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2312 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2311, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2313 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2312 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2314 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2313, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1261 = tensor.collapse_shape %2314 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1262 = tensor.expand_shape %collapsed_1261 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1263 = tensor.collapse_shape %expanded_1243 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2315 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1263, %expanded_1262 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2309 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1264 = tensor.expand_shape %2315 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1265 = tensor.dim %expanded_1264, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1266 = tensor.extract_slice %expanded_1264[0, 18, 0, 0, 0, 0] [%dim_1265, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2316 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1266, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1267 = tensor.extract_slice %expanded_1264[0, 18, 1, 0, 0, 0] [%dim_1265, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2317 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1267, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1268 = linalg.transpose ins(%2316 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1269 = tensor.collapse_shape %transposed_1268 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1270 = linalg.transpose ins(%2317 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1271 = tensor.collapse_shape %transposed_1270 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2318 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1269 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1272 = tensor.collapse_shape %2318 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2319 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1271 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1273 = tensor.collapse_shape %2319 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1274 = linalg.transpose ins(%collapsed_1250 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1275 = linalg.transpose ins(%collapsed_1272 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1276 = linalg.transpose ins(%collapsed_1273 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1277 = tensor.collapse_shape %transposed_1274 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1278 = tensor.collapse_shape %transposed_1275 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1279 = tensor.collapse_shape %transposed_1276 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2320 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1277, %collapsed_1278, %collapsed_1279, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1280 = tensor.expand_shape %2320 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1281 = linalg.transpose ins(%expanded_1280 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1282 = tensor.collapse_shape %transposed_1281 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2321 = iree_tensor_ext.bitcast %__auto.blk.18.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1283 = tensor.expand_shape %2321 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1284 = tensor.extract_slice %expanded_1283[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2322 = iree_tensor_ext.bitcast %extracted_slice_1284 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1285 = tensor.extract_slice %expanded_1283[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2323 = iree_tensor_ext.bitcast %extracted_slice_1285 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2324 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2322, %2323 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1286 = tensor.expand_shape %collapsed_1282 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2325 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1286, %2324 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2326 = linalg.copy ins(%2325 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2327 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2239, %2326 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2328 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2327 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2329 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2328 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2330 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2329 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2331 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2330 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2332 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2331 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2333 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2332 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2334 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2328, %2333 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2335 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2334 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2336 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.18.ffn_norm.weight, %2335 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2337 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2336 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2338 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1287 = tensor.expand_shape %2338 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1288 = tensor.extract_slice %expanded_1287[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2339 = iree_tensor_ext.bitcast %extracted_slice_1288 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1289 = tensor.extract_slice %expanded_1287[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2340 = iree_tensor_ext.bitcast %extracted_slice_1289 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2341 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2339, %2340 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1290 = tensor.expand_shape %2337 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2342 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1290, %2341 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2343 = linalg.copy ins(%2342 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2344 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2343 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %2345 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2344, %2343 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2346 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1291 = tensor.expand_shape %2346 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1292 = tensor.extract_slice %expanded_1291[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2347 = iree_tensor_ext.bitcast %extracted_slice_1292 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1293 = tensor.extract_slice %expanded_1291[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2348 = iree_tensor_ext.bitcast %extracted_slice_1293 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2349 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2347, %2348 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %2350 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1290, %2349 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2351 = linalg.copy ins(%2350 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2352 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2345, %2351 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2353 = iree_tensor_ext.bitcast %__auto.blk.18.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1294 = tensor.expand_shape %2353 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1295 = tensor.extract_slice %expanded_1294[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2354 = iree_tensor_ext.bitcast %extracted_slice_1295 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1296 = tensor.extract_slice %expanded_1294[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2355 = iree_tensor_ext.bitcast %extracted_slice_1296 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2356 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2354, %2355 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1297 = tensor.expand_shape %2352 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2357 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1297, %2356 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2358 = linalg.copy ins(%2357 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2359 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2327, %2358 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2360 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2359 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2361 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2360 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2362 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2361 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2363 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2362 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2364 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2363 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2365 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2364 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2366 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2360, %2365 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2367 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2366 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2368 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.attn_norm.weight, %2367 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2369 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2368 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2370 = iree_tensor_ext.bitcast %__auto.blk.19.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1298 = tensor.expand_shape %2370 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1299 = tensor.extract_slice %expanded_1298[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2371 = iree_tensor_ext.bitcast %extracted_slice_1299 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1300 = tensor.extract_slice %expanded_1298[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2372 = iree_tensor_ext.bitcast %extracted_slice_1300 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2373 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2371, %2372 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1301 = tensor.expand_shape %2369 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2374 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1301, %2373 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2375 = linalg.copy ins(%2374 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2376 = iree_tensor_ext.bitcast %__auto.blk.19.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1302 = tensor.expand_shape %2376 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1303 = tensor.extract_slice %expanded_1302[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2377 = iree_tensor_ext.bitcast %extracted_slice_1303 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1304 = tensor.extract_slice %expanded_1302[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2378 = iree_tensor_ext.bitcast %extracted_slice_1304 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2379 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2377, %2378 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2380 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1301, %2379 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2381 = linalg.copy ins(%2380 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2382 = iree_tensor_ext.bitcast %__auto.blk.19.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1305 = tensor.expand_shape %2382 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1306 = tensor.extract_slice %expanded_1305[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2383 = iree_tensor_ext.bitcast %extracted_slice_1306 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1307 = tensor.extract_slice %expanded_1305[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2384 = iree_tensor_ext.bitcast %extracted_slice_1307 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2385 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2383, %2384 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2386 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1301, %2385 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2387 = linalg.copy ins(%2386 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1308 = tensor.expand_shape %2375 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1309 = tensor.expand_shape %2381 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1310 = tensor.expand_shape %2387 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2388 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1311 = tensor.expand_shape %2388 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2389 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1311 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2390 = linalg.batch_matmul ins(%2389, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1312 = linalg.transpose ins(%2390 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2391 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1312 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2392 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2391, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2393 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2392 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2394 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1312 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2395 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2394, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2396 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2395 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1313 = tensor.expand_shape %2393 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1314 = tensor.expand_shape %2396 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1315 = tensor.extract_slice %expanded_1308[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1316 = tensor.extract_slice %expanded_1308[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2397 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1315, %expanded_1313 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2398 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1316, %expanded_1314 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2399 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2397, %2398 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2400 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1316, %expanded_1313 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2401 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1315, %expanded_1314 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2402 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2400, %2401 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2403 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2399, %2402 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1317 = tensor.collapse_shape %2403 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2404 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1318 = tensor.expand_shape %2404 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2405 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1318 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2406 = linalg.batch_matmul ins(%2405, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1319 = linalg.transpose ins(%2406 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2407 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1319 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2408 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2407, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2409 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2408 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2410 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1319 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2411 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2410, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2412 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2411 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1320 = tensor.expand_shape %2409 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1321 = tensor.expand_shape %2412 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1322 = tensor.extract_slice %expanded_1309[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1323 = tensor.extract_slice %expanded_1309[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2413 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1322, %expanded_1320 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2414 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1323, %expanded_1321 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2415 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2413, %2414 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2416 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1323, %expanded_1320 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2417 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1322, %expanded_1321 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2418 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2416, %2417 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2419 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2415, %2418 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2420 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1324 = tensor.expand_shape %2420 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2421 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1324 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2422 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2421 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c19_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2423 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2422 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2424 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2423, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2425 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2424 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2426 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2425, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2427 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2426 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2428 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2427, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1325 = tensor.collapse_shape %2428 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1326 = tensor.expand_shape %collapsed_1325 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1327 = tensor.collapse_shape %2419 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2429 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1327, %expanded_1326 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2315 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2430 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2423, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2431 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2430 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2432 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2431, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2433 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2432 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2434 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2433, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1328 = tensor.collapse_shape %2434 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1329 = tensor.expand_shape %collapsed_1328 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1330 = tensor.collapse_shape %expanded_1310 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2435 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1330, %expanded_1329 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2429 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1331 = tensor.expand_shape %2435 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1332 = tensor.dim %expanded_1331, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1333 = tensor.extract_slice %expanded_1331[0, 19, 0, 0, 0, 0] [%dim_1332, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2436 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1333, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1334 = tensor.extract_slice %expanded_1331[0, 19, 1, 0, 0, 0] [%dim_1332, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2437 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1334, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1335 = linalg.transpose ins(%2436 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1336 = tensor.collapse_shape %transposed_1335 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1337 = linalg.transpose ins(%2437 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1338 = tensor.collapse_shape %transposed_1337 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2438 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1336 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1339 = tensor.collapse_shape %2438 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2439 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1338 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1340 = tensor.collapse_shape %2439 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1341 = linalg.transpose ins(%collapsed_1317 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1342 = linalg.transpose ins(%collapsed_1339 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1343 = linalg.transpose ins(%collapsed_1340 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1344 = tensor.collapse_shape %transposed_1341 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1345 = tensor.collapse_shape %transposed_1342 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1346 = tensor.collapse_shape %transposed_1343 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2440 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1344, %collapsed_1345, %collapsed_1346, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1347 = tensor.expand_shape %2440 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1348 = linalg.transpose ins(%expanded_1347 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1349 = tensor.collapse_shape %transposed_1348 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2441 = iree_tensor_ext.bitcast %__auto.blk.19.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1350 = tensor.expand_shape %2441 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1351 = tensor.extract_slice %expanded_1350[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2442 = iree_tensor_ext.bitcast %extracted_slice_1351 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1352 = tensor.extract_slice %expanded_1350[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2443 = iree_tensor_ext.bitcast %extracted_slice_1352 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2444 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2442, %2443 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1353 = tensor.expand_shape %collapsed_1349 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2445 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1353, %2444 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2446 = linalg.copy ins(%2445 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2447 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2359, %2446 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2448 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2447 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2449 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2448 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2450 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2449 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2451 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2450 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2452 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2451 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2453 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2452 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2454 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2448, %2453 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2455 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2454 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2456 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.19.ffn_norm.weight, %2455 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2457 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2456 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2458 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1354 = tensor.expand_shape %2458 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1355 = tensor.extract_slice %expanded_1354[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2459 = iree_tensor_ext.bitcast %extracted_slice_1355 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1356 = tensor.extract_slice %expanded_1354[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2460 = iree_tensor_ext.bitcast %extracted_slice_1356 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2461 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2459, %2460 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1357 = tensor.expand_shape %2457 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2462 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1357, %2461 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2463 = linalg.copy ins(%2462 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2464 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2463 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %2465 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2464, %2463 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2466 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1358 = tensor.expand_shape %2466 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1359 = tensor.extract_slice %expanded_1358[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2467 = iree_tensor_ext.bitcast %extracted_slice_1359 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1360 = tensor.extract_slice %expanded_1358[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2468 = iree_tensor_ext.bitcast %extracted_slice_1360 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2469 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2467, %2468 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %2470 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1357, %2469 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2471 = linalg.copy ins(%2470 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2472 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2465, %2471 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2473 = iree_tensor_ext.bitcast %__auto.blk.19.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1361 = tensor.expand_shape %2473 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1362 = tensor.extract_slice %expanded_1361[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2474 = iree_tensor_ext.bitcast %extracted_slice_1362 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1363 = tensor.extract_slice %expanded_1361[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2475 = iree_tensor_ext.bitcast %extracted_slice_1363 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2476 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2474, %2475 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1364 = tensor.expand_shape %2472 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2477 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1364, %2476 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2478 = linalg.copy ins(%2477 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2479 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2447, %2478 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2480 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2479 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2481 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2480 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2482 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2481 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2483 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2482 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2484 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2483 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2485 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2484 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2486 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2480, %2485 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2487 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2486 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2488 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.attn_norm.weight, %2487 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2489 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2488 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2490 = iree_tensor_ext.bitcast %__auto.blk.20.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1365 = tensor.expand_shape %2490 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1366 = tensor.extract_slice %expanded_1365[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2491 = iree_tensor_ext.bitcast %extracted_slice_1366 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1367 = tensor.extract_slice %expanded_1365[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2492 = iree_tensor_ext.bitcast %extracted_slice_1367 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2493 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2491, %2492 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1368 = tensor.expand_shape %2489 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2494 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1368, %2493 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2495 = linalg.copy ins(%2494 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2496 = iree_tensor_ext.bitcast %__auto.blk.20.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1369 = tensor.expand_shape %2496 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1370 = tensor.extract_slice %expanded_1369[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2497 = iree_tensor_ext.bitcast %extracted_slice_1370 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1371 = tensor.extract_slice %expanded_1369[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2498 = iree_tensor_ext.bitcast %extracted_slice_1371 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2499 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2497, %2498 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2500 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1368, %2499 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2501 = linalg.copy ins(%2500 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2502 = iree_tensor_ext.bitcast %__auto.blk.20.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1372 = tensor.expand_shape %2502 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1373 = tensor.extract_slice %expanded_1372[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2503 = iree_tensor_ext.bitcast %extracted_slice_1373 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1374 = tensor.extract_slice %expanded_1372[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2504 = iree_tensor_ext.bitcast %extracted_slice_1374 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2505 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2503, %2504 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2506 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1368, %2505 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2507 = linalg.copy ins(%2506 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1375 = tensor.expand_shape %2495 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1376 = tensor.expand_shape %2501 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1377 = tensor.expand_shape %2507 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2508 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1378 = tensor.expand_shape %2508 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2509 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1378 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2510 = linalg.batch_matmul ins(%2509, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1379 = linalg.transpose ins(%2510 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2511 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1379 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2512 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2511, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2513 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2512 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2514 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1379 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2515 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2514, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2516 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2515 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1380 = tensor.expand_shape %2513 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1381 = tensor.expand_shape %2516 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1382 = tensor.extract_slice %expanded_1375[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1383 = tensor.extract_slice %expanded_1375[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2517 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1382, %expanded_1380 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2518 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1383, %expanded_1381 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2519 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2517, %2518 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2520 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1383, %expanded_1380 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2521 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1382, %expanded_1381 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2522 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2520, %2521 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2523 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2519, %2522 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1384 = tensor.collapse_shape %2523 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2524 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1385 = tensor.expand_shape %2524 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2525 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1385 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2526 = linalg.batch_matmul ins(%2525, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1386 = linalg.transpose ins(%2526 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2527 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1386 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2528 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2527, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2529 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2528 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2530 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1386 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2531 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2530, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2532 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2531 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1387 = tensor.expand_shape %2529 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1388 = tensor.expand_shape %2532 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1389 = tensor.extract_slice %expanded_1376[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1390 = tensor.extract_slice %expanded_1376[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2533 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1389, %expanded_1387 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2534 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1390, %expanded_1388 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2535 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2533, %2534 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2536 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1390, %expanded_1387 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2537 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1389, %expanded_1388 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2538 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2536, %2537 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2539 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2535, %2538 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2540 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1391 = tensor.expand_shape %2540 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2541 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1391 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2542 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2541 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c20_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2543 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2542 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2544 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2543, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2545 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2544 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2546 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2545, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2547 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2546 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2548 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2547, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1392 = tensor.collapse_shape %2548 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1393 = tensor.expand_shape %collapsed_1392 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1394 = tensor.collapse_shape %2539 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2549 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1394, %expanded_1393 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2435 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2550 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2543, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2551 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2550 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2552 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2551, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2553 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2552 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2554 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2553, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1395 = tensor.collapse_shape %2554 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1396 = tensor.expand_shape %collapsed_1395 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1397 = tensor.collapse_shape %expanded_1377 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2555 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1397, %expanded_1396 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2549 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1398 = tensor.expand_shape %2555 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %dim_1399 = tensor.dim %expanded_1398, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1400 = tensor.extract_slice %expanded_1398[0, 20, 0, 0, 0, 0] [%dim_1399, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2556 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1400, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1401 = tensor.extract_slice %expanded_1398[0, 20, 1, 0, 0, 0] [%dim_1399, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2557 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1401, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1402 = linalg.transpose ins(%2556 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1403 = tensor.collapse_shape %transposed_1402 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1404 = linalg.transpose ins(%2557 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1405 = tensor.collapse_shape %transposed_1404 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2558 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1403 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1406 = tensor.collapse_shape %2558 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2559 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1405 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1407 = tensor.collapse_shape %2559 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1408 = linalg.transpose ins(%collapsed_1384 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1409 = linalg.transpose ins(%collapsed_1406 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1410 = linalg.transpose ins(%collapsed_1407 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1411 = tensor.collapse_shape %transposed_1408 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1412 = tensor.collapse_shape %transposed_1409 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1413 = tensor.collapse_shape %transposed_1410 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2560 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1411, %collapsed_1412, %collapsed_1413, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1414 = tensor.expand_shape %2560 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1415 = linalg.transpose ins(%expanded_1414 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1416 = tensor.collapse_shape %transposed_1415 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2561 = iree_tensor_ext.bitcast %__auto.blk.20.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1417 = tensor.expand_shape %2561 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1418 = tensor.extract_slice %expanded_1417[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2562 = iree_tensor_ext.bitcast %extracted_slice_1418 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1419 = tensor.extract_slice %expanded_1417[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2563 = iree_tensor_ext.bitcast %extracted_slice_1419 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2564 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2562, %2563 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1420 = tensor.expand_shape %collapsed_1416 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2565 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1420, %2564 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2566 = linalg.copy ins(%2565 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2567 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2479, %2566 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2568 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2567 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2569 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2568 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2570 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2569 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2571 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2570 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2572 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2571 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2573 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2572 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2574 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2568, %2573 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2575 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2574 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2576 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.20.ffn_norm.weight, %2575 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2577 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2576 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2578 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1421 = tensor.expand_shape %2578 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1422 = tensor.extract_slice %expanded_1421[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2579 = iree_tensor_ext.bitcast %extracted_slice_1422 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1423 = tensor.extract_slice %expanded_1421[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2580 = iree_tensor_ext.bitcast %extracted_slice_1423 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2581 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2579, %2580 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1424 = tensor.expand_shape %2577 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2582 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1424, %2581 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2583 = linalg.copy ins(%2582 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2584 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2583 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %2585 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2584, %2583 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2586 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1425 = tensor.expand_shape %2586 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1426 = tensor.extract_slice %expanded_1425[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2587 = iree_tensor_ext.bitcast %extracted_slice_1426 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1427 = tensor.extract_slice %expanded_1425[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2588 = iree_tensor_ext.bitcast %extracted_slice_1427 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2589 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2587, %2588 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %2590 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1424, %2589 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2591 = linalg.copy ins(%2590 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2592 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2585, %2591 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2593 = iree_tensor_ext.bitcast %__auto.blk.20.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1428 = tensor.expand_shape %2593 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1429 = tensor.extract_slice %expanded_1428[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2594 = iree_tensor_ext.bitcast %extracted_slice_1429 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1430 = tensor.extract_slice %expanded_1428[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2595 = iree_tensor_ext.bitcast %extracted_slice_1430 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2596 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2594, %2595 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1431 = tensor.expand_shape %2592 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2597 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1431, %2596 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2598 = linalg.copy ins(%2597 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2599 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2567, %2598 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2600 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2599 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2601 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2600 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2602 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2601 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2603 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2602 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2604 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2603 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2605 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2604 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2606 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2600, %2605 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2607 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2606 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2608 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.attn_norm.weight, %2607 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2609 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2608 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2610 = iree_tensor_ext.bitcast %__auto.blk.21.attn_q.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1432 = tensor.expand_shape %2610 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1433 = tensor.extract_slice %expanded_1432[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2611 = iree_tensor_ext.bitcast %extracted_slice_1433 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1434 = tensor.extract_slice %expanded_1432[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2612 = iree_tensor_ext.bitcast %extracted_slice_1434 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2613 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2611, %2612 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1435 = tensor.expand_shape %2609 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2614 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1435, %2613 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2615 = linalg.copy ins(%2614 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2616 = iree_tensor_ext.bitcast %__auto.blk.21.attn_k.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1436 = tensor.expand_shape %2616 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1437 = tensor.extract_slice %expanded_1436[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2617 = iree_tensor_ext.bitcast %extracted_slice_1437 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1438 = tensor.extract_slice %expanded_1436[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2618 = iree_tensor_ext.bitcast %extracted_slice_1438 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2619 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2617, %2618 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2620 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1435, %2619 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2621 = linalg.copy ins(%2620 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %2622 = iree_tensor_ext.bitcast %__auto.blk.21.attn_v.weight : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1439 = tensor.expand_shape %2622 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1440 = tensor.extract_slice %expanded_1439[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x1xi16>
    %2623 = iree_tensor_ext.bitcast %extracted_slice_1440 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1441 = tensor.extract_slice %expanded_1439[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2624 = iree_tensor_ext.bitcast %extracted_slice_1441 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %2625 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2623, %2624 : tensor<256x64x1xf16>, tensor<256x64x32xi8>) outs(%44 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<256x64x32xf16>
    %2626 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1435, %2625 : tensor<4x1x64x32xf16>, tensor<256x64x32xf16>) outs(%47 : tensor<4x1x256xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x256xf32>
    %2627 = linalg.copy ins(%2626 : tensor<4x1x256xf32>) outs(%49 : tensor<4x1x256xf16>) -> tensor<4x1x256xf16>
    %expanded_1442 = tensor.expand_shape %2615 [[0], [1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x1x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1443 = tensor.expand_shape %2621 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %expanded_1444 = tensor.expand_shape %2627 [[0], [1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x1x256xf16> into tensor<4x1x4x64xf16>
    %2628 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1445 = tensor.expand_shape %2628 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2629 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1445 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2630 = linalg.batch_matmul ins(%2629, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1446 = linalg.transpose ins(%2630 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2631 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1446 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2632 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2631, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2633 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2632 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2634 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1446 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2635 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2634, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2636 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2635 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1447 = tensor.expand_shape %2633 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1448 = tensor.expand_shape %2636 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1449 = tensor.extract_slice %expanded_1442[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %extracted_slice_1450 = tensor.extract_slice %expanded_1442[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x1x32x32xf16>
    %2637 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1449, %expanded_1447 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2638 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1450, %expanded_1448 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2639 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2637, %2638 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2640 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1450, %expanded_1447 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2641 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1449, %expanded_1448 : tensor<4x1x32x32xf16>, tensor<4x1x1x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2642 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2640, %2641 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%82 : tensor<4x1x32x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32x32xf16>
    %2643 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2639, %2642 : tensor<4x1x32x32xf16>, tensor<4x1x32x32xf16>) outs(%89 : tensor<4x1x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x32x2x32xf16>
    %collapsed_1451 = tensor.collapse_shape %2643 [[0], [1], [2], [3, 4]] : tensor<4x1x32x2x32xf16> into tensor<4x1x32x64xf16>
    %2644 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%66 : tensor<32xf32>) outs(%63 : tensor<32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.cmpf one, %in, %cst_5 : f32
      cf.assert %2742, "unimplemented: tensor with zero element"
      %2743 = arith.divf %cst_6, %in : f32
      linalg.yield %2743 : f32
    } -> tensor<32xf32>
    %expanded_1452 = tensor.expand_shape %2644 [[0, 1]] output_shape [32, 1] : tensor<32xf32> into tensor<32x1xf32>
    %2645 = linalg.generic {indexing_maps = [#map29, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1452 : tensor<32x1xf32>) outs(%68 : tensor<4x32x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      linalg.yield %in : f32
    } -> tensor<4x32x1xf32>
    %2646 = linalg.batch_matmul ins(%2645, %70 : tensor<4x32x1xf32>, tensor<4x1x1xf32>) outs(%71 : tensor<4x32x1xf32>) -> tensor<4x32x1xf32>
    %transposed_1453 = linalg.transpose ins(%2646 : tensor<4x32x1xf32>) outs(%73 : tensor<4x1x32xf32>) permutation = [0, 2, 1] 
    %2647 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1453 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.cos %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2648 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2647, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2649 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2648 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %2650 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%transposed_1453 : tensor<4x1x32xf32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.sin %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2651 = linalg.generic {indexing_maps = [#map, #map8, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2650, %cst_4 : tensor<4x1x32xf32>, tensor<f32>) outs(%73 : tensor<4x1x32xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x32xf32>
    %2652 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2651 : tensor<4x1x32xf32>) outs(%76 : tensor<4x1x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x32xf16>
    %expanded_1454 = tensor.expand_shape %2649 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %expanded_1455 = tensor.expand_shape %2652 [[0], [1], [2, 3]] output_shape [4, 1, 1, 32] : tensor<4x1x32xf16> into tensor<4x1x1x32xf16>
    %extracted_slice_1456 = tensor.extract_slice %expanded_1443[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %extracted_slice_1457 = tensor.extract_slice %expanded_1443[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x1x4x32xf16>
    %2653 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1456, %expanded_1454 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2654 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1457, %expanded_1455 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2655 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2653, %2654 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.subf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2656 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1457, %expanded_1454 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2657 = linalg.generic {indexing_maps = [#map9, #map17, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1456, %expanded_1455 : tensor<4x1x4x32xf16>, tensor<4x1x1x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2658 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2656, %2657 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%100 : tensor<4x1x4x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x4x32xf16>
    %2659 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2655, %2658 : tensor<4x1x4x32xf16>, tensor<4x1x4x32xf16>) outs(%107 : tensor<4x1x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = linalg.index 3 : index
      %2743 = arith.cmpi eq, %2742, %c0 : index
      %2744 = arith.select %2743, %in, %in_1505 : f16
      linalg.yield %2744 : f16
    } -> tensor<4x1x4x2x32xf16>
    %2660 = linalg.generic {indexing_maps = [#map13, #map13], iterator_types = ["parallel", "parallel"]} ins(%expanded_44 : tensor<4x1xi64>) outs(%111 : tensor<4x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = linalg.index 0 : index
      %2743 = arith.index_cast %in : i64 to index
      %2744 = arith.cmpi slt, %2743, %7 : index
      cf.assert %2744, "index must be smaller than dim size"
      %2745 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2745, "index must be larger or equal to 0"
      %extracted = tensor.extract %8[%2742, %2743] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4x1xi64>
    %expanded_1458 = tensor.expand_shape %2660 [[0], [1, 2]] output_shape [4, 1, 1] : tensor<4x1xi64> into tensor<4x1x1xi64>
    %2661 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%expanded_1458 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2662 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2661 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.addi %in, %c21_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2663 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2662 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2664 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2663, %cst_1 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2665 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2664 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2666 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2665, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2667 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2666 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2668 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2667, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1459 = tensor.collapse_shape %2668 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1460 = tensor.expand_shape %collapsed_1459 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1461 = tensor.collapse_shape %2659 [[0, 1, 2], [3, 4]] : tensor<4x1x4x2x32xf16> into tensor<16x64xf16>
    %2669 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1461, %expanded_1460 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2555 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2670 = linalg.generic {indexing_maps = [#map, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2663, %cst_0 : tensor<4x1x1xi64>, tensor<1x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2671 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2670 : tensor<4x1x1xi64>) outs(%115 : tensor<4x1x1xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x1xi64>
    %2672 = linalg.generic {indexing_maps = [#map1, #map30, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2671, %expanded_47 : tensor<4x1x1xi64>, tensor<1x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2673 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2672 : tensor<4x1x4xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2742 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %2674 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2673, %expanded_46 : tensor<4x1x4xi64>, tensor<4x1x1xi64>) outs(%120 : tensor<4x1x4xi64>) {
    ^bb0(%in: i64, %in_1505: i64, %out: i64):
      %2742 = arith.addi %in, %in_1505 : i64
      linalg.yield %2742 : i64
    } -> tensor<4x1x4xi64>
    %collapsed_1462 = tensor.collapse_shape %2674 [[0, 1, 2]] : tensor<4x1x4xi64> into tensor<16xi64>
    %expanded_1463 = tensor.expand_shape %collapsed_1462 [[0, 1]] output_shape [16, 1] : tensor<16xi64> into tensor<16x1xi64>
    %collapsed_1464 = tensor.collapse_shape %expanded_1444 [[0, 1, 2], [3]] : tensor<4x1x4x64xf16> into tensor<16x64xf16>
    %2675 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1464, %expanded_1463 : tensor<16x64xf16>, tensor<16x1xi64>) outs(%2669 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1465 = tensor.expand_shape %2675 [[0, 1, 2, 3, 4], [5]] output_shape [%131, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_1466 = tensor.collapse_shape %expanded_1465 [[0], [1, 2, 3, 4, 5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x360448xf16>
    %dim_1467 = tensor.dim %expanded_1465, %c0 : tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1468 = tensor.extract_slice %expanded_1465[0, 21, 0, 0, 0, 0] [%dim_1467, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2676 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1468, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1469 = tensor.extract_slice %expanded_1465[0, 21, 1, 0, 0, 0] [%dim_1467, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2677 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1469, %8 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%132 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %transposed_1470 = linalg.transpose ins(%2676 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1471 = tensor.collapse_shape %transposed_1470 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %transposed_1472 = linalg.transpose ins(%2677 : tensor<4x?x4x32x64xf16>) outs(%135 : tensor<4x?x32x4x64xf16>) permutation = [0, 1, 3, 2, 4] 
    %collapsed_1473 = tensor.collapse_shape %transposed_1472 [[0], [1, 2], [3], [4]] : tensor<4x?x32x4x64xf16> into tensor<4x?x4x64xf16>
    %2678 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1471 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1474 = tensor.collapse_shape %2678 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %2679 = linalg.generic {indexing_maps = [#map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1473 : tensor<4x?x4x64xf16>) outs(%146 : tensor<4x?x4x8x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x8x64xf16>
    %collapsed_1475 = tensor.collapse_shape %2679 [[0], [1], [2, 3], [4]] : tensor<4x?x4x8x64xf16> into tensor<4x?x32x64xf16>
    %transposed_1476 = linalg.transpose ins(%collapsed_1451 : tensor<4x1x32x64xf16>) outs(%149 : tensor<4x32x1x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1477 = linalg.transpose ins(%collapsed_1474 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %transposed_1478 = linalg.transpose ins(%collapsed_1475 : tensor<4x?x32x64xf16>) outs(%151 : tensor<4x32x?x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1479 = tensor.collapse_shape %transposed_1476 [[0, 1], [2], [3]] : tensor<4x32x1x64xf16> into tensor<128x1x64xf16>
    %collapsed_1480 = tensor.collapse_shape %transposed_1477 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_1481 = tensor.collapse_shape %transposed_1478 [[0, 1], [2], [3]] : tensor<4x32x?x64xf16> into tensor<128x?x64xf16>
    %2680 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1479, %collapsed_1480, %collapsed_1481, %cst, %collapsed_73 : tensor<128x1x64xf16>, tensor<128x?x64xf16>, tensor<128x?x64xf16>, f16, tensor<128x1x?xf16>) outs(%154 : tensor<128x1x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x1x64xf16>
    %expanded_1482 = tensor.expand_shape %2680 [[0, 1], [2], [3]] output_shape [4, 32, 1, 64] : tensor<128x1x64xf16> into tensor<4x32x1x64xf16>
    %transposed_1483 = linalg.transpose ins(%expanded_1482 : tensor<4x32x1x64xf16>) outs(%81 : tensor<4x1x32x64xf16>) permutation = [0, 2, 1, 3] 
    %collapsed_1484 = tensor.collapse_shape %transposed_1483 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2681 = iree_tensor_ext.bitcast %__auto.blk.21.attn_output.weight : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1485 = tensor.expand_shape %2681 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1486 = tensor.extract_slice %expanded_1485[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x1xi16>
    %2682 = iree_tensor_ext.bitcast %extracted_slice_1486 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1487 = tensor.extract_slice %expanded_1485[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2683 = iree_tensor_ext.bitcast %extracted_slice_1487 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %2684 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2682, %2683 : tensor<2048x64x1xf16>, tensor<2048x64x32xi8>) outs(%36 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1488 = tensor.expand_shape %collapsed_1484 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2685 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1488, %2684 : tensor<4x1x64x32xf16>, tensor<2048x64x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2686 = linalg.copy ins(%2685 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2687 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2599, %2686 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2688 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2687 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2689 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2688 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2690 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2689 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2691 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2690 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2692 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2691 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2693 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2692 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2694 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2688, %2693 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2695 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2694 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2696 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.blk.21.ffn_norm.weight, %2695 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2697 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2696 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2698 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_gate.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1489 = tensor.expand_shape %2698 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1490 = tensor.extract_slice %expanded_1489[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2699 = iree_tensor_ext.bitcast %extracted_slice_1490 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1491 = tensor.extract_slice %expanded_1489[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2700 = iree_tensor_ext.bitcast %extracted_slice_1491 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2701 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2699, %2700 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1492 = tensor.expand_shape %2697 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2702 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1492, %2701 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2703 = linalg.copy ins(%2702 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2704 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2703 : tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2742 = arith.negf %in : f16
      %2743 = math.exp %2742 : f16
      %2744 = arith.addf %2743, %cst_7 : f16
      %2745 = arith.divf %cst_7, %2744 : f16
      linalg.yield %2745 : f16
    } -> tensor<4x1x5632xf16>
    %2705 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2704, %2703 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2706 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_up.weight : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1493 = tensor.expand_shape %2706 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1494 = tensor.extract_slice %expanded_1493[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x1xi16>
    %2707 = iree_tensor_ext.bitcast %extracted_slice_1494 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1495 = tensor.extract_slice %expanded_1493[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2708 = iree_tensor_ext.bitcast %extracted_slice_1495 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %2709 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2707, %2708 : tensor<5632x64x1xf16>, tensor<5632x64x32xi8>) outs(%176 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<5632x64x32xf16>
    %2710 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1492, %2709 : tensor<4x1x64x32xf16>, tensor<5632x64x32xf16>) outs(%179 : tensor<4x1x5632xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x5632xf32>
    %2711 = linalg.copy ins(%2710 : tensor<4x1x5632xf32>) outs(%181 : tensor<4x1x5632xf16>) -> tensor<4x1x5632xf16>
    %2712 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2705, %2711 : tensor<4x1x5632xf16>, tensor<4x1x5632xf16>) outs(%181 : tensor<4x1x5632xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.mulf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x5632xf16>
    %2713 = iree_tensor_ext.bitcast %__auto.blk.21.ffn_down.weight : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1496 = tensor.expand_shape %2713 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1497 = tensor.extract_slice %expanded_1496[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x1xi16>
    %2714 = iree_tensor_ext.bitcast %extracted_slice_1497 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1498 = tensor.extract_slice %expanded_1496[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2715 = iree_tensor_ext.bitcast %extracted_slice_1498 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %2716 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2714, %2715 : tensor<2048x176x1xf16>, tensor<2048x176x32xi8>) outs(%195 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1499 = tensor.expand_shape %2712 [[0], [1], [2, 3]] output_shape [4, 1, 176, 32] : tensor<4x1x5632xf16> into tensor<4x1x176x32xf16>
    %2717 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1499, %2716 : tensor<4x1x176x32xf16>, tensor<2048x176x32xf16>) outs(%38 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x2048xf32>
    %2718 = linalg.copy ins(%2717 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) -> tensor<4x1x2048xf16>
    %2719 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2687, %2718 : tensor<4x1x2048xf16>, tensor<4x1x2048xf16>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f16):
      %2742 = arith.addf %in, %in_1505 : f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2720 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2719 : tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2742 = arith.extf %in : f16 to f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2721 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2720 : tensor<4x1x2048xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2722 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2721 : tensor<4x1x2048xf32>) outs(%24 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %out : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2723 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2722 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.divf %in, %cst_8 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2724 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2723 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = arith.addf %in, %cst_9 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2725 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2724 : tensor<4x1x1xf32>) outs(%23 : tensor<4x1x1xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2742 = math.rsqrt %in : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x1xf32>
    %2726 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2720, %2725 : tensor<4x1x2048xf32>, tensor<4x1x1xf32>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f32, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f32
      linalg.yield %2742 : f32
    } -> tensor<4x1x2048xf32>
    %2727 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2726 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2728 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%__auto.output_norm.weight, %2727 : tensor<2048xf32>, tensor<4x1x2048xf16>) outs(%20 : tensor<4x1x2048xf32>) {
    ^bb0(%in: f32, %in_1505: f16, %out: f32):
      %2742 = arith.extf %in_1505 : f16 to f32
      %2743 = arith.mulf %in, %2742 : f32
      linalg.yield %2743 : f32
    } -> tensor<4x1x2048xf32>
    %2729 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2728 : tensor<4x1x2048xf32>) outs(%18 : tensor<4x1x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2742 = arith.truncf %in : f32 to f16
      linalg.yield %2742 : f16
    } -> tensor<4x1x2048xf16>
    %2730 = iree_tensor_ext.bitcast %__auto.output.weight : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded_1500 = tensor.expand_shape %2730 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice_1501 = tensor.extract_slice %expanded_1500[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x1xi16>
    %2731 = iree_tensor_ext.bitcast %extracted_slice_1501 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_1502 = tensor.extract_slice %expanded_1500[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %2732 = iree_tensor_ext.bitcast %extracted_slice_1502 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %2733 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2731, %2732 : tensor<32000x64x1xf16>, tensor<32000x64x32xi8>) outs(%15 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1505: i8, %out: f16):
      %2742 = arith.extsi %in_1505 : i8 to i32
      %2743 = arith.sitofp %2742 : i32 to f16
      %2744 = arith.mulf %2743, %in : f16
      linalg.yield %2744 : f16
    } -> tensor<32000x64x32xf16>
    %expanded_1503 = tensor.expand_shape %2729 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %2734 = tensor.empty() : tensor<4x1x32000xf32>
    %2735 = linalg.fill ins(%cst_5 : f32) outs(%2734 : tensor<4x1x32000xf32>) -> tensor<4x1x32000xf32>
    %2736 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1503, %2733 : tensor<4x1x64x32xf16>, tensor<32000x64x32xf16>) outs(%2735 : tensor<4x1x32000xf32>) {
    ^bb0(%in: f16, %in_1505: f16, %out: f32):
      %2742 = arith.mulf %in, %in_1505 : f16
      %2743 = arith.extf %2742 : f16 to f32
      %2744 = arith.addf %2743, %out : f32
      linalg.yield %2744 : f32
    } -> tensor<4x1x32000xf32>
    %2737 = tensor.empty() : tensor<4x1x32000xf16>
    %2738 = linalg.copy ins(%2736 : tensor<4x1x32000xf32>) outs(%2737 : tensor<4x1x32000xf16>) -> tensor<4x1x32000xf16>
    %dim_1504 = tensor.dim %collapsed_1466, %c0 : tensor<?x360448xf16>
    %2739 = hal.tensor.alias on(#hal.device.promise<@__device_0>) wait(%arg5) => %collapsed_1466 : tensor<?x360448xf16>{%dim_1504} to %arg4 : !hal.buffer_view
    %2740:2 = hal.tensor.barrier join(%2739, %2738 : tensor<?x360448xf16>, tensor<4x1x32000xf16>) => %arg6 : !hal.fence
    %2741 = hal.tensor.export %2740#1 : tensor<4x1x32000xf16> -> !hal.buffer_view
    util.return %2741 : !hal.buffer_view
  }
  util.func public @decode_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @decode_bs4$async(%arg0, %arg1, %arg2, %arg3, %arg4, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
}
