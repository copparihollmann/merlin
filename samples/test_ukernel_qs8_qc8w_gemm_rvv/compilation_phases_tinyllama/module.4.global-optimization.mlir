#executable_target_embedded_elf_x86_64 = #hal.executable.target<"llvm-cpu", "embedded-elf-x86_64", {cpu = "znver3", cpu_features = "+prfchw,-cldemote,+avx,+aes,+sahf,+pclmul,-xop,+crc32,-amx-fp8,+xsaves,-avx512fp16,-usermsr,-sm4,-egpr,+sse4.1,-avx512ifma,+xsave,+sse4.2,-tsxldtrk,-sm3,-ptwrite,-widekl,-movrs,+invpcid,+64bit,+xsavec,-avx10.1-512,-avx512vpopcntdq,+cmov,-avx512vp2intersect,-avx512cd,+movbe,-avxvnniint8,-ccmp,-amx-int8,-kl,-avx10.1-256,-sha512,-avxvnni,-rtm,+adx,+avx2,-hreset,-movdiri,-serialize,+vpclmulqdq,-avx512vl,-uintr,-cf,+clflushopt,-raoint,-cmpccxadd,+bmi,-amx-tile,+sse,-avx10.2-256,-gfni,-avxvnniint16,-amx-fp16,-zu,-ndd,+xsaveopt,+rdrnd,-avx512f,-amx-bf16,-avx512bf16,-avx512vnni,-push2pop2,+cx8,-avx512bw,+sse3,+pku,-nf,-amx-tf32,-amx-avx512,+fsgsbase,+clzero,+mwaitx,-lwp,+lzcnt,+sha,-movdir64b,-ppx,+wbnoinvd,-enqcmd,-amx-transpose,-avx10.2-512,-avxneconvert,-tbm,-pconfig,-amx-complex,+ssse3,+cx16,+bmi2,+fma,+popcnt,-avxifma,+f16c,-avx512bitalg,+rdpru,+clwb,+mmx,+sse2,+rdseed,-avx512vbmi2,-prefetchi,-amx-movrs,+rdpid,-fma4,-avx512vbmi,+shstk,+vaes,-waitpkg,-sgx,+fxsr,-avx512dq,+sse4a", data_layout = "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128", iree.encoding.resolver = #iree_cpu.cpu_encoding_resolver<>, max_stack_allocation_size = 32768 : i64, native_vector_size = 32 : i64, target_triple = "x86_64-unknown-unknown-eabi-elf"}>
#map = affine_map<(d0, d1, d2) -> (d0, d1, d2)>
#map1 = affine_map<(d0, d1, d2) -> (d0, d1)>
#map2 = affine_map<(d0, d1) -> (d0, d1)>
#map3 = affine_map<(d0, d1, d2) -> (d2)>
#map4 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d3, d4)>
#map5 = affine_map<(d0, d1, d2, d3, d4) -> (d2, d3, d4)>
#map6 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2)>
#map7 = affine_map<(d0) -> (d0)>
#map8 = affine_map<(d0, d1) -> ()>
#map9 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d2, d3)>
#map10 = affine_map<(d0, d1, d2, d3) -> (d1, d3)>
#map11 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d4)>
#map12 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d2, d3, d4)>
#map13 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d3, d2, d4)>
#map14 = affine_map<(d0, d1) -> (d1)>
#map15 = affine_map<(d0, d1) -> (d0)>
#map16 = affine_map<(d0, d1, d2) -> (d1, d2)>
#map17 = affine_map<(d0, d1, d2) -> (d0, d2)>
#map18 = affine_map<(d0, d1, d2) -> ()>
#map19 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d2, d1, d4)>
#map20 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d3, d1, d4)>
#map21 = affine_map<(d0, d1, d2, d3) -> (d0, d2, d3)>
#map22 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d4, d1, d3)>
#map23 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d3)>
#map24 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d4, d3)>
#map25 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d2, d4)>
#map26 = affine_map<(d0, d1, d2, d3, d4) -> ()>
#map27 = affine_map<(d0, d1, d2, d3, d4) -> (d0, d1, d4)>
#map28 = affine_map<(d0, d1, d2, d3) -> (d0, d2, d1, d3)>
#map29 = affine_map<(d0, d1, d2, d3) -> (d1, d2, d3)>
#map30 = affine_map<(d0, d1, d2, d3) -> (d0, d1)>
#map31 = affine_map<(d0) -> ()>
#map32 = affine_map<(d0, d1, d2, d3) -> (d0, d1, d3)>
#map33 = affine_map<(d0, d1, d2, d3, d4, d5) -> (d0, d3, d1, d4, d5)>
#map34 = affine_map<(d0, d1, d2, d3, d4, d5) -> (d0, d1, d2, d3, d4, d5)>
#map35 = affine_map<(d0, d1, d2, d3, d4, d5) -> (d0, d4, d1, d5, d3)>
#map36 = affine_map<(d0, d1, d2, d3) -> (d0, d2)>
#map37 = affine_map<(d0, d1, d2, d3) -> (d0, d3, d2)>
#map38 = affine_map<(d0, d1, d2, d3) -> ()>
#map39 = affine_map<(d0, d1, d2, d3) -> (d0, d3)>
#device_target_local = #hal.device.target<"local", [#executable_target_embedded_elf_x86_64]> : !hal.device
module @module attributes {stream.affinity.default = #hal.device.affinity<@__device_0>} {
  util.global private @__device_0 = #device_target_local
  util.global private @__hoisted_tensor_32xf32 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[0.000000e+00, 3.125000e-02, 6.250000e-02, 9.375000e-02, 1.250000e-01, 1.562500e-01, 1.875000e-01, 2.187500e-01, 2.500000e-01, 2.812500e-01, 3.125000e-01, 3.437500e-01, 3.750000e-01, 4.062500e-01, 4.375000e-01, 4.687500e-01, 5.000000e-01, 5.312500e-01, 5.625000e-01, 5.937500e-01, 6.250000e-01, 6.562500e-01, 6.875000e-01, 7.187500e-01, 7.500000e-01, 7.812500e-01, 8.125000e-01, 8.437500e-01, 8.750000e-01, 9.062500e-01, 9.375000e-01, 9.687500e-01]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_0 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_1 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_f16 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<0.000000e+00> : tensor<f16>
  util.global private @__hoisted_tensor_32xf32_2 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_3 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_4 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_5 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_6 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_7 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_8 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_9 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_10 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_11 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_12 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_13 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_14 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_15 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_16 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_17 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_18 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_19 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_20 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_21 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_22 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_23 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_24 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_25 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_26 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_27 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_28 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_29 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_30 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_31 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_32 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_33 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_34 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_35 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_36 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_37 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_38 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_39 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_40 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_41 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_42 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_43 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.func public @prefill_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.fence, %arg5: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %cst = arith.constant 9.99999974E-6 : f32
    %cst_0 = arith.constant 2.048000e+03 : f32
    %cst_1 = arith.constant 1.000000e+00 : f16
    %cst_2 = arith.constant 0.000000e+00 : f32
    %c32000 = arith.constant 32000 : index
    %c1 = arith.constant 1 : index
    %cst_3 = arith.constant dense<1.000000e+00> : tensor<f32>
    %cst_4 = arith.constant dense<0xFC00> : tensor<f16>
    %c0 = arith.constant 0 : index
    %c32 = arith.constant 32 : index
    %c1_i64 = arith.constant 1 : i64
    %c0_i64 = arith.constant 0 : i64
    %c2_i64 = arith.constant 2 : i64
    %c17_i64 = arith.constant 17 : i64
    %c5_i64 = arith.constant 5 : i64
    %c6_i64 = arith.constant 6 : i64
    %c4_i64 = arith.constant 4 : i64
    %c3_i64 = arith.constant 3 : i64
    %c22_i64 = arith.constant 22 : i64
    %c8_i64 = arith.constant 8 : i64
    %c7_i64 = arith.constant 7 : i64
    %c9_i64 = arith.constant 9 : i64
    %c10_i64 = arith.constant 10 : i64
    %c11_i64 = arith.constant 11 : i64
    %c12_i64 = arith.constant 12 : i64
    %c13_i64 = arith.constant 13 : i64
    %c14_i64 = arith.constant 14 : i64
    %c15_i64 = arith.constant 15 : i64
    %c16_i64 = arith.constant 16 : i64
    %c18_i64 = arith.constant 18 : i64
    %c19_i64 = arith.constant 19 : i64
    %c20_i64 = arith.constant 20 : i64
    %c21_i64 = arith.constant 21 : i64
    %cst_5 = arith.constant 1.250000e-01 : f16
    %c8 = arith.constant 8 : index
    %0 = flow.tensor.constant #flow.parameter.named<"model"::"token_embd.weight"> : tensor<32000x2176xi8>
    %1 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_norm.weight"> : tensor<2048xf32>
    %2 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_q.weight"> : tensor<2048x2176xi8>
    %3 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_k.weight"> : tensor<256x2176xi8>
    %4 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_v.weight"> : tensor<256x2176xi8>
    %5 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_output.weight"> : tensor<2048x2176xi8>
    %6 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_norm.weight"> : tensor<2048xf32>
    %7 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_gate.weight"> : tensor<5632x2176xi8>
    %8 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_up.weight"> : tensor<5632x2176xi8>
    %9 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_down.weight"> : tensor<2048x5984xi8>
    %10 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_norm.weight"> : tensor<2048xf32>
    %11 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_q.weight"> : tensor<2048x2176xi8>
    %12 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_k.weight"> : tensor<256x2176xi8>
    %13 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_v.weight"> : tensor<256x2176xi8>
    %14 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_output.weight"> : tensor<2048x2176xi8>
    %15 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_norm.weight"> : tensor<2048xf32>
    %16 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_gate.weight"> : tensor<5632x2176xi8>
    %17 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_up.weight"> : tensor<5632x2176xi8>
    %18 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_down.weight"> : tensor<2048x5984xi8>
    %19 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_norm.weight"> : tensor<2048xf32>
    %20 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_q.weight"> : tensor<2048x2176xi8>
    %21 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_k.weight"> : tensor<256x2176xi8>
    %22 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_v.weight"> : tensor<256x2176xi8>
    %23 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_output.weight"> : tensor<2048x2176xi8>
    %24 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_norm.weight"> : tensor<2048xf32>
    %25 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_gate.weight"> : tensor<5632x2176xi8>
    %26 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_up.weight"> : tensor<5632x2176xi8>
    %27 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_down.weight"> : tensor<2048x5984xi8>
    %28 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_norm.weight"> : tensor<2048xf32>
    %29 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_q.weight"> : tensor<2048x2176xi8>
    %30 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_k.weight"> : tensor<256x2176xi8>
    %31 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_v.weight"> : tensor<256x2176xi8>
    %32 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_output.weight"> : tensor<2048x2176xi8>
    %33 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_norm.weight"> : tensor<2048xf32>
    %34 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_gate.weight"> : tensor<5632x2176xi8>
    %35 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_up.weight"> : tensor<5632x2176xi8>
    %36 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_down.weight"> : tensor<2048x5984xi8>
    %37 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_norm.weight"> : tensor<2048xf32>
    %38 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_q.weight"> : tensor<2048x2176xi8>
    %39 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_k.weight"> : tensor<256x2176xi8>
    %40 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_v.weight"> : tensor<256x2176xi8>
    %41 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_output.weight"> : tensor<2048x2176xi8>
    %42 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_norm.weight"> : tensor<2048xf32>
    %43 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_gate.weight"> : tensor<5632x2176xi8>
    %44 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_up.weight"> : tensor<5632x2176xi8>
    %45 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_down.weight"> : tensor<2048x5984xi8>
    %46 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_norm.weight"> : tensor<2048xf32>
    %47 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_q.weight"> : tensor<2048x2176xi8>
    %48 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_k.weight"> : tensor<256x2176xi8>
    %49 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_v.weight"> : tensor<256x2176xi8>
    %50 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_output.weight"> : tensor<2048x2176xi8>
    %51 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_norm.weight"> : tensor<2048xf32>
    %52 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_gate.weight"> : tensor<5632x2176xi8>
    %53 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_up.weight"> : tensor<5632x2176xi8>
    %54 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_down.weight"> : tensor<2048x5984xi8>
    %55 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_norm.weight"> : tensor<2048xf32>
    %56 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_q.weight"> : tensor<2048x2176xi8>
    %57 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_k.weight"> : tensor<256x2176xi8>
    %58 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_v.weight"> : tensor<256x2176xi8>
    %59 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_output.weight"> : tensor<2048x2176xi8>
    %60 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_norm.weight"> : tensor<2048xf32>
    %61 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_gate.weight"> : tensor<5632x2176xi8>
    %62 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_up.weight"> : tensor<5632x2176xi8>
    %63 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_down.weight"> : tensor<2048x5984xi8>
    %64 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_norm.weight"> : tensor<2048xf32>
    %65 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_q.weight"> : tensor<2048x2176xi8>
    %66 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_k.weight"> : tensor<256x2176xi8>
    %67 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_v.weight"> : tensor<256x2176xi8>
    %68 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_output.weight"> : tensor<2048x2176xi8>
    %69 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_norm.weight"> : tensor<2048xf32>
    %70 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_gate.weight"> : tensor<5632x2176xi8>
    %71 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_up.weight"> : tensor<5632x2176xi8>
    %72 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_down.weight"> : tensor<2048x5984xi8>
    %73 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_norm.weight"> : tensor<2048xf32>
    %74 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_q.weight"> : tensor<2048x2176xi8>
    %75 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_k.weight"> : tensor<256x2176xi8>
    %76 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_v.weight"> : tensor<256x2176xi8>
    %77 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_output.weight"> : tensor<2048x2176xi8>
    %78 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_norm.weight"> : tensor<2048xf32>
    %79 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_gate.weight"> : tensor<5632x2176xi8>
    %80 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_up.weight"> : tensor<5632x2176xi8>
    %81 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_down.weight"> : tensor<2048x5984xi8>
    %82 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_norm.weight"> : tensor<2048xf32>
    %83 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_q.weight"> : tensor<2048x2176xi8>
    %84 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_k.weight"> : tensor<256x2176xi8>
    %85 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_v.weight"> : tensor<256x2176xi8>
    %86 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_output.weight"> : tensor<2048x2176xi8>
    %87 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_norm.weight"> : tensor<2048xf32>
    %88 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_gate.weight"> : tensor<5632x2176xi8>
    %89 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_up.weight"> : tensor<5632x2176xi8>
    %90 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_down.weight"> : tensor<2048x5984xi8>
    %91 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_norm.weight"> : tensor<2048xf32>
    %92 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_q.weight"> : tensor<2048x2176xi8>
    %93 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_k.weight"> : tensor<256x2176xi8>
    %94 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_v.weight"> : tensor<256x2176xi8>
    %95 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_output.weight"> : tensor<2048x2176xi8>
    %96 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_norm.weight"> : tensor<2048xf32>
    %97 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_gate.weight"> : tensor<5632x2176xi8>
    %98 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_up.weight"> : tensor<5632x2176xi8>
    %99 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_down.weight"> : tensor<2048x5984xi8>
    %100 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_norm.weight"> : tensor<2048xf32>
    %101 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_q.weight"> : tensor<2048x2176xi8>
    %102 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_k.weight"> : tensor<256x2176xi8>
    %103 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_v.weight"> : tensor<256x2176xi8>
    %104 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_output.weight"> : tensor<2048x2176xi8>
    %105 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_norm.weight"> : tensor<2048xf32>
    %106 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_gate.weight"> : tensor<5632x2176xi8>
    %107 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_up.weight"> : tensor<5632x2176xi8>
    %108 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_down.weight"> : tensor<2048x5984xi8>
    %109 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_norm.weight"> : tensor<2048xf32>
    %110 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_q.weight"> : tensor<2048x2176xi8>
    %111 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_k.weight"> : tensor<256x2176xi8>
    %112 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_v.weight"> : tensor<256x2176xi8>
    %113 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_output.weight"> : tensor<2048x2176xi8>
    %114 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_norm.weight"> : tensor<2048xf32>
    %115 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_gate.weight"> : tensor<5632x2176xi8>
    %116 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_up.weight"> : tensor<5632x2176xi8>
    %117 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_down.weight"> : tensor<2048x5984xi8>
    %118 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_norm.weight"> : tensor<2048xf32>
    %119 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_q.weight"> : tensor<2048x2176xi8>
    %120 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_k.weight"> : tensor<256x2176xi8>
    %121 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_v.weight"> : tensor<256x2176xi8>
    %122 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_output.weight"> : tensor<2048x2176xi8>
    %123 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_norm.weight"> : tensor<2048xf32>
    %124 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_gate.weight"> : tensor<5632x2176xi8>
    %125 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_up.weight"> : tensor<5632x2176xi8>
    %126 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_down.weight"> : tensor<2048x5984xi8>
    %127 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_norm.weight"> : tensor<2048xf32>
    %128 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_q.weight"> : tensor<2048x2176xi8>
    %129 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_k.weight"> : tensor<256x2176xi8>
    %130 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_v.weight"> : tensor<256x2176xi8>
    %131 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_output.weight"> : tensor<2048x2176xi8>
    %132 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_norm.weight"> : tensor<2048xf32>
    %133 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_gate.weight"> : tensor<5632x2176xi8>
    %134 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_up.weight"> : tensor<5632x2176xi8>
    %135 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_down.weight"> : tensor<2048x5984xi8>
    %136 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_norm.weight"> : tensor<2048xf32>
    %137 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_q.weight"> : tensor<2048x2176xi8>
    %138 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_k.weight"> : tensor<256x2176xi8>
    %139 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_v.weight"> : tensor<256x2176xi8>
    %140 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_output.weight"> : tensor<2048x2176xi8>
    %141 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_norm.weight"> : tensor<2048xf32>
    %142 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_gate.weight"> : tensor<5632x2176xi8>
    %143 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_up.weight"> : tensor<5632x2176xi8>
    %144 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_down.weight"> : tensor<2048x5984xi8>
    %145 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_norm.weight"> : tensor<2048xf32>
    %146 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_q.weight"> : tensor<2048x2176xi8>
    %147 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_k.weight"> : tensor<256x2176xi8>
    %148 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_v.weight"> : tensor<256x2176xi8>
    %149 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_output.weight"> : tensor<2048x2176xi8>
    %150 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_norm.weight"> : tensor<2048xf32>
    %151 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_gate.weight"> : tensor<5632x2176xi8>
    %152 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_up.weight"> : tensor<5632x2176xi8>
    %153 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_down.weight"> : tensor<2048x5984xi8>
    %154 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_norm.weight"> : tensor<2048xf32>
    %155 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_q.weight"> : tensor<2048x2176xi8>
    %156 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_k.weight"> : tensor<256x2176xi8>
    %157 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_v.weight"> : tensor<256x2176xi8>
    %158 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_output.weight"> : tensor<2048x2176xi8>
    %159 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_norm.weight"> : tensor<2048xf32>
    %160 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_gate.weight"> : tensor<5632x2176xi8>
    %161 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_up.weight"> : tensor<5632x2176xi8>
    %162 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_down.weight"> : tensor<2048x5984xi8>
    %163 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_norm.weight"> : tensor<2048xf32>
    %164 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_q.weight"> : tensor<2048x2176xi8>
    %165 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_k.weight"> : tensor<256x2176xi8>
    %166 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_v.weight"> : tensor<256x2176xi8>
    %167 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_output.weight"> : tensor<2048x2176xi8>
    %168 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_norm.weight"> : tensor<2048xf32>
    %169 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_gate.weight"> : tensor<5632x2176xi8>
    %170 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_up.weight"> : tensor<5632x2176xi8>
    %171 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_down.weight"> : tensor<2048x5984xi8>
    %172 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_norm.weight"> : tensor<2048xf32>
    %173 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_q.weight"> : tensor<2048x2176xi8>
    %174 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_k.weight"> : tensor<256x2176xi8>
    %175 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_v.weight"> : tensor<256x2176xi8>
    %176 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_output.weight"> : tensor<2048x2176xi8>
    %177 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_norm.weight"> : tensor<2048xf32>
    %178 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_gate.weight"> : tensor<5632x2176xi8>
    %179 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_up.weight"> : tensor<5632x2176xi8>
    %180 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_down.weight"> : tensor<2048x5984xi8>
    %181 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_norm.weight"> : tensor<2048xf32>
    %182 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_q.weight"> : tensor<2048x2176xi8>
    %183 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_k.weight"> : tensor<256x2176xi8>
    %184 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_v.weight"> : tensor<256x2176xi8>
    %185 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_output.weight"> : tensor<2048x2176xi8>
    %186 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_norm.weight"> : tensor<2048xf32>
    %187 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_gate.weight"> : tensor<5632x2176xi8>
    %188 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_up.weight"> : tensor<5632x2176xi8>
    %189 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_down.weight"> : tensor<2048x5984xi8>
    %190 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_norm.weight"> : tensor<2048xf32>
    %191 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_q.weight"> : tensor<2048x2176xi8>
    %192 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_k.weight"> : tensor<256x2176xi8>
    %193 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_v.weight"> : tensor<256x2176xi8>
    %194 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_output.weight"> : tensor<2048x2176xi8>
    %195 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_norm.weight"> : tensor<2048xf32>
    %196 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_gate.weight"> : tensor<5632x2176xi8>
    %197 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_up.weight"> : tensor<5632x2176xi8>
    %198 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_down.weight"> : tensor<2048x5984xi8>
    %199 = flow.tensor.constant #flow.parameter.named<"model"::"output_norm.weight"> : tensor<2048xf32>
    %200 = flow.tensor.constant #flow.parameter.named<"model"::"output.weight"> : tensor<32000x2176xi8>
    %201 = hal.buffer_view.dim<%arg0 : !hal.buffer_view>[1] : index
    %202 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg0 : !hal.buffer_view -> tensor<4x?xi64>{%201}
    %203 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %204 = hal.buffer_view.dim<%arg2 : !hal.buffer_view>[1] : index
    %205 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg2 : !hal.buffer_view -> tensor<4x?xi64>{%204}
    %206 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[0] : index
    %207 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg4) => %arg3 : !hal.buffer_view -> tensor<?x360448xf16>{%206}
    %208 = arith.muli %204, %c32 : index
    %209 = util.assume.int %208<umin = 32, umax = 2016, udiv = 32> : index
    %210 = flow.tensor.tie_shape %202 : tensor<4x?xi64>{%209}
    %211 = util.assume.int %204<umin = 1, umax = 63> : index
    %212 = flow.tensor.tie_shape %205 : tensor<4x?xi64>{%211}
    %213 = util.assume.int %206<umin = 1, umax = 9007199254740991> : index
    %214 = flow.tensor.tie_shape %207 : tensor<?x360448xf16>{%213}
    %215 = iree_tensor_ext.bitcast %0 : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded = tensor.expand_shape %215 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice = tensor.extract_slice %expanded[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64xi16>
    %expanded_6 = tensor.expand_shape %extracted_slice [[0], [1, 2]] output_shape [32000, 64, 1] : tensor<32000x64xi16> into tensor<32000x64x1xi16>
    %216 = iree_tensor_ext.bitcast %expanded_6 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_7 = tensor.extract_slice %expanded[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %217 = iree_tensor_ext.bitcast %extracted_slice_7 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %218 = tensor.empty() : tensor<32000x64x32xf16>
    %219 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%217 : tensor<32000x64x32xi8>) outs(%218 : tensor<32000x64x32xf16>) {
    ^bb0(%in: i8, %out: f16):
      %2625 = arith.sitofp %in : i8 to f16
      linalg.yield %2625 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed = tensor.collapse_shape %216 [[0], [1, 2]] : tensor<32000x64x1xf16> into tensor<32000x64xf16>
    %220 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed, %219 : tensor<32000x64xf16>, tensor<32000x64x32xf16>) outs(%218 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed_8 = tensor.collapse_shape %220 [[0], [1, 2]] : tensor<32000x64x32xf16> into tensor<32000x2048xf16>
    %221 = tensor.empty(%209) : tensor<4x?x2048xf16>
    %222 = linalg.generic {indexing_maps = [#map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%210 : tensor<4x?xi64>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: i64, %out: f16):
      %2625 = arith.index_cast %in : i64 to index
      %2626 = linalg.index 2 : index
      %2627 = arith.cmpi slt, %2625, %c32000 : index
      cf.assert %2627, "index must be smaller than dim size"
      %2628 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2628, "index must be larger or equal to 0"
      %extracted = tensor.extract %collapsed_8[%2625, %2626] : tensor<32000x2048xf16>
      linalg.yield %extracted : f16
    } -> tensor<4x?x2048xf16>
    %223 = tensor.empty(%209) : tensor<4x?x2048xf32>
    %224 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%222 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %225 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%224 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %226 = tensor.empty(%209) : tensor<4x?xf32>
    %227 = linalg.fill ins(%cst_2 : f32) outs(%226 : tensor<4x?xf32>) -> tensor<4x?xf32>
    %228 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%225 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %229 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%228 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %230 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%229 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %231 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%230 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %232 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%224, %231 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %233 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%232 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %234 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1, %233 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %235 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%234 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %236 = iree_tensor_ext.bitcast %2 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_9 = tensor.expand_shape %236 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_10 = tensor.extract_slice %expanded_9[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_11 = tensor.expand_shape %extracted_slice_10 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %237 = iree_tensor_ext.bitcast %expanded_11 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_12 = tensor.extract_slice %expanded_9[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %238 = iree_tensor_ext.bitcast %extracted_slice_12 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %239 = tensor.empty() : tensor<2048x64x32xf16>
    %collapsed_13 = tensor.collapse_shape %237 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %240 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_13, %238 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_14 = tensor.expand_shape %235 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %241 = linalg.fill ins(%cst_2 : f32) outs(%223 : tensor<4x?x2048xf32>) -> tensor<4x?x2048xf32>
    %242 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_14, %240 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %243 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%242 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %244 = iree_tensor_ext.bitcast %3 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_15 = tensor.expand_shape %244 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_16 = tensor.extract_slice %expanded_15[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_17 = tensor.expand_shape %extracted_slice_16 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %245 = iree_tensor_ext.bitcast %expanded_17 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_18 = tensor.extract_slice %expanded_15[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %246 = iree_tensor_ext.bitcast %extracted_slice_18 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %247 = tensor.empty() : tensor<256x64x32xf16>
    %collapsed_19 = tensor.collapse_shape %245 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %248 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_19, %246 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %249 = tensor.empty(%209) : tensor<4x?x256xf32>
    %250 = linalg.fill ins(%cst_2 : f32) outs(%249 : tensor<4x?x256xf32>) -> tensor<4x?x256xf32>
    %251 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_14, %248 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %252 = tensor.empty(%209) : tensor<4x?x256xf16>
    %253 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%251 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %254 = iree_tensor_ext.bitcast %4 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_20 = tensor.expand_shape %254 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_21 = tensor.extract_slice %expanded_20[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_22 = tensor.expand_shape %extracted_slice_21 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %255 = iree_tensor_ext.bitcast %expanded_22 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_23 = tensor.extract_slice %expanded_20[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %256 = iree_tensor_ext.bitcast %extracted_slice_23 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_24 = tensor.collapse_shape %255 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %257 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_24, %256 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %258 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_14, %257 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %259 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%258 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_25 = tensor.expand_shape %243 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_26 = tensor.expand_shape %253 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_27 = tensor.expand_shape %259 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %260 = tensor.empty(%209) : tensor<?xi64>
    %261 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%260 : tensor<?xi64>) {
    ^bb0(%out: i64):
      %2625 = linalg.index 0 : index
      %2626 = arith.index_cast %2625 : index to i64
      linalg.yield %2626 : i64
    } -> tensor<?xi64>
    %__hoisted_tensor_32xf32_0 = util.global.load immutable @__hoisted_tensor_32xf32_0 : tensor<32xf32>
    %262 = tensor.empty(%209) : tensor<?xf32>
    %263 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%261 : tensor<?xi64>) outs(%262 : tensor<?xf32>) {
    ^bb0(%in: i64, %out: f32):
      %2625 = arith.sitofp %in : i64 to f32
      linalg.yield %2625 : f32
    } -> tensor<?xf32>
    %expanded_28 = tensor.expand_shape %263 [[0, 1, 2]] output_shape [1, 1, %209] : tensor<?xf32> into tensor<1x1x?xf32>
    %expanded_29 = tensor.expand_shape %__hoisted_tensor_32xf32_0 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %264 = arith.subi %209, %c1 : index
    %265 = arith.divui %264, %c8 : index
    %266 = arith.addi %265, %c1 : index
    %267 = tensor.empty(%266) : tensor<1x?x1x8x1xf32>
    %pack = linalg.pack %expanded_28 padding_value(%cst_2 : f32) outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [8, 1] into %267 : tensor<1x1x?xf32> -> tensor<1x?x1x8x1xf32>
    %268 = tensor.empty(%266) : tensor<1x4x?x8x8xf32>
    %269 = linalg.fill ins(%cst_2 : f32) outs(%268 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %270 = linalg.batch_mmt4d ins(%expanded_29, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %271 = tensor.empty(%209) : tensor<?x32xf32>
    %272 = tensor.empty(%209) : tensor<?x1x32xf32>
    %unpack = linalg.unpack %270 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %273 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_30 = tensor.collapse_shape %273 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %274 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_30, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %275 = tensor.empty(%209) : tensor<?x32xf16>
    %276 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%274 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %277 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_31 = tensor.collapse_shape %277 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %278 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_31, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %279 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%278 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_32 = tensor.extract_slice %expanded_25[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_33 = tensor.extract_slice %expanded_25[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %280 = tensor.empty(%209) : tensor<4x?x32x32xf16>
    %281 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_32, %276 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %282 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_33, %279 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %283 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%281, %282 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %284 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_33, %276 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %285 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_32, %279 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %286 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%284, %285 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_1 = util.global.load immutable @__hoisted_tensor_32xf32_1 : tensor<32xf32>
    %expanded_34 = tensor.expand_shape %__hoisted_tensor_32xf32_1 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %287 = linalg.batch_mmt4d ins(%expanded_34, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_35 = linalg.unpack %287 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %288 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_35 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_36 = tensor.collapse_shape %288 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %289 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_36, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %290 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%289 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %291 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_35 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_37 = tensor.collapse_shape %291 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %292 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_37, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %293 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%292 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_38 = tensor.extract_slice %expanded_26[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_39 = tensor.extract_slice %expanded_26[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %294 = tensor.empty(%209) : tensor<4x?x4x32xf16>
    %295 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %290 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %296 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_39, %293 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %297 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%295, %296 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %298 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_39, %290 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %299 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %293 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %300 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%298, %299 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %301 = tensor.empty(%209) : tensor<4x?x4x2x32xf16>
    %302 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%297, %300 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_40 = tensor.collapse_shape %302 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %expanded_41 = tensor.expand_shape %214 [[0], [1, 2, 3, 4, 5]] output_shape [%213, 22, 2, 4, 32, 64] : tensor<?x360448xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_42 = tensor.collapse_shape %expanded_41 [[0, 1, 2], [3], [4], [5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x4x32x64xf16>
    %303 = tensor.empty(%211) : tensor<4x?xi64>
    %304 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%212 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %305 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_43 = tensor.collapse_shape %305 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %306 = arith.divui %209, %c32 : index
    %expanded_44 = tensor.expand_shape %collapsed_40 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %307 = tensor.empty(%306) : tensor<4x?x4x32x64xf16>
    %308 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_44 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_45 = tensor.collapse_shape %308 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %309 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_45, %collapsed_43 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%collapsed_42 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %310 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%305 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_46 = tensor.collapse_shape %310 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_47 = tensor.expand_shape %259 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %311 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_47 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_48 = tensor.collapse_shape %311 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %312 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_48, %collapsed_46 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%309 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %313 = tensor.empty(%209) : tensor<4x?xi1>
    %314 = linalg.generic {indexing_maps = [#map14, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%261, %203 : tensor<?xi64>, tensor<4xi64>) outs(%313 : tensor<4x?xi1>) {
    ^bb0(%in: i64, %in_1472: i64, %out: i1):
      %2625 = arith.cmpi sge, %in, %in_1472 : i64
      linalg.yield %2625 : i1
    } -> tensor<4x?xi1>
    %315 = tensor.empty(%209, %209) : tensor<?x?xi1>
    %316 = linalg.generic {indexing_maps = [#map14, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%261, %261 : tensor<?xi64>, tensor<?xi64>) outs(%315 : tensor<?x?xi1>) {
    ^bb0(%in: i64, %in_1472: i64, %out: i1):
      %2625 = arith.cmpi sgt, %in, %in_1472 : i64
      linalg.yield %2625 : i1
    } -> tensor<?x?xi1>
    %317 = tensor.empty(%209, %209) : tensor<4x?x?xi1>
    %318 = linalg.generic {indexing_maps = [#map16, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%316, %314 : tensor<?x?xi1>, tensor<4x?xi1>) outs(%317 : tensor<4x?x?xi1>) {
    ^bb0(%in: i1, %in_1472: i1, %out: i1):
      %2625 = arith.ori %in, %in_1472 : i1
      linalg.yield %2625 : i1
    } -> tensor<4x?x?xi1>
    %__hoisted_tensor_f16 = util.global.load immutable @__hoisted_tensor_f16 : tensor<f16>
    %319 = tensor.empty(%209, %209) : tensor<4x?x?xf16>
    %320 = linalg.generic {indexing_maps = [#map, #map18, #map18, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%318, %cst_4, %__hoisted_tensor_f16 : tensor<4x?x?xi1>, tensor<f16>, tensor<f16>) outs(%319 : tensor<4x?x?xf16>) {
    ^bb0(%in: i1, %in_1472: f16, %in_1473: f16, %out: f16):
      %2625 = arith.select %in, %in_1472, %in_1473 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x?xf16>
    %321 = tensor.empty(%209) : tensor<4x32x?x2x32xf16>
    %322 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%283, %286 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %323 = tensor.empty(%209) : tensor<4x4x8x?x64xf16>
    %324 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_40 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %325 = tensor.empty(%209, %209) : tensor<4x32x?x?xf16>
    %326 = linalg.generic {indexing_maps = [#map21, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%320 : tensor<4x?x?xf16>) outs(%325 : tensor<4x32x?x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x32x?x?xf16>
    %collapsed_49 = tensor.collapse_shape %322 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_50 = tensor.collapse_shape %324 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %collapsed_51 = tensor.collapse_shape %326 [[0, 1], [2], [3]] : tensor<4x32x?x?xf16> into tensor<128x?x?xf16>
    %327 = tensor.empty(%209) : tensor<128x?x64xf16>
    %328 = tensor.empty(%209) : tensor<4x4x8x64x?xf16>
    %329 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_27 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_52 = tensor.collapse_shape %329 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %330 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_49, %collapsed_50, %collapsed_52, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_53 = tensor.expand_shape %330 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %331 = tensor.empty(%209) : tensor<4x?x32x64xf16>
    %332 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_53 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_54 = tensor.collapse_shape %332 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %333 = iree_tensor_ext.bitcast %5 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_55 = tensor.expand_shape %333 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_56 = tensor.extract_slice %expanded_55[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_57 = tensor.expand_shape %extracted_slice_56 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %334 = iree_tensor_ext.bitcast %expanded_57 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_58 = tensor.extract_slice %expanded_55[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %335 = iree_tensor_ext.bitcast %extracted_slice_58 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_59 = tensor.collapse_shape %334 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %336 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_59, %335 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_60 = tensor.expand_shape %collapsed_54 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %337 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_60, %336 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %338 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%337 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %339 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%222, %338 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%339 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %341 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%340 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %342 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%341 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %343 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%342 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %344 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%343 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %345 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%344 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %346 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%340, %345 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %347 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%346 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %348 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%6, %347 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %349 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%348 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %350 = iree_tensor_ext.bitcast %7 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_61 = tensor.expand_shape %350 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_62 = tensor.extract_slice %expanded_61[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_63 = tensor.expand_shape %extracted_slice_62 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %351 = iree_tensor_ext.bitcast %expanded_63 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_64 = tensor.extract_slice %expanded_61[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %352 = iree_tensor_ext.bitcast %extracted_slice_64 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %353 = tensor.empty() : tensor<5632x64x32xf16>
    %collapsed_65 = tensor.collapse_shape %351 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %354 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_65, %352 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_66 = tensor.expand_shape %349 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %355 = tensor.empty(%209) : tensor<4x?x5632xf32>
    %356 = linalg.fill ins(%cst_2 : f32) outs(%355 : tensor<4x?x5632xf32>) -> tensor<4x?x5632xf32>
    %357 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_66, %354 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %358 = tensor.empty(%209) : tensor<4x?x5632xf16>
    %359 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%357 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %360 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%359 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %361 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%360, %359 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %362 = iree_tensor_ext.bitcast %8 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_67 = tensor.expand_shape %362 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_68 = tensor.extract_slice %expanded_67[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_69 = tensor.expand_shape %extracted_slice_68 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %363 = iree_tensor_ext.bitcast %expanded_69 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_70 = tensor.extract_slice %expanded_67[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %364 = iree_tensor_ext.bitcast %extracted_slice_70 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_71 = tensor.collapse_shape %363 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %365 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_71, %364 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %366 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_66, %365 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %367 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%366 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %368 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%361, %367 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %369 = iree_tensor_ext.bitcast %9 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_72 = tensor.expand_shape %369 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_73 = tensor.extract_slice %expanded_72[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_74 = tensor.expand_shape %extracted_slice_73 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %370 = iree_tensor_ext.bitcast %expanded_74 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_75 = tensor.extract_slice %expanded_72[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %371 = iree_tensor_ext.bitcast %extracted_slice_75 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %372 = tensor.empty() : tensor<2048x176x32xf16>
    %collapsed_76 = tensor.collapse_shape %370 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %373 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_76, %371 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_77 = tensor.expand_shape %368 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %374 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_77, %373 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %375 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%374 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %376 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%339, %375 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %377 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%376 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %378 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%377 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %379 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%378 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %380 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%379 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %381 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%380 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %382 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%381 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %383 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%377, %382 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %384 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%383 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %385 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%10, %384 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %386 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%385 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %387 = iree_tensor_ext.bitcast %11 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_78 = tensor.expand_shape %387 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_79 = tensor.extract_slice %expanded_78[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_80 = tensor.expand_shape %extracted_slice_79 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %388 = iree_tensor_ext.bitcast %expanded_80 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_81 = tensor.extract_slice %expanded_78[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %389 = iree_tensor_ext.bitcast %extracted_slice_81 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_82 = tensor.collapse_shape %388 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %390 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_82, %389 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_83 = tensor.expand_shape %386 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %391 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_83, %390 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %392 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%391 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %393 = iree_tensor_ext.bitcast %12 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_84 = tensor.expand_shape %393 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_85 = tensor.extract_slice %expanded_84[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_86 = tensor.expand_shape %extracted_slice_85 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %394 = iree_tensor_ext.bitcast %expanded_86 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_87 = tensor.extract_slice %expanded_84[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %395 = iree_tensor_ext.bitcast %extracted_slice_87 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_88 = tensor.collapse_shape %394 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %396 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_88, %395 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %397 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_83, %396 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %398 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%397 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %399 = iree_tensor_ext.bitcast %13 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_89 = tensor.expand_shape %399 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_90 = tensor.extract_slice %expanded_89[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_91 = tensor.expand_shape %extracted_slice_90 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %400 = iree_tensor_ext.bitcast %expanded_91 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_92 = tensor.extract_slice %expanded_89[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %401 = iree_tensor_ext.bitcast %extracted_slice_92 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_93 = tensor.collapse_shape %400 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %402 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_93, %401 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %403 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_83, %402 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %404 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%403 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_94 = tensor.expand_shape %392 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_95 = tensor.expand_shape %398 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_96 = tensor.expand_shape %404 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_2 = util.global.load immutable @__hoisted_tensor_32xf32_2 : tensor<32xf32>
    %expanded_97 = tensor.expand_shape %__hoisted_tensor_32xf32_2 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %405 = linalg.batch_mmt4d ins(%expanded_97, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_98 = linalg.unpack %405 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %406 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_98 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_99 = tensor.collapse_shape %406 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %407 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_99, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %408 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%407 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %409 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_98 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_100 = tensor.collapse_shape %409 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %410 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_100, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %411 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%410 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_101 = tensor.extract_slice %expanded_94[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_102 = tensor.extract_slice %expanded_94[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %412 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_101, %408 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %413 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_102, %411 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %414 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%412, %413 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %415 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_102, %408 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %416 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_101, %411 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %417 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%415, %416 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_3 = util.global.load immutable @__hoisted_tensor_32xf32_3 : tensor<32xf32>
    %expanded_103 = tensor.expand_shape %__hoisted_tensor_32xf32_3 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %418 = linalg.batch_mmt4d ins(%expanded_103, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_104 = linalg.unpack %418 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %419 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_104 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_105 = tensor.collapse_shape %419 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %420 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_105, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %421 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%420 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %422 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_104 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_106 = tensor.collapse_shape %422 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %423 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_106, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %424 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%423 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_107 = tensor.extract_slice %expanded_95[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_108 = tensor.extract_slice %expanded_95[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %425 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_107, %421 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %426 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_108, %424 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %427 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%425, %426 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %428 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_108, %421 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %429 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_107, %424 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %430 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%428, %429 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %431 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%427, %430 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_109 = tensor.collapse_shape %431 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %432 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %433 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%432 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_110 = tensor.collapse_shape %433 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_111 = tensor.expand_shape %collapsed_109 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %434 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_111 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_112 = tensor.collapse_shape %434 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %435 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_112, %collapsed_110 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%312 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %436 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%433 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_113 = tensor.collapse_shape %436 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_114 = tensor.expand_shape %404 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %437 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_114 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_115 = tensor.collapse_shape %437 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %438 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_115, %collapsed_113 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%435 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %439 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%414, %417 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %440 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_109 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_116 = tensor.collapse_shape %439 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_117 = tensor.collapse_shape %440 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %441 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_96 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_118 = tensor.collapse_shape %441 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %442 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_116, %collapsed_117, %collapsed_118, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_119 = tensor.expand_shape %442 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %443 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_119 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_120 = tensor.collapse_shape %443 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %444 = iree_tensor_ext.bitcast %14 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_121 = tensor.expand_shape %444 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_122 = tensor.extract_slice %expanded_121[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_123 = tensor.expand_shape %extracted_slice_122 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %445 = iree_tensor_ext.bitcast %expanded_123 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_124 = tensor.extract_slice %expanded_121[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %446 = iree_tensor_ext.bitcast %extracted_slice_124 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_125 = tensor.collapse_shape %445 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %447 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_125, %446 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_126 = tensor.expand_shape %collapsed_120 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %448 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_126, %447 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %449 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%448 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %450 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%376, %449 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %451 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%450 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %452 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%451 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %453 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%452 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %454 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%453 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %455 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%454 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %456 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%455 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %457 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%451, %456 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %458 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%457 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %459 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%15, %458 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %460 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%459 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %461 = iree_tensor_ext.bitcast %16 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_127 = tensor.expand_shape %461 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_128 = tensor.extract_slice %expanded_127[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_129 = tensor.expand_shape %extracted_slice_128 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %462 = iree_tensor_ext.bitcast %expanded_129 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_130 = tensor.extract_slice %expanded_127[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %463 = iree_tensor_ext.bitcast %extracted_slice_130 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_131 = tensor.collapse_shape %462 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %464 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_131, %463 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_132 = tensor.expand_shape %460 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %465 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_132, %464 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %466 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%465 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %467 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%466 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %468 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%467, %466 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %469 = iree_tensor_ext.bitcast %17 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_133 = tensor.expand_shape %469 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_134 = tensor.extract_slice %expanded_133[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_135 = tensor.expand_shape %extracted_slice_134 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %470 = iree_tensor_ext.bitcast %expanded_135 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_136 = tensor.extract_slice %expanded_133[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %471 = iree_tensor_ext.bitcast %extracted_slice_136 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_137 = tensor.collapse_shape %470 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %472 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_137, %471 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %473 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_132, %472 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %474 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%473 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %475 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%468, %474 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %476 = iree_tensor_ext.bitcast %18 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_138 = tensor.expand_shape %476 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_139 = tensor.extract_slice %expanded_138[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_140 = tensor.expand_shape %extracted_slice_139 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %477 = iree_tensor_ext.bitcast %expanded_140 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_141 = tensor.extract_slice %expanded_138[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %478 = iree_tensor_ext.bitcast %extracted_slice_141 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_142 = tensor.collapse_shape %477 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %479 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_142, %478 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_143 = tensor.expand_shape %475 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %480 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_143, %479 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %481 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%480 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %482 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%450, %481 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %483 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%482 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %484 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%483 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %485 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%484 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %486 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%485 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %487 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%486 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %488 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%487 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %489 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%483, %488 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %490 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%489 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %491 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%19, %490 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %492 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%491 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %493 = iree_tensor_ext.bitcast %20 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_144 = tensor.expand_shape %493 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_145 = tensor.extract_slice %expanded_144[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_146 = tensor.expand_shape %extracted_slice_145 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %494 = iree_tensor_ext.bitcast %expanded_146 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_147 = tensor.extract_slice %expanded_144[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %495 = iree_tensor_ext.bitcast %extracted_slice_147 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_148 = tensor.collapse_shape %494 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %496 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_148, %495 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_149 = tensor.expand_shape %492 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %497 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_149, %496 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %498 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%497 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %499 = iree_tensor_ext.bitcast %21 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_150 = tensor.expand_shape %499 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_151 = tensor.extract_slice %expanded_150[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_152 = tensor.expand_shape %extracted_slice_151 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %500 = iree_tensor_ext.bitcast %expanded_152 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_153 = tensor.extract_slice %expanded_150[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %501 = iree_tensor_ext.bitcast %extracted_slice_153 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_154 = tensor.collapse_shape %500 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %502 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_154, %501 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %503 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_149, %502 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %504 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%503 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %505 = iree_tensor_ext.bitcast %22 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_155 = tensor.expand_shape %505 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_156 = tensor.extract_slice %expanded_155[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_157 = tensor.expand_shape %extracted_slice_156 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %506 = iree_tensor_ext.bitcast %expanded_157 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_158 = tensor.extract_slice %expanded_155[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %507 = iree_tensor_ext.bitcast %extracted_slice_158 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_159 = tensor.collapse_shape %506 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %508 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_159, %507 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %509 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_149, %508 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %510 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%509 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_160 = tensor.expand_shape %498 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_161 = tensor.expand_shape %504 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_162 = tensor.expand_shape %510 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_4 = util.global.load immutable @__hoisted_tensor_32xf32_4 : tensor<32xf32>
    %expanded_163 = tensor.expand_shape %__hoisted_tensor_32xf32_4 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %511 = linalg.batch_mmt4d ins(%expanded_163, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_164 = linalg.unpack %511 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %512 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_164 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_165 = tensor.collapse_shape %512 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %513 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_165, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %514 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%513 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %515 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_164 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_166 = tensor.collapse_shape %515 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %516 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_166, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %517 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%516 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_167 = tensor.extract_slice %expanded_160[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_168 = tensor.extract_slice %expanded_160[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %518 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_167, %514 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %519 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_168, %517 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %520 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%518, %519 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %521 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_168, %514 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %522 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_167, %517 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %523 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%521, %522 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_5 = util.global.load immutable @__hoisted_tensor_32xf32_5 : tensor<32xf32>
    %expanded_169 = tensor.expand_shape %__hoisted_tensor_32xf32_5 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %524 = linalg.batch_mmt4d ins(%expanded_169, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_170 = linalg.unpack %524 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %525 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_170 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_171 = tensor.collapse_shape %525 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %526 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_171, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %527 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%526 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %528 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_170 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_172 = tensor.collapse_shape %528 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %529 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_172, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %530 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%529 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_173 = tensor.extract_slice %expanded_161[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_174 = tensor.extract_slice %expanded_161[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %531 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_173, %527 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %532 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_174, %530 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %533 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%531, %532 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %534 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_174, %527 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %535 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_173, %530 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %536 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%534, %535 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %537 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%533, %536 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_175 = tensor.collapse_shape %537 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %538 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %539 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%538 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_176 = tensor.collapse_shape %539 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_177 = tensor.expand_shape %collapsed_175 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %540 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_177 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_178 = tensor.collapse_shape %540 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %541 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_178, %collapsed_176 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%438 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %542 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%539 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_179 = tensor.collapse_shape %542 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_180 = tensor.expand_shape %510 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %543 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_180 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_181 = tensor.collapse_shape %543 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %544 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_181, %collapsed_179 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%541 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %545 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%520, %523 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %546 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_175 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_182 = tensor.collapse_shape %545 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_183 = tensor.collapse_shape %546 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %547 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_162 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_184 = tensor.collapse_shape %547 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %548 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_182, %collapsed_183, %collapsed_184, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_185 = tensor.expand_shape %548 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %549 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_185 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_186 = tensor.collapse_shape %549 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %550 = iree_tensor_ext.bitcast %23 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_187 = tensor.expand_shape %550 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_188 = tensor.extract_slice %expanded_187[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_189 = tensor.expand_shape %extracted_slice_188 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %551 = iree_tensor_ext.bitcast %expanded_189 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_190 = tensor.extract_slice %expanded_187[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %552 = iree_tensor_ext.bitcast %extracted_slice_190 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_191 = tensor.collapse_shape %551 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %553 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_191, %552 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_192 = tensor.expand_shape %collapsed_186 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %554 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_192, %553 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %555 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%554 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %556 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%482, %555 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %557 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%556 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %558 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%557 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %559 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%558 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %560 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%559 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %561 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%560 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %562 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%561 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %563 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%557, %562 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %564 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%563 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %565 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%24, %564 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %566 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%565 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %567 = iree_tensor_ext.bitcast %25 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_193 = tensor.expand_shape %567 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_194 = tensor.extract_slice %expanded_193[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_195 = tensor.expand_shape %extracted_slice_194 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %568 = iree_tensor_ext.bitcast %expanded_195 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_196 = tensor.extract_slice %expanded_193[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %569 = iree_tensor_ext.bitcast %extracted_slice_196 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_197 = tensor.collapse_shape %568 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %570 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_197, %569 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_198 = tensor.expand_shape %566 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %571 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_198, %570 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %572 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%571 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %573 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%572 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %574 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%573, %572 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %575 = iree_tensor_ext.bitcast %26 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_199 = tensor.expand_shape %575 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_200 = tensor.extract_slice %expanded_199[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_201 = tensor.expand_shape %extracted_slice_200 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %576 = iree_tensor_ext.bitcast %expanded_201 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_202 = tensor.extract_slice %expanded_199[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %577 = iree_tensor_ext.bitcast %extracted_slice_202 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_203 = tensor.collapse_shape %576 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %578 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_203, %577 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %579 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_198, %578 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %580 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%579 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %581 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%574, %580 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %582 = iree_tensor_ext.bitcast %27 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_204 = tensor.expand_shape %582 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_205 = tensor.extract_slice %expanded_204[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_206 = tensor.expand_shape %extracted_slice_205 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %583 = iree_tensor_ext.bitcast %expanded_206 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_207 = tensor.extract_slice %expanded_204[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %584 = iree_tensor_ext.bitcast %extracted_slice_207 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_208 = tensor.collapse_shape %583 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %585 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_208, %584 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_209 = tensor.expand_shape %581 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %586 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_209, %585 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %587 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%586 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %588 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%556, %587 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %589 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%588 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %590 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%589 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %591 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%590 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %592 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%591 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %593 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%592 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %594 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%593 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %595 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%589, %594 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %596 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%595 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %597 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%28, %596 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %598 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%597 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %599 = iree_tensor_ext.bitcast %29 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_210 = tensor.expand_shape %599 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_211 = tensor.extract_slice %expanded_210[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_212 = tensor.expand_shape %extracted_slice_211 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %600 = iree_tensor_ext.bitcast %expanded_212 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_213 = tensor.extract_slice %expanded_210[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %601 = iree_tensor_ext.bitcast %extracted_slice_213 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_214 = tensor.collapse_shape %600 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %602 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_214, %601 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_215 = tensor.expand_shape %598 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %603 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_215, %602 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %604 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%603 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %605 = iree_tensor_ext.bitcast %30 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_216 = tensor.expand_shape %605 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_217 = tensor.extract_slice %expanded_216[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_218 = tensor.expand_shape %extracted_slice_217 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %606 = iree_tensor_ext.bitcast %expanded_218 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_219 = tensor.extract_slice %expanded_216[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %607 = iree_tensor_ext.bitcast %extracted_slice_219 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_220 = tensor.collapse_shape %606 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %608 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_220, %607 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %609 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_215, %608 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %610 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%609 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %611 = iree_tensor_ext.bitcast %31 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_221 = tensor.expand_shape %611 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_222 = tensor.extract_slice %expanded_221[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_223 = tensor.expand_shape %extracted_slice_222 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %612 = iree_tensor_ext.bitcast %expanded_223 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_224 = tensor.extract_slice %expanded_221[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %613 = iree_tensor_ext.bitcast %extracted_slice_224 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_225 = tensor.collapse_shape %612 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %614 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_225, %613 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %615 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_215, %614 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %616 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%615 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_226 = tensor.expand_shape %604 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_227 = tensor.expand_shape %610 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_228 = tensor.expand_shape %616 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_6 = util.global.load immutable @__hoisted_tensor_32xf32_6 : tensor<32xf32>
    %expanded_229 = tensor.expand_shape %__hoisted_tensor_32xf32_6 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %617 = linalg.batch_mmt4d ins(%expanded_229, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_230 = linalg.unpack %617 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %618 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_230 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_231 = tensor.collapse_shape %618 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %619 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_231, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %620 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%619 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %621 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_230 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_232 = tensor.collapse_shape %621 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %622 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_232, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %623 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%622 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_233 = tensor.extract_slice %expanded_226[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_234 = tensor.extract_slice %expanded_226[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %624 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_233, %620 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %625 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_234, %623 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %626 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%624, %625 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %627 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_234, %620 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %628 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_233, %623 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %629 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%627, %628 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_7 = util.global.load immutable @__hoisted_tensor_32xf32_7 : tensor<32xf32>
    %expanded_235 = tensor.expand_shape %__hoisted_tensor_32xf32_7 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %630 = linalg.batch_mmt4d ins(%expanded_235, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_236 = linalg.unpack %630 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %631 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_236 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_237 = tensor.collapse_shape %631 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %632 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_237, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %633 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%632 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %634 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_236 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_238 = tensor.collapse_shape %634 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %635 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_238, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %636 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%635 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_239 = tensor.extract_slice %expanded_227[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_240 = tensor.extract_slice %expanded_227[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %637 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_239, %633 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %638 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_240, %636 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %639 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%637, %638 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %640 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_240, %633 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %641 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_239, %636 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %642 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%640, %641 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %643 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%639, %642 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_241 = tensor.collapse_shape %643 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %644 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c3_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %645 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%644 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_242 = tensor.collapse_shape %645 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_243 = tensor.expand_shape %collapsed_241 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %646 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_243 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_244 = tensor.collapse_shape %646 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %647 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_244, %collapsed_242 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%544 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %648 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%645 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_245 = tensor.collapse_shape %648 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_246 = tensor.expand_shape %616 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %649 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_246 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_247 = tensor.collapse_shape %649 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %650 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_247, %collapsed_245 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%647 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %651 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%626, %629 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %652 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_241 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_248 = tensor.collapse_shape %651 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_249 = tensor.collapse_shape %652 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %653 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_228 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_250 = tensor.collapse_shape %653 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %654 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_248, %collapsed_249, %collapsed_250, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_251 = tensor.expand_shape %654 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %655 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_251 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_252 = tensor.collapse_shape %655 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %656 = iree_tensor_ext.bitcast %32 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_253 = tensor.expand_shape %656 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_254 = tensor.extract_slice %expanded_253[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_255 = tensor.expand_shape %extracted_slice_254 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %657 = iree_tensor_ext.bitcast %expanded_255 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_256 = tensor.extract_slice %expanded_253[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %658 = iree_tensor_ext.bitcast %extracted_slice_256 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_257 = tensor.collapse_shape %657 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %659 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_257, %658 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_258 = tensor.expand_shape %collapsed_252 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %660 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_258, %659 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %661 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%660 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %662 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%588, %661 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %663 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%662 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %664 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%663 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %665 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%664 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %666 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%665 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %667 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%666 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %668 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%667 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %669 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%663, %668 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %670 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%669 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %671 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%33, %670 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %672 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%671 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %673 = iree_tensor_ext.bitcast %34 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_259 = tensor.expand_shape %673 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_260 = tensor.extract_slice %expanded_259[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_261 = tensor.expand_shape %extracted_slice_260 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %674 = iree_tensor_ext.bitcast %expanded_261 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_262 = tensor.extract_slice %expanded_259[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %675 = iree_tensor_ext.bitcast %extracted_slice_262 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_263 = tensor.collapse_shape %674 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %676 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_263, %675 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_264 = tensor.expand_shape %672 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %677 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_264, %676 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %678 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%677 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %679 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%678 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %680 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%679, %678 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %681 = iree_tensor_ext.bitcast %35 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_265 = tensor.expand_shape %681 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_266 = tensor.extract_slice %expanded_265[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_267 = tensor.expand_shape %extracted_slice_266 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %682 = iree_tensor_ext.bitcast %expanded_267 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_268 = tensor.extract_slice %expanded_265[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %683 = iree_tensor_ext.bitcast %extracted_slice_268 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_269 = tensor.collapse_shape %682 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %684 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_269, %683 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %685 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_264, %684 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %686 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%685 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %687 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%680, %686 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %688 = iree_tensor_ext.bitcast %36 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_270 = tensor.expand_shape %688 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_271 = tensor.extract_slice %expanded_270[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_272 = tensor.expand_shape %extracted_slice_271 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %689 = iree_tensor_ext.bitcast %expanded_272 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_273 = tensor.extract_slice %expanded_270[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %690 = iree_tensor_ext.bitcast %extracted_slice_273 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_274 = tensor.collapse_shape %689 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %691 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_274, %690 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_275 = tensor.expand_shape %687 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %692 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_275, %691 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %693 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%692 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %694 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%662, %693 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %695 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%694 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %696 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%695 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %697 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%696 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %698 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%697 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %699 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%698 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %700 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%699 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %701 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%695, %700 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %702 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%701 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %703 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%37, %702 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %704 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%703 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %705 = iree_tensor_ext.bitcast %38 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_276 = tensor.expand_shape %705 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_277 = tensor.extract_slice %expanded_276[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_278 = tensor.expand_shape %extracted_slice_277 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %706 = iree_tensor_ext.bitcast %expanded_278 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_279 = tensor.extract_slice %expanded_276[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %707 = iree_tensor_ext.bitcast %extracted_slice_279 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_280 = tensor.collapse_shape %706 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %708 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_280, %707 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_281 = tensor.expand_shape %704 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %709 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_281, %708 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %710 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%709 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %711 = iree_tensor_ext.bitcast %39 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_282 = tensor.expand_shape %711 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_283 = tensor.extract_slice %expanded_282[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_284 = tensor.expand_shape %extracted_slice_283 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %712 = iree_tensor_ext.bitcast %expanded_284 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_285 = tensor.extract_slice %expanded_282[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %713 = iree_tensor_ext.bitcast %extracted_slice_285 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_286 = tensor.collapse_shape %712 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %714 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_286, %713 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %715 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_281, %714 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %716 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%715 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %717 = iree_tensor_ext.bitcast %40 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_287 = tensor.expand_shape %717 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_288 = tensor.extract_slice %expanded_287[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_289 = tensor.expand_shape %extracted_slice_288 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %718 = iree_tensor_ext.bitcast %expanded_289 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_290 = tensor.extract_slice %expanded_287[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %719 = iree_tensor_ext.bitcast %extracted_slice_290 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_291 = tensor.collapse_shape %718 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %720 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_291, %719 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %721 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_281, %720 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %722 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%721 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_292 = tensor.expand_shape %710 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_293 = tensor.expand_shape %716 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_294 = tensor.expand_shape %722 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_8 = util.global.load immutable @__hoisted_tensor_32xf32_8 : tensor<32xf32>
    %expanded_295 = tensor.expand_shape %__hoisted_tensor_32xf32_8 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %723 = linalg.batch_mmt4d ins(%expanded_295, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_296 = linalg.unpack %723 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %724 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_296 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_297 = tensor.collapse_shape %724 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %725 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_297, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %726 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%725 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %727 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_296 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_298 = tensor.collapse_shape %727 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %728 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_298, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %729 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%728 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_299 = tensor.extract_slice %expanded_292[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_300 = tensor.extract_slice %expanded_292[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %730 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_299, %726 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %731 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_300, %729 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %732 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%730, %731 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %733 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_300, %726 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %734 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_299, %729 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %735 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%733, %734 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_9 = util.global.load immutable @__hoisted_tensor_32xf32_9 : tensor<32xf32>
    %expanded_301 = tensor.expand_shape %__hoisted_tensor_32xf32_9 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %736 = linalg.batch_mmt4d ins(%expanded_301, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_302 = linalg.unpack %736 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %737 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_302 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_303 = tensor.collapse_shape %737 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %738 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_303, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %739 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%738 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %740 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_302 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_304 = tensor.collapse_shape %740 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %741 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_304, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %742 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%741 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_305 = tensor.extract_slice %expanded_293[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_306 = tensor.extract_slice %expanded_293[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %743 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_305, %739 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %744 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_306, %742 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %745 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%743, %744 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %746 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_306, %739 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %747 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_305, %742 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %748 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%746, %747 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %749 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%745, %748 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_307 = tensor.collapse_shape %749 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %750 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c4_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %751 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%750 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_308 = tensor.collapse_shape %751 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_309 = tensor.expand_shape %collapsed_307 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %752 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_309 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_310 = tensor.collapse_shape %752 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %753 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_310, %collapsed_308 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%650 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %754 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%751 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_311 = tensor.collapse_shape %754 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_312 = tensor.expand_shape %722 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %755 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_312 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_313 = tensor.collapse_shape %755 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %756 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_313, %collapsed_311 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%753 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %757 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%732, %735 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %758 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_307 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_314 = tensor.collapse_shape %757 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_315 = tensor.collapse_shape %758 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %759 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_294 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_316 = tensor.collapse_shape %759 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %760 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_314, %collapsed_315, %collapsed_316, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_317 = tensor.expand_shape %760 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %761 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_317 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_318 = tensor.collapse_shape %761 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %762 = iree_tensor_ext.bitcast %41 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_319 = tensor.expand_shape %762 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_320 = tensor.extract_slice %expanded_319[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_321 = tensor.expand_shape %extracted_slice_320 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %763 = iree_tensor_ext.bitcast %expanded_321 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_322 = tensor.extract_slice %expanded_319[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %764 = iree_tensor_ext.bitcast %extracted_slice_322 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_323 = tensor.collapse_shape %763 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %765 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_323, %764 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_324 = tensor.expand_shape %collapsed_318 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %766 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_324, %765 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %767 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%766 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %768 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%694, %767 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %769 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%768 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %770 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%769 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %771 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%770 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %772 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%771 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %773 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%772 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %774 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%773 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %775 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%769, %774 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %776 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%775 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %777 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%42, %776 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %778 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%777 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %779 = iree_tensor_ext.bitcast %43 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_325 = tensor.expand_shape %779 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_326 = tensor.extract_slice %expanded_325[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_327 = tensor.expand_shape %extracted_slice_326 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %780 = iree_tensor_ext.bitcast %expanded_327 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_328 = tensor.extract_slice %expanded_325[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %781 = iree_tensor_ext.bitcast %extracted_slice_328 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_329 = tensor.collapse_shape %780 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %782 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_329, %781 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_330 = tensor.expand_shape %778 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %783 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_330, %782 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %784 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%783 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %785 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%784 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %786 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%785, %784 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %787 = iree_tensor_ext.bitcast %44 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_331 = tensor.expand_shape %787 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_332 = tensor.extract_slice %expanded_331[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_333 = tensor.expand_shape %extracted_slice_332 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %788 = iree_tensor_ext.bitcast %expanded_333 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_334 = tensor.extract_slice %expanded_331[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %789 = iree_tensor_ext.bitcast %extracted_slice_334 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_335 = tensor.collapse_shape %788 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %790 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_335, %789 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %791 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_330, %790 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %792 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%791 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %793 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%786, %792 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %794 = iree_tensor_ext.bitcast %45 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_336 = tensor.expand_shape %794 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_337 = tensor.extract_slice %expanded_336[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_338 = tensor.expand_shape %extracted_slice_337 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %795 = iree_tensor_ext.bitcast %expanded_338 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_339 = tensor.extract_slice %expanded_336[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %796 = iree_tensor_ext.bitcast %extracted_slice_339 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_340 = tensor.collapse_shape %795 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %797 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_340, %796 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_341 = tensor.expand_shape %793 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %798 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_341, %797 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %799 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%798 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %800 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%768, %799 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %801 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%800 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %802 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%801 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %803 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%802 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %804 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%803 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %805 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%804 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %806 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%805 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %807 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%801, %806 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %808 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%807 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %809 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%46, %808 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %810 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%809 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %811 = iree_tensor_ext.bitcast %47 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_342 = tensor.expand_shape %811 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_343 = tensor.extract_slice %expanded_342[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_344 = tensor.expand_shape %extracted_slice_343 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %812 = iree_tensor_ext.bitcast %expanded_344 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_345 = tensor.extract_slice %expanded_342[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %813 = iree_tensor_ext.bitcast %extracted_slice_345 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_346 = tensor.collapse_shape %812 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %814 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_346, %813 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_347 = tensor.expand_shape %810 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %815 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_347, %814 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %816 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%815 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %817 = iree_tensor_ext.bitcast %48 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_348 = tensor.expand_shape %817 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_349 = tensor.extract_slice %expanded_348[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_350 = tensor.expand_shape %extracted_slice_349 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %818 = iree_tensor_ext.bitcast %expanded_350 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_351 = tensor.extract_slice %expanded_348[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %819 = iree_tensor_ext.bitcast %extracted_slice_351 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_352 = tensor.collapse_shape %818 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %820 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_352, %819 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %821 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_347, %820 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %822 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%821 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %823 = iree_tensor_ext.bitcast %49 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_353 = tensor.expand_shape %823 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_354 = tensor.extract_slice %expanded_353[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_355 = tensor.expand_shape %extracted_slice_354 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %824 = iree_tensor_ext.bitcast %expanded_355 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_356 = tensor.extract_slice %expanded_353[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %825 = iree_tensor_ext.bitcast %extracted_slice_356 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_357 = tensor.collapse_shape %824 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %826 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_357, %825 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %827 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_347, %826 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %828 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%827 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_358 = tensor.expand_shape %816 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_359 = tensor.expand_shape %822 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_360 = tensor.expand_shape %828 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_10 = util.global.load immutable @__hoisted_tensor_32xf32_10 : tensor<32xf32>
    %expanded_361 = tensor.expand_shape %__hoisted_tensor_32xf32_10 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %829 = linalg.batch_mmt4d ins(%expanded_361, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_362 = linalg.unpack %829 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %830 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_362 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_363 = tensor.collapse_shape %830 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %831 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_363, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %832 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%831 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %833 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_362 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_364 = tensor.collapse_shape %833 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %834 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_364, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %835 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%834 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_365 = tensor.extract_slice %expanded_358[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_366 = tensor.extract_slice %expanded_358[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %836 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_365, %832 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %837 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_366, %835 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %838 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%836, %837 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %839 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_366, %832 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %840 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_365, %835 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %841 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%839, %840 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_11 = util.global.load immutable @__hoisted_tensor_32xf32_11 : tensor<32xf32>
    %expanded_367 = tensor.expand_shape %__hoisted_tensor_32xf32_11 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %842 = linalg.batch_mmt4d ins(%expanded_367, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_368 = linalg.unpack %842 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %843 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_368 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_369 = tensor.collapse_shape %843 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %844 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_369, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %845 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%844 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %846 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_368 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_370 = tensor.collapse_shape %846 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %847 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_370, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %848 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%847 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_371 = tensor.extract_slice %expanded_359[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_372 = tensor.extract_slice %expanded_359[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %849 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_371, %845 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %850 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_372, %848 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %851 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%849, %850 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %852 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_372, %845 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %853 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_371, %848 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %854 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%852, %853 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %855 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%851, %854 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_373 = tensor.collapse_shape %855 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %856 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c5_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %857 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%856 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_374 = tensor.collapse_shape %857 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_375 = tensor.expand_shape %collapsed_373 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %858 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_375 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_376 = tensor.collapse_shape %858 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %859 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_376, %collapsed_374 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%756 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %860 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%857 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_377 = tensor.collapse_shape %860 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_378 = tensor.expand_shape %828 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %861 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_378 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_379 = tensor.collapse_shape %861 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %862 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_379, %collapsed_377 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%859 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %863 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%838, %841 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %864 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_373 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_380 = tensor.collapse_shape %863 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_381 = tensor.collapse_shape %864 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %865 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_360 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_382 = tensor.collapse_shape %865 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %866 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_380, %collapsed_381, %collapsed_382, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_383 = tensor.expand_shape %866 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %867 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_383 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_384 = tensor.collapse_shape %867 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %868 = iree_tensor_ext.bitcast %50 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_385 = tensor.expand_shape %868 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_386 = tensor.extract_slice %expanded_385[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_387 = tensor.expand_shape %extracted_slice_386 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %869 = iree_tensor_ext.bitcast %expanded_387 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_388 = tensor.extract_slice %expanded_385[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %870 = iree_tensor_ext.bitcast %extracted_slice_388 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_389 = tensor.collapse_shape %869 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %871 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_389, %870 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_390 = tensor.expand_shape %collapsed_384 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %872 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_390, %871 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %873 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%872 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %874 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%800, %873 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %875 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%874 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %876 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%875 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %877 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%876 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %878 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%877 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %879 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%878 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %880 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%879 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %881 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%875, %880 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %882 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%881 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %883 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%51, %882 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %884 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%883 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %885 = iree_tensor_ext.bitcast %52 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_391 = tensor.expand_shape %885 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_392 = tensor.extract_slice %expanded_391[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_393 = tensor.expand_shape %extracted_slice_392 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %886 = iree_tensor_ext.bitcast %expanded_393 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_394 = tensor.extract_slice %expanded_391[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %887 = iree_tensor_ext.bitcast %extracted_slice_394 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_395 = tensor.collapse_shape %886 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %888 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_395, %887 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_396 = tensor.expand_shape %884 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %889 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_396, %888 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %890 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%889 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %891 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%890 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %892 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%891, %890 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %893 = iree_tensor_ext.bitcast %53 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_397 = tensor.expand_shape %893 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_398 = tensor.extract_slice %expanded_397[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_399 = tensor.expand_shape %extracted_slice_398 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %894 = iree_tensor_ext.bitcast %expanded_399 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_400 = tensor.extract_slice %expanded_397[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %895 = iree_tensor_ext.bitcast %extracted_slice_400 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_401 = tensor.collapse_shape %894 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %896 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_401, %895 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %897 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_396, %896 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %898 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%897 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %899 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%892, %898 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %900 = iree_tensor_ext.bitcast %54 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_402 = tensor.expand_shape %900 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_403 = tensor.extract_slice %expanded_402[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_404 = tensor.expand_shape %extracted_slice_403 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %901 = iree_tensor_ext.bitcast %expanded_404 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_405 = tensor.extract_slice %expanded_402[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %902 = iree_tensor_ext.bitcast %extracted_slice_405 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_406 = tensor.collapse_shape %901 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %903 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_406, %902 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_407 = tensor.expand_shape %899 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %904 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_407, %903 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %905 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%904 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %906 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%874, %905 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %907 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%906 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %908 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%907 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %909 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%908 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %910 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%909 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %911 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%910 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %912 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%911 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %913 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%907, %912 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %914 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%913 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %915 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%55, %914 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %916 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%915 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %917 = iree_tensor_ext.bitcast %56 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_408 = tensor.expand_shape %917 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_409 = tensor.extract_slice %expanded_408[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_410 = tensor.expand_shape %extracted_slice_409 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %918 = iree_tensor_ext.bitcast %expanded_410 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_411 = tensor.extract_slice %expanded_408[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %919 = iree_tensor_ext.bitcast %extracted_slice_411 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_412 = tensor.collapse_shape %918 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %920 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_412, %919 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_413 = tensor.expand_shape %916 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %921 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_413, %920 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %922 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%921 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %923 = iree_tensor_ext.bitcast %57 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_414 = tensor.expand_shape %923 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_415 = tensor.extract_slice %expanded_414[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_416 = tensor.expand_shape %extracted_slice_415 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %924 = iree_tensor_ext.bitcast %expanded_416 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_417 = tensor.extract_slice %expanded_414[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %925 = iree_tensor_ext.bitcast %extracted_slice_417 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_418 = tensor.collapse_shape %924 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %926 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_418, %925 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %927 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_413, %926 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %928 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%927 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %929 = iree_tensor_ext.bitcast %58 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_419 = tensor.expand_shape %929 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_420 = tensor.extract_slice %expanded_419[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_421 = tensor.expand_shape %extracted_slice_420 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %930 = iree_tensor_ext.bitcast %expanded_421 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_422 = tensor.extract_slice %expanded_419[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %931 = iree_tensor_ext.bitcast %extracted_slice_422 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_423 = tensor.collapse_shape %930 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %932 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_423, %931 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %933 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_413, %932 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %934 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%933 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_424 = tensor.expand_shape %922 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_425 = tensor.expand_shape %928 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_426 = tensor.expand_shape %934 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_12 = util.global.load immutable @__hoisted_tensor_32xf32_12 : tensor<32xf32>
    %expanded_427 = tensor.expand_shape %__hoisted_tensor_32xf32_12 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %935 = linalg.batch_mmt4d ins(%expanded_427, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_428 = linalg.unpack %935 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %936 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_428 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_429 = tensor.collapse_shape %936 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %937 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_429, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %938 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%937 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %939 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_428 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_430 = tensor.collapse_shape %939 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %940 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_430, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %941 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%940 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_431 = tensor.extract_slice %expanded_424[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_432 = tensor.extract_slice %expanded_424[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %942 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_431, %938 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %943 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_432, %941 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %944 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%942, %943 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %945 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_432, %938 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %946 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_431, %941 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %947 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%945, %946 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_13 = util.global.load immutable @__hoisted_tensor_32xf32_13 : tensor<32xf32>
    %expanded_433 = tensor.expand_shape %__hoisted_tensor_32xf32_13 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %948 = linalg.batch_mmt4d ins(%expanded_433, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_434 = linalg.unpack %948 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %949 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_434 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_435 = tensor.collapse_shape %949 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %950 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_435, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %951 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%950 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %952 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_434 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_436 = tensor.collapse_shape %952 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %953 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_436, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %954 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%953 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_437 = tensor.extract_slice %expanded_425[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_438 = tensor.extract_slice %expanded_425[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %955 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_437, %951 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %956 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_438, %954 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %957 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%955, %956 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %958 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_438, %951 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %959 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_437, %954 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %960 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%958, %959 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %961 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%957, %960 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_439 = tensor.collapse_shape %961 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %962 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c6_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %963 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%962 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_440 = tensor.collapse_shape %963 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_441 = tensor.expand_shape %collapsed_439 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %964 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_441 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_442 = tensor.collapse_shape %964 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %965 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_442, %collapsed_440 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%862 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %966 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%963 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_443 = tensor.collapse_shape %966 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_444 = tensor.expand_shape %934 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %967 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_444 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_445 = tensor.collapse_shape %967 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %968 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_445, %collapsed_443 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%965 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %969 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%944, %947 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %970 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_439 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_446 = tensor.collapse_shape %969 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_447 = tensor.collapse_shape %970 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %971 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_426 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_448 = tensor.collapse_shape %971 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %972 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_446, %collapsed_447, %collapsed_448, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_449 = tensor.expand_shape %972 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %973 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_449 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_450 = tensor.collapse_shape %973 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %974 = iree_tensor_ext.bitcast %59 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_451 = tensor.expand_shape %974 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_452 = tensor.extract_slice %expanded_451[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_453 = tensor.expand_shape %extracted_slice_452 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %975 = iree_tensor_ext.bitcast %expanded_453 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_454 = tensor.extract_slice %expanded_451[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %976 = iree_tensor_ext.bitcast %extracted_slice_454 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_455 = tensor.collapse_shape %975 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %977 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_455, %976 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_456 = tensor.expand_shape %collapsed_450 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %978 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_456, %977 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %979 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%978 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %980 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%906, %979 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %981 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%980 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %982 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%981 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %983 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%982 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %984 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%983 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %985 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%984 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %986 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%985 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %987 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%981, %986 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %988 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%987 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %989 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%60, %988 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %990 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%989 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %991 = iree_tensor_ext.bitcast %61 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_457 = tensor.expand_shape %991 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_458 = tensor.extract_slice %expanded_457[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_459 = tensor.expand_shape %extracted_slice_458 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %992 = iree_tensor_ext.bitcast %expanded_459 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_460 = tensor.extract_slice %expanded_457[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %993 = iree_tensor_ext.bitcast %extracted_slice_460 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_461 = tensor.collapse_shape %992 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %994 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_461, %993 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_462 = tensor.expand_shape %990 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %995 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_462, %994 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %996 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%995 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %997 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%996 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %998 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%997, %996 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %999 = iree_tensor_ext.bitcast %62 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_463 = tensor.expand_shape %999 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_464 = tensor.extract_slice %expanded_463[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_465 = tensor.expand_shape %extracted_slice_464 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1000 = iree_tensor_ext.bitcast %expanded_465 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_466 = tensor.extract_slice %expanded_463[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1001 = iree_tensor_ext.bitcast %extracted_slice_466 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_467 = tensor.collapse_shape %1000 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1002 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_467, %1001 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1003 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_462, %1002 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1004 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1003 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1005 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%998, %1004 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1006 = iree_tensor_ext.bitcast %63 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_468 = tensor.expand_shape %1006 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_469 = tensor.extract_slice %expanded_468[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_470 = tensor.expand_shape %extracted_slice_469 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1007 = iree_tensor_ext.bitcast %expanded_470 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_471 = tensor.extract_slice %expanded_468[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1008 = iree_tensor_ext.bitcast %extracted_slice_471 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_472 = tensor.collapse_shape %1007 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1009 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_472, %1008 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_473 = tensor.expand_shape %1005 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1010 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_473, %1009 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1011 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1010 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1012 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%980, %1011 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1013 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1012 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1014 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1013 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1015 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1014 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1016 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1015 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1017 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1016 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1018 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1017 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1019 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1013, %1018 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1020 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1019 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1021 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%64, %1020 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1022 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1021 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1023 = iree_tensor_ext.bitcast %65 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_474 = tensor.expand_shape %1023 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_475 = tensor.extract_slice %expanded_474[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_476 = tensor.expand_shape %extracted_slice_475 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1024 = iree_tensor_ext.bitcast %expanded_476 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_477 = tensor.extract_slice %expanded_474[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1025 = iree_tensor_ext.bitcast %extracted_slice_477 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_478 = tensor.collapse_shape %1024 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1026 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_478, %1025 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_479 = tensor.expand_shape %1022 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1027 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_479, %1026 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1028 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1027 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1029 = iree_tensor_ext.bitcast %66 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_480 = tensor.expand_shape %1029 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_481 = tensor.extract_slice %expanded_480[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_482 = tensor.expand_shape %extracted_slice_481 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1030 = iree_tensor_ext.bitcast %expanded_482 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_483 = tensor.extract_slice %expanded_480[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1031 = iree_tensor_ext.bitcast %extracted_slice_483 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_484 = tensor.collapse_shape %1030 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1032 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_484, %1031 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1033 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_479, %1032 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1034 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1033 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1035 = iree_tensor_ext.bitcast %67 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_485 = tensor.expand_shape %1035 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_486 = tensor.extract_slice %expanded_485[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_487 = tensor.expand_shape %extracted_slice_486 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1036 = iree_tensor_ext.bitcast %expanded_487 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_488 = tensor.extract_slice %expanded_485[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1037 = iree_tensor_ext.bitcast %extracted_slice_488 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_489 = tensor.collapse_shape %1036 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1038 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_489, %1037 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1039 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_479, %1038 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1040 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1039 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_490 = tensor.expand_shape %1028 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_491 = tensor.expand_shape %1034 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_492 = tensor.expand_shape %1040 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_14 = util.global.load immutable @__hoisted_tensor_32xf32_14 : tensor<32xf32>
    %expanded_493 = tensor.expand_shape %__hoisted_tensor_32xf32_14 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1041 = linalg.batch_mmt4d ins(%expanded_493, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_494 = linalg.unpack %1041 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1042 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_494 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_495 = tensor.collapse_shape %1042 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1043 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_495, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1044 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1043 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1045 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_494 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_496 = tensor.collapse_shape %1045 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1046 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_496, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1047 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1046 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_497 = tensor.extract_slice %expanded_490[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_498 = tensor.extract_slice %expanded_490[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1048 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_497, %1044 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1049 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_498, %1047 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1050 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1048, %1049 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1051 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_498, %1044 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1052 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_497, %1047 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1053 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1051, %1052 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_15 = util.global.load immutable @__hoisted_tensor_32xf32_15 : tensor<32xf32>
    %expanded_499 = tensor.expand_shape %__hoisted_tensor_32xf32_15 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1054 = linalg.batch_mmt4d ins(%expanded_499, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_500 = linalg.unpack %1054 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1055 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_500 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_501 = tensor.collapse_shape %1055 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1056 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_501, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1057 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1056 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1058 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_500 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_502 = tensor.collapse_shape %1058 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1059 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_502, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1060 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1059 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_503 = tensor.extract_slice %expanded_491[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_504 = tensor.extract_slice %expanded_491[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1061 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_503, %1057 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1062 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_504, %1060 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1063 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1061, %1062 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1064 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_504, %1057 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1065 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_503, %1060 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1066 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1064, %1065 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1067 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1063, %1066 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_505 = tensor.collapse_shape %1067 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1068 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c7_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1069 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1068 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_506 = tensor.collapse_shape %1069 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_507 = tensor.expand_shape %collapsed_505 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1070 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_507 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_508 = tensor.collapse_shape %1070 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1071 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_508, %collapsed_506 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%968 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1072 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1069 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_509 = tensor.collapse_shape %1072 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_510 = tensor.expand_shape %1040 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1073 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_510 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_511 = tensor.collapse_shape %1073 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1074 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_511, %collapsed_509 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1071 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1075 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1050, %1053 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1076 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_505 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_512 = tensor.collapse_shape %1075 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_513 = tensor.collapse_shape %1076 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1077 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_492 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_514 = tensor.collapse_shape %1077 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1078 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_512, %collapsed_513, %collapsed_514, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_515 = tensor.expand_shape %1078 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1079 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_515 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_516 = tensor.collapse_shape %1079 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1080 = iree_tensor_ext.bitcast %68 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_517 = tensor.expand_shape %1080 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_518 = tensor.extract_slice %expanded_517[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_519 = tensor.expand_shape %extracted_slice_518 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1081 = iree_tensor_ext.bitcast %expanded_519 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_520 = tensor.extract_slice %expanded_517[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1082 = iree_tensor_ext.bitcast %extracted_slice_520 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_521 = tensor.collapse_shape %1081 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1083 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_521, %1082 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_522 = tensor.expand_shape %collapsed_516 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1084 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_522, %1083 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1085 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1084 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1086 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1012, %1085 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1087 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1086 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1088 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1087 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1089 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1088 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1090 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1089 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1091 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1090 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1092 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1091 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1093 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1087, %1092 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1094 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1093 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1095 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%69, %1094 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1096 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1095 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1097 = iree_tensor_ext.bitcast %70 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_523 = tensor.expand_shape %1097 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_524 = tensor.extract_slice %expanded_523[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_525 = tensor.expand_shape %extracted_slice_524 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1098 = iree_tensor_ext.bitcast %expanded_525 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_526 = tensor.extract_slice %expanded_523[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1099 = iree_tensor_ext.bitcast %extracted_slice_526 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_527 = tensor.collapse_shape %1098 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1100 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_527, %1099 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_528 = tensor.expand_shape %1096 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1101 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_528, %1100 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1101 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1103 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1102 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1104 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1103, %1102 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1105 = iree_tensor_ext.bitcast %71 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_529 = tensor.expand_shape %1105 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_530 = tensor.extract_slice %expanded_529[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_531 = tensor.expand_shape %extracted_slice_530 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1106 = iree_tensor_ext.bitcast %expanded_531 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_532 = tensor.extract_slice %expanded_529[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1107 = iree_tensor_ext.bitcast %extracted_slice_532 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_533 = tensor.collapse_shape %1106 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1108 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_533, %1107 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1109 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_528, %1108 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1110 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1109 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1111 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1104, %1110 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1112 = iree_tensor_ext.bitcast %72 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_534 = tensor.expand_shape %1112 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_535 = tensor.extract_slice %expanded_534[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_536 = tensor.expand_shape %extracted_slice_535 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1113 = iree_tensor_ext.bitcast %expanded_536 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_537 = tensor.extract_slice %expanded_534[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1114 = iree_tensor_ext.bitcast %extracted_slice_537 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_538 = tensor.collapse_shape %1113 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1115 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_538, %1114 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_539 = tensor.expand_shape %1111 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1116 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_539, %1115 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1117 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1116 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1118 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1086, %1117 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1119 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1118 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1120 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1119 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1121 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1120 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1122 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1121 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1123 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1122 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1124 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1123 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1125 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1119, %1124 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1126 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1125 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1127 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%73, %1126 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1128 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1127 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1129 = iree_tensor_ext.bitcast %74 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_540 = tensor.expand_shape %1129 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_541 = tensor.extract_slice %expanded_540[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_542 = tensor.expand_shape %extracted_slice_541 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1130 = iree_tensor_ext.bitcast %expanded_542 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_543 = tensor.extract_slice %expanded_540[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1131 = iree_tensor_ext.bitcast %extracted_slice_543 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_544 = tensor.collapse_shape %1130 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1132 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_544, %1131 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_545 = tensor.expand_shape %1128 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1133 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_545, %1132 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1134 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1133 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1135 = iree_tensor_ext.bitcast %75 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_546 = tensor.expand_shape %1135 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_547 = tensor.extract_slice %expanded_546[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_548 = tensor.expand_shape %extracted_slice_547 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1136 = iree_tensor_ext.bitcast %expanded_548 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_549 = tensor.extract_slice %expanded_546[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1137 = iree_tensor_ext.bitcast %extracted_slice_549 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_550 = tensor.collapse_shape %1136 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1138 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_550, %1137 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1139 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_545, %1138 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1140 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1139 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1141 = iree_tensor_ext.bitcast %76 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_551 = tensor.expand_shape %1141 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_552 = tensor.extract_slice %expanded_551[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_553 = tensor.expand_shape %extracted_slice_552 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1142 = iree_tensor_ext.bitcast %expanded_553 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_554 = tensor.extract_slice %expanded_551[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1143 = iree_tensor_ext.bitcast %extracted_slice_554 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_555 = tensor.collapse_shape %1142 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1144 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_555, %1143 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1145 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_545, %1144 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1146 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1145 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_556 = tensor.expand_shape %1134 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_557 = tensor.expand_shape %1140 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_558 = tensor.expand_shape %1146 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_16 = util.global.load immutable @__hoisted_tensor_32xf32_16 : tensor<32xf32>
    %expanded_559 = tensor.expand_shape %__hoisted_tensor_32xf32_16 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1147 = linalg.batch_mmt4d ins(%expanded_559, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_560 = linalg.unpack %1147 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1148 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_560 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_561 = tensor.collapse_shape %1148 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1149 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_561, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1150 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1149 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1151 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_560 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_562 = tensor.collapse_shape %1151 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1152 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_562, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1153 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1152 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_563 = tensor.extract_slice %expanded_556[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_564 = tensor.extract_slice %expanded_556[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1154 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_563, %1150 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1155 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_564, %1153 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1156 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1154, %1155 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1157 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_564, %1150 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1158 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_563, %1153 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1159 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1157, %1158 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_17 = util.global.load immutable @__hoisted_tensor_32xf32_17 : tensor<32xf32>
    %expanded_565 = tensor.expand_shape %__hoisted_tensor_32xf32_17 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1160 = linalg.batch_mmt4d ins(%expanded_565, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_566 = linalg.unpack %1160 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1161 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_566 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_567 = tensor.collapse_shape %1161 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1162 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_567, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1163 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1162 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1164 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_566 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_568 = tensor.collapse_shape %1164 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1165 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_568, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1166 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1165 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_569 = tensor.extract_slice %expanded_557[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_570 = tensor.extract_slice %expanded_557[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1167 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_569, %1163 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1168 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_570, %1166 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1169 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1167, %1168 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1170 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_570, %1163 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1171 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_569, %1166 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1172 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1170, %1171 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1173 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1169, %1172 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_571 = tensor.collapse_shape %1173 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1174 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c8_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1175 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1174 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_572 = tensor.collapse_shape %1175 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_573 = tensor.expand_shape %collapsed_571 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1176 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_573 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_574 = tensor.collapse_shape %1176 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1177 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_574, %collapsed_572 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1074 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1178 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1175 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_575 = tensor.collapse_shape %1178 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_576 = tensor.expand_shape %1146 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1179 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_576 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_577 = tensor.collapse_shape %1179 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1180 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_577, %collapsed_575 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1177 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1181 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1156, %1159 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1182 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_571 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_578 = tensor.collapse_shape %1181 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_579 = tensor.collapse_shape %1182 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1183 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_558 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_580 = tensor.collapse_shape %1183 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1184 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_578, %collapsed_579, %collapsed_580, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_581 = tensor.expand_shape %1184 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1185 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_581 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_582 = tensor.collapse_shape %1185 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1186 = iree_tensor_ext.bitcast %77 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_583 = tensor.expand_shape %1186 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_584 = tensor.extract_slice %expanded_583[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_585 = tensor.expand_shape %extracted_slice_584 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1187 = iree_tensor_ext.bitcast %expanded_585 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_586 = tensor.extract_slice %expanded_583[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1188 = iree_tensor_ext.bitcast %extracted_slice_586 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_587 = tensor.collapse_shape %1187 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1189 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_587, %1188 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_588 = tensor.expand_shape %collapsed_582 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1190 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_588, %1189 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1191 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1190 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1192 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1118, %1191 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1193 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1192 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1194 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1193 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1195 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1194 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1196 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1195 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1197 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1196 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1198 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1197 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1199 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1193, %1198 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1200 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1199 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1201 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%78, %1200 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1202 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1201 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1203 = iree_tensor_ext.bitcast %79 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_589 = tensor.expand_shape %1203 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_590 = tensor.extract_slice %expanded_589[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_591 = tensor.expand_shape %extracted_slice_590 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1204 = iree_tensor_ext.bitcast %expanded_591 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_592 = tensor.extract_slice %expanded_589[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1205 = iree_tensor_ext.bitcast %extracted_slice_592 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_593 = tensor.collapse_shape %1204 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1206 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_593, %1205 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_594 = tensor.expand_shape %1202 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1207 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_594, %1206 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1208 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1207 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1209 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1208 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1210 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1209, %1208 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1211 = iree_tensor_ext.bitcast %80 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_595 = tensor.expand_shape %1211 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_596 = tensor.extract_slice %expanded_595[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_597 = tensor.expand_shape %extracted_slice_596 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1212 = iree_tensor_ext.bitcast %expanded_597 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_598 = tensor.extract_slice %expanded_595[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1213 = iree_tensor_ext.bitcast %extracted_slice_598 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_599 = tensor.collapse_shape %1212 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1214 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_599, %1213 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1215 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_594, %1214 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1216 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1215 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1217 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1210, %1216 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1218 = iree_tensor_ext.bitcast %81 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_600 = tensor.expand_shape %1218 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_601 = tensor.extract_slice %expanded_600[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_602 = tensor.expand_shape %extracted_slice_601 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1219 = iree_tensor_ext.bitcast %expanded_602 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_603 = tensor.extract_slice %expanded_600[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1220 = iree_tensor_ext.bitcast %extracted_slice_603 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_604 = tensor.collapse_shape %1219 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1221 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_604, %1220 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_605 = tensor.expand_shape %1217 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1222 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_605, %1221 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1223 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1222 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1224 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1192, %1223 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1225 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1224 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1226 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1225 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1227 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1226 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1228 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1227 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1229 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1228 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1230 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1229 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1231 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1225, %1230 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1232 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1231 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1233 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%82, %1232 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1234 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1233 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1235 = iree_tensor_ext.bitcast %83 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_606 = tensor.expand_shape %1235 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_607 = tensor.extract_slice %expanded_606[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_608 = tensor.expand_shape %extracted_slice_607 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1236 = iree_tensor_ext.bitcast %expanded_608 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_609 = tensor.extract_slice %expanded_606[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1237 = iree_tensor_ext.bitcast %extracted_slice_609 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_610 = tensor.collapse_shape %1236 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1238 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_610, %1237 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_611 = tensor.expand_shape %1234 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1239 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_611, %1238 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1240 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1239 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1241 = iree_tensor_ext.bitcast %84 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_612 = tensor.expand_shape %1241 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_613 = tensor.extract_slice %expanded_612[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_614 = tensor.expand_shape %extracted_slice_613 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1242 = iree_tensor_ext.bitcast %expanded_614 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_615 = tensor.extract_slice %expanded_612[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1243 = iree_tensor_ext.bitcast %extracted_slice_615 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_616 = tensor.collapse_shape %1242 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1244 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_616, %1243 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1245 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_611, %1244 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1246 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1245 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1247 = iree_tensor_ext.bitcast %85 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_617 = tensor.expand_shape %1247 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_618 = tensor.extract_slice %expanded_617[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_619 = tensor.expand_shape %extracted_slice_618 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1248 = iree_tensor_ext.bitcast %expanded_619 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_620 = tensor.extract_slice %expanded_617[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1249 = iree_tensor_ext.bitcast %extracted_slice_620 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_621 = tensor.collapse_shape %1248 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1250 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_621, %1249 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1251 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_611, %1250 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1252 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1251 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_622 = tensor.expand_shape %1240 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_623 = tensor.expand_shape %1246 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_624 = tensor.expand_shape %1252 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_18 = util.global.load immutable @__hoisted_tensor_32xf32_18 : tensor<32xf32>
    %expanded_625 = tensor.expand_shape %__hoisted_tensor_32xf32_18 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1253 = linalg.batch_mmt4d ins(%expanded_625, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_626 = linalg.unpack %1253 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1254 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_626 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_627 = tensor.collapse_shape %1254 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1255 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_627, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1256 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1255 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1257 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_626 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_628 = tensor.collapse_shape %1257 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1258 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_628, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1259 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1258 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_629 = tensor.extract_slice %expanded_622[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_630 = tensor.extract_slice %expanded_622[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1260 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_629, %1256 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1261 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_630, %1259 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1262 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1260, %1261 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1263 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_630, %1256 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1264 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_629, %1259 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1265 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1263, %1264 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_19 = util.global.load immutable @__hoisted_tensor_32xf32_19 : tensor<32xf32>
    %expanded_631 = tensor.expand_shape %__hoisted_tensor_32xf32_19 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1266 = linalg.batch_mmt4d ins(%expanded_631, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_632 = linalg.unpack %1266 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1267 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_632 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_633 = tensor.collapse_shape %1267 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1268 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_633, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1269 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1268 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1270 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_632 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_634 = tensor.collapse_shape %1270 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1271 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_634, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1272 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1271 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_635 = tensor.extract_slice %expanded_623[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_636 = tensor.extract_slice %expanded_623[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1273 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_635, %1269 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1274 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_636, %1272 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1275 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1273, %1274 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1276 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_636, %1269 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1277 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_635, %1272 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1278 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1276, %1277 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1279 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1275, %1278 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_637 = tensor.collapse_shape %1279 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1280 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c9_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1281 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1280 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_638 = tensor.collapse_shape %1281 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_639 = tensor.expand_shape %collapsed_637 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1282 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_639 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_640 = tensor.collapse_shape %1282 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1283 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_640, %collapsed_638 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1180 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1284 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1281 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_641 = tensor.collapse_shape %1284 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_642 = tensor.expand_shape %1252 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1285 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_642 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_643 = tensor.collapse_shape %1285 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1286 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_643, %collapsed_641 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1283 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1287 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1262, %1265 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1288 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_637 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_644 = tensor.collapse_shape %1287 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_645 = tensor.collapse_shape %1288 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1289 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_624 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_646 = tensor.collapse_shape %1289 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1290 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_644, %collapsed_645, %collapsed_646, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_647 = tensor.expand_shape %1290 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1291 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_647 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_648 = tensor.collapse_shape %1291 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1292 = iree_tensor_ext.bitcast %86 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_649 = tensor.expand_shape %1292 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_650 = tensor.extract_slice %expanded_649[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_651 = tensor.expand_shape %extracted_slice_650 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1293 = iree_tensor_ext.bitcast %expanded_651 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_652 = tensor.extract_slice %expanded_649[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1294 = iree_tensor_ext.bitcast %extracted_slice_652 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_653 = tensor.collapse_shape %1293 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1295 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_653, %1294 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_654 = tensor.expand_shape %collapsed_648 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1296 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_654, %1295 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1297 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1296 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1298 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1224, %1297 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1299 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1298 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1300 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1299 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1301 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1300 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1302 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1301 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1303 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1302 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1304 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1303 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1305 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1299, %1304 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1306 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1305 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1307 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%87, %1306 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1308 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1307 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1309 = iree_tensor_ext.bitcast %88 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_655 = tensor.expand_shape %1309 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_656 = tensor.extract_slice %expanded_655[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_657 = tensor.expand_shape %extracted_slice_656 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1310 = iree_tensor_ext.bitcast %expanded_657 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_658 = tensor.extract_slice %expanded_655[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1311 = iree_tensor_ext.bitcast %extracted_slice_658 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_659 = tensor.collapse_shape %1310 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1312 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_659, %1311 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_660 = tensor.expand_shape %1308 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1313 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_660, %1312 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1314 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1313 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1315 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1314 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1316 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1315, %1314 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1317 = iree_tensor_ext.bitcast %89 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_661 = tensor.expand_shape %1317 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_662 = tensor.extract_slice %expanded_661[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_663 = tensor.expand_shape %extracted_slice_662 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1318 = iree_tensor_ext.bitcast %expanded_663 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_664 = tensor.extract_slice %expanded_661[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1319 = iree_tensor_ext.bitcast %extracted_slice_664 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_665 = tensor.collapse_shape %1318 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1320 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_665, %1319 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1321 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_660, %1320 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1322 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1321 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1323 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1316, %1322 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1324 = iree_tensor_ext.bitcast %90 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_666 = tensor.expand_shape %1324 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_667 = tensor.extract_slice %expanded_666[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_668 = tensor.expand_shape %extracted_slice_667 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1325 = iree_tensor_ext.bitcast %expanded_668 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_669 = tensor.extract_slice %expanded_666[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1326 = iree_tensor_ext.bitcast %extracted_slice_669 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_670 = tensor.collapse_shape %1325 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1327 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_670, %1326 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_671 = tensor.expand_shape %1323 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1328 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_671, %1327 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1329 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1328 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1330 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1298, %1329 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1331 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1330 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1332 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1331 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1333 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1332 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1334 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1333 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1335 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1334 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1336 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1335 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1337 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1331, %1336 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1338 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1337 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1339 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%91, %1338 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1340 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1339 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1341 = iree_tensor_ext.bitcast %92 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_672 = tensor.expand_shape %1341 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_673 = tensor.extract_slice %expanded_672[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_674 = tensor.expand_shape %extracted_slice_673 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1342 = iree_tensor_ext.bitcast %expanded_674 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_675 = tensor.extract_slice %expanded_672[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1343 = iree_tensor_ext.bitcast %extracted_slice_675 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_676 = tensor.collapse_shape %1342 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1344 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_676, %1343 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_677 = tensor.expand_shape %1340 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1345 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_677, %1344 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1346 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1345 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1347 = iree_tensor_ext.bitcast %93 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_678 = tensor.expand_shape %1347 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_679 = tensor.extract_slice %expanded_678[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_680 = tensor.expand_shape %extracted_slice_679 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1348 = iree_tensor_ext.bitcast %expanded_680 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_681 = tensor.extract_slice %expanded_678[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1349 = iree_tensor_ext.bitcast %extracted_slice_681 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_682 = tensor.collapse_shape %1348 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1350 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_682, %1349 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1351 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_677, %1350 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1352 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1351 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1353 = iree_tensor_ext.bitcast %94 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_683 = tensor.expand_shape %1353 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_684 = tensor.extract_slice %expanded_683[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_685 = tensor.expand_shape %extracted_slice_684 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1354 = iree_tensor_ext.bitcast %expanded_685 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_686 = tensor.extract_slice %expanded_683[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1355 = iree_tensor_ext.bitcast %extracted_slice_686 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_687 = tensor.collapse_shape %1354 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1356 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_687, %1355 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1357 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_677, %1356 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1358 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1357 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_688 = tensor.expand_shape %1346 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_689 = tensor.expand_shape %1352 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_690 = tensor.expand_shape %1358 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_20 = util.global.load immutable @__hoisted_tensor_32xf32_20 : tensor<32xf32>
    %expanded_691 = tensor.expand_shape %__hoisted_tensor_32xf32_20 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1359 = linalg.batch_mmt4d ins(%expanded_691, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_692 = linalg.unpack %1359 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1360 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_692 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_693 = tensor.collapse_shape %1360 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1361 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_693, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1362 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1361 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1363 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_692 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_694 = tensor.collapse_shape %1363 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1364 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_694, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1365 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1364 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_695 = tensor.extract_slice %expanded_688[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_696 = tensor.extract_slice %expanded_688[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1366 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_695, %1362 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1367 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_696, %1365 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1368 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1366, %1367 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1369 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_696, %1362 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1370 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_695, %1365 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1371 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1369, %1370 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_21 = util.global.load immutable @__hoisted_tensor_32xf32_21 : tensor<32xf32>
    %expanded_697 = tensor.expand_shape %__hoisted_tensor_32xf32_21 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1372 = linalg.batch_mmt4d ins(%expanded_697, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_698 = linalg.unpack %1372 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1373 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_698 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_699 = tensor.collapse_shape %1373 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1374 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_699, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1375 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1374 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1376 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_698 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_700 = tensor.collapse_shape %1376 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1377 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_700, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1378 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1377 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_701 = tensor.extract_slice %expanded_689[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_702 = tensor.extract_slice %expanded_689[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1379 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_701, %1375 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1380 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_702, %1378 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1381 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1379, %1380 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1382 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_702, %1375 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1383 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_701, %1378 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1384 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1382, %1383 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1385 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1381, %1384 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_703 = tensor.collapse_shape %1385 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1386 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c10_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1387 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1386 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_704 = tensor.collapse_shape %1387 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_705 = tensor.expand_shape %collapsed_703 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1388 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_705 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_706 = tensor.collapse_shape %1388 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1389 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_706, %collapsed_704 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1286 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1390 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1387 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_707 = tensor.collapse_shape %1390 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_708 = tensor.expand_shape %1358 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1391 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_708 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_709 = tensor.collapse_shape %1391 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1392 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_709, %collapsed_707 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1389 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1393 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1368, %1371 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1394 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_703 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_710 = tensor.collapse_shape %1393 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_711 = tensor.collapse_shape %1394 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1395 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_690 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_712 = tensor.collapse_shape %1395 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1396 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_710, %collapsed_711, %collapsed_712, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_713 = tensor.expand_shape %1396 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1397 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_713 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_714 = tensor.collapse_shape %1397 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1398 = iree_tensor_ext.bitcast %95 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_715 = tensor.expand_shape %1398 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_716 = tensor.extract_slice %expanded_715[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_717 = tensor.expand_shape %extracted_slice_716 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1399 = iree_tensor_ext.bitcast %expanded_717 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_718 = tensor.extract_slice %expanded_715[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1400 = iree_tensor_ext.bitcast %extracted_slice_718 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_719 = tensor.collapse_shape %1399 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1401 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_719, %1400 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_720 = tensor.expand_shape %collapsed_714 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1402 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_720, %1401 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1403 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1402 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1404 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1330, %1403 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1405 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1404 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1406 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1405 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1407 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1406 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1408 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1407 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1409 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1408 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1410 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1409 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1411 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1405, %1410 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1412 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1411 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1413 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%96, %1412 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1414 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1413 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1415 = iree_tensor_ext.bitcast %97 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_721 = tensor.expand_shape %1415 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_722 = tensor.extract_slice %expanded_721[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_723 = tensor.expand_shape %extracted_slice_722 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1416 = iree_tensor_ext.bitcast %expanded_723 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_724 = tensor.extract_slice %expanded_721[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1417 = iree_tensor_ext.bitcast %extracted_slice_724 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_725 = tensor.collapse_shape %1416 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1418 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_725, %1417 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_726 = tensor.expand_shape %1414 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1419 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_726, %1418 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1420 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1419 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1421 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1420 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1422 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1421, %1420 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1423 = iree_tensor_ext.bitcast %98 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_727 = tensor.expand_shape %1423 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_728 = tensor.extract_slice %expanded_727[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_729 = tensor.expand_shape %extracted_slice_728 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1424 = iree_tensor_ext.bitcast %expanded_729 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_730 = tensor.extract_slice %expanded_727[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1425 = iree_tensor_ext.bitcast %extracted_slice_730 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_731 = tensor.collapse_shape %1424 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1426 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_731, %1425 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1427 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_726, %1426 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1428 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1427 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1429 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1422, %1428 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1430 = iree_tensor_ext.bitcast %99 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_732 = tensor.expand_shape %1430 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_733 = tensor.extract_slice %expanded_732[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_734 = tensor.expand_shape %extracted_slice_733 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1431 = iree_tensor_ext.bitcast %expanded_734 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_735 = tensor.extract_slice %expanded_732[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1432 = iree_tensor_ext.bitcast %extracted_slice_735 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_736 = tensor.collapse_shape %1431 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1433 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_736, %1432 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_737 = tensor.expand_shape %1429 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1434 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_737, %1433 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1435 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1434 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1436 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1404, %1435 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1437 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1436 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1438 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1437 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1439 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1438 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1440 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1439 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1441 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1440 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1442 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1441 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1443 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1437, %1442 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1444 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1443 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1445 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%100, %1444 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1446 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1445 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1447 = iree_tensor_ext.bitcast %101 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_738 = tensor.expand_shape %1447 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_739 = tensor.extract_slice %expanded_738[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_740 = tensor.expand_shape %extracted_slice_739 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1448 = iree_tensor_ext.bitcast %expanded_740 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_741 = tensor.extract_slice %expanded_738[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1449 = iree_tensor_ext.bitcast %extracted_slice_741 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_742 = tensor.collapse_shape %1448 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1450 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_742, %1449 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_743 = tensor.expand_shape %1446 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1451 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_743, %1450 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1452 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1451 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1453 = iree_tensor_ext.bitcast %102 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_744 = tensor.expand_shape %1453 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_745 = tensor.extract_slice %expanded_744[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_746 = tensor.expand_shape %extracted_slice_745 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1454 = iree_tensor_ext.bitcast %expanded_746 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_747 = tensor.extract_slice %expanded_744[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1455 = iree_tensor_ext.bitcast %extracted_slice_747 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_748 = tensor.collapse_shape %1454 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1456 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_748, %1455 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1457 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_743, %1456 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1458 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1457 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1459 = iree_tensor_ext.bitcast %103 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_749 = tensor.expand_shape %1459 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_750 = tensor.extract_slice %expanded_749[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_751 = tensor.expand_shape %extracted_slice_750 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1460 = iree_tensor_ext.bitcast %expanded_751 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_752 = tensor.extract_slice %expanded_749[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1461 = iree_tensor_ext.bitcast %extracted_slice_752 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_753 = tensor.collapse_shape %1460 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1462 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_753, %1461 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1463 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_743, %1462 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1464 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1463 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_754 = tensor.expand_shape %1452 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_755 = tensor.expand_shape %1458 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_756 = tensor.expand_shape %1464 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_22 = util.global.load immutable @__hoisted_tensor_32xf32_22 : tensor<32xf32>
    %expanded_757 = tensor.expand_shape %__hoisted_tensor_32xf32_22 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1465 = linalg.batch_mmt4d ins(%expanded_757, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_758 = linalg.unpack %1465 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1466 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_758 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_759 = tensor.collapse_shape %1466 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1467 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_759, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1468 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1467 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1469 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_758 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_760 = tensor.collapse_shape %1469 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1470 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_760, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1471 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1470 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_761 = tensor.extract_slice %expanded_754[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_762 = tensor.extract_slice %expanded_754[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1472 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_761, %1468 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1473 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_762, %1471 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1474 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1472, %1473 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1475 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_762, %1468 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1476 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_761, %1471 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1477 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1475, %1476 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_23 = util.global.load immutable @__hoisted_tensor_32xf32_23 : tensor<32xf32>
    %expanded_763 = tensor.expand_shape %__hoisted_tensor_32xf32_23 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1478 = linalg.batch_mmt4d ins(%expanded_763, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_764 = linalg.unpack %1478 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1479 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_764 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_765 = tensor.collapse_shape %1479 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1480 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_765, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1481 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1480 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1482 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_764 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_766 = tensor.collapse_shape %1482 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1483 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_766, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1484 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1483 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_767 = tensor.extract_slice %expanded_755[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_768 = tensor.extract_slice %expanded_755[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1485 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_767, %1481 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1486 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_768, %1484 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1487 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1485, %1486 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1488 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_768, %1481 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1489 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_767, %1484 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1490 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1488, %1489 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1491 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1487, %1490 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_769 = tensor.collapse_shape %1491 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1492 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c11_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1493 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1492 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_770 = tensor.collapse_shape %1493 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_771 = tensor.expand_shape %collapsed_769 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1494 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_771 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_772 = tensor.collapse_shape %1494 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1495 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_772, %collapsed_770 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1392 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1496 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1493 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_773 = tensor.collapse_shape %1496 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_774 = tensor.expand_shape %1464 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1497 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_774 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_775 = tensor.collapse_shape %1497 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1498 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_775, %collapsed_773 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1495 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1499 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1474, %1477 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1500 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_769 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_776 = tensor.collapse_shape %1499 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_777 = tensor.collapse_shape %1500 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1501 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_756 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_778 = tensor.collapse_shape %1501 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1502 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_776, %collapsed_777, %collapsed_778, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_779 = tensor.expand_shape %1502 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1503 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_779 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_780 = tensor.collapse_shape %1503 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1504 = iree_tensor_ext.bitcast %104 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_781 = tensor.expand_shape %1504 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_782 = tensor.extract_slice %expanded_781[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_783 = tensor.expand_shape %extracted_slice_782 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1505 = iree_tensor_ext.bitcast %expanded_783 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_784 = tensor.extract_slice %expanded_781[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1506 = iree_tensor_ext.bitcast %extracted_slice_784 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_785 = tensor.collapse_shape %1505 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1507 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_785, %1506 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_786 = tensor.expand_shape %collapsed_780 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1508 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_786, %1507 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1509 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1508 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1510 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1436, %1509 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1511 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1510 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1512 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1511 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1513 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1512 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1514 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1513 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1515 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1514 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1516 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1515 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1517 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1511, %1516 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1518 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1517 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1519 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%105, %1518 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1520 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1519 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1521 = iree_tensor_ext.bitcast %106 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_787 = tensor.expand_shape %1521 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_788 = tensor.extract_slice %expanded_787[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_789 = tensor.expand_shape %extracted_slice_788 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1522 = iree_tensor_ext.bitcast %expanded_789 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_790 = tensor.extract_slice %expanded_787[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1523 = iree_tensor_ext.bitcast %extracted_slice_790 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_791 = tensor.collapse_shape %1522 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1524 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_791, %1523 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_792 = tensor.expand_shape %1520 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1525 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_792, %1524 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1526 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1525 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1527 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1526 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1528 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1527, %1526 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1529 = iree_tensor_ext.bitcast %107 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_793 = tensor.expand_shape %1529 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_794 = tensor.extract_slice %expanded_793[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_795 = tensor.expand_shape %extracted_slice_794 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1530 = iree_tensor_ext.bitcast %expanded_795 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_796 = tensor.extract_slice %expanded_793[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1531 = iree_tensor_ext.bitcast %extracted_slice_796 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_797 = tensor.collapse_shape %1530 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1532 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_797, %1531 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1533 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_792, %1532 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1534 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1533 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1535 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1528, %1534 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1536 = iree_tensor_ext.bitcast %108 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_798 = tensor.expand_shape %1536 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_799 = tensor.extract_slice %expanded_798[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_800 = tensor.expand_shape %extracted_slice_799 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1537 = iree_tensor_ext.bitcast %expanded_800 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_801 = tensor.extract_slice %expanded_798[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1538 = iree_tensor_ext.bitcast %extracted_slice_801 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_802 = tensor.collapse_shape %1537 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1539 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_802, %1538 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_803 = tensor.expand_shape %1535 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1540 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_803, %1539 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1541 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1540 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1542 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1510, %1541 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1543 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1542 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1544 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1543 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1545 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1544 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1546 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1545 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1547 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1546 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1548 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1547 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1549 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1543, %1548 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1550 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1549 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1551 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%109, %1550 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1552 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1551 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1553 = iree_tensor_ext.bitcast %110 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_804 = tensor.expand_shape %1553 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_805 = tensor.extract_slice %expanded_804[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_806 = tensor.expand_shape %extracted_slice_805 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1554 = iree_tensor_ext.bitcast %expanded_806 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_807 = tensor.extract_slice %expanded_804[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1555 = iree_tensor_ext.bitcast %extracted_slice_807 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_808 = tensor.collapse_shape %1554 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1556 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_808, %1555 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_809 = tensor.expand_shape %1552 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1557 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_809, %1556 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1558 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1557 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1559 = iree_tensor_ext.bitcast %111 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_810 = tensor.expand_shape %1559 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_811 = tensor.extract_slice %expanded_810[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_812 = tensor.expand_shape %extracted_slice_811 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1560 = iree_tensor_ext.bitcast %expanded_812 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_813 = tensor.extract_slice %expanded_810[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1561 = iree_tensor_ext.bitcast %extracted_slice_813 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_814 = tensor.collapse_shape %1560 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1562 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_814, %1561 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1563 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_809, %1562 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1564 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1563 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1565 = iree_tensor_ext.bitcast %112 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_815 = tensor.expand_shape %1565 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_816 = tensor.extract_slice %expanded_815[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_817 = tensor.expand_shape %extracted_slice_816 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1566 = iree_tensor_ext.bitcast %expanded_817 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_818 = tensor.extract_slice %expanded_815[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1567 = iree_tensor_ext.bitcast %extracted_slice_818 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_819 = tensor.collapse_shape %1566 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1568 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_819, %1567 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1569 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_809, %1568 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1570 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1569 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_820 = tensor.expand_shape %1558 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_821 = tensor.expand_shape %1564 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_822 = tensor.expand_shape %1570 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_24 = util.global.load immutable @__hoisted_tensor_32xf32_24 : tensor<32xf32>
    %expanded_823 = tensor.expand_shape %__hoisted_tensor_32xf32_24 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1571 = linalg.batch_mmt4d ins(%expanded_823, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_824 = linalg.unpack %1571 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1572 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_824 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_825 = tensor.collapse_shape %1572 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1573 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_825, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1574 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1573 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1575 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_824 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_826 = tensor.collapse_shape %1575 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1576 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_826, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1577 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1576 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_827 = tensor.extract_slice %expanded_820[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_828 = tensor.extract_slice %expanded_820[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1578 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_827, %1574 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1579 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_828, %1577 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1580 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1578, %1579 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1581 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_828, %1574 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1582 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_827, %1577 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1583 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1581, %1582 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_25 = util.global.load immutable @__hoisted_tensor_32xf32_25 : tensor<32xf32>
    %expanded_829 = tensor.expand_shape %__hoisted_tensor_32xf32_25 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1584 = linalg.batch_mmt4d ins(%expanded_829, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_830 = linalg.unpack %1584 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1585 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_830 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_831 = tensor.collapse_shape %1585 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1586 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_831, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1587 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1586 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1588 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_830 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_832 = tensor.collapse_shape %1588 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1589 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_832, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1590 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1589 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_833 = tensor.extract_slice %expanded_821[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_834 = tensor.extract_slice %expanded_821[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1591 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_833, %1587 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1592 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_834, %1590 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1593 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1591, %1592 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1594 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_834, %1587 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1595 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_833, %1590 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1596 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1594, %1595 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1597 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1593, %1596 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_835 = tensor.collapse_shape %1597 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1598 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c12_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1599 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1598 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_836 = tensor.collapse_shape %1599 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_837 = tensor.expand_shape %collapsed_835 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1600 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_837 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_838 = tensor.collapse_shape %1600 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1601 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_838, %collapsed_836 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1498 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1602 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1599 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_839 = tensor.collapse_shape %1602 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_840 = tensor.expand_shape %1570 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1603 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_840 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_841 = tensor.collapse_shape %1603 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1604 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_841, %collapsed_839 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1601 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1605 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1580, %1583 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1606 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_835 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_842 = tensor.collapse_shape %1605 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_843 = tensor.collapse_shape %1606 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1607 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_822 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_844 = tensor.collapse_shape %1607 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1608 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_842, %collapsed_843, %collapsed_844, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_845 = tensor.expand_shape %1608 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1609 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_845 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_846 = tensor.collapse_shape %1609 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1610 = iree_tensor_ext.bitcast %113 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_847 = tensor.expand_shape %1610 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_848 = tensor.extract_slice %expanded_847[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_849 = tensor.expand_shape %extracted_slice_848 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1611 = iree_tensor_ext.bitcast %expanded_849 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_850 = tensor.extract_slice %expanded_847[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1612 = iree_tensor_ext.bitcast %extracted_slice_850 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_851 = tensor.collapse_shape %1611 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1613 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_851, %1612 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_852 = tensor.expand_shape %collapsed_846 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1614 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_852, %1613 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1615 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1614 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1616 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1542, %1615 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1617 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1616 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1618 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1617 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1619 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1618 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1620 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1619 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1621 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1620 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1622 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1621 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1623 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1617, %1622 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1624 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1623 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1625 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%114, %1624 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1626 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1625 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1627 = iree_tensor_ext.bitcast %115 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_853 = tensor.expand_shape %1627 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_854 = tensor.extract_slice %expanded_853[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_855 = tensor.expand_shape %extracted_slice_854 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1628 = iree_tensor_ext.bitcast %expanded_855 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_856 = tensor.extract_slice %expanded_853[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1629 = iree_tensor_ext.bitcast %extracted_slice_856 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_857 = tensor.collapse_shape %1628 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1630 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_857, %1629 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_858 = tensor.expand_shape %1626 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1631 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_858, %1630 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1632 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1631 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1633 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1632 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1634 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1633, %1632 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1635 = iree_tensor_ext.bitcast %116 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_859 = tensor.expand_shape %1635 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_860 = tensor.extract_slice %expanded_859[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_861 = tensor.expand_shape %extracted_slice_860 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1636 = iree_tensor_ext.bitcast %expanded_861 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_862 = tensor.extract_slice %expanded_859[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1637 = iree_tensor_ext.bitcast %extracted_slice_862 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_863 = tensor.collapse_shape %1636 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1638 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_863, %1637 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1639 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_858, %1638 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1640 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1639 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1641 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1634, %1640 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1642 = iree_tensor_ext.bitcast %117 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_864 = tensor.expand_shape %1642 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_865 = tensor.extract_slice %expanded_864[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_866 = tensor.expand_shape %extracted_slice_865 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1643 = iree_tensor_ext.bitcast %expanded_866 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_867 = tensor.extract_slice %expanded_864[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1644 = iree_tensor_ext.bitcast %extracted_slice_867 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_868 = tensor.collapse_shape %1643 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1645 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_868, %1644 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_869 = tensor.expand_shape %1641 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1646 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_869, %1645 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1647 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1646 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1648 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1616, %1647 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1649 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1648 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1650 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1649 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1651 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1650 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1652 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1651 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1653 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1652 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1654 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1653 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1655 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1649, %1654 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1656 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1655 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1657 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%118, %1656 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1658 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1657 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1659 = iree_tensor_ext.bitcast %119 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_870 = tensor.expand_shape %1659 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_871 = tensor.extract_slice %expanded_870[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_872 = tensor.expand_shape %extracted_slice_871 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1660 = iree_tensor_ext.bitcast %expanded_872 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_873 = tensor.extract_slice %expanded_870[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1661 = iree_tensor_ext.bitcast %extracted_slice_873 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_874 = tensor.collapse_shape %1660 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1662 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_874, %1661 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_875 = tensor.expand_shape %1658 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1663 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_875, %1662 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1664 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1663 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1665 = iree_tensor_ext.bitcast %120 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_876 = tensor.expand_shape %1665 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_877 = tensor.extract_slice %expanded_876[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_878 = tensor.expand_shape %extracted_slice_877 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1666 = iree_tensor_ext.bitcast %expanded_878 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_879 = tensor.extract_slice %expanded_876[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1667 = iree_tensor_ext.bitcast %extracted_slice_879 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_880 = tensor.collapse_shape %1666 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1668 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_880, %1667 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1669 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_875, %1668 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1670 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1669 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1671 = iree_tensor_ext.bitcast %121 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_881 = tensor.expand_shape %1671 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_882 = tensor.extract_slice %expanded_881[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_883 = tensor.expand_shape %extracted_slice_882 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1672 = iree_tensor_ext.bitcast %expanded_883 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_884 = tensor.extract_slice %expanded_881[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1673 = iree_tensor_ext.bitcast %extracted_slice_884 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_885 = tensor.collapse_shape %1672 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1674 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_885, %1673 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1675 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_875, %1674 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1676 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1675 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_886 = tensor.expand_shape %1664 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_887 = tensor.expand_shape %1670 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_888 = tensor.expand_shape %1676 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_26 = util.global.load immutable @__hoisted_tensor_32xf32_26 : tensor<32xf32>
    %expanded_889 = tensor.expand_shape %__hoisted_tensor_32xf32_26 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1677 = linalg.batch_mmt4d ins(%expanded_889, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_890 = linalg.unpack %1677 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1678 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_890 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_891 = tensor.collapse_shape %1678 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1679 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_891, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1680 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1679 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1681 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_890 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_892 = tensor.collapse_shape %1681 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1682 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_892, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1683 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1682 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_893 = tensor.extract_slice %expanded_886[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_894 = tensor.extract_slice %expanded_886[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1684 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_893, %1680 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1685 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_894, %1683 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1686 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1684, %1685 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1687 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_894, %1680 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1688 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_893, %1683 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1689 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1687, %1688 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_27 = util.global.load immutable @__hoisted_tensor_32xf32_27 : tensor<32xf32>
    %expanded_895 = tensor.expand_shape %__hoisted_tensor_32xf32_27 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1690 = linalg.batch_mmt4d ins(%expanded_895, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_896 = linalg.unpack %1690 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1691 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_896 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_897 = tensor.collapse_shape %1691 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1692 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_897, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1693 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1692 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1694 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_896 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_898 = tensor.collapse_shape %1694 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1695 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_898, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1696 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1695 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_899 = tensor.extract_slice %expanded_887[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_900 = tensor.extract_slice %expanded_887[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1697 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_899, %1693 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1698 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_900, %1696 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1699 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1697, %1698 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1700 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_900, %1693 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1701 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_899, %1696 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1702 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1700, %1701 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1703 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1699, %1702 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_901 = tensor.collapse_shape %1703 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1704 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c13_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1705 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1704 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_902 = tensor.collapse_shape %1705 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_903 = tensor.expand_shape %collapsed_901 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1706 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_903 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_904 = tensor.collapse_shape %1706 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1707 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_904, %collapsed_902 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1604 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1708 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1705 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_905 = tensor.collapse_shape %1708 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_906 = tensor.expand_shape %1676 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1709 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_906 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_907 = tensor.collapse_shape %1709 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1710 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_907, %collapsed_905 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1707 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1711 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1686, %1689 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1712 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_901 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_908 = tensor.collapse_shape %1711 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_909 = tensor.collapse_shape %1712 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1713 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_888 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_910 = tensor.collapse_shape %1713 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1714 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_908, %collapsed_909, %collapsed_910, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_911 = tensor.expand_shape %1714 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1715 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_911 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_912 = tensor.collapse_shape %1715 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1716 = iree_tensor_ext.bitcast %122 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_913 = tensor.expand_shape %1716 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_914 = tensor.extract_slice %expanded_913[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_915 = tensor.expand_shape %extracted_slice_914 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1717 = iree_tensor_ext.bitcast %expanded_915 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_916 = tensor.extract_slice %expanded_913[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1718 = iree_tensor_ext.bitcast %extracted_slice_916 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_917 = tensor.collapse_shape %1717 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1719 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_917, %1718 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_918 = tensor.expand_shape %collapsed_912 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1720 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_918, %1719 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1721 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1720 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1722 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1648, %1721 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1723 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1722 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1724 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1723 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1725 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1724 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1726 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1725 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1727 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1726 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1728 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1727 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1729 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1723, %1728 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1730 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1729 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1731 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%123, %1730 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1732 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1731 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1733 = iree_tensor_ext.bitcast %124 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_919 = tensor.expand_shape %1733 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_920 = tensor.extract_slice %expanded_919[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_921 = tensor.expand_shape %extracted_slice_920 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1734 = iree_tensor_ext.bitcast %expanded_921 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_922 = tensor.extract_slice %expanded_919[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1735 = iree_tensor_ext.bitcast %extracted_slice_922 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_923 = tensor.collapse_shape %1734 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1736 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_923, %1735 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_924 = tensor.expand_shape %1732 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1737 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_924, %1736 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1738 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1737 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1739 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1738 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1740 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1739, %1738 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1741 = iree_tensor_ext.bitcast %125 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_925 = tensor.expand_shape %1741 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_926 = tensor.extract_slice %expanded_925[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_927 = tensor.expand_shape %extracted_slice_926 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1742 = iree_tensor_ext.bitcast %expanded_927 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_928 = tensor.extract_slice %expanded_925[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1743 = iree_tensor_ext.bitcast %extracted_slice_928 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_929 = tensor.collapse_shape %1742 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1744 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_929, %1743 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1745 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_924, %1744 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1746 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1745 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1747 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1740, %1746 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1748 = iree_tensor_ext.bitcast %126 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_930 = tensor.expand_shape %1748 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_931 = tensor.extract_slice %expanded_930[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_932 = tensor.expand_shape %extracted_slice_931 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1749 = iree_tensor_ext.bitcast %expanded_932 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_933 = tensor.extract_slice %expanded_930[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1750 = iree_tensor_ext.bitcast %extracted_slice_933 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_934 = tensor.collapse_shape %1749 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1751 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_934, %1750 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_935 = tensor.expand_shape %1747 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1752 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_935, %1751 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1753 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1752 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1754 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1722, %1753 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1755 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1754 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1756 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1755 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1757 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1756 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1758 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1757 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1759 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1758 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1760 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1759 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1761 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1755, %1760 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1762 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1761 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1763 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%127, %1762 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1764 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1763 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1765 = iree_tensor_ext.bitcast %128 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_936 = tensor.expand_shape %1765 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_937 = tensor.extract_slice %expanded_936[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_938 = tensor.expand_shape %extracted_slice_937 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1766 = iree_tensor_ext.bitcast %expanded_938 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_939 = tensor.extract_slice %expanded_936[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1767 = iree_tensor_ext.bitcast %extracted_slice_939 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_940 = tensor.collapse_shape %1766 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1768 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_940, %1767 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_941 = tensor.expand_shape %1764 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1769 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_941, %1768 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1770 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1769 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1771 = iree_tensor_ext.bitcast %129 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_942 = tensor.expand_shape %1771 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_943 = tensor.extract_slice %expanded_942[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_944 = tensor.expand_shape %extracted_slice_943 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1772 = iree_tensor_ext.bitcast %expanded_944 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_945 = tensor.extract_slice %expanded_942[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1773 = iree_tensor_ext.bitcast %extracted_slice_945 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_946 = tensor.collapse_shape %1772 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1774 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_946, %1773 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1775 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_941, %1774 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1776 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1775 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1777 = iree_tensor_ext.bitcast %130 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_947 = tensor.expand_shape %1777 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_948 = tensor.extract_slice %expanded_947[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_949 = tensor.expand_shape %extracted_slice_948 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1778 = iree_tensor_ext.bitcast %expanded_949 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_950 = tensor.extract_slice %expanded_947[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1779 = iree_tensor_ext.bitcast %extracted_slice_950 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_951 = tensor.collapse_shape %1778 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1780 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_951, %1779 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1781 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_941, %1780 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1782 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1781 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_952 = tensor.expand_shape %1770 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_953 = tensor.expand_shape %1776 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_954 = tensor.expand_shape %1782 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_28 = util.global.load immutable @__hoisted_tensor_32xf32_28 : tensor<32xf32>
    %expanded_955 = tensor.expand_shape %__hoisted_tensor_32xf32_28 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1783 = linalg.batch_mmt4d ins(%expanded_955, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_956 = linalg.unpack %1783 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1784 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_956 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_957 = tensor.collapse_shape %1784 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1785 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_957, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1786 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1785 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1787 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_956 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_958 = tensor.collapse_shape %1787 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1788 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_958, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1789 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1788 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_959 = tensor.extract_slice %expanded_952[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_960 = tensor.extract_slice %expanded_952[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1790 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_959, %1786 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1791 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_960, %1789 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1792 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1790, %1791 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1793 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_960, %1786 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1794 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_959, %1789 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1795 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1793, %1794 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_29 = util.global.load immutable @__hoisted_tensor_32xf32_29 : tensor<32xf32>
    %expanded_961 = tensor.expand_shape %__hoisted_tensor_32xf32_29 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1796 = linalg.batch_mmt4d ins(%expanded_961, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_962 = linalg.unpack %1796 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1797 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_962 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_963 = tensor.collapse_shape %1797 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1798 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_963, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1799 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1798 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1800 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_962 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_964 = tensor.collapse_shape %1800 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1801 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_964, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1802 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1801 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_965 = tensor.extract_slice %expanded_953[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_966 = tensor.extract_slice %expanded_953[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1803 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_965, %1799 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1804 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_966, %1802 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1805 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1803, %1804 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1806 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_966, %1799 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1807 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_965, %1802 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1808 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1806, %1807 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1809 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1805, %1808 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_967 = tensor.collapse_shape %1809 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1810 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c14_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1811 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1810 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_968 = tensor.collapse_shape %1811 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_969 = tensor.expand_shape %collapsed_967 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1812 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_969 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_970 = tensor.collapse_shape %1812 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1813 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_970, %collapsed_968 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1710 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1814 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1811 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_971 = tensor.collapse_shape %1814 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_972 = tensor.expand_shape %1782 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1815 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_972 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_973 = tensor.collapse_shape %1815 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1816 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_973, %collapsed_971 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1813 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1817 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1792, %1795 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1818 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_967 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_974 = tensor.collapse_shape %1817 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_975 = tensor.collapse_shape %1818 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1819 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_954 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_976 = tensor.collapse_shape %1819 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1820 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_974, %collapsed_975, %collapsed_976, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_977 = tensor.expand_shape %1820 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1821 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_977 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_978 = tensor.collapse_shape %1821 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1822 = iree_tensor_ext.bitcast %131 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_979 = tensor.expand_shape %1822 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_980 = tensor.extract_slice %expanded_979[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_981 = tensor.expand_shape %extracted_slice_980 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1823 = iree_tensor_ext.bitcast %expanded_981 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_982 = tensor.extract_slice %expanded_979[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1824 = iree_tensor_ext.bitcast %extracted_slice_982 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_983 = tensor.collapse_shape %1823 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1825 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_983, %1824 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_984 = tensor.expand_shape %collapsed_978 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1826 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_984, %1825 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1827 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1826 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1828 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1754, %1827 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1829 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1828 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1830 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1829 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1831 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1830 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1832 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1831 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1833 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1832 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1834 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1833 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1835 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1829, %1834 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1836 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1835 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1837 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%132, %1836 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1838 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1837 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1839 = iree_tensor_ext.bitcast %133 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_985 = tensor.expand_shape %1839 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_986 = tensor.extract_slice %expanded_985[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_987 = tensor.expand_shape %extracted_slice_986 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1840 = iree_tensor_ext.bitcast %expanded_987 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_988 = tensor.extract_slice %expanded_985[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1841 = iree_tensor_ext.bitcast %extracted_slice_988 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_989 = tensor.collapse_shape %1840 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1842 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_989, %1841 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_990 = tensor.expand_shape %1838 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1843 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_990, %1842 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1844 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1843 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1845 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1844 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1846 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1845, %1844 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1847 = iree_tensor_ext.bitcast %134 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_991 = tensor.expand_shape %1847 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_992 = tensor.extract_slice %expanded_991[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_993 = tensor.expand_shape %extracted_slice_992 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1848 = iree_tensor_ext.bitcast %expanded_993 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_994 = tensor.extract_slice %expanded_991[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1849 = iree_tensor_ext.bitcast %extracted_slice_994 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_995 = tensor.collapse_shape %1848 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1850 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_995, %1849 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1851 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_990, %1850 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1852 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1851 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1853 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1846, %1852 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1854 = iree_tensor_ext.bitcast %135 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_996 = tensor.expand_shape %1854 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_997 = tensor.extract_slice %expanded_996[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_998 = tensor.expand_shape %extracted_slice_997 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1855 = iree_tensor_ext.bitcast %expanded_998 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_999 = tensor.extract_slice %expanded_996[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1856 = iree_tensor_ext.bitcast %extracted_slice_999 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1000 = tensor.collapse_shape %1855 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1857 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1000, %1856 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1001 = tensor.expand_shape %1853 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1858 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1001, %1857 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1859 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1858 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1860 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1828, %1859 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1861 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1860 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1862 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1861 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1863 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1862 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1864 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1863 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1865 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1864 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1866 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1865 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1867 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1861, %1866 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1868 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1867 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1869 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%136, %1868 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1870 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1869 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1871 = iree_tensor_ext.bitcast %137 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1002 = tensor.expand_shape %1871 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1003 = tensor.extract_slice %expanded_1002[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1004 = tensor.expand_shape %extracted_slice_1003 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1872 = iree_tensor_ext.bitcast %expanded_1004 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1005 = tensor.extract_slice %expanded_1002[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1873 = iree_tensor_ext.bitcast %extracted_slice_1005 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1006 = tensor.collapse_shape %1872 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1874 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1006, %1873 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1007 = tensor.expand_shape %1870 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1875 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1007, %1874 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1876 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1875 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1877 = iree_tensor_ext.bitcast %138 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1008 = tensor.expand_shape %1877 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1009 = tensor.extract_slice %expanded_1008[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1010 = tensor.expand_shape %extracted_slice_1009 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1878 = iree_tensor_ext.bitcast %expanded_1010 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1011 = tensor.extract_slice %expanded_1008[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1879 = iree_tensor_ext.bitcast %extracted_slice_1011 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1012 = tensor.collapse_shape %1878 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1880 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1012, %1879 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1881 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1007, %1880 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1882 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1881 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1883 = iree_tensor_ext.bitcast %139 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1013 = tensor.expand_shape %1883 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1014 = tensor.extract_slice %expanded_1013[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1015 = tensor.expand_shape %extracted_slice_1014 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1884 = iree_tensor_ext.bitcast %expanded_1015 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1016 = tensor.extract_slice %expanded_1013[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1885 = iree_tensor_ext.bitcast %extracted_slice_1016 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1017 = tensor.collapse_shape %1884 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1886 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1017, %1885 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1887 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1007, %1886 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1888 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1887 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_1018 = tensor.expand_shape %1876 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1019 = tensor.expand_shape %1882 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1020 = tensor.expand_shape %1888 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_30 = util.global.load immutable @__hoisted_tensor_32xf32_30 : tensor<32xf32>
    %expanded_1021 = tensor.expand_shape %__hoisted_tensor_32xf32_30 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1889 = linalg.batch_mmt4d ins(%expanded_1021, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1022 = linalg.unpack %1889 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1890 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1022 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1023 = tensor.collapse_shape %1890 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1891 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1023, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1892 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1891 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1893 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1022 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1024 = tensor.collapse_shape %1893 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1894 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1024, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1895 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1894 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1025 = tensor.extract_slice %expanded_1018[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1026 = tensor.extract_slice %expanded_1018[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %1896 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1025, %1892 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1897 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1026, %1895 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1898 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1896, %1897 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1899 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1026, %1892 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1900 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1025, %1895 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %1901 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1899, %1900 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_31 = util.global.load immutable @__hoisted_tensor_32xf32_31 : tensor<32xf32>
    %expanded_1027 = tensor.expand_shape %__hoisted_tensor_32xf32_31 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1902 = linalg.batch_mmt4d ins(%expanded_1027, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1028 = linalg.unpack %1902 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1903 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1028 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1029 = tensor.collapse_shape %1903 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1904 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1029, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1905 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1904 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1906 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1028 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1030 = tensor.collapse_shape %1906 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1907 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1030, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1908 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1907 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1031 = tensor.extract_slice %expanded_1019[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1032 = tensor.extract_slice %expanded_1019[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %1909 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1031, %1905 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1910 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1032, %1908 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1911 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1909, %1910 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1912 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1032, %1905 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1913 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1031, %1908 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1914 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1912, %1913 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %1915 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1911, %1914 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1033 = tensor.collapse_shape %1915 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %1916 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c15_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %1917 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1916 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1034 = tensor.collapse_shape %1917 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1035 = tensor.expand_shape %collapsed_1033 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %1918 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1035 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1036 = tensor.collapse_shape %1918 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1919 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1036, %collapsed_1034 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1816 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1920 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1917 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1037 = tensor.collapse_shape %1920 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1038 = tensor.expand_shape %1888 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %1921 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1038 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1039 = tensor.collapse_shape %1921 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %1922 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1039, %collapsed_1037 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1919 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %1923 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1898, %1901 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %1924 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1033 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_1040 = tensor.collapse_shape %1923 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_1041 = tensor.collapse_shape %1924 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %1925 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1020 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_1042 = tensor.collapse_shape %1925 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %1926 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1040, %collapsed_1041, %collapsed_1042, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1043 = tensor.expand_shape %1926 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %1927 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1043 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_1044 = tensor.collapse_shape %1927 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %1928 = iree_tensor_ext.bitcast %140 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1045 = tensor.expand_shape %1928 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1046 = tensor.extract_slice %expanded_1045[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1047 = tensor.expand_shape %extracted_slice_1046 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1929 = iree_tensor_ext.bitcast %expanded_1047 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1048 = tensor.extract_slice %expanded_1045[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1930 = iree_tensor_ext.bitcast %extracted_slice_1048 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1049 = tensor.collapse_shape %1929 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1931 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1049, %1930 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1050 = tensor.expand_shape %collapsed_1044 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1932 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1050, %1931 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1933 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1932 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1934 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1860, %1933 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1935 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1934 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1936 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1935 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1937 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1936 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1938 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1937 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1939 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1938 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1940 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1939 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1941 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1935, %1940 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1942 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1941 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1943 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%141, %1942 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1944 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1943 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1945 = iree_tensor_ext.bitcast %142 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1051 = tensor.expand_shape %1945 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1052 = tensor.extract_slice %expanded_1051[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1053 = tensor.expand_shape %extracted_slice_1052 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1946 = iree_tensor_ext.bitcast %expanded_1053 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1054 = tensor.extract_slice %expanded_1051[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1947 = iree_tensor_ext.bitcast %extracted_slice_1054 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1055 = tensor.collapse_shape %1946 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1948 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1055, %1947 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1056 = tensor.expand_shape %1944 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1949 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1056, %1948 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1950 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1949 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1951 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1950 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %1952 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1951, %1950 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1953 = iree_tensor_ext.bitcast %143 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1057 = tensor.expand_shape %1953 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1058 = tensor.extract_slice %expanded_1057[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1059 = tensor.expand_shape %extracted_slice_1058 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1954 = iree_tensor_ext.bitcast %expanded_1059 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1060 = tensor.extract_slice %expanded_1057[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1955 = iree_tensor_ext.bitcast %extracted_slice_1060 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1061 = tensor.collapse_shape %1954 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1956 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1061, %1955 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %1957 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1056, %1956 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %1958 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1957 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1959 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1952, %1958 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %1960 = iree_tensor_ext.bitcast %144 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1062 = tensor.expand_shape %1960 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1063 = tensor.extract_slice %expanded_1062[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1064 = tensor.expand_shape %extracted_slice_1063 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1961 = iree_tensor_ext.bitcast %expanded_1064 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1065 = tensor.extract_slice %expanded_1062[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1962 = iree_tensor_ext.bitcast %extracted_slice_1065 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1066 = tensor.collapse_shape %1961 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1963 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1066, %1962 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1067 = tensor.expand_shape %1959 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %1964 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1067, %1963 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1965 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1964 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1966 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1934, %1965 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1967 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1966 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1968 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1967 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1969 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%1968 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1970 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1969 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1971 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1970 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1972 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1971 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %1973 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1967, %1972 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %1974 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1973 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1975 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%145, %1974 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %1976 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1975 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1977 = iree_tensor_ext.bitcast %146 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1068 = tensor.expand_shape %1977 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1069 = tensor.extract_slice %expanded_1068[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1070 = tensor.expand_shape %extracted_slice_1069 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1978 = iree_tensor_ext.bitcast %expanded_1070 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1071 = tensor.extract_slice %expanded_1068[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1979 = iree_tensor_ext.bitcast %extracted_slice_1071 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1072 = tensor.collapse_shape %1978 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1980 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1072, %1979 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1073 = tensor.expand_shape %1976 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %1981 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1073, %1980 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %1982 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1981 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %1983 = iree_tensor_ext.bitcast %147 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1074 = tensor.expand_shape %1983 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1075 = tensor.extract_slice %expanded_1074[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1076 = tensor.expand_shape %extracted_slice_1075 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1984 = iree_tensor_ext.bitcast %expanded_1076 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1077 = tensor.extract_slice %expanded_1074[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1985 = iree_tensor_ext.bitcast %extracted_slice_1077 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1078 = tensor.collapse_shape %1984 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1986 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1078, %1985 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1987 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1073, %1986 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1988 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1987 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %1989 = iree_tensor_ext.bitcast %148 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1079 = tensor.expand_shape %1989 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1080 = tensor.extract_slice %expanded_1079[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1081 = tensor.expand_shape %extracted_slice_1080 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1990 = iree_tensor_ext.bitcast %expanded_1081 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1082 = tensor.extract_slice %expanded_1079[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1991 = iree_tensor_ext.bitcast %extracted_slice_1082 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1083 = tensor.collapse_shape %1990 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1992 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1083, %1991 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %1993 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1073, %1992 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %1994 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1993 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_1084 = tensor.expand_shape %1982 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1085 = tensor.expand_shape %1988 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1086 = tensor.expand_shape %1994 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_32 = util.global.load immutable @__hoisted_tensor_32xf32_32 : tensor<32xf32>
    %expanded_1087 = tensor.expand_shape %__hoisted_tensor_32xf32_32 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %1995 = linalg.batch_mmt4d ins(%expanded_1087, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1088 = linalg.unpack %1995 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %1996 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1088 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1089 = tensor.collapse_shape %1996 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %1997 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1089, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %1998 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1997 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %1999 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1088 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1090 = tensor.collapse_shape %1999 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2000 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1090, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2001 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2000 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1091 = tensor.extract_slice %expanded_1084[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1092 = tensor.extract_slice %expanded_1084[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2002 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1091, %1998 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2003 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1092, %2001 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2004 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2002, %2003 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2005 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1092, %1998 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2006 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1091, %2001 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2007 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2005, %2006 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_33 = util.global.load immutable @__hoisted_tensor_32xf32_33 : tensor<32xf32>
    %expanded_1093 = tensor.expand_shape %__hoisted_tensor_32xf32_33 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2008 = linalg.batch_mmt4d ins(%expanded_1093, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1094 = linalg.unpack %2008 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2009 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1094 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1095 = tensor.collapse_shape %2009 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2010 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1095, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2011 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2010 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2012 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1094 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1096 = tensor.collapse_shape %2012 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2013 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1096, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2014 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2013 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1097 = tensor.extract_slice %expanded_1085[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1098 = tensor.extract_slice %expanded_1085[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2015 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1097, %2011 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2016 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1098, %2014 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2017 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2015, %2016 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2018 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1098, %2011 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2019 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1097, %2014 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2020 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2018, %2019 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2021 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2017, %2020 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1099 = tensor.collapse_shape %2021 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2022 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c16_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %2023 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2022 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1100 = tensor.collapse_shape %2023 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1101 = tensor.expand_shape %collapsed_1099 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %2024 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1101 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1102 = tensor.collapse_shape %2024 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2025 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1102, %collapsed_1100 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%1922 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2026 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2023 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1103 = tensor.collapse_shape %2026 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1104 = tensor.expand_shape %1994 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %2027 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1104 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1105 = tensor.collapse_shape %2027 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2028 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1105, %collapsed_1103 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2025 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2029 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2004, %2007 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %2030 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1099 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_1106 = tensor.collapse_shape %2029 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_1107 = tensor.collapse_shape %2030 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %2031 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1086 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_1108 = tensor.collapse_shape %2031 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %2032 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1106, %collapsed_1107, %collapsed_1108, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1109 = tensor.expand_shape %2032 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %2033 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1109 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_1110 = tensor.collapse_shape %2033 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2034 = iree_tensor_ext.bitcast %149 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1111 = tensor.expand_shape %2034 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1112 = tensor.extract_slice %expanded_1111[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1113 = tensor.expand_shape %extracted_slice_1112 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2035 = iree_tensor_ext.bitcast %expanded_1113 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1114 = tensor.extract_slice %expanded_1111[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2036 = iree_tensor_ext.bitcast %extracted_slice_1114 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1115 = tensor.collapse_shape %2035 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2037 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1115, %2036 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1116 = tensor.expand_shape %collapsed_1110 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2038 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1116, %2037 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2039 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2038 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2040 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1966, %2039 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2041 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2040 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2042 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2041 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2043 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2042 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2044 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2043 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2045 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2044 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2046 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2045 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2047 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2041, %2046 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2048 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2047 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2049 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%150, %2048 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2050 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2049 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2051 = iree_tensor_ext.bitcast %151 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1117 = tensor.expand_shape %2051 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1118 = tensor.extract_slice %expanded_1117[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1119 = tensor.expand_shape %extracted_slice_1118 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2052 = iree_tensor_ext.bitcast %expanded_1119 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1120 = tensor.extract_slice %expanded_1117[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2053 = iree_tensor_ext.bitcast %extracted_slice_1120 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1121 = tensor.collapse_shape %2052 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2054 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1121, %2053 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1122 = tensor.expand_shape %2050 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2055 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1122, %2054 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2056 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2055 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2057 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2056 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %2058 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2057, %2056 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2059 = iree_tensor_ext.bitcast %152 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1123 = tensor.expand_shape %2059 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1124 = tensor.extract_slice %expanded_1123[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1125 = tensor.expand_shape %extracted_slice_1124 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2060 = iree_tensor_ext.bitcast %expanded_1125 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1126 = tensor.extract_slice %expanded_1123[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2061 = iree_tensor_ext.bitcast %extracted_slice_1126 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1127 = tensor.collapse_shape %2060 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2062 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1127, %2061 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %2063 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1122, %2062 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2064 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2063 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2065 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2058, %2064 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2066 = iree_tensor_ext.bitcast %153 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1128 = tensor.expand_shape %2066 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1129 = tensor.extract_slice %expanded_1128[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1130 = tensor.expand_shape %extracted_slice_1129 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2067 = iree_tensor_ext.bitcast %expanded_1130 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1131 = tensor.extract_slice %expanded_1128[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2068 = iree_tensor_ext.bitcast %extracted_slice_1131 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1132 = tensor.collapse_shape %2067 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2069 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1132, %2068 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1133 = tensor.expand_shape %2065 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2070 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1133, %2069 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2071 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2070 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2072 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2040, %2071 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2073 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2072 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2074 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2073 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2075 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2074 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2076 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2075 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2077 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2076 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2078 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2077 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2079 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2073, %2078 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2080 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2079 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2081 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%154, %2080 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2082 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2081 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2083 = iree_tensor_ext.bitcast %155 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1134 = tensor.expand_shape %2083 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1135 = tensor.extract_slice %expanded_1134[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1136 = tensor.expand_shape %extracted_slice_1135 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2084 = iree_tensor_ext.bitcast %expanded_1136 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1137 = tensor.extract_slice %expanded_1134[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2085 = iree_tensor_ext.bitcast %extracted_slice_1137 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1138 = tensor.collapse_shape %2084 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2086 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1138, %2085 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1139 = tensor.expand_shape %2082 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2087 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1139, %2086 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2088 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2087 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2089 = iree_tensor_ext.bitcast %156 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1140 = tensor.expand_shape %2089 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1141 = tensor.extract_slice %expanded_1140[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1142 = tensor.expand_shape %extracted_slice_1141 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2090 = iree_tensor_ext.bitcast %expanded_1142 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1143 = tensor.extract_slice %expanded_1140[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2091 = iree_tensor_ext.bitcast %extracted_slice_1143 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1144 = tensor.collapse_shape %2090 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2092 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1144, %2091 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2093 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1139, %2092 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2094 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2093 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %2095 = iree_tensor_ext.bitcast %157 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1145 = tensor.expand_shape %2095 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1146 = tensor.extract_slice %expanded_1145[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1147 = tensor.expand_shape %extracted_slice_1146 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2096 = iree_tensor_ext.bitcast %expanded_1147 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1148 = tensor.extract_slice %expanded_1145[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2097 = iree_tensor_ext.bitcast %extracted_slice_1148 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1149 = tensor.collapse_shape %2096 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2098 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1149, %2097 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2099 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1139, %2098 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2100 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2099 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_1150 = tensor.expand_shape %2088 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1151 = tensor.expand_shape %2094 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1152 = tensor.expand_shape %2100 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_34 = util.global.load immutable @__hoisted_tensor_32xf32_34 : tensor<32xf32>
    %expanded_1153 = tensor.expand_shape %__hoisted_tensor_32xf32_34 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2101 = linalg.batch_mmt4d ins(%expanded_1153, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1154 = linalg.unpack %2101 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2102 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1154 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1155 = tensor.collapse_shape %2102 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2103 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1155, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2104 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2103 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2105 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1154 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1156 = tensor.collapse_shape %2105 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2106 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1156, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2107 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2106 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1157 = tensor.extract_slice %expanded_1150[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1158 = tensor.extract_slice %expanded_1150[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2108 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1157, %2104 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2109 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1158, %2107 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2110 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2108, %2109 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2111 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1158, %2104 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2112 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1157, %2107 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2113 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2111, %2112 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_35 = util.global.load immutable @__hoisted_tensor_32xf32_35 : tensor<32xf32>
    %expanded_1159 = tensor.expand_shape %__hoisted_tensor_32xf32_35 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2114 = linalg.batch_mmt4d ins(%expanded_1159, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1160 = linalg.unpack %2114 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2115 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1160 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1161 = tensor.collapse_shape %2115 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2116 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1161, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2117 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2116 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2118 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1160 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1162 = tensor.collapse_shape %2118 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2119 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1162, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2120 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2119 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1163 = tensor.extract_slice %expanded_1151[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1164 = tensor.extract_slice %expanded_1151[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2121 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1163, %2117 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2122 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1164, %2120 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2123 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2121, %2122 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2124 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1164, %2117 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2125 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1163, %2120 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2126 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2124, %2125 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2127 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2123, %2126 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1165 = tensor.collapse_shape %2127 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2128 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c17_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %2129 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2128 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1166 = tensor.collapse_shape %2129 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1167 = tensor.expand_shape %collapsed_1165 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %2130 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1167 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1168 = tensor.collapse_shape %2130 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2131 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1168, %collapsed_1166 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2028 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2132 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2129 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1169 = tensor.collapse_shape %2132 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1170 = tensor.expand_shape %2100 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %2133 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1170 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1171 = tensor.collapse_shape %2133 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2134 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1171, %collapsed_1169 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2131 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2135 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2110, %2113 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %2136 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1165 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_1172 = tensor.collapse_shape %2135 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_1173 = tensor.collapse_shape %2136 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %2137 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1152 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_1174 = tensor.collapse_shape %2137 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %2138 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1172, %collapsed_1173, %collapsed_1174, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1175 = tensor.expand_shape %2138 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %2139 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1175 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_1176 = tensor.collapse_shape %2139 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2140 = iree_tensor_ext.bitcast %158 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1177 = tensor.expand_shape %2140 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1178 = tensor.extract_slice %expanded_1177[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1179 = tensor.expand_shape %extracted_slice_1178 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2141 = iree_tensor_ext.bitcast %expanded_1179 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1180 = tensor.extract_slice %expanded_1177[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2142 = iree_tensor_ext.bitcast %extracted_slice_1180 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1181 = tensor.collapse_shape %2141 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2143 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1181, %2142 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1182 = tensor.expand_shape %collapsed_1176 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2144 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1182, %2143 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2145 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2144 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2146 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2072, %2145 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2147 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2146 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2148 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2147 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2149 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2148 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2150 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2149 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2151 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2150 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2152 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2151 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2153 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2147, %2152 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2154 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2153 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2155 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%159, %2154 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2156 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2155 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2157 = iree_tensor_ext.bitcast %160 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1183 = tensor.expand_shape %2157 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1184 = tensor.extract_slice %expanded_1183[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1185 = tensor.expand_shape %extracted_slice_1184 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2158 = iree_tensor_ext.bitcast %expanded_1185 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1186 = tensor.extract_slice %expanded_1183[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2159 = iree_tensor_ext.bitcast %extracted_slice_1186 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1187 = tensor.collapse_shape %2158 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2160 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1187, %2159 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1188 = tensor.expand_shape %2156 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2161 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1188, %2160 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2162 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2161 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2163 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2162 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %2164 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2163, %2162 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2165 = iree_tensor_ext.bitcast %161 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1189 = tensor.expand_shape %2165 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1190 = tensor.extract_slice %expanded_1189[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1191 = tensor.expand_shape %extracted_slice_1190 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2166 = iree_tensor_ext.bitcast %expanded_1191 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1192 = tensor.extract_slice %expanded_1189[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2167 = iree_tensor_ext.bitcast %extracted_slice_1192 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1193 = tensor.collapse_shape %2166 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2168 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1193, %2167 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %2169 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1188, %2168 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2170 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2169 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2171 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2164, %2170 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2172 = iree_tensor_ext.bitcast %162 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1194 = tensor.expand_shape %2172 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1195 = tensor.extract_slice %expanded_1194[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1196 = tensor.expand_shape %extracted_slice_1195 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2173 = iree_tensor_ext.bitcast %expanded_1196 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1197 = tensor.extract_slice %expanded_1194[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2174 = iree_tensor_ext.bitcast %extracted_slice_1197 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1198 = tensor.collapse_shape %2173 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2175 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1198, %2174 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1199 = tensor.expand_shape %2171 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2176 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1199, %2175 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2177 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2176 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2178 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2146, %2177 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2179 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2178 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2180 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2179 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2181 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2180 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2182 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2181 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2183 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2182 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2184 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2183 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2185 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2179, %2184 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2186 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2185 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2187 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%163, %2186 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2188 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2187 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2189 = iree_tensor_ext.bitcast %164 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1200 = tensor.expand_shape %2189 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1201 = tensor.extract_slice %expanded_1200[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1202 = tensor.expand_shape %extracted_slice_1201 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2190 = iree_tensor_ext.bitcast %expanded_1202 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1203 = tensor.extract_slice %expanded_1200[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2191 = iree_tensor_ext.bitcast %extracted_slice_1203 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1204 = tensor.collapse_shape %2190 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2192 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1204, %2191 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1205 = tensor.expand_shape %2188 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2193 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1205, %2192 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2194 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2193 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2195 = iree_tensor_ext.bitcast %165 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1206 = tensor.expand_shape %2195 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1207 = tensor.extract_slice %expanded_1206[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1208 = tensor.expand_shape %extracted_slice_1207 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2196 = iree_tensor_ext.bitcast %expanded_1208 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1209 = tensor.extract_slice %expanded_1206[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2197 = iree_tensor_ext.bitcast %extracted_slice_1209 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1210 = tensor.collapse_shape %2196 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2198 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1210, %2197 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2199 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1205, %2198 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2200 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2199 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %2201 = iree_tensor_ext.bitcast %166 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1211 = tensor.expand_shape %2201 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1212 = tensor.extract_slice %expanded_1211[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1213 = tensor.expand_shape %extracted_slice_1212 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2202 = iree_tensor_ext.bitcast %expanded_1213 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1214 = tensor.extract_slice %expanded_1211[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2203 = iree_tensor_ext.bitcast %extracted_slice_1214 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1215 = tensor.collapse_shape %2202 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2204 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1215, %2203 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2205 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1205, %2204 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2206 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2205 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_1216 = tensor.expand_shape %2194 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1217 = tensor.expand_shape %2200 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1218 = tensor.expand_shape %2206 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_36 = util.global.load immutable @__hoisted_tensor_32xf32_36 : tensor<32xf32>
    %expanded_1219 = tensor.expand_shape %__hoisted_tensor_32xf32_36 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2207 = linalg.batch_mmt4d ins(%expanded_1219, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1220 = linalg.unpack %2207 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2208 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1220 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1221 = tensor.collapse_shape %2208 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2209 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1221, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2210 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2209 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2211 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1220 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1222 = tensor.collapse_shape %2211 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2212 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1222, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2213 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2212 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1223 = tensor.extract_slice %expanded_1216[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1224 = tensor.extract_slice %expanded_1216[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2214 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1223, %2210 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2215 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1224, %2213 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2216 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2214, %2215 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2217 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1224, %2210 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2218 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1223, %2213 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2219 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2217, %2218 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_37 = util.global.load immutable @__hoisted_tensor_32xf32_37 : tensor<32xf32>
    %expanded_1225 = tensor.expand_shape %__hoisted_tensor_32xf32_37 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2220 = linalg.batch_mmt4d ins(%expanded_1225, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1226 = linalg.unpack %2220 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2221 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1226 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1227 = tensor.collapse_shape %2221 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2222 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1227, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2223 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2222 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2224 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1226 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1228 = tensor.collapse_shape %2224 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2225 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1228, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2226 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2225 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1229 = tensor.extract_slice %expanded_1217[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1230 = tensor.extract_slice %expanded_1217[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2227 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1229, %2223 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2228 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1230, %2226 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2229 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2227, %2228 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2230 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1230, %2223 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2231 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1229, %2226 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2232 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2230, %2231 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2233 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2229, %2232 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1231 = tensor.collapse_shape %2233 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2234 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c18_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %2235 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1232 = tensor.collapse_shape %2235 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1233 = tensor.expand_shape %collapsed_1231 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %2236 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1233 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1234 = tensor.collapse_shape %2236 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2237 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1234, %collapsed_1232 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2134 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2238 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2235 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1235 = tensor.collapse_shape %2238 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1236 = tensor.expand_shape %2206 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %2239 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1236 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1237 = tensor.collapse_shape %2239 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2240 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1237, %collapsed_1235 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2237 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2241 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2216, %2219 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %2242 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1231 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_1238 = tensor.collapse_shape %2241 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_1239 = tensor.collapse_shape %2242 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %2243 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1218 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_1240 = tensor.collapse_shape %2243 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %2244 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1238, %collapsed_1239, %collapsed_1240, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1241 = tensor.expand_shape %2244 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %2245 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1241 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_1242 = tensor.collapse_shape %2245 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2246 = iree_tensor_ext.bitcast %167 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1243 = tensor.expand_shape %2246 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1244 = tensor.extract_slice %expanded_1243[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1245 = tensor.expand_shape %extracted_slice_1244 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2247 = iree_tensor_ext.bitcast %expanded_1245 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1246 = tensor.extract_slice %expanded_1243[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2248 = iree_tensor_ext.bitcast %extracted_slice_1246 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1247 = tensor.collapse_shape %2247 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2249 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1247, %2248 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1248 = tensor.expand_shape %collapsed_1242 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2250 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1248, %2249 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2251 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2250 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2252 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2178, %2251 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2253 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2252 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2254 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2253 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2255 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2254 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2256 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2255 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2257 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2256 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2258 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2257 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2259 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2253, %2258 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2260 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2259 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2261 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%168, %2260 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2262 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2261 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2263 = iree_tensor_ext.bitcast %169 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1249 = tensor.expand_shape %2263 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1250 = tensor.extract_slice %expanded_1249[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1251 = tensor.expand_shape %extracted_slice_1250 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2264 = iree_tensor_ext.bitcast %expanded_1251 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1252 = tensor.extract_slice %expanded_1249[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2265 = iree_tensor_ext.bitcast %extracted_slice_1252 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1253 = tensor.collapse_shape %2264 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2266 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1253, %2265 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1254 = tensor.expand_shape %2262 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2267 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1254, %2266 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2268 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2267 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2269 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2268 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %2270 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2269, %2268 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2271 = iree_tensor_ext.bitcast %170 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1255 = tensor.expand_shape %2271 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1256 = tensor.extract_slice %expanded_1255[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1257 = tensor.expand_shape %extracted_slice_1256 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2272 = iree_tensor_ext.bitcast %expanded_1257 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1258 = tensor.extract_slice %expanded_1255[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2273 = iree_tensor_ext.bitcast %extracted_slice_1258 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1259 = tensor.collapse_shape %2272 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2274 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1259, %2273 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %2275 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1254, %2274 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2276 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2275 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2277 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2270, %2276 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2278 = iree_tensor_ext.bitcast %171 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1260 = tensor.expand_shape %2278 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1261 = tensor.extract_slice %expanded_1260[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1262 = tensor.expand_shape %extracted_slice_1261 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2279 = iree_tensor_ext.bitcast %expanded_1262 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1263 = tensor.extract_slice %expanded_1260[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2280 = iree_tensor_ext.bitcast %extracted_slice_1263 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1264 = tensor.collapse_shape %2279 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2281 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1264, %2280 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1265 = tensor.expand_shape %2277 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2282 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1265, %2281 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2283 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2282 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2284 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2252, %2283 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2285 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2284 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2286 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2285 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2287 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2286 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2288 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2287 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2289 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2288 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2290 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2289 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2291 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2285, %2290 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2292 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2291 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2293 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%172, %2292 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2294 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2293 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2295 = iree_tensor_ext.bitcast %173 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1266 = tensor.expand_shape %2295 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1267 = tensor.extract_slice %expanded_1266[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1268 = tensor.expand_shape %extracted_slice_1267 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2296 = iree_tensor_ext.bitcast %expanded_1268 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1269 = tensor.extract_slice %expanded_1266[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2297 = iree_tensor_ext.bitcast %extracted_slice_1269 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1270 = tensor.collapse_shape %2296 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2298 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1270, %2297 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1271 = tensor.expand_shape %2294 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2299 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1271, %2298 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2300 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2299 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2301 = iree_tensor_ext.bitcast %174 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1272 = tensor.expand_shape %2301 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1273 = tensor.extract_slice %expanded_1272[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1274 = tensor.expand_shape %extracted_slice_1273 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2302 = iree_tensor_ext.bitcast %expanded_1274 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1275 = tensor.extract_slice %expanded_1272[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2303 = iree_tensor_ext.bitcast %extracted_slice_1275 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1276 = tensor.collapse_shape %2302 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2304 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1276, %2303 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2305 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1271, %2304 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2306 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2305 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %2307 = iree_tensor_ext.bitcast %175 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1277 = tensor.expand_shape %2307 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1278 = tensor.extract_slice %expanded_1277[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1279 = tensor.expand_shape %extracted_slice_1278 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2308 = iree_tensor_ext.bitcast %expanded_1279 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1280 = tensor.extract_slice %expanded_1277[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2309 = iree_tensor_ext.bitcast %extracted_slice_1280 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1281 = tensor.collapse_shape %2308 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2310 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1281, %2309 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2311 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1271, %2310 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2312 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2311 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_1282 = tensor.expand_shape %2300 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1283 = tensor.expand_shape %2306 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1284 = tensor.expand_shape %2312 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_38 = util.global.load immutable @__hoisted_tensor_32xf32_38 : tensor<32xf32>
    %expanded_1285 = tensor.expand_shape %__hoisted_tensor_32xf32_38 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2313 = linalg.batch_mmt4d ins(%expanded_1285, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1286 = linalg.unpack %2313 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2314 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1286 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1287 = tensor.collapse_shape %2314 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2315 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1287, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2316 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2315 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2317 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1286 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1288 = tensor.collapse_shape %2317 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2318 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1288, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2319 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2318 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1289 = tensor.extract_slice %expanded_1282[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1290 = tensor.extract_slice %expanded_1282[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2320 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1289, %2316 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2321 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1290, %2319 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2322 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2320, %2321 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2323 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1290, %2316 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2324 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1289, %2319 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2325 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2323, %2324 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_39 = util.global.load immutable @__hoisted_tensor_32xf32_39 : tensor<32xf32>
    %expanded_1291 = tensor.expand_shape %__hoisted_tensor_32xf32_39 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2326 = linalg.batch_mmt4d ins(%expanded_1291, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1292 = linalg.unpack %2326 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2327 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1292 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1293 = tensor.collapse_shape %2327 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2328 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1293, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2329 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2328 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2330 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1292 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1294 = tensor.collapse_shape %2330 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2331 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1294, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2332 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2331 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1295 = tensor.extract_slice %expanded_1283[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1296 = tensor.extract_slice %expanded_1283[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2333 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1295, %2329 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2334 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1296, %2332 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2335 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2333, %2334 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2336 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1296, %2329 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2337 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1295, %2332 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2338 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2336, %2337 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2339 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2335, %2338 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1297 = tensor.collapse_shape %2339 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2340 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c19_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %2341 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2340 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1298 = tensor.collapse_shape %2341 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1299 = tensor.expand_shape %collapsed_1297 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %2342 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1299 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1300 = tensor.collapse_shape %2342 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2343 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1300, %collapsed_1298 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2240 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2344 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2341 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1301 = tensor.collapse_shape %2344 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1302 = tensor.expand_shape %2312 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %2345 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1302 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1303 = tensor.collapse_shape %2345 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2346 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1303, %collapsed_1301 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2343 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2347 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2322, %2325 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %2348 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1297 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_1304 = tensor.collapse_shape %2347 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_1305 = tensor.collapse_shape %2348 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %2349 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1284 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_1306 = tensor.collapse_shape %2349 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %2350 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1304, %collapsed_1305, %collapsed_1306, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1307 = tensor.expand_shape %2350 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %2351 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1307 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_1308 = tensor.collapse_shape %2351 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2352 = iree_tensor_ext.bitcast %176 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1309 = tensor.expand_shape %2352 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1310 = tensor.extract_slice %expanded_1309[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1311 = tensor.expand_shape %extracted_slice_1310 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2353 = iree_tensor_ext.bitcast %expanded_1311 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1312 = tensor.extract_slice %expanded_1309[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2354 = iree_tensor_ext.bitcast %extracted_slice_1312 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1313 = tensor.collapse_shape %2353 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2355 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1313, %2354 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1314 = tensor.expand_shape %collapsed_1308 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2356 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1314, %2355 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2357 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2356 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2358 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2284, %2357 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2359 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2358 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2360 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2359 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2361 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2360 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2362 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2361 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2363 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2362 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2364 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2363 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2365 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2359, %2364 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2366 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2365 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2367 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%177, %2366 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2368 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2367 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2369 = iree_tensor_ext.bitcast %178 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1315 = tensor.expand_shape %2369 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1316 = tensor.extract_slice %expanded_1315[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1317 = tensor.expand_shape %extracted_slice_1316 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2370 = iree_tensor_ext.bitcast %expanded_1317 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1318 = tensor.extract_slice %expanded_1315[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2371 = iree_tensor_ext.bitcast %extracted_slice_1318 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1319 = tensor.collapse_shape %2370 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2372 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1319, %2371 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1320 = tensor.expand_shape %2368 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2373 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1320, %2372 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2374 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2373 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2375 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2374 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %2376 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2375, %2374 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2377 = iree_tensor_ext.bitcast %179 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1321 = tensor.expand_shape %2377 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1322 = tensor.extract_slice %expanded_1321[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1323 = tensor.expand_shape %extracted_slice_1322 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2378 = iree_tensor_ext.bitcast %expanded_1323 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1324 = tensor.extract_slice %expanded_1321[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2379 = iree_tensor_ext.bitcast %extracted_slice_1324 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1325 = tensor.collapse_shape %2378 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2380 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1325, %2379 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %2381 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1320, %2380 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2382 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2381 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2383 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2376, %2382 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2384 = iree_tensor_ext.bitcast %180 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1326 = tensor.expand_shape %2384 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1327 = tensor.extract_slice %expanded_1326[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1328 = tensor.expand_shape %extracted_slice_1327 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2385 = iree_tensor_ext.bitcast %expanded_1328 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1329 = tensor.extract_slice %expanded_1326[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2386 = iree_tensor_ext.bitcast %extracted_slice_1329 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1330 = tensor.collapse_shape %2385 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2387 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1330, %2386 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1331 = tensor.expand_shape %2383 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2388 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1331, %2387 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2389 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2388 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2390 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2358, %2389 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2391 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2390 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2392 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2391 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2393 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2392 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2394 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2393 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2395 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2394 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2396 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2395 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2397 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2391, %2396 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2398 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2397 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2399 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%181, %2398 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2400 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2399 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2401 = iree_tensor_ext.bitcast %182 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1332 = tensor.expand_shape %2401 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1333 = tensor.extract_slice %expanded_1332[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1334 = tensor.expand_shape %extracted_slice_1333 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2402 = iree_tensor_ext.bitcast %expanded_1334 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1335 = tensor.extract_slice %expanded_1332[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2403 = iree_tensor_ext.bitcast %extracted_slice_1335 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1336 = tensor.collapse_shape %2402 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2404 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1336, %2403 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1337 = tensor.expand_shape %2400 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2405 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1337, %2404 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2406 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2405 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2407 = iree_tensor_ext.bitcast %183 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1338 = tensor.expand_shape %2407 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1339 = tensor.extract_slice %expanded_1338[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1340 = tensor.expand_shape %extracted_slice_1339 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2408 = iree_tensor_ext.bitcast %expanded_1340 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1341 = tensor.extract_slice %expanded_1338[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2409 = iree_tensor_ext.bitcast %extracted_slice_1341 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1342 = tensor.collapse_shape %2408 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2410 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1342, %2409 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2411 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1337, %2410 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2412 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2411 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %2413 = iree_tensor_ext.bitcast %184 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1343 = tensor.expand_shape %2413 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1344 = tensor.extract_slice %expanded_1343[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1345 = tensor.expand_shape %extracted_slice_1344 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2414 = iree_tensor_ext.bitcast %expanded_1345 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1346 = tensor.extract_slice %expanded_1343[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2415 = iree_tensor_ext.bitcast %extracted_slice_1346 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1347 = tensor.collapse_shape %2414 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2416 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1347, %2415 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2417 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1337, %2416 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2418 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2417 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_1348 = tensor.expand_shape %2406 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1349 = tensor.expand_shape %2412 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1350 = tensor.expand_shape %2418 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_40 = util.global.load immutable @__hoisted_tensor_32xf32_40 : tensor<32xf32>
    %expanded_1351 = tensor.expand_shape %__hoisted_tensor_32xf32_40 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2419 = linalg.batch_mmt4d ins(%expanded_1351, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1352 = linalg.unpack %2419 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2420 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1352 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1353 = tensor.collapse_shape %2420 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2421 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1353, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2422 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2421 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2423 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1352 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1354 = tensor.collapse_shape %2423 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2424 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1354, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2425 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2424 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1355 = tensor.extract_slice %expanded_1348[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1356 = tensor.extract_slice %expanded_1348[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2426 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1355, %2422 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2427 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1356, %2425 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2428 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2426, %2427 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2429 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1356, %2422 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2430 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1355, %2425 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2431 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2429, %2430 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_41 = util.global.load immutable @__hoisted_tensor_32xf32_41 : tensor<32xf32>
    %expanded_1357 = tensor.expand_shape %__hoisted_tensor_32xf32_41 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2432 = linalg.batch_mmt4d ins(%expanded_1357, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1358 = linalg.unpack %2432 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2433 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1358 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1359 = tensor.collapse_shape %2433 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2434 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1359, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2435 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2434 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2436 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1358 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1360 = tensor.collapse_shape %2436 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2437 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1360, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2438 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2437 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1361 = tensor.extract_slice %expanded_1349[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1362 = tensor.extract_slice %expanded_1349[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2439 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1361, %2435 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2440 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1362, %2438 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2441 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2439, %2440 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2442 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1362, %2435 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2443 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1361, %2438 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2444 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2442, %2443 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2445 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2441, %2444 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1363 = tensor.collapse_shape %2445 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2446 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c20_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %2447 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2446 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1364 = tensor.collapse_shape %2447 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1365 = tensor.expand_shape %collapsed_1363 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %2448 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1365 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1366 = tensor.collapse_shape %2448 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2449 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1366, %collapsed_1364 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2346 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2450 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2447 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1367 = tensor.collapse_shape %2450 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1368 = tensor.expand_shape %2418 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %2451 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1368 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1369 = tensor.collapse_shape %2451 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2452 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1369, %collapsed_1367 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2449 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2453 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2428, %2431 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %2454 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1363 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_1370 = tensor.collapse_shape %2453 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_1371 = tensor.collapse_shape %2454 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %2455 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1350 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_1372 = tensor.collapse_shape %2455 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %2456 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1370, %collapsed_1371, %collapsed_1372, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1373 = tensor.expand_shape %2456 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %2457 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1373 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_1374 = tensor.collapse_shape %2457 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2458 = iree_tensor_ext.bitcast %185 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1375 = tensor.expand_shape %2458 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1376 = tensor.extract_slice %expanded_1375[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1377 = tensor.expand_shape %extracted_slice_1376 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2459 = iree_tensor_ext.bitcast %expanded_1377 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1378 = tensor.extract_slice %expanded_1375[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2460 = iree_tensor_ext.bitcast %extracted_slice_1378 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1379 = tensor.collapse_shape %2459 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2461 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1379, %2460 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1380 = tensor.expand_shape %collapsed_1374 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2462 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1380, %2461 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2463 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2462 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2464 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2390, %2463 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2465 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2464 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2466 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2465 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2467 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2466 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2468 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2467 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2469 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2468 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2470 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2469 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2471 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2465, %2470 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2472 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2471 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2473 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%186, %2472 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2474 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2473 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2475 = iree_tensor_ext.bitcast %187 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1381 = tensor.expand_shape %2475 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1382 = tensor.extract_slice %expanded_1381[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1383 = tensor.expand_shape %extracted_slice_1382 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2476 = iree_tensor_ext.bitcast %expanded_1383 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1384 = tensor.extract_slice %expanded_1381[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2477 = iree_tensor_ext.bitcast %extracted_slice_1384 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1385 = tensor.collapse_shape %2476 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2478 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1385, %2477 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1386 = tensor.expand_shape %2474 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2479 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1386, %2478 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2480 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2479 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2481 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2480 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %2482 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2481, %2480 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2483 = iree_tensor_ext.bitcast %188 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1387 = tensor.expand_shape %2483 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1388 = tensor.extract_slice %expanded_1387[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1389 = tensor.expand_shape %extracted_slice_1388 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2484 = iree_tensor_ext.bitcast %expanded_1389 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1390 = tensor.extract_slice %expanded_1387[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2485 = iree_tensor_ext.bitcast %extracted_slice_1390 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1391 = tensor.collapse_shape %2484 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2486 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1391, %2485 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %2487 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1386, %2486 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2488 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2487 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2489 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2482, %2488 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2490 = iree_tensor_ext.bitcast %189 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1392 = tensor.expand_shape %2490 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1393 = tensor.extract_slice %expanded_1392[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1394 = tensor.expand_shape %extracted_slice_1393 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2491 = iree_tensor_ext.bitcast %expanded_1394 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1395 = tensor.extract_slice %expanded_1392[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2492 = iree_tensor_ext.bitcast %extracted_slice_1395 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1396 = tensor.collapse_shape %2491 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2493 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1396, %2492 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1397 = tensor.expand_shape %2489 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2494 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1397, %2493 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2495 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2494 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2496 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2464, %2495 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2497 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2496 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2498 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2497 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2499 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2498 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2500 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2499 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2501 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2500 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2502 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2501 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2503 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2497, %2502 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2504 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2503 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2505 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%190, %2504 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2506 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2505 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2507 = iree_tensor_ext.bitcast %191 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1398 = tensor.expand_shape %2507 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1399 = tensor.extract_slice %expanded_1398[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1400 = tensor.expand_shape %extracted_slice_1399 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2508 = iree_tensor_ext.bitcast %expanded_1400 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1401 = tensor.extract_slice %expanded_1398[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2509 = iree_tensor_ext.bitcast %extracted_slice_1401 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1402 = tensor.collapse_shape %2508 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2510 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1402, %2509 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1403 = tensor.expand_shape %2506 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2511 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1403, %2510 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2512 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2511 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2513 = iree_tensor_ext.bitcast %192 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1404 = tensor.expand_shape %2513 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1405 = tensor.extract_slice %expanded_1404[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1406 = tensor.expand_shape %extracted_slice_1405 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2514 = iree_tensor_ext.bitcast %expanded_1406 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1407 = tensor.extract_slice %expanded_1404[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2515 = iree_tensor_ext.bitcast %extracted_slice_1407 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1408 = tensor.collapse_shape %2514 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2516 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1408, %2515 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2517 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1403, %2516 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2518 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2517 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %2519 = iree_tensor_ext.bitcast %193 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1409 = tensor.expand_shape %2519 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1410 = tensor.extract_slice %expanded_1409[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1411 = tensor.expand_shape %extracted_slice_1410 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2520 = iree_tensor_ext.bitcast %expanded_1411 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1412 = tensor.extract_slice %expanded_1409[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2521 = iree_tensor_ext.bitcast %extracted_slice_1412 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1413 = tensor.collapse_shape %2520 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2522 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1413, %2521 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%247 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<256x64x32xf16>
    %2523 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1403, %2522 : tensor<4x?x64x32xf16>, tensor<256x64x32xf16>) outs(%250 : tensor<4x?x256xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x256xf32>
    %2524 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2523 : tensor<4x?x256xf32>) outs(%252 : tensor<4x?x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x256xf16>
    %expanded_1414 = tensor.expand_shape %2512 [[0], [1], [2, 3]] output_shape [4, %209, 32, 64] : tensor<4x?x2048xf16> into tensor<4x?x32x64xf16>
    %expanded_1415 = tensor.expand_shape %2518 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %expanded_1416 = tensor.expand_shape %2524 [[0], [1], [2, 3]] output_shape [4, %209, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x4x64xf16>
    %__hoisted_tensor_32xf32_42 = util.global.load immutable @__hoisted_tensor_32xf32_42 : tensor<32xf32>
    %expanded_1417 = tensor.expand_shape %__hoisted_tensor_32xf32_42 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2525 = linalg.batch_mmt4d ins(%expanded_1417, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1418 = linalg.unpack %2525 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2526 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1418 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1419 = tensor.collapse_shape %2526 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2527 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1419, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2528 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2527 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2529 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1418 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1420 = tensor.collapse_shape %2529 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2530 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1420, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2531 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2530 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1421 = tensor.extract_slice %expanded_1414[0, 0, 0, 0] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %extracted_slice_1422 = tensor.extract_slice %expanded_1414[0, 0, 0, 1] [4, %209, 32, 32] [1, 1, 1, 2] : tensor<4x?x32x64xf16> to tensor<4x?x32x32xf16>
    %2532 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1421, %2528 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2533 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1422, %2531 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2534 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2532, %2533 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2535 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1422, %2528 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2536 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1421, %2531 : tensor<4x?x32x32xf16>, tensor<?x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %2537 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2535, %2536 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%280 : tensor<4x?x32x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32x32xf16>
    %__hoisted_tensor_32xf32_43 = util.global.load immutable @__hoisted_tensor_32xf32_43 : tensor<32xf32>
    %expanded_1423 = tensor.expand_shape %__hoisted_tensor_32xf32_43 [[0, 1, 2, 3, 4]] output_shape [1, 4, 1, 8, 1] : tensor<32xf32> into tensor<1x4x1x8x1xf32>
    %2538 = linalg.batch_mmt4d ins(%expanded_1423, %pack : tensor<1x4x1x8x1xf32>, tensor<1x?x1x8x1xf32>) outs(%269 : tensor<1x4x?x8x8xf32>) -> tensor<1x4x?x8x8xf32>
    %unpack_1424 = linalg.unpack %2538 outer_dims_perm = [1, 2, 0] inner_dims_pos = [2, 0] inner_tiles = [8, 8] into %272 : tensor<1x4x?x8x8xf32> -> tensor<?x1x32xf32>
    %2539 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1424 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.cos %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1425 = tensor.collapse_shape %2539 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2540 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1425, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2541 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2540 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %2542 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%unpack_1424 : tensor<?x1x32xf32>) outs(%272 : tensor<?x1x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.sin %in : f32
      linalg.yield %2625 : f32
    } -> tensor<?x1x32xf32>
    %collapsed_1426 = tensor.collapse_shape %2542 [[0], [1, 2]] : tensor<?x1x32xf32> into tensor<?x32xf32>
    %2543 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1426, %cst_3 : tensor<?x32xf32>, tensor<f32>) outs(%271 : tensor<?x32xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<?x32xf32>
    %2544 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2543 : tensor<?x32xf32>) outs(%275 : tensor<?x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<?x32xf16>
    %extracted_slice_1427 = tensor.extract_slice %expanded_1415[0, 0, 0, 0] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %extracted_slice_1428 = tensor.extract_slice %expanded_1415[0, 0, 0, 1] [4, %209, 4, 32] [1, 1, 1, 2] : tensor<4x?x4x64xf16> to tensor<4x?x4x32xf16>
    %2545 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1427, %2541 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2546 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1428, %2544 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2547 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2545, %2546 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.subf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2548 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1428, %2541 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2549 = linalg.generic {indexing_maps = [#map9, #map10, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%extracted_slice_1427, %2544 : tensor<4x?x4x32xf16>, tensor<?x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2550 = linalg.generic {indexing_maps = [#map9, #map9, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2548, %2549 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%294 : tensor<4x?x4x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x4x32xf16>
    %2551 = linalg.generic {indexing_maps = [#map11, #map11, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2547, %2550 : tensor<4x?x4x32xf16>, tensor<4x?x4x32xf16>) outs(%301 : tensor<4x?x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x?x4x2x32xf16>
    %collapsed_1429 = tensor.collapse_shape %2551 [[0], [1], [2], [3, 4]] : tensor<4x?x4x2x32xf16> into tensor<4x?x4x64xf16>
    %2552 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%304 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c21_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %2553 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2552 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1430 = tensor.collapse_shape %2553 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1431 = tensor.expand_shape %collapsed_1429 [[0], [1, 2], [3], [4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x4x64xf16> into tensor<4x?x32x4x64xf16>
    %2554 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1431 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1432 = tensor.collapse_shape %2554 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2555 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1432, %collapsed_1430 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2452 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %2556 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2553 : tensor<4x?xi64>) outs(%303 : tensor<4x?xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2625 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2625 : i64
    } -> tensor<4x?xi64>
    %collapsed_1433 = tensor.collapse_shape %2556 [[0, 1]] : tensor<4x?xi64> into tensor<?xi64>
    %expanded_1434 = tensor.expand_shape %2524 [[0], [1, 2], [3, 4]] output_shape [4, %306, 32, 4, 64] : tensor<4x?x256xf16> into tensor<4x?x32x4x64xf16>
    %2557 = linalg.generic {indexing_maps = [#map13, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1434 : tensor<4x?x32x4x64xf16>) outs(%307 : tensor<4x?x4x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x4x32x64xf16>
    %collapsed_1435 = tensor.collapse_shape %2557 [[0, 1], [2], [3], [4]] : tensor<4x?x4x32x64xf16> into tensor<?x4x32x64xf16>
    %2558 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1435, %collapsed_1433 : tensor<?x4x32x64xf16>, tensor<?xi64>) outs(%2555 : tensor<?x4x32x64xf16>) {
    ^bb0(%arg6: f16, %arg7: f16):
      iree_linalg_ext.yield %arg6 : f16
    } -> tensor<?x4x32x64xf16>
    %expanded_1436 = tensor.expand_shape %2558 [[0, 1, 2], [3], [4], [5]] output_shape [%213, 22, 2, 4, 32, 64] : tensor<?x4x32x64xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_1437 = tensor.collapse_shape %expanded_1436 [[0], [1, 2, 3, 4, 5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x360448xf16>
    %2559 = linalg.generic {indexing_maps = [#map19, #map19, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2534, %2537 : tensor<4x?x32x32xf16>, tensor<4x?x32x32xf16>) outs(%321 : tensor<4x32x?x2x32xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = linalg.index 3 : index
      %2626 = arith.cmpi eq, %2625, %c0 : index
      %2627 = arith.select %2626, %in, %in_1472 : f16
      linalg.yield %2627 : f16
    } -> tensor<4x32x?x2x32xf16>
    %2560 = linalg.generic {indexing_maps = [#map20, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%collapsed_1429 : tensor<4x?x4x64xf16>) outs(%323 : tensor<4x4x8x?x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x64xf16>
    %collapsed_1438 = tensor.collapse_shape %2559 [[0, 1], [2], [3, 4]] : tensor<4x32x?x2x32xf16> into tensor<128x?x64xf16>
    %collapsed_1439 = tensor.collapse_shape %2560 [[0, 1, 2], [3], [4]] : tensor<4x4x8x?x64xf16> into tensor<128x?x64xf16>
    %2561 = linalg.generic {indexing_maps = [#map22, #map12], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1416 : tensor<4x?x4x64xf16>) outs(%328 : tensor<4x4x8x64x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?xf16>
    %collapsed_1440 = tensor.collapse_shape %2561 [[0, 1, 2], [3], [4]] : tensor<4x4x8x64x?xf16> into tensor<128x64x?xf16>
    %2562 = iree_linalg_ext.attention {indexing_maps = [#map23, #map24, #map25, #map26, #map27, #map6]} ins(%collapsed_1438, %collapsed_1439, %collapsed_1440, %cst_5, %collapsed_51 : tensor<128x?x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?x?xf16>) outs(%327 : tensor<128x?x64xf16>) {
    ^bb0(%arg6: f32):
      iree_linalg_ext.yield %arg6 : f32
    } -> tensor<128x?x64xf16>
    %expanded_1441 = tensor.expand_shape %2562 [[0, 1], [2], [3]] output_shape [4, 32, %209, 64] : tensor<128x?x64xf16> into tensor<4x32x?x64xf16>
    %2563 = linalg.generic {indexing_maps = [#map28, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%expanded_1441 : tensor<4x32x?x64xf16>) outs(%331 : tensor<4x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x?x32x64xf16>
    %collapsed_1442 = tensor.collapse_shape %2563 [[0], [1], [2, 3]] : tensor<4x?x32x64xf16> into tensor<4x?x2048xf16>
    %2564 = iree_tensor_ext.bitcast %194 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1443 = tensor.expand_shape %2564 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1444 = tensor.extract_slice %expanded_1443[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1445 = tensor.expand_shape %extracted_slice_1444 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2565 = iree_tensor_ext.bitcast %expanded_1445 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1446 = tensor.extract_slice %expanded_1443[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2566 = iree_tensor_ext.bitcast %extracted_slice_1446 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1447 = tensor.collapse_shape %2565 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2567 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1447, %2566 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%239 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1448 = tensor.expand_shape %collapsed_1442 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2568 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1448, %2567 : tensor<4x?x64x32xf16>, tensor<2048x64x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2569 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2568 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2570 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2496, %2569 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2571 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2570 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2572 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2571 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2573 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2572 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2574 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2573 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2575 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2574 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2576 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2575 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2577 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2571, %2576 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2578 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2577 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2579 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%195, %2578 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2580 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2579 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2581 = iree_tensor_ext.bitcast %196 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1449 = tensor.expand_shape %2581 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1450 = tensor.extract_slice %expanded_1449[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1451 = tensor.expand_shape %extracted_slice_1450 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2582 = iree_tensor_ext.bitcast %expanded_1451 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1452 = tensor.extract_slice %expanded_1449[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2583 = iree_tensor_ext.bitcast %extracted_slice_1452 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1453 = tensor.collapse_shape %2582 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2584 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1453, %2583 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1454 = tensor.expand_shape %2580 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2585 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1454, %2584 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2586 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2585 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2587 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2586 : tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2625 = arith.negf %in : f16
      %2626 = math.exp %2625 : f16
      %2627 = arith.addf %2626, %cst_1 : f16
      %2628 = arith.divf %cst_1, %2627 : f16
      linalg.yield %2628 : f16
    } -> tensor<4x?x5632xf16>
    %2588 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2587, %2586 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2589 = iree_tensor_ext.bitcast %197 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1455 = tensor.expand_shape %2589 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1456 = tensor.extract_slice %expanded_1455[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1457 = tensor.expand_shape %extracted_slice_1456 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2590 = iree_tensor_ext.bitcast %expanded_1457 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1458 = tensor.extract_slice %expanded_1455[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2591 = iree_tensor_ext.bitcast %extracted_slice_1458 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1459 = tensor.collapse_shape %2590 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2592 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1459, %2591 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%353 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<5632x64x32xf16>
    %2593 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1454, %2592 : tensor<4x?x64x32xf16>, tensor<5632x64x32xf16>) outs(%356 : tensor<4x?x5632xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x5632xf32>
    %2594 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2593 : tensor<4x?x5632xf32>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2595 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2588, %2594 : tensor<4x?x5632xf16>, tensor<4x?x5632xf16>) outs(%358 : tensor<4x?x5632xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.mulf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x5632xf16>
    %2596 = iree_tensor_ext.bitcast %198 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1460 = tensor.expand_shape %2596 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1461 = tensor.extract_slice %expanded_1460[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1462 = tensor.expand_shape %extracted_slice_1461 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2597 = iree_tensor_ext.bitcast %expanded_1462 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1463 = tensor.extract_slice %expanded_1460[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2598 = iree_tensor_ext.bitcast %extracted_slice_1463 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1464 = tensor.collapse_shape %2597 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2599 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1464, %2598 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%372 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1465 = tensor.expand_shape %2595 [[0], [1], [2, 3]] output_shape [4, %209, 176, 32] : tensor<4x?x5632xf16> into tensor<4x?x176x32xf16>
    %2600 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1465, %2599 : tensor<4x?x176x32xf16>, tensor<2048x176x32xf16>) outs(%241 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x2048xf32>
    %2601 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2600 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2602 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2570, %2601 : tensor<4x?x2048xf16>, tensor<4x?x2048xf16>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f16):
      %2625 = arith.addf %in, %in_1472 : f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2603 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2602 : tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2625 = arith.extf %in : f16 to f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2604 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2603 : tensor<4x?x2048xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2605 = linalg.generic {indexing_maps = [#map, #map1], iterator_types = ["parallel", "parallel", "reduction"]} ins(%2604 : tensor<4x?x2048xf32>) outs(%227 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %out : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2606 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2605 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.divf %in, %cst_0 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2607 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2606 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = arith.addf %in, %cst : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2608 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2607 : tensor<4x?xf32>) outs(%226 : tensor<4x?xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2625 = math.rsqrt %in : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?xf32>
    %2609 = linalg.generic {indexing_maps = [#map, #map1, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2603, %2608 : tensor<4x?x2048xf32>, tensor<4x?xf32>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f32, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f32
      linalg.yield %2625 : f32
    } -> tensor<4x?x2048xf32>
    %2610 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2609 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2611 = linalg.generic {indexing_maps = [#map3, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%199, %2610 : tensor<2048xf32>, tensor<4x?x2048xf16>) outs(%223 : tensor<4x?x2048xf32>) {
    ^bb0(%in: f32, %in_1472: f16, %out: f32):
      %2625 = arith.extf %in_1472 : f16 to f32
      %2626 = arith.mulf %in, %2625 : f32
      linalg.yield %2626 : f32
    } -> tensor<4x?x2048xf32>
    %2612 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2611 : tensor<4x?x2048xf32>) outs(%221 : tensor<4x?x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x2048xf16>
    %2613 = iree_tensor_ext.bitcast %200 : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded_1466 = tensor.expand_shape %2613 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice_1467 = tensor.extract_slice %expanded_1466[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64xi16>
    %expanded_1468 = tensor.expand_shape %extracted_slice_1467 [[0], [1, 2]] output_shape [32000, 64, 1] : tensor<32000x64xi16> into tensor<32000x64x1xi16>
    %2614 = iree_tensor_ext.bitcast %expanded_1468 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_1469 = tensor.extract_slice %expanded_1466[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %2615 = iree_tensor_ext.bitcast %extracted_slice_1469 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %collapsed_1470 = tensor.collapse_shape %2614 [[0], [1, 2]] : tensor<32000x64x1xf16> into tensor<32000x64xf16>
    %2616 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1470, %2615 : tensor<32000x64xf16>, tensor<32000x64x32xi8>) outs(%218 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1472: i8, %out: f16):
      %2625 = arith.extsi %in_1472 : i8 to i32
      %2626 = arith.sitofp %2625 : i32 to f16
      %2627 = arith.mulf %2626, %in : f16
      linalg.yield %2627 : f16
    } -> tensor<32000x64x32xf16>
    %expanded_1471 = tensor.expand_shape %2612 [[0], [1], [2, 3]] output_shape [4, %209, 64, 32] : tensor<4x?x2048xf16> into tensor<4x?x64x32xf16>
    %2617 = tensor.empty(%209) : tensor<4x?x32000xf32>
    %2618 = linalg.fill ins(%cst_2 : f32) outs(%2617 : tensor<4x?x32000xf32>) -> tensor<4x?x32000xf32>
    %2619 = linalg.generic {indexing_maps = [#map4, #map5, #map6], iterator_types = ["parallel", "parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1471, %2616 : tensor<4x?x64x32xf16>, tensor<32000x64x32xf16>) outs(%2618 : tensor<4x?x32000xf32>) {
    ^bb0(%in: f16, %in_1472: f16, %out: f32):
      %2625 = arith.mulf %in, %in_1472 : f16
      %2626 = arith.extf %2625 : f16 to f32
      %2627 = arith.addf %2626, %out : f32
      linalg.yield %2627 : f32
    } -> tensor<4x?x32000xf32>
    %2620 = tensor.empty(%209) : tensor<4x?x32000xf16>
    %2621 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2619 : tensor<4x?x32000xf32>) outs(%2620 : tensor<4x?x32000xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2625 = arith.truncf %in : f32 to f16
      linalg.yield %2625 : f16
    } -> tensor<4x?x32000xf16>
    %2622 = hal.tensor.alias on(#hal.device.affinity<@__device_0>) wait(%arg4) => %collapsed_1437 : tensor<?x360448xf16>{%213} to %arg3 : !hal.buffer_view
    %2623:2 = hal.tensor.barrier join(%2622, %2621 : tensor<?x360448xf16>, tensor<4x?x32000xf16>) => %arg5 : !hal.fence
    %dim = tensor.dim %2623#1, %c1 : tensor<4x?x32000xf16>
    %2624 = hal.tensor.export %2623#1 : tensor<4x?x32000xf16>{%dim} -> !hal.buffer_view
    util.return %2624 : !hal.buffer_view
  }
  util.func public @prefill_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @prefill_bs4$async(%arg0, %arg1, %arg2, %arg3, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
  util.global private @__hoisted_tensor_32xf32_44 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[0.000000e+00, 3.125000e-02, 6.250000e-02, 9.375000e-02, 1.250000e-01, 1.562500e-01, 1.875000e-01, 2.187500e-01, 2.500000e-01, 2.812500e-01, 3.125000e-01, 3.437500e-01, 3.750000e-01, 4.062500e-01, 4.375000e-01, 4.687500e-01, 5.000000e-01, 5.312500e-01, 5.625000e-01, 5.937500e-01, 6.250000e-01, 6.562500e-01, 6.875000e-01, 7.187500e-01, 7.500000e-01, 7.812500e-01, 8.125000e-01, 8.437500e-01, 8.750000e-01, 9.062500e-01, 9.375000e-01, 9.687500e-01]> : tensor<32xf32>
  util.global private @__hoisted_tensor_32xf32_45 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_46 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_47 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_f16_48 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<0.000000e+00> : tensor<f16>
  util.global private @__hoisted_tensor_32xf32_49 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_50 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_51 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_52 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_53 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_54 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_55 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_56 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_57 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_58 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_59 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_60 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_61 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_62 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_63 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_64 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_65 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_66 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_67 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_68 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_69 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_70 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_71 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_72 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_73 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_74 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_75 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_76 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_77 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_78 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_79 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_80 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_81 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_82 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_83 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_84 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_85 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_86 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_87 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_88 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_89 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_90 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_91 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_92 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_93 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_94 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_95 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_96 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_97 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_98 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_99 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_100 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_101 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_102 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_103 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_104 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_105 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_106 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_107 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_108 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_109 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_110 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_111 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_112 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_113 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_114 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_115 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_116 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_117 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_118 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_119 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_120 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_121 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_122 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_123 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_124 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_125 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_126 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_127 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_128 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_129 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_130 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.global private @__hoisted_tensor_32xf32_131 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<[1.000000e+00, 0.749894261, 0.562341332, 0.421696514, 0.316227764, 0.237137362, 0.177827939, 0.133352146, 1.000000e-01, 0.0749894157, 0.056234125, 0.0421696492, 0.0316227749, 0.023713734, 0.0177827943, 0.0133352149, 0.00999999884, 0.00749894138, 0.00562341232, 0.00421696389, 0.00316227647, 0.00237137382, 0.00177827943, 0.00133352145, 9.99999931E-4, 7.49894068E-4, 5.62341185E-4, 4.21696401E-4, 3.16227786E-4, 2.37137268E-4, 1.7782794E-4, 1.33352063E-4]> : tensor<32xf32>
  util.global private @__hoisted_tensor_4x4x1x8x1xf32_132 {stream.affinity.default = #hal.device.affinity<@__device_0>} = dense<"0x0000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B390000803F12F93F3F9AF50F3F9BE8D73E9BE8A13E23D4723E8718363E778D083ECDCCCC3D0D94993DC155663D15BA2C3DE286013D4E43C23C39AD913CF27B5A3C09D7233CAEB9F53B9A44B83B752E8A3B323E4F3B0D691B3B2815E93A8EC9AE3A6E12833A8A94443A146A133A2217DD3960CBA5390DA8783953773A396CD40B39"> : tensor<4x4x1x8x1xf32>
  util.func public @decode_bs4$async(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view, %arg5: !hal.fence, %arg6: !hal.fence) -> !hal.buffer_view attributes {inlining_policy = #util.inline.never, iree.abi.model = "coarse-fences", iree.abi.stub} {
    %cst = arith.constant 3.200000e+01 : f32
    %cst_0 = arith.constant 9.99999974E-6 : f32
    %cst_1 = arith.constant 2.048000e+03 : f32
    %cst_2 = arith.constant 1.000000e+00 : f16
    %cst_3 = arith.constant 0.000000e+00 : f32
    %c32000 = arith.constant 32000 : index
    %cst_4 = arith.constant dense<1.000000e+00> : tensor<f32>
    %cst_5 = arith.constant dense<0> : tensor<i64>
    %cst_6 = arith.constant dense<0xFC00> : tensor<f16>
    %c0 = arith.constant 0 : index
    %c1_i64 = arith.constant 1 : i64
    %c0_i64 = arith.constant 0 : i64
    %c2_i64 = arith.constant 2 : i64
    %c17_i64 = arith.constant 17 : i64
    %c5_i64 = arith.constant 5 : i64
    %c6_i64 = arith.constant 6 : i64
    %c4_i64 = arith.constant 4 : i64
    %c32_i64 = arith.constant 32 : i64
    %c3_i64 = arith.constant 3 : i64
    %c22_i64 = arith.constant 22 : i64
    %c8_i64 = arith.constant 8 : i64
    %c7_i64 = arith.constant 7 : i64
    %c9_i64 = arith.constant 9 : i64
    %c10_i64 = arith.constant 10 : i64
    %c11_i64 = arith.constant 11 : i64
    %c12_i64 = arith.constant 12 : i64
    %c13_i64 = arith.constant 13 : i64
    %c14_i64 = arith.constant 14 : i64
    %c15_i64 = arith.constant 15 : i64
    %c16_i64 = arith.constant 16 : i64
    %c18_i64 = arith.constant 18 : i64
    %c19_i64 = arith.constant 19 : i64
    %c20_i64 = arith.constant 20 : i64
    %c21_i64 = arith.constant 21 : i64
    %cst_7 = arith.constant 1.250000e-01 : f16
    %c32 = arith.constant 32 : index
    %cst_8 = arith.constant dense<1> : tensor<i64>
    %0 = flow.tensor.constant #flow.parameter.named<"model"::"token_embd.weight"> : tensor<32000x2176xi8>
    %1 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_norm.weight"> : tensor<2048xf32>
    %2 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_q.weight"> : tensor<2048x2176xi8>
    %3 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_k.weight"> : tensor<256x2176xi8>
    %4 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_v.weight"> : tensor<256x2176xi8>
    %5 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.attn_output.weight"> : tensor<2048x2176xi8>
    %6 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_norm.weight"> : tensor<2048xf32>
    %7 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_gate.weight"> : tensor<5632x2176xi8>
    %8 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_up.weight"> : tensor<5632x2176xi8>
    %9 = flow.tensor.constant #flow.parameter.named<"model"::"blk.0.ffn_down.weight"> : tensor<2048x5984xi8>
    %10 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_norm.weight"> : tensor<2048xf32>
    %11 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_q.weight"> : tensor<2048x2176xi8>
    %12 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_k.weight"> : tensor<256x2176xi8>
    %13 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_v.weight"> : tensor<256x2176xi8>
    %14 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.attn_output.weight"> : tensor<2048x2176xi8>
    %15 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_norm.weight"> : tensor<2048xf32>
    %16 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_gate.weight"> : tensor<5632x2176xi8>
    %17 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_up.weight"> : tensor<5632x2176xi8>
    %18 = flow.tensor.constant #flow.parameter.named<"model"::"blk.1.ffn_down.weight"> : tensor<2048x5984xi8>
    %19 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_norm.weight"> : tensor<2048xf32>
    %20 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_q.weight"> : tensor<2048x2176xi8>
    %21 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_k.weight"> : tensor<256x2176xi8>
    %22 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_v.weight"> : tensor<256x2176xi8>
    %23 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.attn_output.weight"> : tensor<2048x2176xi8>
    %24 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_norm.weight"> : tensor<2048xf32>
    %25 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_gate.weight"> : tensor<5632x2176xi8>
    %26 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_up.weight"> : tensor<5632x2176xi8>
    %27 = flow.tensor.constant #flow.parameter.named<"model"::"blk.2.ffn_down.weight"> : tensor<2048x5984xi8>
    %28 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_norm.weight"> : tensor<2048xf32>
    %29 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_q.weight"> : tensor<2048x2176xi8>
    %30 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_k.weight"> : tensor<256x2176xi8>
    %31 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_v.weight"> : tensor<256x2176xi8>
    %32 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.attn_output.weight"> : tensor<2048x2176xi8>
    %33 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_norm.weight"> : tensor<2048xf32>
    %34 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_gate.weight"> : tensor<5632x2176xi8>
    %35 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_up.weight"> : tensor<5632x2176xi8>
    %36 = flow.tensor.constant #flow.parameter.named<"model"::"blk.3.ffn_down.weight"> : tensor<2048x5984xi8>
    %37 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_norm.weight"> : tensor<2048xf32>
    %38 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_q.weight"> : tensor<2048x2176xi8>
    %39 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_k.weight"> : tensor<256x2176xi8>
    %40 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_v.weight"> : tensor<256x2176xi8>
    %41 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.attn_output.weight"> : tensor<2048x2176xi8>
    %42 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_norm.weight"> : tensor<2048xf32>
    %43 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_gate.weight"> : tensor<5632x2176xi8>
    %44 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_up.weight"> : tensor<5632x2176xi8>
    %45 = flow.tensor.constant #flow.parameter.named<"model"::"blk.4.ffn_down.weight"> : tensor<2048x5984xi8>
    %46 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_norm.weight"> : tensor<2048xf32>
    %47 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_q.weight"> : tensor<2048x2176xi8>
    %48 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_k.weight"> : tensor<256x2176xi8>
    %49 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_v.weight"> : tensor<256x2176xi8>
    %50 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.attn_output.weight"> : tensor<2048x2176xi8>
    %51 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_norm.weight"> : tensor<2048xf32>
    %52 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_gate.weight"> : tensor<5632x2176xi8>
    %53 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_up.weight"> : tensor<5632x2176xi8>
    %54 = flow.tensor.constant #flow.parameter.named<"model"::"blk.5.ffn_down.weight"> : tensor<2048x5984xi8>
    %55 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_norm.weight"> : tensor<2048xf32>
    %56 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_q.weight"> : tensor<2048x2176xi8>
    %57 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_k.weight"> : tensor<256x2176xi8>
    %58 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_v.weight"> : tensor<256x2176xi8>
    %59 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.attn_output.weight"> : tensor<2048x2176xi8>
    %60 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_norm.weight"> : tensor<2048xf32>
    %61 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_gate.weight"> : tensor<5632x2176xi8>
    %62 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_up.weight"> : tensor<5632x2176xi8>
    %63 = flow.tensor.constant #flow.parameter.named<"model"::"blk.6.ffn_down.weight"> : tensor<2048x5984xi8>
    %64 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_norm.weight"> : tensor<2048xf32>
    %65 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_q.weight"> : tensor<2048x2176xi8>
    %66 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_k.weight"> : tensor<256x2176xi8>
    %67 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_v.weight"> : tensor<256x2176xi8>
    %68 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.attn_output.weight"> : tensor<2048x2176xi8>
    %69 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_norm.weight"> : tensor<2048xf32>
    %70 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_gate.weight"> : tensor<5632x2176xi8>
    %71 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_up.weight"> : tensor<5632x2176xi8>
    %72 = flow.tensor.constant #flow.parameter.named<"model"::"blk.7.ffn_down.weight"> : tensor<2048x5984xi8>
    %73 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_norm.weight"> : tensor<2048xf32>
    %74 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_q.weight"> : tensor<2048x2176xi8>
    %75 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_k.weight"> : tensor<256x2176xi8>
    %76 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_v.weight"> : tensor<256x2176xi8>
    %77 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.attn_output.weight"> : tensor<2048x2176xi8>
    %78 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_norm.weight"> : tensor<2048xf32>
    %79 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_gate.weight"> : tensor<5632x2176xi8>
    %80 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_up.weight"> : tensor<5632x2176xi8>
    %81 = flow.tensor.constant #flow.parameter.named<"model"::"blk.8.ffn_down.weight"> : tensor<2048x5984xi8>
    %82 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_norm.weight"> : tensor<2048xf32>
    %83 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_q.weight"> : tensor<2048x2176xi8>
    %84 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_k.weight"> : tensor<256x2176xi8>
    %85 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_v.weight"> : tensor<256x2176xi8>
    %86 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.attn_output.weight"> : tensor<2048x2176xi8>
    %87 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_norm.weight"> : tensor<2048xf32>
    %88 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_gate.weight"> : tensor<5632x2176xi8>
    %89 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_up.weight"> : tensor<5632x2176xi8>
    %90 = flow.tensor.constant #flow.parameter.named<"model"::"blk.9.ffn_down.weight"> : tensor<2048x5984xi8>
    %91 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_norm.weight"> : tensor<2048xf32>
    %92 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_q.weight"> : tensor<2048x2176xi8>
    %93 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_k.weight"> : tensor<256x2176xi8>
    %94 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_v.weight"> : tensor<256x2176xi8>
    %95 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.attn_output.weight"> : tensor<2048x2176xi8>
    %96 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_norm.weight"> : tensor<2048xf32>
    %97 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_gate.weight"> : tensor<5632x2176xi8>
    %98 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_up.weight"> : tensor<5632x2176xi8>
    %99 = flow.tensor.constant #flow.parameter.named<"model"::"blk.10.ffn_down.weight"> : tensor<2048x5984xi8>
    %100 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_norm.weight"> : tensor<2048xf32>
    %101 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_q.weight"> : tensor<2048x2176xi8>
    %102 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_k.weight"> : tensor<256x2176xi8>
    %103 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_v.weight"> : tensor<256x2176xi8>
    %104 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.attn_output.weight"> : tensor<2048x2176xi8>
    %105 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_norm.weight"> : tensor<2048xf32>
    %106 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_gate.weight"> : tensor<5632x2176xi8>
    %107 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_up.weight"> : tensor<5632x2176xi8>
    %108 = flow.tensor.constant #flow.parameter.named<"model"::"blk.11.ffn_down.weight"> : tensor<2048x5984xi8>
    %109 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_norm.weight"> : tensor<2048xf32>
    %110 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_q.weight"> : tensor<2048x2176xi8>
    %111 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_k.weight"> : tensor<256x2176xi8>
    %112 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_v.weight"> : tensor<256x2176xi8>
    %113 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.attn_output.weight"> : tensor<2048x2176xi8>
    %114 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_norm.weight"> : tensor<2048xf32>
    %115 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_gate.weight"> : tensor<5632x2176xi8>
    %116 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_up.weight"> : tensor<5632x2176xi8>
    %117 = flow.tensor.constant #flow.parameter.named<"model"::"blk.12.ffn_down.weight"> : tensor<2048x5984xi8>
    %118 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_norm.weight"> : tensor<2048xf32>
    %119 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_q.weight"> : tensor<2048x2176xi8>
    %120 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_k.weight"> : tensor<256x2176xi8>
    %121 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_v.weight"> : tensor<256x2176xi8>
    %122 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.attn_output.weight"> : tensor<2048x2176xi8>
    %123 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_norm.weight"> : tensor<2048xf32>
    %124 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_gate.weight"> : tensor<5632x2176xi8>
    %125 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_up.weight"> : tensor<5632x2176xi8>
    %126 = flow.tensor.constant #flow.parameter.named<"model"::"blk.13.ffn_down.weight"> : tensor<2048x5984xi8>
    %127 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_norm.weight"> : tensor<2048xf32>
    %128 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_q.weight"> : tensor<2048x2176xi8>
    %129 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_k.weight"> : tensor<256x2176xi8>
    %130 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_v.weight"> : tensor<256x2176xi8>
    %131 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.attn_output.weight"> : tensor<2048x2176xi8>
    %132 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_norm.weight"> : tensor<2048xf32>
    %133 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_gate.weight"> : tensor<5632x2176xi8>
    %134 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_up.weight"> : tensor<5632x2176xi8>
    %135 = flow.tensor.constant #flow.parameter.named<"model"::"blk.14.ffn_down.weight"> : tensor<2048x5984xi8>
    %136 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_norm.weight"> : tensor<2048xf32>
    %137 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_q.weight"> : tensor<2048x2176xi8>
    %138 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_k.weight"> : tensor<256x2176xi8>
    %139 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_v.weight"> : tensor<256x2176xi8>
    %140 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.attn_output.weight"> : tensor<2048x2176xi8>
    %141 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_norm.weight"> : tensor<2048xf32>
    %142 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_gate.weight"> : tensor<5632x2176xi8>
    %143 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_up.weight"> : tensor<5632x2176xi8>
    %144 = flow.tensor.constant #flow.parameter.named<"model"::"blk.15.ffn_down.weight"> : tensor<2048x5984xi8>
    %145 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_norm.weight"> : tensor<2048xf32>
    %146 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_q.weight"> : tensor<2048x2176xi8>
    %147 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_k.weight"> : tensor<256x2176xi8>
    %148 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_v.weight"> : tensor<256x2176xi8>
    %149 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.attn_output.weight"> : tensor<2048x2176xi8>
    %150 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_norm.weight"> : tensor<2048xf32>
    %151 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_gate.weight"> : tensor<5632x2176xi8>
    %152 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_up.weight"> : tensor<5632x2176xi8>
    %153 = flow.tensor.constant #flow.parameter.named<"model"::"blk.16.ffn_down.weight"> : tensor<2048x5984xi8>
    %154 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_norm.weight"> : tensor<2048xf32>
    %155 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_q.weight"> : tensor<2048x2176xi8>
    %156 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_k.weight"> : tensor<256x2176xi8>
    %157 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_v.weight"> : tensor<256x2176xi8>
    %158 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.attn_output.weight"> : tensor<2048x2176xi8>
    %159 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_norm.weight"> : tensor<2048xf32>
    %160 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_gate.weight"> : tensor<5632x2176xi8>
    %161 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_up.weight"> : tensor<5632x2176xi8>
    %162 = flow.tensor.constant #flow.parameter.named<"model"::"blk.17.ffn_down.weight"> : tensor<2048x5984xi8>
    %163 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_norm.weight"> : tensor<2048xf32>
    %164 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_q.weight"> : tensor<2048x2176xi8>
    %165 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_k.weight"> : tensor<256x2176xi8>
    %166 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_v.weight"> : tensor<256x2176xi8>
    %167 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.attn_output.weight"> : tensor<2048x2176xi8>
    %168 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_norm.weight"> : tensor<2048xf32>
    %169 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_gate.weight"> : tensor<5632x2176xi8>
    %170 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_up.weight"> : tensor<5632x2176xi8>
    %171 = flow.tensor.constant #flow.parameter.named<"model"::"blk.18.ffn_down.weight"> : tensor<2048x5984xi8>
    %172 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_norm.weight"> : tensor<2048xf32>
    %173 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_q.weight"> : tensor<2048x2176xi8>
    %174 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_k.weight"> : tensor<256x2176xi8>
    %175 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_v.weight"> : tensor<256x2176xi8>
    %176 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.attn_output.weight"> : tensor<2048x2176xi8>
    %177 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_norm.weight"> : tensor<2048xf32>
    %178 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_gate.weight"> : tensor<5632x2176xi8>
    %179 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_up.weight"> : tensor<5632x2176xi8>
    %180 = flow.tensor.constant #flow.parameter.named<"model"::"blk.19.ffn_down.weight"> : tensor<2048x5984xi8>
    %181 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_norm.weight"> : tensor<2048xf32>
    %182 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_q.weight"> : tensor<2048x2176xi8>
    %183 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_k.weight"> : tensor<256x2176xi8>
    %184 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_v.weight"> : tensor<256x2176xi8>
    %185 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.attn_output.weight"> : tensor<2048x2176xi8>
    %186 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_norm.weight"> : tensor<2048xf32>
    %187 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_gate.weight"> : tensor<5632x2176xi8>
    %188 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_up.weight"> : tensor<5632x2176xi8>
    %189 = flow.tensor.constant #flow.parameter.named<"model"::"blk.20.ffn_down.weight"> : tensor<2048x5984xi8>
    %190 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_norm.weight"> : tensor<2048xf32>
    %191 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_q.weight"> : tensor<2048x2176xi8>
    %192 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_k.weight"> : tensor<256x2176xi8>
    %193 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_v.weight"> : tensor<256x2176xi8>
    %194 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.attn_output.weight"> : tensor<2048x2176xi8>
    %195 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_norm.weight"> : tensor<2048xf32>
    %196 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_gate.weight"> : tensor<5632x2176xi8>
    %197 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_up.weight"> : tensor<5632x2176xi8>
    %198 = flow.tensor.constant #flow.parameter.named<"model"::"blk.21.ffn_down.weight"> : tensor<2048x5984xi8>
    %199 = flow.tensor.constant #flow.parameter.named<"model"::"output_norm.weight"> : tensor<2048xf32>
    %200 = flow.tensor.constant #flow.parameter.named<"model"::"output.weight"> : tensor<32000x2176xi8>
    %201 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg0 : !hal.buffer_view -> tensor<4x1xi64>
    %202 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg1 : !hal.buffer_view -> tensor<4xi64>
    %203 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg2 : !hal.buffer_view -> tensor<4xi64>
    %204 = hal.buffer_view.dim<%arg3 : !hal.buffer_view>[1] : index
    %205 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg3 : !hal.buffer_view -> tensor<4x?xi64>{%204}
    %206 = hal.buffer_view.dim<%arg4 : !hal.buffer_view>[0] : index
    %207 = hal.tensor.import on(#hal.device.affinity<@__device_0>) wait(%arg5) => %arg4 : !hal.buffer_view -> tensor<?x360448xf16>{%206}
    %208 = util.assume.int %204<umin = 1, umax = 63> : index
    %209 = flow.tensor.tie_shape %205 : tensor<4x?xi64>{%208}
    %210 = util.assume.int %206<umin = 1, umax = 9007199254740991> : index
    %211 = flow.tensor.tie_shape %207 : tensor<?x360448xf16>{%210}
    %212 = iree_tensor_ext.bitcast %0 : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded = tensor.expand_shape %212 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice = tensor.extract_slice %expanded[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64xi16>
    %expanded_9 = tensor.expand_shape %extracted_slice [[0], [1, 2]] output_shape [32000, 64, 1] : tensor<32000x64xi16> into tensor<32000x64x1xi16>
    %213 = iree_tensor_ext.bitcast %expanded_9 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_10 = tensor.extract_slice %expanded[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %214 = iree_tensor_ext.bitcast %extracted_slice_10 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %215 = tensor.empty() : tensor<32000x64x32xf16>
    %216 = linalg.generic {indexing_maps = [#map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%214 : tensor<32000x64x32xi8>) outs(%215 : tensor<32000x64x32xf16>) {
    ^bb0(%in: i8, %out: f16):
      %2839 = arith.sitofp %in : i8 to f16
      linalg.yield %2839 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed = tensor.collapse_shape %213 [[0], [1, 2]] : tensor<32000x64x1xf16> into tensor<32000x64xf16>
    %217 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed, %216 : tensor<32000x64xf16>, tensor<32000x64x32xf16>) outs(%215 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<32000x64x32xf16>
    %collapsed_11 = tensor.collapse_shape %217 [[0], [1, 2]] : tensor<32000x64x32xf16> into tensor<32000x2048xf16>
    %collapsed_12 = tensor.collapse_shape %201 [[0, 1]] : tensor<4x1xi64> into tensor<4xi64>
    %218 = tensor.empty() : tensor<4x2048xf16>
    %219 = linalg.generic {indexing_maps = [#map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_12 : tensor<4xi64>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: i64, %out: f16):
      %2839 = arith.index_cast %in : i64 to index
      %2840 = linalg.index 1 : index
      %2841 = arith.cmpi slt, %2839, %c32000 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %collapsed_11[%2839, %2840] : tensor<32000x2048xf16>
      linalg.yield %extracted : f16
    } -> tensor<4x2048xf16>
    %220 = tensor.empty() : tensor<4x2048xf32>
    %221 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%219 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %222 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%221 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %223 = tensor.empty() : tensor<4xf32>
    %224 = linalg.fill ins(%cst_3 : f32) outs(%223 : tensor<4xf32>) -> tensor<4xf32>
    %225 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%222 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %226 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%225 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %227 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%226 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %228 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%227 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %229 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%221, %228 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %230 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%229 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %231 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1, %230 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %232 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%231 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %233 = iree_tensor_ext.bitcast %2 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_13 = tensor.expand_shape %233 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_14 = tensor.extract_slice %expanded_13[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_15 = tensor.expand_shape %extracted_slice_14 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %234 = iree_tensor_ext.bitcast %expanded_15 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_16 = tensor.extract_slice %expanded_13[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %235 = iree_tensor_ext.bitcast %extracted_slice_16 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %236 = tensor.empty() : tensor<2048x64x32xf16>
    %collapsed_17 = tensor.collapse_shape %234 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %237 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_17, %235 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_18 = tensor.expand_shape %232 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %238 = linalg.fill ins(%cst_3 : f32) outs(%220 : tensor<4x2048xf32>) -> tensor<4x2048xf32>
    %239 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_18, %237 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %240 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%239 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %241 = iree_tensor_ext.bitcast %3 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_19 = tensor.expand_shape %241 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_20 = tensor.extract_slice %expanded_19[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_21 = tensor.expand_shape %extracted_slice_20 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %242 = iree_tensor_ext.bitcast %expanded_21 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_22 = tensor.extract_slice %expanded_19[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %243 = iree_tensor_ext.bitcast %extracted_slice_22 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %244 = tensor.empty() : tensor<256x64x32xf16>
    %collapsed_23 = tensor.collapse_shape %242 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %245 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_23, %243 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %246 = tensor.empty() : tensor<4x256xf32>
    %247 = linalg.fill ins(%cst_3 : f32) outs(%246 : tensor<4x256xf32>) -> tensor<4x256xf32>
    %248 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_18, %245 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %249 = tensor.empty() : tensor<4x256xf16>
    %250 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%248 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %251 = iree_tensor_ext.bitcast %4 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_24 = tensor.expand_shape %251 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_25 = tensor.extract_slice %expanded_24[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_26 = tensor.expand_shape %extracted_slice_25 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %252 = iree_tensor_ext.bitcast %expanded_26 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_27 = tensor.extract_slice %expanded_24[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %253 = iree_tensor_ext.bitcast %extracted_slice_27 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_28 = tensor.collapse_shape %252 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %254 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_28, %253 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %255 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_18, %254 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %256 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%255 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_29 = tensor.expand_shape %240 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_30 = tensor.expand_shape %250 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %257 = tensor.empty() : tensor<i64>
    %258 = linalg.fill ins(%c0_i64 : i64) outs(%257 : tensor<i64>) -> tensor<i64>
    %259 = tensor.empty() : tensor<4xi64>
    %260 = linalg.generic {indexing_maps = [#map31, #map7, #map7], iterator_types = ["parallel"]} ins(%258, %203 : tensor<i64>, tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %261 = tensor.empty() : tensor<4x32xf32>
    %262 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%260 : tensor<4xi64>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: i64, %out: f32):
      %2839 = arith.sitofp %in : i64 to f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %__hoisted_tensor_4x4x1x8x1xf32 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32 : tensor<4x4x1x8x1xf32>
    %expanded_31 = tensor.expand_shape %262 [[0, 1, 2, 3, 4]] output_shape [4, 1, 1, 1, 1] : tensor<4xf32> into tensor<4x1x1x1x1xf32>
    %263 = tensor.empty() : tensor<4x1x4x1x8xf32>
    %264 = linalg.fill ins(%cst_3 : f32) outs(%263 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %265 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %266 = tensor.empty() : tensor<4x32x1xf32>
    %unpack = linalg.unpack %265 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_32 = tensor.collapse_shape %unpack [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %267 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_32 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %268 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%267, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %269 = tensor.empty() : tensor<4x32xf16>
    %270 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%268 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %271 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_32 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %272 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%271, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %273 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%272 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_33 = tensor.extract_slice %expanded_29[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_34 = tensor.extract_slice %expanded_29[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %274 = tensor.empty() : tensor<4x32x32xf16>
    %275 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_33, %270 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %276 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_34, %273 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %277 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%275, %276 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %278 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_34, %270 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %279 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_33, %273 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %280 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%278, %279 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %281 = tensor.empty() : tensor<4x32x2x32xf16>
    %282 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%277, %280 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_47 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_47 : tensor<4x4x1x8x1xf32>
    %283 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_47 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_35 = linalg.unpack %283 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_36 = tensor.collapse_shape %unpack_35 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %284 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_36 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %285 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%284, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %286 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%285 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %287 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_36 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %288 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%287, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %289 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%288 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_37 = tensor.extract_slice %expanded_30[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_38 = tensor.extract_slice %expanded_30[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %290 = tensor.empty() : tensor<4x4x32xf16>
    %291 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_37, %286 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %292 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %289 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %293 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%291, %292 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %294 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_38, %286 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %295 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_37, %289 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %296 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%294, %295 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %297 = tensor.empty() : tensor<4x4x2x32xf16>
    %298 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%293, %296 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %expanded_39 = tensor.expand_shape %211 [[0], [1, 2, 3, 4, 5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x360448xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_40 = tensor.collapse_shape %expanded_39 [[0, 1, 2, 3, 4], [5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x64xf16>
    %299 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%203 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.sitofp %in : i64 to f32
      %2840 = arith.divf %2839, %cst : f32
      %2841 = math.floor %2840 : f32
      %2842 = arith.fptosi %2841 : f32 to i64
      linalg.yield %2842 : i64
    } -> tensor<4xi64>
    %300 = linalg.fill ins(%c0_i64 : i64) outs(%259 : tensor<4xi64>) -> tensor<4xi64>
    %301 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %302 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%203 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.remsi %in, %c32_i64 : i64
      %2840 = arith.cmpi ne, %2839, %c0_i64 : i64
      %2841 = arith.cmpi slt, %2839, %c0_i64 : i64
      %2842 = arith.andi %2840, %2841 : i1
      %2843 = arith.addi %2839, %c32_i64 : i64
      %2844 = arith.select %2842, %2843, %2839 : i64
      linalg.yield %2844 : i64
    } -> tensor<4xi64>
    %303 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%259 : tensor<4xi64>) {
    ^bb0(%out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %2839 : index to i64
      linalg.yield %2840 : i64
    } -> tensor<4xi64>
    %304 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%301 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %305 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%304 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %306 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%305, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %307 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%306 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %308 = tensor.empty() : tensor<4x4xi64>
    %309 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%307, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %310 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%309 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %311 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%310, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_41 = tensor.collapse_shape %311 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_42 = tensor.collapse_shape %298 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %312 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_42, %collapsed_41 : tensor<16x64xf16>, tensor<16xi64>) outs(%collapsed_40 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %313 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%305, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %314 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%313 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %315 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%314, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %316 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%315 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %317 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%316, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_43 = tensor.collapse_shape %317 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_44 = tensor.expand_shape %256 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_45 = tensor.collapse_shape %expanded_44 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %318 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_45, %collapsed_43 : tensor<16x64xf16>, tensor<16xi64>) outs(%312 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_46 = tensor.expand_shape %318 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_47 = tensor.extract_slice %expanded_46[0, 0, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %319 = tensor.empty(%208) : tensor<4x?x4x32x64xf16>
    %320 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_47, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_48 = tensor.extract_slice %expanded_46[0, 0, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %321 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_48, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %322 = arith.muli %208, %c32 : index
    %323 = tensor.empty(%322) : tensor<?xi64>
    %324 = linalg.generic {indexing_maps = [#map7], iterator_types = ["parallel"]} outs(%323 : tensor<?xi64>) {
    ^bb0(%out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %2839 : index to i64
      linalg.yield %2840 : i64
    } -> tensor<?xi64>
    %325 = tensor.empty(%322) : tensor<4x?xi1>
    %326 = linalg.generic {indexing_maps = [#map14, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%324, %202 : tensor<?xi64>, tensor<4xi64>) outs(%325 : tensor<4x?xi1>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i1):
      %2839 = arith.cmpi sge, %in, %in_1410 : i64
      linalg.yield %2839 : i1
    } -> tensor<4x?xi1>
    %__hoisted_tensor_f16_48 = util.global.load immutable @__hoisted_tensor_f16_48 : tensor<f16>
    %327 = tensor.empty(%322) : tensor<4x?xf16>
    %328 = linalg.generic {indexing_maps = [#map2, #map8, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%326, %cst_6, %__hoisted_tensor_f16_48 : tensor<4x?xi1>, tensor<f16>, tensor<f16>) outs(%327 : tensor<4x?xf16>) {
    ^bb0(%in: i1, %in_1410: f16, %in_1411: f16, %out: f16):
      %2839 = arith.select %in, %in_1410, %in_1411 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x?xf16>
    %329 = tensor.empty(%208) : tensor<4x4x8x?x32x64xf16>
    %330 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%320 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %331 = tensor.empty(%322) : tensor<4x32x?xf16>
    %332 = linalg.generic {indexing_maps = [#map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%328 : tensor<4x?xf16>) outs(%331 : tensor<4x32x?xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x32x?xf16>
    %collapsed_49 = tensor.collapse_shape %330 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_50 = tensor.collapse_shape %282 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %collapsed_51 = tensor.collapse_shape %332 [[0, 1], [2]] : tensor<4x32x?xf16> into tensor<128x?xf16>
    %333 = tensor.empty() : tensor<128x64xf16>
    %334 = tensor.empty(%208) : tensor<4x4x8x64x?x32xf16>
    %335 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%321 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_52 = tensor.collapse_shape %335 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %336 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_50, %collapsed_49, %collapsed_52, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_53 = tensor.expand_shape %336 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_54 = tensor.collapse_shape %expanded_53 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %337 = iree_tensor_ext.bitcast %5 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_55 = tensor.expand_shape %337 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_56 = tensor.extract_slice %expanded_55[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_57 = tensor.expand_shape %extracted_slice_56 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %338 = iree_tensor_ext.bitcast %expanded_57 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_58 = tensor.extract_slice %expanded_55[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %339 = iree_tensor_ext.bitcast %extracted_slice_58 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_59 = tensor.collapse_shape %338 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %340 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_59, %339 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_60 = tensor.expand_shape %collapsed_54 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_61 = tensor.collapse_shape %expanded_60 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %341 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_61, %340 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %342 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%341 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %343 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%219, %342 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %344 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%343 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %345 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%344 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %346 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%345 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %347 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%346 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %348 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%347 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %349 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%348 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %350 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%344, %349 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %351 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%350 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %352 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%6, %351 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %353 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%352 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %354 = iree_tensor_ext.bitcast %7 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_62 = tensor.expand_shape %354 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_63 = tensor.extract_slice %expanded_62[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_64 = tensor.expand_shape %extracted_slice_63 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %355 = iree_tensor_ext.bitcast %expanded_64 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_65 = tensor.extract_slice %expanded_62[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %356 = iree_tensor_ext.bitcast %extracted_slice_65 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %357 = tensor.empty() : tensor<5632x64x32xf16>
    %collapsed_66 = tensor.collapse_shape %355 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %358 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_66, %356 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_67 = tensor.expand_shape %353 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %359 = tensor.empty() : tensor<4x5632xf32>
    %360 = linalg.fill ins(%cst_3 : f32) outs(%359 : tensor<4x5632xf32>) -> tensor<4x5632xf32>
    %361 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_67, %358 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %362 = tensor.empty() : tensor<4x5632xf16>
    %363 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%361 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %364 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%363 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %365 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%364, %363 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %366 = iree_tensor_ext.bitcast %8 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_68 = tensor.expand_shape %366 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_69 = tensor.extract_slice %expanded_68[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_70 = tensor.expand_shape %extracted_slice_69 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %367 = iree_tensor_ext.bitcast %expanded_70 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_71 = tensor.extract_slice %expanded_68[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %368 = iree_tensor_ext.bitcast %extracted_slice_71 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_72 = tensor.collapse_shape %367 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %369 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_72, %368 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %370 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_67, %369 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %371 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%370 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %372 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%365, %371 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %373 = iree_tensor_ext.bitcast %9 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_73 = tensor.expand_shape %373 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_74 = tensor.extract_slice %expanded_73[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_75 = tensor.expand_shape %extracted_slice_74 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %374 = iree_tensor_ext.bitcast %expanded_75 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_76 = tensor.extract_slice %expanded_73[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %375 = iree_tensor_ext.bitcast %extracted_slice_76 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %376 = tensor.empty() : tensor<2048x176x32xf16>
    %collapsed_77 = tensor.collapse_shape %374 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %377 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_77, %375 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_78 = tensor.expand_shape %372 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %378 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_78, %377 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %379 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%378 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %380 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%343, %379 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %381 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%380 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %382 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%381 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %383 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%382 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %384 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%383 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %385 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%384 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %386 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%385 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %387 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%381, %386 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %388 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%387 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %389 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%10, %388 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %390 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%389 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %391 = iree_tensor_ext.bitcast %11 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_79 = tensor.expand_shape %391 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_80 = tensor.extract_slice %expanded_79[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_81 = tensor.expand_shape %extracted_slice_80 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %392 = iree_tensor_ext.bitcast %expanded_81 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_82 = tensor.extract_slice %expanded_79[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %393 = iree_tensor_ext.bitcast %extracted_slice_82 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_83 = tensor.collapse_shape %392 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %394 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_83, %393 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_84 = tensor.expand_shape %390 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %395 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_84, %394 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %396 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%395 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %397 = iree_tensor_ext.bitcast %12 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_85 = tensor.expand_shape %397 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_86 = tensor.extract_slice %expanded_85[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_87 = tensor.expand_shape %extracted_slice_86 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %398 = iree_tensor_ext.bitcast %expanded_87 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_88 = tensor.extract_slice %expanded_85[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %399 = iree_tensor_ext.bitcast %extracted_slice_88 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_89 = tensor.collapse_shape %398 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %400 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_89, %399 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %401 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_84, %400 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %402 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%401 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %403 = iree_tensor_ext.bitcast %13 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_90 = tensor.expand_shape %403 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_91 = tensor.extract_slice %expanded_90[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_92 = tensor.expand_shape %extracted_slice_91 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %404 = iree_tensor_ext.bitcast %expanded_92 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_93 = tensor.extract_slice %expanded_90[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %405 = iree_tensor_ext.bitcast %extracted_slice_93 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_94 = tensor.collapse_shape %404 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %406 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_94, %405 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %407 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_84, %406 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %408 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%407 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_95 = tensor.expand_shape %396 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_96 = tensor.expand_shape %402 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_50 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_50 : tensor<4x4x1x8x1xf32>
    %409 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_50 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_97 = linalg.unpack %409 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_98 = tensor.collapse_shape %unpack_97 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %410 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_98 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %411 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%410, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %412 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%411 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %413 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_98 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %414 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%413, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %415 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%414 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_99 = tensor.extract_slice %expanded_95[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_100 = tensor.extract_slice %expanded_95[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %416 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_99, %412 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %417 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_100, %415 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %418 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%416, %417 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %419 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_100, %412 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %420 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_99, %415 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %421 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%419, %420 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %422 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%418, %421 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_52 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_52 : tensor<4x4x1x8x1xf32>
    %423 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_52 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_101 = linalg.unpack %423 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_102 = tensor.collapse_shape %unpack_101 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %424 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_102 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %425 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%424, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %426 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%425 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %427 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_102 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %428 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%427, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %429 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%428 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_103 = tensor.extract_slice %expanded_96[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_104 = tensor.extract_slice %expanded_96[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %430 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_103, %426 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %431 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_104, %429 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %432 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%430, %431 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %433 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_104, %426 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %434 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_103, %429 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %435 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%433, %434 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %436 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%432, %435 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %437 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %438 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%437 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %439 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%438 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c1_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %440 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%439 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %441 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%440, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %442 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%441 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %443 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%442, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %444 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%443 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %445 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%444, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_105 = tensor.collapse_shape %445 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_106 = tensor.collapse_shape %436 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %446 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_106, %collapsed_105 : tensor<16x64xf16>, tensor<16xi64>) outs(%318 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %447 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%440, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %448 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%447 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %449 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%448, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %450 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%449 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %451 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%450, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_107 = tensor.collapse_shape %451 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_108 = tensor.expand_shape %408 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_109 = tensor.collapse_shape %expanded_108 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %452 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_109, %collapsed_107 : tensor<16x64xf16>, tensor<16xi64>) outs(%446 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_110 = tensor.expand_shape %452 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_111 = tensor.extract_slice %expanded_110[0, 1, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %453 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_111, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_112 = tensor.extract_slice %expanded_110[0, 1, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %454 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_112, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %455 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%453 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_113 = tensor.collapse_shape %455 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_114 = tensor.collapse_shape %422 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %456 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%454 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_115 = tensor.collapse_shape %456 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %457 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_114, %collapsed_113, %collapsed_115, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_116 = tensor.expand_shape %457 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_117 = tensor.collapse_shape %expanded_116 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %458 = iree_tensor_ext.bitcast %14 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_118 = tensor.expand_shape %458 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_119 = tensor.extract_slice %expanded_118[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_120 = tensor.expand_shape %extracted_slice_119 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %459 = iree_tensor_ext.bitcast %expanded_120 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_121 = tensor.extract_slice %expanded_118[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %460 = iree_tensor_ext.bitcast %extracted_slice_121 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_122 = tensor.collapse_shape %459 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %461 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_122, %460 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_123 = tensor.expand_shape %collapsed_117 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_124 = tensor.collapse_shape %expanded_123 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %462 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_124, %461 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %463 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%462 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %464 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%380, %463 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %465 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%464 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %466 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%465 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %467 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%466 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %468 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%467 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %469 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%468 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %470 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%469 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %471 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%465, %470 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %472 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%471 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %473 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%15, %472 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %474 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%473 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %475 = iree_tensor_ext.bitcast %16 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_125 = tensor.expand_shape %475 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_126 = tensor.extract_slice %expanded_125[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_127 = tensor.expand_shape %extracted_slice_126 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %476 = iree_tensor_ext.bitcast %expanded_127 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_128 = tensor.extract_slice %expanded_125[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %477 = iree_tensor_ext.bitcast %extracted_slice_128 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_129 = tensor.collapse_shape %476 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %478 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_129, %477 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_130 = tensor.expand_shape %474 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %479 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_130, %478 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %480 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%479 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %481 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%480 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %482 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%481, %480 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %483 = iree_tensor_ext.bitcast %17 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_131 = tensor.expand_shape %483 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_132 = tensor.extract_slice %expanded_131[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_133 = tensor.expand_shape %extracted_slice_132 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %484 = iree_tensor_ext.bitcast %expanded_133 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_134 = tensor.extract_slice %expanded_131[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %485 = iree_tensor_ext.bitcast %extracted_slice_134 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_135 = tensor.collapse_shape %484 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %486 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_135, %485 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %487 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_130, %486 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %488 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%487 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %489 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%482, %488 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %490 = iree_tensor_ext.bitcast %18 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_136 = tensor.expand_shape %490 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_137 = tensor.extract_slice %expanded_136[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_138 = tensor.expand_shape %extracted_slice_137 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %491 = iree_tensor_ext.bitcast %expanded_138 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_139 = tensor.extract_slice %expanded_136[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %492 = iree_tensor_ext.bitcast %extracted_slice_139 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_140 = tensor.collapse_shape %491 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %493 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_140, %492 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_141 = tensor.expand_shape %489 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %494 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_141, %493 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %495 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%494 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %496 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%464, %495 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %497 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%496 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %498 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%497 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %499 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%498 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %500 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%499 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %501 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%500 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %502 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%501 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %503 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%497, %502 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %504 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%503 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %505 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%19, %504 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %506 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%505 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %507 = iree_tensor_ext.bitcast %20 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_142 = tensor.expand_shape %507 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_143 = tensor.extract_slice %expanded_142[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_144 = tensor.expand_shape %extracted_slice_143 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %508 = iree_tensor_ext.bitcast %expanded_144 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_145 = tensor.extract_slice %expanded_142[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %509 = iree_tensor_ext.bitcast %extracted_slice_145 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_146 = tensor.collapse_shape %508 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %510 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_146, %509 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_147 = tensor.expand_shape %506 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %511 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_147, %510 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %512 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%511 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %513 = iree_tensor_ext.bitcast %21 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_148 = tensor.expand_shape %513 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_149 = tensor.extract_slice %expanded_148[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_150 = tensor.expand_shape %extracted_slice_149 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %514 = iree_tensor_ext.bitcast %expanded_150 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_151 = tensor.extract_slice %expanded_148[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %515 = iree_tensor_ext.bitcast %extracted_slice_151 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_152 = tensor.collapse_shape %514 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %516 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_152, %515 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %517 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_147, %516 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %518 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%517 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %519 = iree_tensor_ext.bitcast %22 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_153 = tensor.expand_shape %519 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_154 = tensor.extract_slice %expanded_153[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_155 = tensor.expand_shape %extracted_slice_154 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %520 = iree_tensor_ext.bitcast %expanded_155 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_156 = tensor.extract_slice %expanded_153[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %521 = iree_tensor_ext.bitcast %extracted_slice_156 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_157 = tensor.collapse_shape %520 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %522 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_157, %521 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %523 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_147, %522 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %524 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%523 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_158 = tensor.expand_shape %512 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_159 = tensor.expand_shape %518 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_54 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_54 : tensor<4x4x1x8x1xf32>
    %525 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_54 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_160 = linalg.unpack %525 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_161 = tensor.collapse_shape %unpack_160 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %526 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_161 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %527 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%526, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %528 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%527 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %529 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_161 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %530 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%529, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %531 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%530 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_162 = tensor.extract_slice %expanded_158[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_163 = tensor.extract_slice %expanded_158[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %532 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_162, %528 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %533 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_163, %531 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %534 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%532, %533 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %535 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_163, %528 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %536 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_162, %531 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %537 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%535, %536 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %538 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%534, %537 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_56 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_56 : tensor<4x4x1x8x1xf32>
    %539 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_56 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_164 = linalg.unpack %539 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_165 = tensor.collapse_shape %unpack_164 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %540 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_165 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %541 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%540, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %542 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%541 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %543 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_165 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %544 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%543, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %545 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%544 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_166 = tensor.extract_slice %expanded_159[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_167 = tensor.extract_slice %expanded_159[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %546 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_166, %542 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %547 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_167, %545 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %548 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%546, %547 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %549 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_167, %542 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %550 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_166, %545 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %551 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%549, %550 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %552 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%548, %551 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %553 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %554 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%553 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %555 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%554 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %556 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%555 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %557 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%556, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %558 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%557 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %559 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%558, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %560 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%559 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %561 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%560, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_168 = tensor.collapse_shape %561 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_169 = tensor.collapse_shape %552 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %562 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_169, %collapsed_168 : tensor<16x64xf16>, tensor<16xi64>) outs(%452 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %563 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%556, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %564 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%563 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %565 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%564, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %566 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%565 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %567 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%566, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_170 = tensor.collapse_shape %567 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_171 = tensor.expand_shape %524 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_172 = tensor.collapse_shape %expanded_171 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %568 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_172, %collapsed_170 : tensor<16x64xf16>, tensor<16xi64>) outs(%562 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_173 = tensor.expand_shape %568 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_174 = tensor.extract_slice %expanded_173[0, 2, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %569 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_174, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_175 = tensor.extract_slice %expanded_173[0, 2, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %570 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_175, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %571 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%569 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_176 = tensor.collapse_shape %571 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_177 = tensor.collapse_shape %538 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %572 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%570 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_178 = tensor.collapse_shape %572 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %573 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_177, %collapsed_176, %collapsed_178, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_179 = tensor.expand_shape %573 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_180 = tensor.collapse_shape %expanded_179 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %574 = iree_tensor_ext.bitcast %23 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_181 = tensor.expand_shape %574 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_182 = tensor.extract_slice %expanded_181[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_183 = tensor.expand_shape %extracted_slice_182 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %575 = iree_tensor_ext.bitcast %expanded_183 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_184 = tensor.extract_slice %expanded_181[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %576 = iree_tensor_ext.bitcast %extracted_slice_184 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_185 = tensor.collapse_shape %575 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %577 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_185, %576 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_186 = tensor.expand_shape %collapsed_180 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_187 = tensor.collapse_shape %expanded_186 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %578 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_187, %577 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %579 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%578 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %580 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%496, %579 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %581 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%580 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %582 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%581 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %583 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%582 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %584 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%583 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %585 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%584 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %586 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%585 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %587 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%581, %586 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %588 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%587 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %589 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%24, %588 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %590 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%589 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %591 = iree_tensor_ext.bitcast %25 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_188 = tensor.expand_shape %591 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_189 = tensor.extract_slice %expanded_188[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_190 = tensor.expand_shape %extracted_slice_189 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %592 = iree_tensor_ext.bitcast %expanded_190 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_191 = tensor.extract_slice %expanded_188[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %593 = iree_tensor_ext.bitcast %extracted_slice_191 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_192 = tensor.collapse_shape %592 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %594 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_192, %593 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_193 = tensor.expand_shape %590 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %595 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_193, %594 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %596 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%595 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %597 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%596 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %598 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%597, %596 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %599 = iree_tensor_ext.bitcast %26 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_194 = tensor.expand_shape %599 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_195 = tensor.extract_slice %expanded_194[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_196 = tensor.expand_shape %extracted_slice_195 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %600 = iree_tensor_ext.bitcast %expanded_196 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_197 = tensor.extract_slice %expanded_194[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %601 = iree_tensor_ext.bitcast %extracted_slice_197 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_198 = tensor.collapse_shape %600 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %602 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_198, %601 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %603 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_193, %602 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %604 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%603 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %605 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%598, %604 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %606 = iree_tensor_ext.bitcast %27 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_199 = tensor.expand_shape %606 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_200 = tensor.extract_slice %expanded_199[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_201 = tensor.expand_shape %extracted_slice_200 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %607 = iree_tensor_ext.bitcast %expanded_201 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_202 = tensor.extract_slice %expanded_199[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %608 = iree_tensor_ext.bitcast %extracted_slice_202 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_203 = tensor.collapse_shape %607 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %609 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_203, %608 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_204 = tensor.expand_shape %605 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %610 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_204, %609 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %611 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%610 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %612 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%580, %611 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %613 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%612 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %614 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%613 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %615 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%614 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %616 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%615 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %617 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%616 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %618 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%617 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %619 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%613, %618 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %620 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%619 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %621 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%28, %620 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %622 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%621 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %623 = iree_tensor_ext.bitcast %29 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_205 = tensor.expand_shape %623 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_206 = tensor.extract_slice %expanded_205[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_207 = tensor.expand_shape %extracted_slice_206 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %624 = iree_tensor_ext.bitcast %expanded_207 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_208 = tensor.extract_slice %expanded_205[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %625 = iree_tensor_ext.bitcast %extracted_slice_208 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_209 = tensor.collapse_shape %624 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %626 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_209, %625 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_210 = tensor.expand_shape %622 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %627 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_210, %626 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %628 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%627 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %629 = iree_tensor_ext.bitcast %30 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_211 = tensor.expand_shape %629 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_212 = tensor.extract_slice %expanded_211[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_213 = tensor.expand_shape %extracted_slice_212 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %630 = iree_tensor_ext.bitcast %expanded_213 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_214 = tensor.extract_slice %expanded_211[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %631 = iree_tensor_ext.bitcast %extracted_slice_214 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_215 = tensor.collapse_shape %630 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %632 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_215, %631 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %633 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_210, %632 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %634 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%633 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %635 = iree_tensor_ext.bitcast %31 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_216 = tensor.expand_shape %635 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_217 = tensor.extract_slice %expanded_216[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_218 = tensor.expand_shape %extracted_slice_217 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %636 = iree_tensor_ext.bitcast %expanded_218 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_219 = tensor.extract_slice %expanded_216[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %637 = iree_tensor_ext.bitcast %extracted_slice_219 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_220 = tensor.collapse_shape %636 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %638 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_220, %637 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %639 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_210, %638 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %640 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%639 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_221 = tensor.expand_shape %628 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_222 = tensor.expand_shape %634 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_58 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_58 : tensor<4x4x1x8x1xf32>
    %641 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_58 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_223 = linalg.unpack %641 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_224 = tensor.collapse_shape %unpack_223 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %642 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_224 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %643 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%642, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %644 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%643 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %645 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_224 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %646 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%645, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %647 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%646 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_225 = tensor.extract_slice %expanded_221[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_226 = tensor.extract_slice %expanded_221[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %648 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_225, %644 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %649 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_226, %647 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %650 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%648, %649 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %651 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_226, %644 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %652 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_225, %647 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %653 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%651, %652 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %654 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%650, %653 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_60 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_60 : tensor<4x4x1x8x1xf32>
    %655 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_60 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_227 = linalg.unpack %655 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_228 = tensor.collapse_shape %unpack_227 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %656 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_228 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %657 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%656, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %658 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%657 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %659 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_228 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %660 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%659, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %661 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%660 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_229 = tensor.extract_slice %expanded_222[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_230 = tensor.extract_slice %expanded_222[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %662 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_229, %658 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %663 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_230, %661 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %664 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%662, %663 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %665 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_230, %658 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %666 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_229, %661 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %667 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%665, %666 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %668 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%664, %667 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %669 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %670 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%669 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %671 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%670 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c3_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %672 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%671 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %673 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%672, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %674 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%673 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %675 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%674, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %676 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%675 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %677 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%676, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_231 = tensor.collapse_shape %677 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_232 = tensor.collapse_shape %668 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %678 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_232, %collapsed_231 : tensor<16x64xf16>, tensor<16xi64>) outs(%568 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %679 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%672, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %680 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%679 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %681 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%680, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %682 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%681 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %683 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%682, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_233 = tensor.collapse_shape %683 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_234 = tensor.expand_shape %640 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_235 = tensor.collapse_shape %expanded_234 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %684 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_235, %collapsed_233 : tensor<16x64xf16>, tensor<16xi64>) outs(%678 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_236 = tensor.expand_shape %684 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_237 = tensor.extract_slice %expanded_236[0, 3, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %685 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_237, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_238 = tensor.extract_slice %expanded_236[0, 3, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %686 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_238, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %687 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%685 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_239 = tensor.collapse_shape %687 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_240 = tensor.collapse_shape %654 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %688 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%686 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_241 = tensor.collapse_shape %688 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %689 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_240, %collapsed_239, %collapsed_241, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_242 = tensor.expand_shape %689 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_243 = tensor.collapse_shape %expanded_242 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %690 = iree_tensor_ext.bitcast %32 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_244 = tensor.expand_shape %690 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_245 = tensor.extract_slice %expanded_244[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_246 = tensor.expand_shape %extracted_slice_245 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %691 = iree_tensor_ext.bitcast %expanded_246 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_247 = tensor.extract_slice %expanded_244[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %692 = iree_tensor_ext.bitcast %extracted_slice_247 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_248 = tensor.collapse_shape %691 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %693 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_248, %692 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_249 = tensor.expand_shape %collapsed_243 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_250 = tensor.collapse_shape %expanded_249 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %694 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_250, %693 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %695 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%694 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %696 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%612, %695 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %697 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%696 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %698 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%697 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %699 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%698 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %700 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%699 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %701 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%700 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %702 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%701 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %703 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%697, %702 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %704 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%703 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %705 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%33, %704 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %706 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%705 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %707 = iree_tensor_ext.bitcast %34 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_251 = tensor.expand_shape %707 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_252 = tensor.extract_slice %expanded_251[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_253 = tensor.expand_shape %extracted_slice_252 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %708 = iree_tensor_ext.bitcast %expanded_253 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_254 = tensor.extract_slice %expanded_251[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %709 = iree_tensor_ext.bitcast %extracted_slice_254 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_255 = tensor.collapse_shape %708 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %710 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_255, %709 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_256 = tensor.expand_shape %706 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %711 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_256, %710 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %712 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%711 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %713 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%712 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %714 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%713, %712 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %715 = iree_tensor_ext.bitcast %35 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_257 = tensor.expand_shape %715 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_258 = tensor.extract_slice %expanded_257[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_259 = tensor.expand_shape %extracted_slice_258 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %716 = iree_tensor_ext.bitcast %expanded_259 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_260 = tensor.extract_slice %expanded_257[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %717 = iree_tensor_ext.bitcast %extracted_slice_260 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_261 = tensor.collapse_shape %716 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %718 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_261, %717 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %719 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_256, %718 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %720 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%719 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %721 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%714, %720 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %722 = iree_tensor_ext.bitcast %36 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_262 = tensor.expand_shape %722 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_263 = tensor.extract_slice %expanded_262[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_264 = tensor.expand_shape %extracted_slice_263 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %723 = iree_tensor_ext.bitcast %expanded_264 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_265 = tensor.extract_slice %expanded_262[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %724 = iree_tensor_ext.bitcast %extracted_slice_265 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_266 = tensor.collapse_shape %723 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %725 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_266, %724 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_267 = tensor.expand_shape %721 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %726 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_267, %725 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %727 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%726 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %728 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%696, %727 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %729 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%728 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %730 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%729 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %731 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%730 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %732 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%731 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %733 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%732 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %734 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%733 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %735 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%729, %734 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %736 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%735 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %737 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%37, %736 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %738 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%737 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %739 = iree_tensor_ext.bitcast %38 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_268 = tensor.expand_shape %739 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_269 = tensor.extract_slice %expanded_268[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_270 = tensor.expand_shape %extracted_slice_269 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %740 = iree_tensor_ext.bitcast %expanded_270 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_271 = tensor.extract_slice %expanded_268[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %741 = iree_tensor_ext.bitcast %extracted_slice_271 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_272 = tensor.collapse_shape %740 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %742 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_272, %741 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_273 = tensor.expand_shape %738 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %743 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_273, %742 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %744 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%743 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %745 = iree_tensor_ext.bitcast %39 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_274 = tensor.expand_shape %745 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_275 = tensor.extract_slice %expanded_274[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_276 = tensor.expand_shape %extracted_slice_275 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %746 = iree_tensor_ext.bitcast %expanded_276 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_277 = tensor.extract_slice %expanded_274[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %747 = iree_tensor_ext.bitcast %extracted_slice_277 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_278 = tensor.collapse_shape %746 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %748 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_278, %747 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %749 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_273, %748 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %750 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%749 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %751 = iree_tensor_ext.bitcast %40 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_279 = tensor.expand_shape %751 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_280 = tensor.extract_slice %expanded_279[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_281 = tensor.expand_shape %extracted_slice_280 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %752 = iree_tensor_ext.bitcast %expanded_281 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_282 = tensor.extract_slice %expanded_279[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %753 = iree_tensor_ext.bitcast %extracted_slice_282 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_283 = tensor.collapse_shape %752 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %754 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_283, %753 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %755 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_273, %754 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %756 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%755 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_284 = tensor.expand_shape %744 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_285 = tensor.expand_shape %750 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_62 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_62 : tensor<4x4x1x8x1xf32>
    %757 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_62 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_286 = linalg.unpack %757 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_287 = tensor.collapse_shape %unpack_286 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %758 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_287 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %759 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%758, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %760 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%759 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %761 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_287 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %762 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%761, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %763 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%762 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_288 = tensor.extract_slice %expanded_284[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_289 = tensor.extract_slice %expanded_284[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %764 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_288, %760 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %765 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_289, %763 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %766 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%764, %765 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %767 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_289, %760 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %768 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_288, %763 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %769 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%767, %768 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %770 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%766, %769 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_64 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_64 : tensor<4x4x1x8x1xf32>
    %771 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_64 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_290 = linalg.unpack %771 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_291 = tensor.collapse_shape %unpack_290 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %772 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_291 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %773 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%772, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %774 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%773 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %775 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_291 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %776 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%775, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %777 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%776 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_292 = tensor.extract_slice %expanded_285[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_293 = tensor.extract_slice %expanded_285[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %778 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_292, %774 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %779 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_293, %777 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %780 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%778, %779 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %781 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_293, %774 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %782 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_292, %777 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %783 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%781, %782 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %784 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%780, %783 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %785 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %786 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%785 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %787 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%786 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %788 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%787 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %789 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%788, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %790 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%789 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %791 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%790, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %792 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%791 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %793 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%792, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_294 = tensor.collapse_shape %793 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_295 = tensor.collapse_shape %784 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %794 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_295, %collapsed_294 : tensor<16x64xf16>, tensor<16xi64>) outs(%684 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %795 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%788, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %796 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%795 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %797 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%796, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %798 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%797 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %799 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%798, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_296 = tensor.collapse_shape %799 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_297 = tensor.expand_shape %756 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_298 = tensor.collapse_shape %expanded_297 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %800 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_298, %collapsed_296 : tensor<16x64xf16>, tensor<16xi64>) outs(%794 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_299 = tensor.expand_shape %800 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_300 = tensor.extract_slice %expanded_299[0, 4, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %801 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_300, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_301 = tensor.extract_slice %expanded_299[0, 4, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %802 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_301, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %803 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%801 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_302 = tensor.collapse_shape %803 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_303 = tensor.collapse_shape %770 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %804 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%802 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_304 = tensor.collapse_shape %804 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %805 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_303, %collapsed_302, %collapsed_304, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_305 = tensor.expand_shape %805 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_306 = tensor.collapse_shape %expanded_305 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %806 = iree_tensor_ext.bitcast %41 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_307 = tensor.expand_shape %806 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_308 = tensor.extract_slice %expanded_307[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_309 = tensor.expand_shape %extracted_slice_308 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %807 = iree_tensor_ext.bitcast %expanded_309 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_310 = tensor.extract_slice %expanded_307[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %808 = iree_tensor_ext.bitcast %extracted_slice_310 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_311 = tensor.collapse_shape %807 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %809 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_311, %808 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_312 = tensor.expand_shape %collapsed_306 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_313 = tensor.collapse_shape %expanded_312 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %810 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_313, %809 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %811 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%810 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %812 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%728, %811 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %813 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%812 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %814 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%813 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %815 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%814 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %816 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%815 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %817 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%816 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %818 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%817 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %819 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%813, %818 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %820 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%819 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %821 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%42, %820 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %822 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%821 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %823 = iree_tensor_ext.bitcast %43 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_314 = tensor.expand_shape %823 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_315 = tensor.extract_slice %expanded_314[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_316 = tensor.expand_shape %extracted_slice_315 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %824 = iree_tensor_ext.bitcast %expanded_316 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_317 = tensor.extract_slice %expanded_314[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %825 = iree_tensor_ext.bitcast %extracted_slice_317 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_318 = tensor.collapse_shape %824 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %826 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_318, %825 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_319 = tensor.expand_shape %822 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %827 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_319, %826 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %828 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%827 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %829 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%828 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %830 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%829, %828 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %831 = iree_tensor_ext.bitcast %44 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_320 = tensor.expand_shape %831 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_321 = tensor.extract_slice %expanded_320[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_322 = tensor.expand_shape %extracted_slice_321 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %832 = iree_tensor_ext.bitcast %expanded_322 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_323 = tensor.extract_slice %expanded_320[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %833 = iree_tensor_ext.bitcast %extracted_slice_323 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_324 = tensor.collapse_shape %832 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %834 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_324, %833 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %835 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_319, %834 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %836 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%835 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %837 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%830, %836 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %838 = iree_tensor_ext.bitcast %45 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_325 = tensor.expand_shape %838 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_326 = tensor.extract_slice %expanded_325[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_327 = tensor.expand_shape %extracted_slice_326 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %839 = iree_tensor_ext.bitcast %expanded_327 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_328 = tensor.extract_slice %expanded_325[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %840 = iree_tensor_ext.bitcast %extracted_slice_328 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_329 = tensor.collapse_shape %839 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %841 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_329, %840 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_330 = tensor.expand_shape %837 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %842 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_330, %841 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %843 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%842 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %844 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%812, %843 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %845 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%844 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %846 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%845 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %847 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%846 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %848 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%847 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %849 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%848 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %850 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%849 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %851 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%845, %850 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %852 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%851 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %853 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%46, %852 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %854 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%853 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %855 = iree_tensor_ext.bitcast %47 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_331 = tensor.expand_shape %855 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_332 = tensor.extract_slice %expanded_331[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_333 = tensor.expand_shape %extracted_slice_332 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %856 = iree_tensor_ext.bitcast %expanded_333 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_334 = tensor.extract_slice %expanded_331[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %857 = iree_tensor_ext.bitcast %extracted_slice_334 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_335 = tensor.collapse_shape %856 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %858 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_335, %857 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_336 = tensor.expand_shape %854 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %859 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_336, %858 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %860 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%859 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %861 = iree_tensor_ext.bitcast %48 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_337 = tensor.expand_shape %861 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_338 = tensor.extract_slice %expanded_337[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_339 = tensor.expand_shape %extracted_slice_338 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %862 = iree_tensor_ext.bitcast %expanded_339 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_340 = tensor.extract_slice %expanded_337[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %863 = iree_tensor_ext.bitcast %extracted_slice_340 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_341 = tensor.collapse_shape %862 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %864 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_341, %863 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %865 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_336, %864 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %866 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%865 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %867 = iree_tensor_ext.bitcast %49 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_342 = tensor.expand_shape %867 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_343 = tensor.extract_slice %expanded_342[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_344 = tensor.expand_shape %extracted_slice_343 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %868 = iree_tensor_ext.bitcast %expanded_344 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_345 = tensor.extract_slice %expanded_342[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %869 = iree_tensor_ext.bitcast %extracted_slice_345 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_346 = tensor.collapse_shape %868 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %870 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_346, %869 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %871 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_336, %870 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %872 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%871 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_347 = tensor.expand_shape %860 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_348 = tensor.expand_shape %866 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_66 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_66 : tensor<4x4x1x8x1xf32>
    %873 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_66 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_349 = linalg.unpack %873 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_350 = tensor.collapse_shape %unpack_349 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %874 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_350 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %875 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%874, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %876 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%875 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %877 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_350 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %878 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%877, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %879 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%878 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_351 = tensor.extract_slice %expanded_347[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_352 = tensor.extract_slice %expanded_347[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %880 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_351, %876 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %881 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_352, %879 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %882 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%880, %881 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %883 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_352, %876 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %884 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_351, %879 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %885 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%883, %884 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %886 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%882, %885 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_68 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_68 : tensor<4x4x1x8x1xf32>
    %887 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_68 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_353 = linalg.unpack %887 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_354 = tensor.collapse_shape %unpack_353 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %888 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_354 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %889 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%888, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %890 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%889 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %891 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_354 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %892 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%891, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %893 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%892 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_355 = tensor.extract_slice %expanded_348[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_356 = tensor.extract_slice %expanded_348[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %894 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_355, %890 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %895 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_356, %893 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %896 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%894, %895 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %897 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_356, %890 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %898 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_355, %893 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %899 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%897, %898 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %900 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%896, %899 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %901 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %902 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%901 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %903 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%902 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c5_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %904 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%903 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %905 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%904, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %906 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%905 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %907 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%906, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %908 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%907 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %909 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%908, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_357 = tensor.collapse_shape %909 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_358 = tensor.collapse_shape %900 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %910 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_358, %collapsed_357 : tensor<16x64xf16>, tensor<16xi64>) outs(%800 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %911 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%904, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %912 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%911 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %913 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%912, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %914 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%913 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %915 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%914, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_359 = tensor.collapse_shape %915 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_360 = tensor.expand_shape %872 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_361 = tensor.collapse_shape %expanded_360 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %916 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_361, %collapsed_359 : tensor<16x64xf16>, tensor<16xi64>) outs(%910 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_362 = tensor.expand_shape %916 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_363 = tensor.extract_slice %expanded_362[0, 5, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %917 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_363, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_364 = tensor.extract_slice %expanded_362[0, 5, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %918 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_364, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %919 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%917 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_365 = tensor.collapse_shape %919 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_366 = tensor.collapse_shape %886 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %920 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%918 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_367 = tensor.collapse_shape %920 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %921 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_366, %collapsed_365, %collapsed_367, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_368 = tensor.expand_shape %921 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_369 = tensor.collapse_shape %expanded_368 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %922 = iree_tensor_ext.bitcast %50 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_370 = tensor.expand_shape %922 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_371 = tensor.extract_slice %expanded_370[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_372 = tensor.expand_shape %extracted_slice_371 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %923 = iree_tensor_ext.bitcast %expanded_372 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_373 = tensor.extract_slice %expanded_370[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %924 = iree_tensor_ext.bitcast %extracted_slice_373 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_374 = tensor.collapse_shape %923 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %925 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_374, %924 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_375 = tensor.expand_shape %collapsed_369 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_376 = tensor.collapse_shape %expanded_375 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %926 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_376, %925 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %927 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%926 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %928 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%844, %927 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %929 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%928 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %930 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%929 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %931 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%930 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %932 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%931 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %933 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%932 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %934 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%933 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %935 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%929, %934 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %936 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%935 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %937 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%51, %936 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %938 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%937 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %939 = iree_tensor_ext.bitcast %52 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_377 = tensor.expand_shape %939 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_378 = tensor.extract_slice %expanded_377[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_379 = tensor.expand_shape %extracted_slice_378 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %940 = iree_tensor_ext.bitcast %expanded_379 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_380 = tensor.extract_slice %expanded_377[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %941 = iree_tensor_ext.bitcast %extracted_slice_380 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_381 = tensor.collapse_shape %940 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %942 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_381, %941 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_382 = tensor.expand_shape %938 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %943 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_382, %942 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %944 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%943 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %945 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%944 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %946 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%945, %944 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %947 = iree_tensor_ext.bitcast %53 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_383 = tensor.expand_shape %947 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_384 = tensor.extract_slice %expanded_383[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_385 = tensor.expand_shape %extracted_slice_384 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %948 = iree_tensor_ext.bitcast %expanded_385 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_386 = tensor.extract_slice %expanded_383[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %949 = iree_tensor_ext.bitcast %extracted_slice_386 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_387 = tensor.collapse_shape %948 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %950 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_387, %949 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %951 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_382, %950 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %952 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%951 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %953 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%946, %952 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %954 = iree_tensor_ext.bitcast %54 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_388 = tensor.expand_shape %954 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_389 = tensor.extract_slice %expanded_388[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_390 = tensor.expand_shape %extracted_slice_389 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %955 = iree_tensor_ext.bitcast %expanded_390 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_391 = tensor.extract_slice %expanded_388[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %956 = iree_tensor_ext.bitcast %extracted_slice_391 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_392 = tensor.collapse_shape %955 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %957 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_392, %956 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_393 = tensor.expand_shape %953 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %958 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_393, %957 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %959 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%958 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %960 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%928, %959 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %961 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%960 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %962 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%961 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %963 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%962 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %964 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%963 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %965 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%964 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %966 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%965 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %967 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%961, %966 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %968 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%967 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %969 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%55, %968 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %970 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%969 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %971 = iree_tensor_ext.bitcast %56 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_394 = tensor.expand_shape %971 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_395 = tensor.extract_slice %expanded_394[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_396 = tensor.expand_shape %extracted_slice_395 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %972 = iree_tensor_ext.bitcast %expanded_396 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_397 = tensor.extract_slice %expanded_394[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %973 = iree_tensor_ext.bitcast %extracted_slice_397 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_398 = tensor.collapse_shape %972 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %974 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_398, %973 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_399 = tensor.expand_shape %970 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %975 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_399, %974 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %976 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%975 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %977 = iree_tensor_ext.bitcast %57 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_400 = tensor.expand_shape %977 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_401 = tensor.extract_slice %expanded_400[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_402 = tensor.expand_shape %extracted_slice_401 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %978 = iree_tensor_ext.bitcast %expanded_402 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_403 = tensor.extract_slice %expanded_400[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %979 = iree_tensor_ext.bitcast %extracted_slice_403 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_404 = tensor.collapse_shape %978 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %980 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_404, %979 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %981 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_399, %980 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %982 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%981 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %983 = iree_tensor_ext.bitcast %58 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_405 = tensor.expand_shape %983 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_406 = tensor.extract_slice %expanded_405[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_407 = tensor.expand_shape %extracted_slice_406 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %984 = iree_tensor_ext.bitcast %expanded_407 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_408 = tensor.extract_slice %expanded_405[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %985 = iree_tensor_ext.bitcast %extracted_slice_408 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_409 = tensor.collapse_shape %984 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %986 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_409, %985 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %987 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_399, %986 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %988 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%987 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_410 = tensor.expand_shape %976 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_411 = tensor.expand_shape %982 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_70 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_70 : tensor<4x4x1x8x1xf32>
    %989 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_70 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_412 = linalg.unpack %989 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_413 = tensor.collapse_shape %unpack_412 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %990 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_413 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %991 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%990, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %992 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%991 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %993 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_413 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %994 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%993, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %995 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%994 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_414 = tensor.extract_slice %expanded_410[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_415 = tensor.extract_slice %expanded_410[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %996 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_414, %992 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %997 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_415, %995 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %998 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%996, %997 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %999 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_415, %992 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1000 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_414, %995 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1001 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%999, %1000 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1002 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%998, %1001 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_72 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_72 : tensor<4x4x1x8x1xf32>
    %1003 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_72 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_416 = linalg.unpack %1003 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_417 = tensor.collapse_shape %unpack_416 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1004 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_417 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1005 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1004, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1006 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1005 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1007 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_417 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1008 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1007, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1009 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1008 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_418 = tensor.extract_slice %expanded_411[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_419 = tensor.extract_slice %expanded_411[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1010 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_418, %1006 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1011 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_419, %1009 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1012 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1010, %1011 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1013 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_419, %1006 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1014 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_418, %1009 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1015 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1013, %1014 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1016 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1012, %1015 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1017 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1018 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1017 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1019 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1018 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c6_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1020 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1019 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1021 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1020, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1022 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1021 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1023 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1022, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1024 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1023 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1025 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1024, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_420 = tensor.collapse_shape %1025 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_421 = tensor.collapse_shape %1016 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1026 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_421, %collapsed_420 : tensor<16x64xf16>, tensor<16xi64>) outs(%916 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1027 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1020, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1028 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1027 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1029 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1028, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1030 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1029 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1031 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1030, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_422 = tensor.collapse_shape %1031 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_423 = tensor.expand_shape %988 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_424 = tensor.collapse_shape %expanded_423 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1032 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_424, %collapsed_422 : tensor<16x64xf16>, tensor<16xi64>) outs(%1026 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_425 = tensor.expand_shape %1032 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_426 = tensor.extract_slice %expanded_425[0, 6, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1033 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_426, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_427 = tensor.extract_slice %expanded_425[0, 6, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1034 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_427, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1035 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1033 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_428 = tensor.collapse_shape %1035 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_429 = tensor.collapse_shape %1002 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1036 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1034 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_430 = tensor.collapse_shape %1036 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1037 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_429, %collapsed_428, %collapsed_430, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_431 = tensor.expand_shape %1037 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_432 = tensor.collapse_shape %expanded_431 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1038 = iree_tensor_ext.bitcast %59 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_433 = tensor.expand_shape %1038 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_434 = tensor.extract_slice %expanded_433[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_435 = tensor.expand_shape %extracted_slice_434 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1039 = iree_tensor_ext.bitcast %expanded_435 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_436 = tensor.extract_slice %expanded_433[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1040 = iree_tensor_ext.bitcast %extracted_slice_436 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_437 = tensor.collapse_shape %1039 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1041 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_437, %1040 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_438 = tensor.expand_shape %collapsed_432 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_439 = tensor.collapse_shape %expanded_438 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1042 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_439, %1041 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1043 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1042 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1044 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%960, %1043 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1045 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1044 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1046 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1045 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1047 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1046 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1048 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1047 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1049 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1048 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1050 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1049 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1051 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1045, %1050 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1052 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1051 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1053 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%60, %1052 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1054 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1053 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1055 = iree_tensor_ext.bitcast %61 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_440 = tensor.expand_shape %1055 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_441 = tensor.extract_slice %expanded_440[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_442 = tensor.expand_shape %extracted_slice_441 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1056 = iree_tensor_ext.bitcast %expanded_442 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_443 = tensor.extract_slice %expanded_440[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1057 = iree_tensor_ext.bitcast %extracted_slice_443 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_444 = tensor.collapse_shape %1056 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1058 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_444, %1057 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_445 = tensor.expand_shape %1054 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1059 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_445, %1058 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1060 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1059 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1061 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1060 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1062 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1061, %1060 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1063 = iree_tensor_ext.bitcast %62 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_446 = tensor.expand_shape %1063 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_447 = tensor.extract_slice %expanded_446[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_448 = tensor.expand_shape %extracted_slice_447 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1064 = iree_tensor_ext.bitcast %expanded_448 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_449 = tensor.extract_slice %expanded_446[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1065 = iree_tensor_ext.bitcast %extracted_slice_449 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_450 = tensor.collapse_shape %1064 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1066 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_450, %1065 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1067 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_445, %1066 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1068 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1067 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1069 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1062, %1068 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1070 = iree_tensor_ext.bitcast %63 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_451 = tensor.expand_shape %1070 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_452 = tensor.extract_slice %expanded_451[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_453 = tensor.expand_shape %extracted_slice_452 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1071 = iree_tensor_ext.bitcast %expanded_453 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_454 = tensor.extract_slice %expanded_451[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1072 = iree_tensor_ext.bitcast %extracted_slice_454 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_455 = tensor.collapse_shape %1071 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1073 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_455, %1072 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_456 = tensor.expand_shape %1069 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1074 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_456, %1073 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1075 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1074 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1076 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1044, %1075 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1077 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1076 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1078 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1077 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1079 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1078 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1080 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1079 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1081 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1080 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1082 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1081 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1083 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1077, %1082 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1084 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1083 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1085 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%64, %1084 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1086 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1085 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1087 = iree_tensor_ext.bitcast %65 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_457 = tensor.expand_shape %1087 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_458 = tensor.extract_slice %expanded_457[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_459 = tensor.expand_shape %extracted_slice_458 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1088 = iree_tensor_ext.bitcast %expanded_459 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_460 = tensor.extract_slice %expanded_457[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1089 = iree_tensor_ext.bitcast %extracted_slice_460 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_461 = tensor.collapse_shape %1088 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1090 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_461, %1089 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_462 = tensor.expand_shape %1086 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1091 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_462, %1090 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1092 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1091 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1093 = iree_tensor_ext.bitcast %66 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_463 = tensor.expand_shape %1093 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_464 = tensor.extract_slice %expanded_463[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_465 = tensor.expand_shape %extracted_slice_464 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1094 = iree_tensor_ext.bitcast %expanded_465 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_466 = tensor.extract_slice %expanded_463[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1095 = iree_tensor_ext.bitcast %extracted_slice_466 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_467 = tensor.collapse_shape %1094 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1096 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_467, %1095 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1097 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_462, %1096 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1098 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1097 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1099 = iree_tensor_ext.bitcast %67 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_468 = tensor.expand_shape %1099 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_469 = tensor.extract_slice %expanded_468[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_470 = tensor.expand_shape %extracted_slice_469 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1100 = iree_tensor_ext.bitcast %expanded_470 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_471 = tensor.extract_slice %expanded_468[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1101 = iree_tensor_ext.bitcast %extracted_slice_471 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_472 = tensor.collapse_shape %1100 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1102 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_472, %1101 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1103 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_462, %1102 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1104 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1103 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_473 = tensor.expand_shape %1092 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_474 = tensor.expand_shape %1098 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_74 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_74 : tensor<4x4x1x8x1xf32>
    %1105 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_74 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_475 = linalg.unpack %1105 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_476 = tensor.collapse_shape %unpack_475 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1106 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_476 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1107 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1106, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1108 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1107 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1109 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_476 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1110 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1109, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1111 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1110 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_477 = tensor.extract_slice %expanded_473[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_478 = tensor.extract_slice %expanded_473[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1112 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_477, %1108 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1113 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_478, %1111 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1114 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1112, %1113 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1115 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_478, %1108 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1116 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_477, %1111 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1117 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1115, %1116 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1118 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1114, %1117 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_76 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_76 : tensor<4x4x1x8x1xf32>
    %1119 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_76 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_479 = linalg.unpack %1119 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_480 = tensor.collapse_shape %unpack_479 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1120 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_480 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1121 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1120, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1122 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1121 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1123 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_480 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1124 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1123, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1125 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1124 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_481 = tensor.extract_slice %expanded_474[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_482 = tensor.extract_slice %expanded_474[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1126 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_481, %1122 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1127 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_482, %1125 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1128 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1126, %1127 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1129 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_482, %1122 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1130 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_481, %1125 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1131 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1129, %1130 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1132 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1128, %1131 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1133 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1134 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1133 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1135 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1134 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c7_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1136 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1135 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1137 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1136, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1138 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1137 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1139 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1138, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1140 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1139 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1141 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1140, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_483 = tensor.collapse_shape %1141 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_484 = tensor.collapse_shape %1132 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1142 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_484, %collapsed_483 : tensor<16x64xf16>, tensor<16xi64>) outs(%1032 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1143 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1136, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1144 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1143 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1145 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1144, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1146 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1145 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1147 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1146, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_485 = tensor.collapse_shape %1147 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_486 = tensor.expand_shape %1104 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_487 = tensor.collapse_shape %expanded_486 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1148 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_487, %collapsed_485 : tensor<16x64xf16>, tensor<16xi64>) outs(%1142 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_488 = tensor.expand_shape %1148 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_489 = tensor.extract_slice %expanded_488[0, 7, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1149 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_489, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_490 = tensor.extract_slice %expanded_488[0, 7, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1150 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_490, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1151 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1149 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_491 = tensor.collapse_shape %1151 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_492 = tensor.collapse_shape %1118 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1152 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1150 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_493 = tensor.collapse_shape %1152 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1153 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_492, %collapsed_491, %collapsed_493, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_494 = tensor.expand_shape %1153 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_495 = tensor.collapse_shape %expanded_494 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1154 = iree_tensor_ext.bitcast %68 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_496 = tensor.expand_shape %1154 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_497 = tensor.extract_slice %expanded_496[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_498 = tensor.expand_shape %extracted_slice_497 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1155 = iree_tensor_ext.bitcast %expanded_498 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_499 = tensor.extract_slice %expanded_496[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1156 = iree_tensor_ext.bitcast %extracted_slice_499 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_500 = tensor.collapse_shape %1155 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1157 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_500, %1156 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_501 = tensor.expand_shape %collapsed_495 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_502 = tensor.collapse_shape %expanded_501 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1158 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_502, %1157 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1159 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1158 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1160 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1076, %1159 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1161 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1160 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1162 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1161 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1163 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1162 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1164 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1163 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1165 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1164 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1166 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1165 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1167 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1161, %1166 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1168 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1167 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1169 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%69, %1168 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1170 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1169 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1171 = iree_tensor_ext.bitcast %70 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_503 = tensor.expand_shape %1171 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_504 = tensor.extract_slice %expanded_503[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_505 = tensor.expand_shape %extracted_slice_504 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1172 = iree_tensor_ext.bitcast %expanded_505 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_506 = tensor.extract_slice %expanded_503[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1173 = iree_tensor_ext.bitcast %extracted_slice_506 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_507 = tensor.collapse_shape %1172 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1174 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_507, %1173 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_508 = tensor.expand_shape %1170 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1175 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_508, %1174 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1176 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1175 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1177 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1176 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1178 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1177, %1176 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1179 = iree_tensor_ext.bitcast %71 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_509 = tensor.expand_shape %1179 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_510 = tensor.extract_slice %expanded_509[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_511 = tensor.expand_shape %extracted_slice_510 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1180 = iree_tensor_ext.bitcast %expanded_511 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_512 = tensor.extract_slice %expanded_509[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1181 = iree_tensor_ext.bitcast %extracted_slice_512 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_513 = tensor.collapse_shape %1180 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1182 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_513, %1181 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1183 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_508, %1182 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1184 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1183 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1185 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1178, %1184 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1186 = iree_tensor_ext.bitcast %72 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_514 = tensor.expand_shape %1186 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_515 = tensor.extract_slice %expanded_514[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_516 = tensor.expand_shape %extracted_slice_515 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1187 = iree_tensor_ext.bitcast %expanded_516 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_517 = tensor.extract_slice %expanded_514[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1188 = iree_tensor_ext.bitcast %extracted_slice_517 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_518 = tensor.collapse_shape %1187 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1189 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_518, %1188 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_519 = tensor.expand_shape %1185 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1190 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_519, %1189 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1191 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1190 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1192 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1160, %1191 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1193 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1192 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1194 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1193 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1195 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1194 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1196 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1195 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1197 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1196 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1198 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1197 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1199 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1193, %1198 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1200 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1199 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1201 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%73, %1200 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1202 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1201 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1203 = iree_tensor_ext.bitcast %74 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_520 = tensor.expand_shape %1203 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_521 = tensor.extract_slice %expanded_520[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_522 = tensor.expand_shape %extracted_slice_521 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1204 = iree_tensor_ext.bitcast %expanded_522 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_523 = tensor.extract_slice %expanded_520[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1205 = iree_tensor_ext.bitcast %extracted_slice_523 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_524 = tensor.collapse_shape %1204 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1206 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_524, %1205 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_525 = tensor.expand_shape %1202 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1207 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_525, %1206 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1208 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1207 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1209 = iree_tensor_ext.bitcast %75 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_526 = tensor.expand_shape %1209 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_527 = tensor.extract_slice %expanded_526[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_528 = tensor.expand_shape %extracted_slice_527 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1210 = iree_tensor_ext.bitcast %expanded_528 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_529 = tensor.extract_slice %expanded_526[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1211 = iree_tensor_ext.bitcast %extracted_slice_529 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_530 = tensor.collapse_shape %1210 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1212 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_530, %1211 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1213 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_525, %1212 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1214 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1213 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1215 = iree_tensor_ext.bitcast %76 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_531 = tensor.expand_shape %1215 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_532 = tensor.extract_slice %expanded_531[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_533 = tensor.expand_shape %extracted_slice_532 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1216 = iree_tensor_ext.bitcast %expanded_533 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_534 = tensor.extract_slice %expanded_531[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1217 = iree_tensor_ext.bitcast %extracted_slice_534 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_535 = tensor.collapse_shape %1216 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1218 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_535, %1217 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1219 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_525, %1218 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1220 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1219 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_536 = tensor.expand_shape %1208 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_537 = tensor.expand_shape %1214 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_78 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_78 : tensor<4x4x1x8x1xf32>
    %1221 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_78 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_538 = linalg.unpack %1221 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_539 = tensor.collapse_shape %unpack_538 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1222 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_539 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1223 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1222, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1224 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1223 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1225 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_539 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1226 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1225, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1227 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1226 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_540 = tensor.extract_slice %expanded_536[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_541 = tensor.extract_slice %expanded_536[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1228 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_540, %1224 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1229 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_541, %1227 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1230 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1228, %1229 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1231 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_541, %1224 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1232 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_540, %1227 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1233 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1231, %1232 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1234 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1230, %1233 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_80 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_80 : tensor<4x4x1x8x1xf32>
    %1235 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_80 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_542 = linalg.unpack %1235 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_543 = tensor.collapse_shape %unpack_542 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1236 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_543 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1237 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1236, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1238 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1237 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1239 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_543 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1240 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1239, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1241 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1240 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_544 = tensor.extract_slice %expanded_537[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_545 = tensor.extract_slice %expanded_537[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1242 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_544, %1238 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1243 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_545, %1241 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1244 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1242, %1243 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1245 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_545, %1238 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1246 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_544, %1241 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1247 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1245, %1246 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1248 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1244, %1247 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1249 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1250 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1249 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1251 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1250 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c8_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1252 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1251 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1253 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1252, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1254 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1253 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1255 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1254, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1256 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1255 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1257 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1256, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_546 = tensor.collapse_shape %1257 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_547 = tensor.collapse_shape %1248 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1258 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_547, %collapsed_546 : tensor<16x64xf16>, tensor<16xi64>) outs(%1148 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1259 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1252, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1260 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1259 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1261 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1260, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1262 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1261 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1263 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1262, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_548 = tensor.collapse_shape %1263 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_549 = tensor.expand_shape %1220 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_550 = tensor.collapse_shape %expanded_549 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1264 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_550, %collapsed_548 : tensor<16x64xf16>, tensor<16xi64>) outs(%1258 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_551 = tensor.expand_shape %1264 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_552 = tensor.extract_slice %expanded_551[0, 8, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1265 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_552, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_553 = tensor.extract_slice %expanded_551[0, 8, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1266 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_553, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1267 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1265 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_554 = tensor.collapse_shape %1267 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_555 = tensor.collapse_shape %1234 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1268 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1266 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_556 = tensor.collapse_shape %1268 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1269 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_555, %collapsed_554, %collapsed_556, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_557 = tensor.expand_shape %1269 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_558 = tensor.collapse_shape %expanded_557 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1270 = iree_tensor_ext.bitcast %77 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_559 = tensor.expand_shape %1270 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_560 = tensor.extract_slice %expanded_559[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_561 = tensor.expand_shape %extracted_slice_560 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1271 = iree_tensor_ext.bitcast %expanded_561 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_562 = tensor.extract_slice %expanded_559[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1272 = iree_tensor_ext.bitcast %extracted_slice_562 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_563 = tensor.collapse_shape %1271 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1273 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_563, %1272 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_564 = tensor.expand_shape %collapsed_558 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_565 = tensor.collapse_shape %expanded_564 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1274 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_565, %1273 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1275 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1274 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1276 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1192, %1275 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1277 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1276 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1278 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1277 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1279 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1278 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1280 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1279 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1281 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1280 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1282 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1281 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1283 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1277, %1282 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1284 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1283 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1285 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%78, %1284 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1286 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1285 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1287 = iree_tensor_ext.bitcast %79 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_566 = tensor.expand_shape %1287 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_567 = tensor.extract_slice %expanded_566[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_568 = tensor.expand_shape %extracted_slice_567 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1288 = iree_tensor_ext.bitcast %expanded_568 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_569 = tensor.extract_slice %expanded_566[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1289 = iree_tensor_ext.bitcast %extracted_slice_569 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_570 = tensor.collapse_shape %1288 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1290 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_570, %1289 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_571 = tensor.expand_shape %1286 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1291 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_571, %1290 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1292 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1291 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1293 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1292 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1294 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1293, %1292 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1295 = iree_tensor_ext.bitcast %80 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_572 = tensor.expand_shape %1295 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_573 = tensor.extract_slice %expanded_572[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_574 = tensor.expand_shape %extracted_slice_573 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1296 = iree_tensor_ext.bitcast %expanded_574 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_575 = tensor.extract_slice %expanded_572[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1297 = iree_tensor_ext.bitcast %extracted_slice_575 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_576 = tensor.collapse_shape %1296 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1298 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_576, %1297 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1299 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_571, %1298 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1300 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1299 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1301 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1294, %1300 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1302 = iree_tensor_ext.bitcast %81 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_577 = tensor.expand_shape %1302 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_578 = tensor.extract_slice %expanded_577[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_579 = tensor.expand_shape %extracted_slice_578 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1303 = iree_tensor_ext.bitcast %expanded_579 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_580 = tensor.extract_slice %expanded_577[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1304 = iree_tensor_ext.bitcast %extracted_slice_580 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_581 = tensor.collapse_shape %1303 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1305 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_581, %1304 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_582 = tensor.expand_shape %1301 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1306 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_582, %1305 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1307 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1306 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1308 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1276, %1307 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1309 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1308 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1310 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1309 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1311 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1310 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1312 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1311 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1313 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1312 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1314 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1313 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1315 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1309, %1314 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1316 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1315 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1317 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%82, %1316 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1318 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1317 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1319 = iree_tensor_ext.bitcast %83 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_583 = tensor.expand_shape %1319 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_584 = tensor.extract_slice %expanded_583[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_585 = tensor.expand_shape %extracted_slice_584 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1320 = iree_tensor_ext.bitcast %expanded_585 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_586 = tensor.extract_slice %expanded_583[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1321 = iree_tensor_ext.bitcast %extracted_slice_586 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_587 = tensor.collapse_shape %1320 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1322 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_587, %1321 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_588 = tensor.expand_shape %1318 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1323 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_588, %1322 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1324 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1323 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1325 = iree_tensor_ext.bitcast %84 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_589 = tensor.expand_shape %1325 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_590 = tensor.extract_slice %expanded_589[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_591 = tensor.expand_shape %extracted_slice_590 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1326 = iree_tensor_ext.bitcast %expanded_591 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_592 = tensor.extract_slice %expanded_589[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1327 = iree_tensor_ext.bitcast %extracted_slice_592 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_593 = tensor.collapse_shape %1326 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1328 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_593, %1327 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1329 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_588, %1328 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1330 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1329 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1331 = iree_tensor_ext.bitcast %85 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_594 = tensor.expand_shape %1331 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_595 = tensor.extract_slice %expanded_594[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_596 = tensor.expand_shape %extracted_slice_595 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1332 = iree_tensor_ext.bitcast %expanded_596 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_597 = tensor.extract_slice %expanded_594[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1333 = iree_tensor_ext.bitcast %extracted_slice_597 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_598 = tensor.collapse_shape %1332 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1334 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_598, %1333 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1335 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_588, %1334 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1336 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1335 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_599 = tensor.expand_shape %1324 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_600 = tensor.expand_shape %1330 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_82 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_82 : tensor<4x4x1x8x1xf32>
    %1337 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_82 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_601 = linalg.unpack %1337 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_602 = tensor.collapse_shape %unpack_601 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1338 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_602 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1339 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1338, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1340 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1339 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1341 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_602 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1342 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1341, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1343 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1342 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_603 = tensor.extract_slice %expanded_599[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_604 = tensor.extract_slice %expanded_599[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1344 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_603, %1340 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1345 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_604, %1343 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1346 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1344, %1345 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1347 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_604, %1340 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1348 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_603, %1343 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1349 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1347, %1348 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1350 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1346, %1349 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_84 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_84 : tensor<4x4x1x8x1xf32>
    %1351 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_84 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_605 = linalg.unpack %1351 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_606 = tensor.collapse_shape %unpack_605 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1352 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_606 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1353 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1352, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1354 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1353 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1355 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_606 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1356 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1355, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1357 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1356 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_607 = tensor.extract_slice %expanded_600[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_608 = tensor.extract_slice %expanded_600[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1358 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_607, %1354 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1359 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_608, %1357 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1360 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1358, %1359 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1361 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_608, %1354 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1362 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_607, %1357 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1363 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1361, %1362 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1364 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1360, %1363 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1365 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1366 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1365 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1367 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1366 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c9_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1368 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1367 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1369 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1368, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1370 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1369 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1371 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1370, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1372 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1371 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1373 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1372, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_609 = tensor.collapse_shape %1373 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_610 = tensor.collapse_shape %1364 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1374 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_610, %collapsed_609 : tensor<16x64xf16>, tensor<16xi64>) outs(%1264 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1375 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1368, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1376 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1375 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1377 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1376, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1378 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1377 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1379 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1378, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_611 = tensor.collapse_shape %1379 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_612 = tensor.expand_shape %1336 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_613 = tensor.collapse_shape %expanded_612 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1380 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_613, %collapsed_611 : tensor<16x64xf16>, tensor<16xi64>) outs(%1374 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_614 = tensor.expand_shape %1380 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_615 = tensor.extract_slice %expanded_614[0, 9, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1381 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_615, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_616 = tensor.extract_slice %expanded_614[0, 9, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1382 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_616, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1383 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1381 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_617 = tensor.collapse_shape %1383 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_618 = tensor.collapse_shape %1350 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1384 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1382 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_619 = tensor.collapse_shape %1384 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1385 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_618, %collapsed_617, %collapsed_619, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_620 = tensor.expand_shape %1385 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_621 = tensor.collapse_shape %expanded_620 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1386 = iree_tensor_ext.bitcast %86 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_622 = tensor.expand_shape %1386 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_623 = tensor.extract_slice %expanded_622[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_624 = tensor.expand_shape %extracted_slice_623 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1387 = iree_tensor_ext.bitcast %expanded_624 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_625 = tensor.extract_slice %expanded_622[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1388 = iree_tensor_ext.bitcast %extracted_slice_625 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_626 = tensor.collapse_shape %1387 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1389 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_626, %1388 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_627 = tensor.expand_shape %collapsed_621 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_628 = tensor.collapse_shape %expanded_627 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1390 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_628, %1389 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1391 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1390 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1392 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1308, %1391 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1393 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1392 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1394 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1393 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1395 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1394 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1396 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1395 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1397 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1396 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1398 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1397 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1399 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1393, %1398 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1400 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1399 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1401 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%87, %1400 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1402 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1401 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1403 = iree_tensor_ext.bitcast %88 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_629 = tensor.expand_shape %1403 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_630 = tensor.extract_slice %expanded_629[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_631 = tensor.expand_shape %extracted_slice_630 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1404 = iree_tensor_ext.bitcast %expanded_631 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_632 = tensor.extract_slice %expanded_629[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1405 = iree_tensor_ext.bitcast %extracted_slice_632 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_633 = tensor.collapse_shape %1404 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1406 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_633, %1405 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_634 = tensor.expand_shape %1402 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1407 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_634, %1406 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1408 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1407 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1409 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1408 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1410 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1409, %1408 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1411 = iree_tensor_ext.bitcast %89 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_635 = tensor.expand_shape %1411 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_636 = tensor.extract_slice %expanded_635[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_637 = tensor.expand_shape %extracted_slice_636 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1412 = iree_tensor_ext.bitcast %expanded_637 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_638 = tensor.extract_slice %expanded_635[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1413 = iree_tensor_ext.bitcast %extracted_slice_638 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_639 = tensor.collapse_shape %1412 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1414 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_639, %1413 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1415 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_634, %1414 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1416 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1415 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1417 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1410, %1416 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1418 = iree_tensor_ext.bitcast %90 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_640 = tensor.expand_shape %1418 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_641 = tensor.extract_slice %expanded_640[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_642 = tensor.expand_shape %extracted_slice_641 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1419 = iree_tensor_ext.bitcast %expanded_642 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_643 = tensor.extract_slice %expanded_640[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1420 = iree_tensor_ext.bitcast %extracted_slice_643 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_644 = tensor.collapse_shape %1419 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1421 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_644, %1420 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_645 = tensor.expand_shape %1417 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1422 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_645, %1421 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1423 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1422 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1424 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1392, %1423 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1425 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1424 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1426 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1425 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1427 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1426 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1428 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1427 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1429 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1428 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1430 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1429 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1431 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1425, %1430 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1432 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1431 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1433 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%91, %1432 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1434 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1433 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1435 = iree_tensor_ext.bitcast %92 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_646 = tensor.expand_shape %1435 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_647 = tensor.extract_slice %expanded_646[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_648 = tensor.expand_shape %extracted_slice_647 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1436 = iree_tensor_ext.bitcast %expanded_648 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_649 = tensor.extract_slice %expanded_646[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1437 = iree_tensor_ext.bitcast %extracted_slice_649 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_650 = tensor.collapse_shape %1436 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1438 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_650, %1437 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_651 = tensor.expand_shape %1434 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1439 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_651, %1438 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1440 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1439 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1441 = iree_tensor_ext.bitcast %93 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_652 = tensor.expand_shape %1441 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_653 = tensor.extract_slice %expanded_652[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_654 = tensor.expand_shape %extracted_slice_653 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1442 = iree_tensor_ext.bitcast %expanded_654 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_655 = tensor.extract_slice %expanded_652[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1443 = iree_tensor_ext.bitcast %extracted_slice_655 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_656 = tensor.collapse_shape %1442 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1444 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_656, %1443 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1445 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_651, %1444 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1446 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1445 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1447 = iree_tensor_ext.bitcast %94 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_657 = tensor.expand_shape %1447 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_658 = tensor.extract_slice %expanded_657[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_659 = tensor.expand_shape %extracted_slice_658 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1448 = iree_tensor_ext.bitcast %expanded_659 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_660 = tensor.extract_slice %expanded_657[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1449 = iree_tensor_ext.bitcast %extracted_slice_660 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_661 = tensor.collapse_shape %1448 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1450 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_661, %1449 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1451 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_651, %1450 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1452 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1451 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_662 = tensor.expand_shape %1440 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_663 = tensor.expand_shape %1446 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_86 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_86 : tensor<4x4x1x8x1xf32>
    %1453 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_86 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_664 = linalg.unpack %1453 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_665 = tensor.collapse_shape %unpack_664 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1454 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_665 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1455 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1454, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1456 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1455 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1457 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_665 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1458 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1457, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1459 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1458 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_666 = tensor.extract_slice %expanded_662[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_667 = tensor.extract_slice %expanded_662[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1460 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_666, %1456 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1461 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_667, %1459 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1462 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1460, %1461 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1463 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_667, %1456 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1464 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_666, %1459 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1465 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1463, %1464 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1466 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1462, %1465 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_88 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_88 : tensor<4x4x1x8x1xf32>
    %1467 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_88 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_668 = linalg.unpack %1467 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_669 = tensor.collapse_shape %unpack_668 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1468 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_669 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1469 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1468, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1470 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1469 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1471 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_669 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1472 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1471, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1473 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1472 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_670 = tensor.extract_slice %expanded_663[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_671 = tensor.extract_slice %expanded_663[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1474 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_670, %1470 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1475 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_671, %1473 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1476 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1474, %1475 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1477 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_671, %1470 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1478 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_670, %1473 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1479 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1477, %1478 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1480 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1476, %1479 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1481 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1482 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1481 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1483 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1482 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c10_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1484 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1483 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1485 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1484, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1486 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1485 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1487 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1486, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1488 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1487 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1489 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1488, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_672 = tensor.collapse_shape %1489 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_673 = tensor.collapse_shape %1480 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1490 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_673, %collapsed_672 : tensor<16x64xf16>, tensor<16xi64>) outs(%1380 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1491 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1484, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1492 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1491 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1493 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1492, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1494 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1493 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1495 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1494, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_674 = tensor.collapse_shape %1495 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_675 = tensor.expand_shape %1452 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_676 = tensor.collapse_shape %expanded_675 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1496 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_676, %collapsed_674 : tensor<16x64xf16>, tensor<16xi64>) outs(%1490 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_677 = tensor.expand_shape %1496 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_678 = tensor.extract_slice %expanded_677[0, 10, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1497 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_678, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_679 = tensor.extract_slice %expanded_677[0, 10, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1498 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_679, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1499 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1497 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_680 = tensor.collapse_shape %1499 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_681 = tensor.collapse_shape %1466 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1500 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1498 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_682 = tensor.collapse_shape %1500 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1501 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_681, %collapsed_680, %collapsed_682, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_683 = tensor.expand_shape %1501 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_684 = tensor.collapse_shape %expanded_683 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1502 = iree_tensor_ext.bitcast %95 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_685 = tensor.expand_shape %1502 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_686 = tensor.extract_slice %expanded_685[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_687 = tensor.expand_shape %extracted_slice_686 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1503 = iree_tensor_ext.bitcast %expanded_687 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_688 = tensor.extract_slice %expanded_685[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1504 = iree_tensor_ext.bitcast %extracted_slice_688 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_689 = tensor.collapse_shape %1503 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1505 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_689, %1504 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_690 = tensor.expand_shape %collapsed_684 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_691 = tensor.collapse_shape %expanded_690 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1506 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_691, %1505 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1507 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1506 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1508 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1424, %1507 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1509 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1508 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1510 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1509 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1511 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1510 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1512 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1511 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1513 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1512 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1514 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1513 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1515 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1509, %1514 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1516 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1515 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1517 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%96, %1516 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1518 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1517 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1519 = iree_tensor_ext.bitcast %97 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_692 = tensor.expand_shape %1519 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_693 = tensor.extract_slice %expanded_692[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_694 = tensor.expand_shape %extracted_slice_693 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1520 = iree_tensor_ext.bitcast %expanded_694 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_695 = tensor.extract_slice %expanded_692[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1521 = iree_tensor_ext.bitcast %extracted_slice_695 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_696 = tensor.collapse_shape %1520 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1522 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_696, %1521 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_697 = tensor.expand_shape %1518 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1523 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_697, %1522 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1524 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1523 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1525 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1524 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1526 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1525, %1524 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1527 = iree_tensor_ext.bitcast %98 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_698 = tensor.expand_shape %1527 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_699 = tensor.extract_slice %expanded_698[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_700 = tensor.expand_shape %extracted_slice_699 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1528 = iree_tensor_ext.bitcast %expanded_700 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_701 = tensor.extract_slice %expanded_698[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1529 = iree_tensor_ext.bitcast %extracted_slice_701 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_702 = tensor.collapse_shape %1528 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1530 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_702, %1529 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1531 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_697, %1530 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1532 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1531 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1533 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1526, %1532 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1534 = iree_tensor_ext.bitcast %99 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_703 = tensor.expand_shape %1534 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_704 = tensor.extract_slice %expanded_703[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_705 = tensor.expand_shape %extracted_slice_704 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1535 = iree_tensor_ext.bitcast %expanded_705 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_706 = tensor.extract_slice %expanded_703[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1536 = iree_tensor_ext.bitcast %extracted_slice_706 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_707 = tensor.collapse_shape %1535 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1537 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_707, %1536 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_708 = tensor.expand_shape %1533 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1538 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_708, %1537 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1539 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1538 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1540 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1508, %1539 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1541 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1540 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1542 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1541 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1543 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1542 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1544 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1543 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1545 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1544 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1546 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1545 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1547 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1541, %1546 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1548 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1547 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1549 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%100, %1548 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1550 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1549 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1551 = iree_tensor_ext.bitcast %101 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_709 = tensor.expand_shape %1551 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_710 = tensor.extract_slice %expanded_709[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_711 = tensor.expand_shape %extracted_slice_710 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1552 = iree_tensor_ext.bitcast %expanded_711 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_712 = tensor.extract_slice %expanded_709[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1553 = iree_tensor_ext.bitcast %extracted_slice_712 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_713 = tensor.collapse_shape %1552 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1554 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_713, %1553 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_714 = tensor.expand_shape %1550 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1555 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_714, %1554 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1556 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1555 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1557 = iree_tensor_ext.bitcast %102 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_715 = tensor.expand_shape %1557 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_716 = tensor.extract_slice %expanded_715[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_717 = tensor.expand_shape %extracted_slice_716 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1558 = iree_tensor_ext.bitcast %expanded_717 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_718 = tensor.extract_slice %expanded_715[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1559 = iree_tensor_ext.bitcast %extracted_slice_718 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_719 = tensor.collapse_shape %1558 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1560 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_719, %1559 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1561 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_714, %1560 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1562 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1561 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1563 = iree_tensor_ext.bitcast %103 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_720 = tensor.expand_shape %1563 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_721 = tensor.extract_slice %expanded_720[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_722 = tensor.expand_shape %extracted_slice_721 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1564 = iree_tensor_ext.bitcast %expanded_722 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_723 = tensor.extract_slice %expanded_720[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1565 = iree_tensor_ext.bitcast %extracted_slice_723 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_724 = tensor.collapse_shape %1564 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1566 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_724, %1565 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1567 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_714, %1566 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1568 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1567 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_725 = tensor.expand_shape %1556 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_726 = tensor.expand_shape %1562 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_90 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_90 : tensor<4x4x1x8x1xf32>
    %1569 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_90 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_727 = linalg.unpack %1569 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_728 = tensor.collapse_shape %unpack_727 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1570 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_728 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1571 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1570, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1572 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1571 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1573 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_728 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1574 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1573, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1575 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1574 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_729 = tensor.extract_slice %expanded_725[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_730 = tensor.extract_slice %expanded_725[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1576 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_729, %1572 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1577 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_730, %1575 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1578 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1576, %1577 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1579 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_730, %1572 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1580 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_729, %1575 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1581 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1579, %1580 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1582 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1578, %1581 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_92 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_92 : tensor<4x4x1x8x1xf32>
    %1583 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_92 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_731 = linalg.unpack %1583 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_732 = tensor.collapse_shape %unpack_731 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1584 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_732 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1585 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1584, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1586 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1585 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1587 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_732 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1588 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1587, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1589 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1588 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_733 = tensor.extract_slice %expanded_726[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_734 = tensor.extract_slice %expanded_726[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1590 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_733, %1586 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1591 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_734, %1589 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1592 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1590, %1591 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1593 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_734, %1586 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1594 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_733, %1589 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1595 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1593, %1594 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1596 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1592, %1595 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1597 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1598 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1597 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1599 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1598 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c11_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1600 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1599 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1601 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1600, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1602 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1601 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1603 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1602, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1604 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1603 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1605 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1604, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_735 = tensor.collapse_shape %1605 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_736 = tensor.collapse_shape %1596 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1606 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_736, %collapsed_735 : tensor<16x64xf16>, tensor<16xi64>) outs(%1496 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1607 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1600, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1608 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1607 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1609 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1608, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1610 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1609 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1611 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1610, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_737 = tensor.collapse_shape %1611 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_738 = tensor.expand_shape %1568 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_739 = tensor.collapse_shape %expanded_738 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1612 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_739, %collapsed_737 : tensor<16x64xf16>, tensor<16xi64>) outs(%1606 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_740 = tensor.expand_shape %1612 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_741 = tensor.extract_slice %expanded_740[0, 11, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1613 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_741, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_742 = tensor.extract_slice %expanded_740[0, 11, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1614 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_742, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1615 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1613 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_743 = tensor.collapse_shape %1615 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_744 = tensor.collapse_shape %1582 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1616 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1614 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_745 = tensor.collapse_shape %1616 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1617 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_744, %collapsed_743, %collapsed_745, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_746 = tensor.expand_shape %1617 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_747 = tensor.collapse_shape %expanded_746 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1618 = iree_tensor_ext.bitcast %104 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_748 = tensor.expand_shape %1618 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_749 = tensor.extract_slice %expanded_748[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_750 = tensor.expand_shape %extracted_slice_749 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1619 = iree_tensor_ext.bitcast %expanded_750 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_751 = tensor.extract_slice %expanded_748[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1620 = iree_tensor_ext.bitcast %extracted_slice_751 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_752 = tensor.collapse_shape %1619 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1621 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_752, %1620 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_753 = tensor.expand_shape %collapsed_747 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_754 = tensor.collapse_shape %expanded_753 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1622 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_754, %1621 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1623 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1622 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1624 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1540, %1623 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1625 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1624 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1626 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1625 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1627 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1626 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1628 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1627 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1629 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1628 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1630 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1629 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1631 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1625, %1630 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1632 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1631 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1633 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%105, %1632 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1634 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1633 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1635 = iree_tensor_ext.bitcast %106 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_755 = tensor.expand_shape %1635 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_756 = tensor.extract_slice %expanded_755[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_757 = tensor.expand_shape %extracted_slice_756 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1636 = iree_tensor_ext.bitcast %expanded_757 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_758 = tensor.extract_slice %expanded_755[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1637 = iree_tensor_ext.bitcast %extracted_slice_758 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_759 = tensor.collapse_shape %1636 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1638 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_759, %1637 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_760 = tensor.expand_shape %1634 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1639 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_760, %1638 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1640 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1639 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1641 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1640 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1642 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1641, %1640 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1643 = iree_tensor_ext.bitcast %107 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_761 = tensor.expand_shape %1643 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_762 = tensor.extract_slice %expanded_761[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_763 = tensor.expand_shape %extracted_slice_762 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1644 = iree_tensor_ext.bitcast %expanded_763 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_764 = tensor.extract_slice %expanded_761[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1645 = iree_tensor_ext.bitcast %extracted_slice_764 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_765 = tensor.collapse_shape %1644 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1646 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_765, %1645 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1647 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_760, %1646 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1648 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1647 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1649 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1642, %1648 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1650 = iree_tensor_ext.bitcast %108 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_766 = tensor.expand_shape %1650 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_767 = tensor.extract_slice %expanded_766[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_768 = tensor.expand_shape %extracted_slice_767 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1651 = iree_tensor_ext.bitcast %expanded_768 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_769 = tensor.extract_slice %expanded_766[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1652 = iree_tensor_ext.bitcast %extracted_slice_769 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_770 = tensor.collapse_shape %1651 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1653 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_770, %1652 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_771 = tensor.expand_shape %1649 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1654 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_771, %1653 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1655 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1654 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1656 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1624, %1655 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1657 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1656 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1658 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1657 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1659 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1658 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1660 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1659 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1661 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1660 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1662 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1661 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1663 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1657, %1662 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1664 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1663 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1665 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%109, %1664 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1666 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1665 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1667 = iree_tensor_ext.bitcast %110 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_772 = tensor.expand_shape %1667 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_773 = tensor.extract_slice %expanded_772[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_774 = tensor.expand_shape %extracted_slice_773 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1668 = iree_tensor_ext.bitcast %expanded_774 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_775 = tensor.extract_slice %expanded_772[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1669 = iree_tensor_ext.bitcast %extracted_slice_775 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_776 = tensor.collapse_shape %1668 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1670 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_776, %1669 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_777 = tensor.expand_shape %1666 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1671 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_777, %1670 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1672 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1671 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1673 = iree_tensor_ext.bitcast %111 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_778 = tensor.expand_shape %1673 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_779 = tensor.extract_slice %expanded_778[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_780 = tensor.expand_shape %extracted_slice_779 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1674 = iree_tensor_ext.bitcast %expanded_780 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_781 = tensor.extract_slice %expanded_778[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1675 = iree_tensor_ext.bitcast %extracted_slice_781 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_782 = tensor.collapse_shape %1674 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1676 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_782, %1675 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1677 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_777, %1676 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1678 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1677 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1679 = iree_tensor_ext.bitcast %112 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_783 = tensor.expand_shape %1679 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_784 = tensor.extract_slice %expanded_783[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_785 = tensor.expand_shape %extracted_slice_784 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1680 = iree_tensor_ext.bitcast %expanded_785 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_786 = tensor.extract_slice %expanded_783[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1681 = iree_tensor_ext.bitcast %extracted_slice_786 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_787 = tensor.collapse_shape %1680 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1682 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_787, %1681 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1683 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_777, %1682 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1684 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1683 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_788 = tensor.expand_shape %1672 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_789 = tensor.expand_shape %1678 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_94 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_94 : tensor<4x4x1x8x1xf32>
    %1685 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_94 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_790 = linalg.unpack %1685 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_791 = tensor.collapse_shape %unpack_790 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1686 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_791 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1687 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1686, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1688 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1687 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1689 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_791 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1690 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1689, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1691 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1690 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_792 = tensor.extract_slice %expanded_788[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_793 = tensor.extract_slice %expanded_788[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1692 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_792, %1688 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1693 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_793, %1691 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1694 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1692, %1693 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1695 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_793, %1688 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1696 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_792, %1691 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1697 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1695, %1696 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1698 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1694, %1697 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_96 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_96 : tensor<4x4x1x8x1xf32>
    %1699 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_96 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_794 = linalg.unpack %1699 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_795 = tensor.collapse_shape %unpack_794 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1700 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_795 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1701 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1700, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1702 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1701 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1703 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_795 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1704 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1703, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1705 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1704 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_796 = tensor.extract_slice %expanded_789[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_797 = tensor.extract_slice %expanded_789[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1706 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_796, %1702 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1707 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_797, %1705 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1708 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1706, %1707 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1709 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_797, %1702 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1710 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_796, %1705 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1711 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1709, %1710 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1712 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1708, %1711 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1713 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1714 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1713 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1715 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1714 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c12_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1716 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1715 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1717 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1716, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1718 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1717 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1719 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1718, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1720 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1719 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1721 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1720, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_798 = tensor.collapse_shape %1721 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_799 = tensor.collapse_shape %1712 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1722 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_799, %collapsed_798 : tensor<16x64xf16>, tensor<16xi64>) outs(%1612 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1723 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1716, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1724 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1723 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1725 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1724, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1726 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1725 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1727 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1726, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_800 = tensor.collapse_shape %1727 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_801 = tensor.expand_shape %1684 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_802 = tensor.collapse_shape %expanded_801 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1728 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_802, %collapsed_800 : tensor<16x64xf16>, tensor<16xi64>) outs(%1722 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_803 = tensor.expand_shape %1728 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_804 = tensor.extract_slice %expanded_803[0, 12, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1729 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_804, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_805 = tensor.extract_slice %expanded_803[0, 12, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1730 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_805, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1731 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1729 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_806 = tensor.collapse_shape %1731 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_807 = tensor.collapse_shape %1698 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1732 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1730 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_808 = tensor.collapse_shape %1732 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1733 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_807, %collapsed_806, %collapsed_808, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_809 = tensor.expand_shape %1733 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_810 = tensor.collapse_shape %expanded_809 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1734 = iree_tensor_ext.bitcast %113 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_811 = tensor.expand_shape %1734 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_812 = tensor.extract_slice %expanded_811[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_813 = tensor.expand_shape %extracted_slice_812 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1735 = iree_tensor_ext.bitcast %expanded_813 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_814 = tensor.extract_slice %expanded_811[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1736 = iree_tensor_ext.bitcast %extracted_slice_814 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_815 = tensor.collapse_shape %1735 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1737 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_815, %1736 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_816 = tensor.expand_shape %collapsed_810 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_817 = tensor.collapse_shape %expanded_816 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1738 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_817, %1737 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1739 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1738 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1740 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1656, %1739 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1741 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1740 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1742 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1741 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1743 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1742 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1744 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1743 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1745 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1744 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1746 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1745 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1747 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1741, %1746 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1748 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1747 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1749 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%114, %1748 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1750 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1749 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1751 = iree_tensor_ext.bitcast %115 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_818 = tensor.expand_shape %1751 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_819 = tensor.extract_slice %expanded_818[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_820 = tensor.expand_shape %extracted_slice_819 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1752 = iree_tensor_ext.bitcast %expanded_820 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_821 = tensor.extract_slice %expanded_818[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1753 = iree_tensor_ext.bitcast %extracted_slice_821 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_822 = tensor.collapse_shape %1752 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1754 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_822, %1753 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_823 = tensor.expand_shape %1750 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1755 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_823, %1754 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1756 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1755 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1757 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1756 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1758 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1757, %1756 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1759 = iree_tensor_ext.bitcast %116 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_824 = tensor.expand_shape %1759 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_825 = tensor.extract_slice %expanded_824[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_826 = tensor.expand_shape %extracted_slice_825 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1760 = iree_tensor_ext.bitcast %expanded_826 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_827 = tensor.extract_slice %expanded_824[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1761 = iree_tensor_ext.bitcast %extracted_slice_827 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_828 = tensor.collapse_shape %1760 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1762 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_828, %1761 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1763 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_823, %1762 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1764 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1763 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1765 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1758, %1764 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1766 = iree_tensor_ext.bitcast %117 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_829 = tensor.expand_shape %1766 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_830 = tensor.extract_slice %expanded_829[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_831 = tensor.expand_shape %extracted_slice_830 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1767 = iree_tensor_ext.bitcast %expanded_831 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_832 = tensor.extract_slice %expanded_829[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1768 = iree_tensor_ext.bitcast %extracted_slice_832 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_833 = tensor.collapse_shape %1767 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1769 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_833, %1768 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_834 = tensor.expand_shape %1765 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1770 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_834, %1769 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1771 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1770 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1772 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1740, %1771 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1773 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1772 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1774 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1773 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1775 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1774 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1776 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1775 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1777 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1776 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1778 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1777 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1779 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1773, %1778 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1780 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1779 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1781 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%118, %1780 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1782 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1781 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1783 = iree_tensor_ext.bitcast %119 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_835 = tensor.expand_shape %1783 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_836 = tensor.extract_slice %expanded_835[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_837 = tensor.expand_shape %extracted_slice_836 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1784 = iree_tensor_ext.bitcast %expanded_837 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_838 = tensor.extract_slice %expanded_835[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1785 = iree_tensor_ext.bitcast %extracted_slice_838 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_839 = tensor.collapse_shape %1784 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1786 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_839, %1785 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_840 = tensor.expand_shape %1782 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1787 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_840, %1786 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1788 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1787 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1789 = iree_tensor_ext.bitcast %120 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_841 = tensor.expand_shape %1789 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_842 = tensor.extract_slice %expanded_841[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_843 = tensor.expand_shape %extracted_slice_842 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1790 = iree_tensor_ext.bitcast %expanded_843 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_844 = tensor.extract_slice %expanded_841[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1791 = iree_tensor_ext.bitcast %extracted_slice_844 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_845 = tensor.collapse_shape %1790 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1792 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_845, %1791 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1793 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_840, %1792 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1794 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1793 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1795 = iree_tensor_ext.bitcast %121 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_846 = tensor.expand_shape %1795 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_847 = tensor.extract_slice %expanded_846[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_848 = tensor.expand_shape %extracted_slice_847 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1796 = iree_tensor_ext.bitcast %expanded_848 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_849 = tensor.extract_slice %expanded_846[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1797 = iree_tensor_ext.bitcast %extracted_slice_849 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_850 = tensor.collapse_shape %1796 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1798 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_850, %1797 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1799 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_840, %1798 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1800 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1799 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_851 = tensor.expand_shape %1788 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_852 = tensor.expand_shape %1794 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_98 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_98 : tensor<4x4x1x8x1xf32>
    %1801 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_98 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_853 = linalg.unpack %1801 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_854 = tensor.collapse_shape %unpack_853 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1802 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_854 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1803 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1802, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1804 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1803 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1805 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_854 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1806 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1805, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1807 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1806 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_855 = tensor.extract_slice %expanded_851[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_856 = tensor.extract_slice %expanded_851[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1808 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_855, %1804 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1809 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_856, %1807 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1810 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1808, %1809 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1811 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_856, %1804 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1812 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_855, %1807 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1813 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1811, %1812 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1814 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1810, %1813 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_100 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_100 : tensor<4x4x1x8x1xf32>
    %1815 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_100 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_857 = linalg.unpack %1815 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_858 = tensor.collapse_shape %unpack_857 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1816 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_858 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1817 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1816, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1818 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1817 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1819 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_858 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1820 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1819, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1821 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1820 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_859 = tensor.extract_slice %expanded_852[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_860 = tensor.extract_slice %expanded_852[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1822 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_859, %1818 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1823 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_860, %1821 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1824 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1822, %1823 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1825 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_860, %1818 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1826 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_859, %1821 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1827 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1825, %1826 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1828 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1824, %1827 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1829 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1830 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1829 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1831 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1830 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c13_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1832 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1831 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1833 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1832, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1834 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1833 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1835 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1834, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1836 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1835 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1837 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1836, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_861 = tensor.collapse_shape %1837 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_862 = tensor.collapse_shape %1828 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1838 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_862, %collapsed_861 : tensor<16x64xf16>, tensor<16xi64>) outs(%1728 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1839 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1832, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1840 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1839 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1841 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1840, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1842 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1841 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1843 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1842, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_863 = tensor.collapse_shape %1843 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_864 = tensor.expand_shape %1800 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_865 = tensor.collapse_shape %expanded_864 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1844 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_865, %collapsed_863 : tensor<16x64xf16>, tensor<16xi64>) outs(%1838 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_866 = tensor.expand_shape %1844 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_867 = tensor.extract_slice %expanded_866[0, 13, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1845 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_867, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_868 = tensor.extract_slice %expanded_866[0, 13, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1846 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_868, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1847 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1845 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_869 = tensor.collapse_shape %1847 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_870 = tensor.collapse_shape %1814 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1848 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1846 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_871 = tensor.collapse_shape %1848 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1849 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_870, %collapsed_869, %collapsed_871, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_872 = tensor.expand_shape %1849 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_873 = tensor.collapse_shape %expanded_872 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1850 = iree_tensor_ext.bitcast %122 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_874 = tensor.expand_shape %1850 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_875 = tensor.extract_slice %expanded_874[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_876 = tensor.expand_shape %extracted_slice_875 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1851 = iree_tensor_ext.bitcast %expanded_876 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_877 = tensor.extract_slice %expanded_874[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1852 = iree_tensor_ext.bitcast %extracted_slice_877 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_878 = tensor.collapse_shape %1851 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1853 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_878, %1852 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_879 = tensor.expand_shape %collapsed_873 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_880 = tensor.collapse_shape %expanded_879 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1854 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_880, %1853 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1855 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1854 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1856 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1772, %1855 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1857 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1856 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1858 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1857 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1859 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1858 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1860 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1859 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1861 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1860 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1862 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1861 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1863 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1857, %1862 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1864 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1863 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1865 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%123, %1864 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1866 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1865 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1867 = iree_tensor_ext.bitcast %124 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_881 = tensor.expand_shape %1867 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_882 = tensor.extract_slice %expanded_881[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_883 = tensor.expand_shape %extracted_slice_882 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1868 = iree_tensor_ext.bitcast %expanded_883 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_884 = tensor.extract_slice %expanded_881[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1869 = iree_tensor_ext.bitcast %extracted_slice_884 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_885 = tensor.collapse_shape %1868 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1870 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_885, %1869 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_886 = tensor.expand_shape %1866 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1871 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_886, %1870 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1872 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1871 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1873 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1872 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1874 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1873, %1872 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1875 = iree_tensor_ext.bitcast %125 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_887 = tensor.expand_shape %1875 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_888 = tensor.extract_slice %expanded_887[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_889 = tensor.expand_shape %extracted_slice_888 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1876 = iree_tensor_ext.bitcast %expanded_889 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_890 = tensor.extract_slice %expanded_887[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1877 = iree_tensor_ext.bitcast %extracted_slice_890 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_891 = tensor.collapse_shape %1876 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1878 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_891, %1877 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1879 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_886, %1878 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1880 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1879 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1881 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1874, %1880 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1882 = iree_tensor_ext.bitcast %126 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_892 = tensor.expand_shape %1882 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_893 = tensor.extract_slice %expanded_892[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_894 = tensor.expand_shape %extracted_slice_893 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1883 = iree_tensor_ext.bitcast %expanded_894 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_895 = tensor.extract_slice %expanded_892[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %1884 = iree_tensor_ext.bitcast %extracted_slice_895 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_896 = tensor.collapse_shape %1883 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %1885 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_896, %1884 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_897 = tensor.expand_shape %1881 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %1886 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_897, %1885 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1887 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1886 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1888 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1856, %1887 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1889 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1888 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1890 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1889 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1891 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1890 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1892 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1891 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1893 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1892 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1894 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1893 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1895 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1889, %1894 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1896 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1895 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1897 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%127, %1896 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1898 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1897 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1899 = iree_tensor_ext.bitcast %128 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_898 = tensor.expand_shape %1899 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_899 = tensor.extract_slice %expanded_898[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_900 = tensor.expand_shape %extracted_slice_899 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1900 = iree_tensor_ext.bitcast %expanded_900 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_901 = tensor.extract_slice %expanded_898[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1901 = iree_tensor_ext.bitcast %extracted_slice_901 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_902 = tensor.collapse_shape %1900 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1902 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_902, %1901 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_903 = tensor.expand_shape %1898 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1903 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_903, %1902 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1904 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1903 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1905 = iree_tensor_ext.bitcast %129 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_904 = tensor.expand_shape %1905 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_905 = tensor.extract_slice %expanded_904[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_906 = tensor.expand_shape %extracted_slice_905 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1906 = iree_tensor_ext.bitcast %expanded_906 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_907 = tensor.extract_slice %expanded_904[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1907 = iree_tensor_ext.bitcast %extracted_slice_907 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_908 = tensor.collapse_shape %1906 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1908 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_908, %1907 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1909 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_903, %1908 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1910 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1909 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %1911 = iree_tensor_ext.bitcast %130 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_909 = tensor.expand_shape %1911 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_910 = tensor.extract_slice %expanded_909[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_911 = tensor.expand_shape %extracted_slice_910 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %1912 = iree_tensor_ext.bitcast %expanded_911 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_912 = tensor.extract_slice %expanded_909[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %1913 = iree_tensor_ext.bitcast %extracted_slice_912 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_913 = tensor.collapse_shape %1912 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %1914 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_913, %1913 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %1915 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_903, %1914 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %1916 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1915 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_914 = tensor.expand_shape %1904 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_915 = tensor.expand_shape %1910 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_102 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_102 : tensor<4x4x1x8x1xf32>
    %1917 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_102 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_916 = linalg.unpack %1917 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_917 = tensor.collapse_shape %unpack_916 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1918 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_917 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1919 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1918, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1920 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1919 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1921 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_917 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1922 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1921, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1923 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1922 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_918 = tensor.extract_slice %expanded_914[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_919 = tensor.extract_slice %expanded_914[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %1924 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_918, %1920 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1925 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_919, %1923 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1926 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1924, %1925 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1927 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_919, %1920 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1928 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_918, %1923 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1929 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1927, %1928 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %1930 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1926, %1929 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_104 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_104 : tensor<4x4x1x8x1xf32>
    %1931 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_104 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_920 = linalg.unpack %1931 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_921 = tensor.collapse_shape %unpack_920 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %1932 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_921 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1933 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1932, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1934 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1933 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %1935 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_921 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1936 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%1935, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %1937 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1936 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_922 = tensor.extract_slice %expanded_915[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_923 = tensor.extract_slice %expanded_915[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %1938 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_922, %1934 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1939 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_923, %1937 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1940 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1938, %1939 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1941 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_923, %1934 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1942 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_922, %1937 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1943 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%1941, %1942 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %1944 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%1940, %1943 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %1945 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %1946 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1945 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1947 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1946 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c14_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1948 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1947 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1949 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1948, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1950 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1949 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1951 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1950, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1952 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1951 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1953 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1952, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_924 = tensor.collapse_shape %1953 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_925 = tensor.collapse_shape %1944 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %1954 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_925, %collapsed_924 : tensor<16x64xf16>, tensor<16xi64>) outs(%1844 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %1955 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%1948, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1956 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1955 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %1957 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%1956, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1958 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1957 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %1959 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1958, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_926 = tensor.collapse_shape %1959 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_927 = tensor.expand_shape %1916 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_928 = tensor.collapse_shape %expanded_927 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %1960 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_928, %collapsed_926 : tensor<16x64xf16>, tensor<16xi64>) outs(%1954 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_929 = tensor.expand_shape %1960 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_930 = tensor.extract_slice %expanded_929[0, 14, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1961 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_930, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_931 = tensor.extract_slice %expanded_929[0, 14, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %1962 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_931, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %1963 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1961 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_932 = tensor.collapse_shape %1963 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_933 = tensor.collapse_shape %1930 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %1964 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%1962 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_934 = tensor.collapse_shape %1964 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %1965 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_933, %collapsed_932, %collapsed_934, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_935 = tensor.expand_shape %1965 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_936 = tensor.collapse_shape %expanded_935 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %1966 = iree_tensor_ext.bitcast %131 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_937 = tensor.expand_shape %1966 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_938 = tensor.extract_slice %expanded_937[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_939 = tensor.expand_shape %extracted_slice_938 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %1967 = iree_tensor_ext.bitcast %expanded_939 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_940 = tensor.extract_slice %expanded_937[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %1968 = iree_tensor_ext.bitcast %extracted_slice_940 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_941 = tensor.collapse_shape %1967 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %1969 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_941, %1968 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_942 = tensor.expand_shape %collapsed_936 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_943 = tensor.collapse_shape %expanded_942 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %1970 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_943, %1969 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %1971 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1970 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1972 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1888, %1971 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1973 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1972 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1974 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1973 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1975 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%1974 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1976 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1975 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1977 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1976 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1978 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%1977 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %1979 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%1973, %1978 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %1980 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1979 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1981 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%132, %1980 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %1982 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1981 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %1983 = iree_tensor_ext.bitcast %133 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_944 = tensor.expand_shape %1983 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_945 = tensor.extract_slice %expanded_944[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_946 = tensor.expand_shape %extracted_slice_945 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1984 = iree_tensor_ext.bitcast %expanded_946 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_947 = tensor.extract_slice %expanded_944[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1985 = iree_tensor_ext.bitcast %extracted_slice_947 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_948 = tensor.collapse_shape %1984 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1986 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_948, %1985 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_949 = tensor.expand_shape %1982 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %1987 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_949, %1986 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1988 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1987 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1989 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1988 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %1990 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1989, %1988 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1991 = iree_tensor_ext.bitcast %134 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_950 = tensor.expand_shape %1991 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_951 = tensor.extract_slice %expanded_950[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_952 = tensor.expand_shape %extracted_slice_951 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %1992 = iree_tensor_ext.bitcast %expanded_952 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_953 = tensor.extract_slice %expanded_950[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %1993 = iree_tensor_ext.bitcast %extracted_slice_953 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_954 = tensor.collapse_shape %1992 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %1994 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_954, %1993 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %1995 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_949, %1994 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %1996 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1995 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1997 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1990, %1996 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %1998 = iree_tensor_ext.bitcast %135 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_955 = tensor.expand_shape %1998 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_956 = tensor.extract_slice %expanded_955[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_957 = tensor.expand_shape %extracted_slice_956 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %1999 = iree_tensor_ext.bitcast %expanded_957 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_958 = tensor.extract_slice %expanded_955[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2000 = iree_tensor_ext.bitcast %extracted_slice_958 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_959 = tensor.collapse_shape %1999 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2001 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_959, %2000 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_960 = tensor.expand_shape %1997 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2002 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_960, %2001 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2003 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2002 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2004 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%1972, %2003 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2005 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2004 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2006 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2005 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2007 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2006 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2008 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2007 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2009 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2008 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2010 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2009 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2011 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2005, %2010 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2012 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2011 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2013 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%136, %2012 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2014 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2013 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2015 = iree_tensor_ext.bitcast %137 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_961 = tensor.expand_shape %2015 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_962 = tensor.extract_slice %expanded_961[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_963 = tensor.expand_shape %extracted_slice_962 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2016 = iree_tensor_ext.bitcast %expanded_963 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_964 = tensor.extract_slice %expanded_961[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2017 = iree_tensor_ext.bitcast %extracted_slice_964 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_965 = tensor.collapse_shape %2016 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2018 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_965, %2017 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_966 = tensor.expand_shape %2014 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2019 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_966, %2018 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2020 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2019 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2021 = iree_tensor_ext.bitcast %138 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_967 = tensor.expand_shape %2021 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_968 = tensor.extract_slice %expanded_967[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_969 = tensor.expand_shape %extracted_slice_968 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2022 = iree_tensor_ext.bitcast %expanded_969 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_970 = tensor.extract_slice %expanded_967[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2023 = iree_tensor_ext.bitcast %extracted_slice_970 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_971 = tensor.collapse_shape %2022 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2024 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_971, %2023 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2025 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_966, %2024 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2026 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2025 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %2027 = iree_tensor_ext.bitcast %139 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_972 = tensor.expand_shape %2027 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_973 = tensor.extract_slice %expanded_972[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_974 = tensor.expand_shape %extracted_slice_973 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2028 = iree_tensor_ext.bitcast %expanded_974 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_975 = tensor.extract_slice %expanded_972[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2029 = iree_tensor_ext.bitcast %extracted_slice_975 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_976 = tensor.collapse_shape %2028 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2030 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_976, %2029 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2031 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_966, %2030 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2032 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2031 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_977 = tensor.expand_shape %2020 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_978 = tensor.expand_shape %2026 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_106 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_106 : tensor<4x4x1x8x1xf32>
    %2033 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_106 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_979 = linalg.unpack %2033 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_980 = tensor.collapse_shape %unpack_979 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2034 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_980 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2035 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2034, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2036 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2035 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2037 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_980 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2038 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2037, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2039 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2038 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_981 = tensor.extract_slice %expanded_977[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_982 = tensor.extract_slice %expanded_977[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %2040 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_981, %2036 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2041 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_982, %2039 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2042 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2040, %2041 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2043 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_982, %2036 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2044 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_981, %2039 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2045 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2043, %2044 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2046 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2042, %2045 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_108 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_108 : tensor<4x4x1x8x1xf32>
    %2047 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_108 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_983 = linalg.unpack %2047 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_984 = tensor.collapse_shape %unpack_983 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2048 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_984 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2049 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2048, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2050 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2049 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2051 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_984 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2052 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2051, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2053 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2052 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_985 = tensor.extract_slice %expanded_978[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_986 = tensor.extract_slice %expanded_978[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %2054 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_985, %2050 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2055 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_986, %2053 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2056 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2054, %2055 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2057 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_986, %2050 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2058 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_985, %2053 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2059 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2057, %2058 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2060 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2056, %2059 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %2061 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %2062 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2061 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2063 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2062 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c15_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2064 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2063 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2065 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2064, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2066 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2065 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2067 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2066, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2068 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2067 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2069 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2068, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_987 = tensor.collapse_shape %2069 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_988 = tensor.collapse_shape %2060 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %2070 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_988, %collapsed_987 : tensor<16x64xf16>, tensor<16xi64>) outs(%1960 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2071 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2064, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2072 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2071 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2073 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2072, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2074 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2073 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2075 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2074, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_989 = tensor.collapse_shape %2075 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_990 = tensor.expand_shape %2032 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_991 = tensor.collapse_shape %expanded_990 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %2076 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_991, %collapsed_989 : tensor<16x64xf16>, tensor<16xi64>) outs(%2070 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_992 = tensor.expand_shape %2076 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_993 = tensor.extract_slice %expanded_992[0, 15, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2077 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_993, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_994 = tensor.extract_slice %expanded_992[0, 15, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2078 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_994, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %2079 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2077 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_995 = tensor.collapse_shape %2079 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_996 = tensor.collapse_shape %2046 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %2080 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2078 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_997 = tensor.collapse_shape %2080 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %2081 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_996, %collapsed_995, %collapsed_997, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_998 = tensor.expand_shape %2081 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_999 = tensor.collapse_shape %expanded_998 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2082 = iree_tensor_ext.bitcast %140 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1000 = tensor.expand_shape %2082 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1001 = tensor.extract_slice %expanded_1000[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1002 = tensor.expand_shape %extracted_slice_1001 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2083 = iree_tensor_ext.bitcast %expanded_1002 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1003 = tensor.extract_slice %expanded_1000[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2084 = iree_tensor_ext.bitcast %extracted_slice_1003 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1004 = tensor.collapse_shape %2083 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2085 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1004, %2084 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1005 = tensor.expand_shape %collapsed_999 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_1006 = tensor.collapse_shape %expanded_1005 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %2086 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_1006, %2085 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2087 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2086 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2088 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2004, %2087 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2089 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2088 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2090 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2089 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2091 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2090 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2092 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2091 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2093 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2092 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2094 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2093 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2095 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2089, %2094 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2096 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2095 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2097 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%141, %2096 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2098 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2097 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2099 = iree_tensor_ext.bitcast %142 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1007 = tensor.expand_shape %2099 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1008 = tensor.extract_slice %expanded_1007[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1009 = tensor.expand_shape %extracted_slice_1008 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2100 = iree_tensor_ext.bitcast %expanded_1009 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1010 = tensor.extract_slice %expanded_1007[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2101 = iree_tensor_ext.bitcast %extracted_slice_1010 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1011 = tensor.collapse_shape %2100 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2102 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1011, %2101 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1012 = tensor.expand_shape %2098 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2103 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1012, %2102 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2104 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2103 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2105 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2104 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %2106 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2105, %2104 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2107 = iree_tensor_ext.bitcast %143 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1013 = tensor.expand_shape %2107 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1014 = tensor.extract_slice %expanded_1013[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1015 = tensor.expand_shape %extracted_slice_1014 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2108 = iree_tensor_ext.bitcast %expanded_1015 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1016 = tensor.extract_slice %expanded_1013[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2109 = iree_tensor_ext.bitcast %extracted_slice_1016 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1017 = tensor.collapse_shape %2108 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2110 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1017, %2109 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %2111 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1012, %2110 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2112 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2111 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2113 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2106, %2112 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2114 = iree_tensor_ext.bitcast %144 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1018 = tensor.expand_shape %2114 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1019 = tensor.extract_slice %expanded_1018[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1020 = tensor.expand_shape %extracted_slice_1019 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2115 = iree_tensor_ext.bitcast %expanded_1020 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1021 = tensor.extract_slice %expanded_1018[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2116 = iree_tensor_ext.bitcast %extracted_slice_1021 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1022 = tensor.collapse_shape %2115 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2117 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1022, %2116 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1023 = tensor.expand_shape %2113 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2118 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1023, %2117 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2119 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2118 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2120 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2088, %2119 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2121 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2120 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2122 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2121 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2123 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2122 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2124 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2123 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2125 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2124 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2126 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2125 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2127 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2121, %2126 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2128 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2127 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2129 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%145, %2128 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2130 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2129 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2131 = iree_tensor_ext.bitcast %146 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1024 = tensor.expand_shape %2131 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1025 = tensor.extract_slice %expanded_1024[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1026 = tensor.expand_shape %extracted_slice_1025 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2132 = iree_tensor_ext.bitcast %expanded_1026 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1027 = tensor.extract_slice %expanded_1024[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2133 = iree_tensor_ext.bitcast %extracted_slice_1027 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1028 = tensor.collapse_shape %2132 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2134 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1028, %2133 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1029 = tensor.expand_shape %2130 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2135 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1029, %2134 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2136 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2135 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2137 = iree_tensor_ext.bitcast %147 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1030 = tensor.expand_shape %2137 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1031 = tensor.extract_slice %expanded_1030[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1032 = tensor.expand_shape %extracted_slice_1031 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2138 = iree_tensor_ext.bitcast %expanded_1032 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1033 = tensor.extract_slice %expanded_1030[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2139 = iree_tensor_ext.bitcast %extracted_slice_1033 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1034 = tensor.collapse_shape %2138 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2140 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1034, %2139 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2141 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1029, %2140 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2142 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2141 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %2143 = iree_tensor_ext.bitcast %148 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1035 = tensor.expand_shape %2143 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1036 = tensor.extract_slice %expanded_1035[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1037 = tensor.expand_shape %extracted_slice_1036 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2144 = iree_tensor_ext.bitcast %expanded_1037 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1038 = tensor.extract_slice %expanded_1035[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2145 = iree_tensor_ext.bitcast %extracted_slice_1038 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1039 = tensor.collapse_shape %2144 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2146 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1039, %2145 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2147 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1029, %2146 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2148 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2147 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_1040 = tensor.expand_shape %2136 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1041 = tensor.expand_shape %2142 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_110 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_110 : tensor<4x4x1x8x1xf32>
    %2149 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_110 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1042 = linalg.unpack %2149 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1043 = tensor.collapse_shape %unpack_1042 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2150 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1043 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2151 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2150, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2152 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2151 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2153 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1043 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2154 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2153, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2155 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2154 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1044 = tensor.extract_slice %expanded_1040[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_1045 = tensor.extract_slice %expanded_1040[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %2156 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1044, %2152 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2157 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1045, %2155 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2158 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2156, %2157 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2159 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1045, %2152 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2160 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1044, %2155 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2161 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2159, %2160 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2162 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2158, %2161 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_112 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_112 : tensor<4x4x1x8x1xf32>
    %2163 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_112 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1046 = linalg.unpack %2163 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1047 = tensor.collapse_shape %unpack_1046 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2164 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1047 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2165 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2164, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2166 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2165 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2167 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1047 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2168 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2167, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2169 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2168 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1048 = tensor.extract_slice %expanded_1041[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_1049 = tensor.extract_slice %expanded_1041[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %2170 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1048, %2166 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2171 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1049, %2169 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2172 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2170, %2171 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2173 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1049, %2166 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2174 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1048, %2169 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2175 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2173, %2174 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2176 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2172, %2175 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %2177 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %2178 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2177 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2179 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2178 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c16_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2180 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2179 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2181 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2180, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2182 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2181 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2183 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2182, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2184 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2183 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2185 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2184, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1050 = tensor.collapse_shape %2185 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_1051 = tensor.collapse_shape %2176 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %2186 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1051, %collapsed_1050 : tensor<16x64xf16>, tensor<16xi64>) outs(%2076 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2187 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2180, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2188 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2187 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2189 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2188, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2190 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2189 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2191 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2190, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1052 = tensor.collapse_shape %2191 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_1053 = tensor.expand_shape %2148 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_1054 = tensor.collapse_shape %expanded_1053 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %2192 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1054, %collapsed_1052 : tensor<16x64xf16>, tensor<16xi64>) outs(%2186 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1055 = tensor.expand_shape %2192 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1056 = tensor.extract_slice %expanded_1055[0, 16, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2193 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1056, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1057 = tensor.extract_slice %expanded_1055[0, 16, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2194 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1057, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %2195 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2193 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_1058 = tensor.collapse_shape %2195 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_1059 = tensor.collapse_shape %2162 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %2196 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2194 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_1060 = tensor.collapse_shape %2196 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %2197 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_1059, %collapsed_1058, %collapsed_1060, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_1061 = tensor.expand_shape %2197 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_1062 = tensor.collapse_shape %expanded_1061 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2198 = iree_tensor_ext.bitcast %149 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1063 = tensor.expand_shape %2198 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1064 = tensor.extract_slice %expanded_1063[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1065 = tensor.expand_shape %extracted_slice_1064 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2199 = iree_tensor_ext.bitcast %expanded_1065 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1066 = tensor.extract_slice %expanded_1063[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2200 = iree_tensor_ext.bitcast %extracted_slice_1066 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1067 = tensor.collapse_shape %2199 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2201 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1067, %2200 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1068 = tensor.expand_shape %collapsed_1062 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_1069 = tensor.collapse_shape %expanded_1068 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %2202 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_1069, %2201 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2203 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2202 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2204 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2120, %2203 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2205 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2204 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2206 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2205 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2207 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2206 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2208 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2207 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2209 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2208 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2210 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2209 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2211 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2205, %2210 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2212 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2211 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2213 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%150, %2212 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2214 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2213 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2215 = iree_tensor_ext.bitcast %151 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1070 = tensor.expand_shape %2215 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1071 = tensor.extract_slice %expanded_1070[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1072 = tensor.expand_shape %extracted_slice_1071 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2216 = iree_tensor_ext.bitcast %expanded_1072 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1073 = tensor.extract_slice %expanded_1070[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2217 = iree_tensor_ext.bitcast %extracted_slice_1073 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1074 = tensor.collapse_shape %2216 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2218 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1074, %2217 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1075 = tensor.expand_shape %2214 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2219 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1075, %2218 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2220 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2219 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2221 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2220 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %2222 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2221, %2220 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2223 = iree_tensor_ext.bitcast %152 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1076 = tensor.expand_shape %2223 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1077 = tensor.extract_slice %expanded_1076[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1078 = tensor.expand_shape %extracted_slice_1077 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2224 = iree_tensor_ext.bitcast %expanded_1078 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1079 = tensor.extract_slice %expanded_1076[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2225 = iree_tensor_ext.bitcast %extracted_slice_1079 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1080 = tensor.collapse_shape %2224 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2226 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1080, %2225 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %2227 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1075, %2226 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2228 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2227 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2229 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2222, %2228 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2230 = iree_tensor_ext.bitcast %153 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1081 = tensor.expand_shape %2230 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1082 = tensor.extract_slice %expanded_1081[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1083 = tensor.expand_shape %extracted_slice_1082 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2231 = iree_tensor_ext.bitcast %expanded_1083 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1084 = tensor.extract_slice %expanded_1081[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2232 = iree_tensor_ext.bitcast %extracted_slice_1084 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1085 = tensor.collapse_shape %2231 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2233 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1085, %2232 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1086 = tensor.expand_shape %2229 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2234 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1086, %2233 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2235 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2234 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2236 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2204, %2235 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2237 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2236 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2238 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2237 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2239 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2238 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2240 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2239 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2241 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2240 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2242 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2241 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2243 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2237, %2242 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2244 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2243 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2245 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%154, %2244 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2246 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2245 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2247 = iree_tensor_ext.bitcast %155 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1087 = tensor.expand_shape %2247 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1088 = tensor.extract_slice %expanded_1087[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1089 = tensor.expand_shape %extracted_slice_1088 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2248 = iree_tensor_ext.bitcast %expanded_1089 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1090 = tensor.extract_slice %expanded_1087[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2249 = iree_tensor_ext.bitcast %extracted_slice_1090 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1091 = tensor.collapse_shape %2248 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2250 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1091, %2249 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1092 = tensor.expand_shape %2246 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2251 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1092, %2250 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2252 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2251 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2253 = iree_tensor_ext.bitcast %156 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1093 = tensor.expand_shape %2253 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1094 = tensor.extract_slice %expanded_1093[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1095 = tensor.expand_shape %extracted_slice_1094 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2254 = iree_tensor_ext.bitcast %expanded_1095 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1096 = tensor.extract_slice %expanded_1093[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2255 = iree_tensor_ext.bitcast %extracted_slice_1096 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1097 = tensor.collapse_shape %2254 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2256 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1097, %2255 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2257 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1092, %2256 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2258 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2257 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %2259 = iree_tensor_ext.bitcast %157 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1098 = tensor.expand_shape %2259 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1099 = tensor.extract_slice %expanded_1098[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1100 = tensor.expand_shape %extracted_slice_1099 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2260 = iree_tensor_ext.bitcast %expanded_1100 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1101 = tensor.extract_slice %expanded_1098[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2261 = iree_tensor_ext.bitcast %extracted_slice_1101 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1102 = tensor.collapse_shape %2260 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2262 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1102, %2261 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2263 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1092, %2262 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2264 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2263 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_1103 = tensor.expand_shape %2252 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1104 = tensor.expand_shape %2258 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_114 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_114 : tensor<4x4x1x8x1xf32>
    %2265 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_114 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1105 = linalg.unpack %2265 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1106 = tensor.collapse_shape %unpack_1105 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2266 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1106 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2267 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2266, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2268 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2267 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2269 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1106 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2270 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2269, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2271 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2270 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1107 = tensor.extract_slice %expanded_1103[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_1108 = tensor.extract_slice %expanded_1103[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %2272 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1107, %2268 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2273 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1108, %2271 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2274 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2272, %2273 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2275 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1108, %2268 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2276 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1107, %2271 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2277 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2275, %2276 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2278 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2274, %2277 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_116 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_116 : tensor<4x4x1x8x1xf32>
    %2279 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_116 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1109 = linalg.unpack %2279 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1110 = tensor.collapse_shape %unpack_1109 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2280 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1110 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2281 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2280, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2282 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2281 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2283 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1110 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2284 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2283, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2285 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2284 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1111 = tensor.extract_slice %expanded_1104[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_1112 = tensor.extract_slice %expanded_1104[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %2286 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1111, %2282 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2287 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1112, %2285 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2288 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2286, %2287 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2289 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1112, %2282 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2290 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1111, %2285 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2291 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2289, %2290 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2292 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2288, %2291 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %2293 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %2294 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2293 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2295 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2294 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c17_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2296 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2295 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2297 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2296, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2298 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2297 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2299 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2298, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2300 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2299 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2301 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2300, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1113 = tensor.collapse_shape %2301 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_1114 = tensor.collapse_shape %2292 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %2302 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1114, %collapsed_1113 : tensor<16x64xf16>, tensor<16xi64>) outs(%2192 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2303 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2296, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2304 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2303 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2305 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2304, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2306 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2305 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2307 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2306, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1115 = tensor.collapse_shape %2307 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_1116 = tensor.expand_shape %2264 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_1117 = tensor.collapse_shape %expanded_1116 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %2308 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1117, %collapsed_1115 : tensor<16x64xf16>, tensor<16xi64>) outs(%2302 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1118 = tensor.expand_shape %2308 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1119 = tensor.extract_slice %expanded_1118[0, 17, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2309 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1119, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1120 = tensor.extract_slice %expanded_1118[0, 17, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2310 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1120, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %2311 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2309 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_1121 = tensor.collapse_shape %2311 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_1122 = tensor.collapse_shape %2278 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %2312 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2310 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_1123 = tensor.collapse_shape %2312 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %2313 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_1122, %collapsed_1121, %collapsed_1123, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_1124 = tensor.expand_shape %2313 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_1125 = tensor.collapse_shape %expanded_1124 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2314 = iree_tensor_ext.bitcast %158 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1126 = tensor.expand_shape %2314 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1127 = tensor.extract_slice %expanded_1126[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1128 = tensor.expand_shape %extracted_slice_1127 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2315 = iree_tensor_ext.bitcast %expanded_1128 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1129 = tensor.extract_slice %expanded_1126[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2316 = iree_tensor_ext.bitcast %extracted_slice_1129 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1130 = tensor.collapse_shape %2315 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2317 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1130, %2316 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1131 = tensor.expand_shape %collapsed_1125 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_1132 = tensor.collapse_shape %expanded_1131 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %2318 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_1132, %2317 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2319 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2318 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2320 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2236, %2319 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2321 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2320 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2322 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2321 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2323 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2322 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2324 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2323 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2325 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2324 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2326 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2325 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2327 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2321, %2326 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2328 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2327 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2329 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%159, %2328 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2330 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2329 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2331 = iree_tensor_ext.bitcast %160 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1133 = tensor.expand_shape %2331 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1134 = tensor.extract_slice %expanded_1133[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1135 = tensor.expand_shape %extracted_slice_1134 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2332 = iree_tensor_ext.bitcast %expanded_1135 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1136 = tensor.extract_slice %expanded_1133[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2333 = iree_tensor_ext.bitcast %extracted_slice_1136 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1137 = tensor.collapse_shape %2332 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2334 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1137, %2333 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1138 = tensor.expand_shape %2330 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2335 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1138, %2334 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2336 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2335 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2337 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2336 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %2338 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2337, %2336 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2339 = iree_tensor_ext.bitcast %161 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1139 = tensor.expand_shape %2339 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1140 = tensor.extract_slice %expanded_1139[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1141 = tensor.expand_shape %extracted_slice_1140 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2340 = iree_tensor_ext.bitcast %expanded_1141 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1142 = tensor.extract_slice %expanded_1139[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2341 = iree_tensor_ext.bitcast %extracted_slice_1142 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1143 = tensor.collapse_shape %2340 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2342 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1143, %2341 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %2343 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1138, %2342 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2344 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2343 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2345 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2338, %2344 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2346 = iree_tensor_ext.bitcast %162 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1144 = tensor.expand_shape %2346 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1145 = tensor.extract_slice %expanded_1144[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1146 = tensor.expand_shape %extracted_slice_1145 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2347 = iree_tensor_ext.bitcast %expanded_1146 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1147 = tensor.extract_slice %expanded_1144[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2348 = iree_tensor_ext.bitcast %extracted_slice_1147 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1148 = tensor.collapse_shape %2347 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2349 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1148, %2348 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1149 = tensor.expand_shape %2345 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2350 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1149, %2349 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2351 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2350 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2352 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2320, %2351 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2353 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2352 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2354 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2353 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2355 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2354 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2356 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2355 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2357 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2356 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2358 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2357 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2359 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2353, %2358 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2360 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2359 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2361 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%163, %2360 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2362 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2361 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2363 = iree_tensor_ext.bitcast %164 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1150 = tensor.expand_shape %2363 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1151 = tensor.extract_slice %expanded_1150[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1152 = tensor.expand_shape %extracted_slice_1151 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2364 = iree_tensor_ext.bitcast %expanded_1152 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1153 = tensor.extract_slice %expanded_1150[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2365 = iree_tensor_ext.bitcast %extracted_slice_1153 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1154 = tensor.collapse_shape %2364 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2366 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1154, %2365 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1155 = tensor.expand_shape %2362 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2367 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1155, %2366 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2368 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2367 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2369 = iree_tensor_ext.bitcast %165 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1156 = tensor.expand_shape %2369 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1157 = tensor.extract_slice %expanded_1156[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1158 = tensor.expand_shape %extracted_slice_1157 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2370 = iree_tensor_ext.bitcast %expanded_1158 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1159 = tensor.extract_slice %expanded_1156[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2371 = iree_tensor_ext.bitcast %extracted_slice_1159 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1160 = tensor.collapse_shape %2370 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2372 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1160, %2371 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2373 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1155, %2372 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2374 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2373 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %2375 = iree_tensor_ext.bitcast %166 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1161 = tensor.expand_shape %2375 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1162 = tensor.extract_slice %expanded_1161[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1163 = tensor.expand_shape %extracted_slice_1162 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2376 = iree_tensor_ext.bitcast %expanded_1163 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1164 = tensor.extract_slice %expanded_1161[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2377 = iree_tensor_ext.bitcast %extracted_slice_1164 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1165 = tensor.collapse_shape %2376 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2378 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1165, %2377 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2379 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1155, %2378 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2380 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2379 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_1166 = tensor.expand_shape %2368 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1167 = tensor.expand_shape %2374 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_118 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_118 : tensor<4x4x1x8x1xf32>
    %2381 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_118 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1168 = linalg.unpack %2381 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1169 = tensor.collapse_shape %unpack_1168 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2382 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1169 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2383 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2382, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2384 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2383 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2385 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1169 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2386 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2385, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2387 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2386 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1170 = tensor.extract_slice %expanded_1166[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_1171 = tensor.extract_slice %expanded_1166[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %2388 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1170, %2384 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2389 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1171, %2387 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2390 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2388, %2389 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2391 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1171, %2384 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2392 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1170, %2387 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2393 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2391, %2392 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2394 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2390, %2393 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_120 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_120 : tensor<4x4x1x8x1xf32>
    %2395 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_120 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1172 = linalg.unpack %2395 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1173 = tensor.collapse_shape %unpack_1172 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2396 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1173 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2397 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2396, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2398 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2397 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2399 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1173 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2400 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2399, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2401 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2400 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1174 = tensor.extract_slice %expanded_1167[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_1175 = tensor.extract_slice %expanded_1167[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %2402 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1174, %2398 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2403 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1175, %2401 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2404 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2402, %2403 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2405 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1175, %2398 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2406 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1174, %2401 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2407 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2405, %2406 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2408 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2404, %2407 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %2409 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %2410 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2409 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2411 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2410 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c18_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2412 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2411 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2413 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2412, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2414 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2413 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2415 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2414, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2416 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2415 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2417 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2416, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1176 = tensor.collapse_shape %2417 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_1177 = tensor.collapse_shape %2408 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %2418 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1177, %collapsed_1176 : tensor<16x64xf16>, tensor<16xi64>) outs(%2308 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2419 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2412, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2420 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2419 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2421 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2420, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2422 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2421 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2423 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2422, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1178 = tensor.collapse_shape %2423 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_1179 = tensor.expand_shape %2380 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_1180 = tensor.collapse_shape %expanded_1179 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %2424 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1180, %collapsed_1178 : tensor<16x64xf16>, tensor<16xi64>) outs(%2418 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1181 = tensor.expand_shape %2424 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1182 = tensor.extract_slice %expanded_1181[0, 18, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2425 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1182, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1183 = tensor.extract_slice %expanded_1181[0, 18, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2426 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1183, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %2427 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2425 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_1184 = tensor.collapse_shape %2427 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_1185 = tensor.collapse_shape %2394 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %2428 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2426 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_1186 = tensor.collapse_shape %2428 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %2429 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_1185, %collapsed_1184, %collapsed_1186, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_1187 = tensor.expand_shape %2429 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_1188 = tensor.collapse_shape %expanded_1187 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2430 = iree_tensor_ext.bitcast %167 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1189 = tensor.expand_shape %2430 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1190 = tensor.extract_slice %expanded_1189[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1191 = tensor.expand_shape %extracted_slice_1190 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2431 = iree_tensor_ext.bitcast %expanded_1191 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1192 = tensor.extract_slice %expanded_1189[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2432 = iree_tensor_ext.bitcast %extracted_slice_1192 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1193 = tensor.collapse_shape %2431 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2433 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1193, %2432 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1194 = tensor.expand_shape %collapsed_1188 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_1195 = tensor.collapse_shape %expanded_1194 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %2434 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_1195, %2433 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2435 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2434 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2436 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2352, %2435 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2437 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2436 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2438 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2437 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2439 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2438 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2440 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2439 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2441 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2440 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2442 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2441 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2443 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2437, %2442 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2444 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2443 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2445 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%168, %2444 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2446 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2445 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2447 = iree_tensor_ext.bitcast %169 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1196 = tensor.expand_shape %2447 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1197 = tensor.extract_slice %expanded_1196[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1198 = tensor.expand_shape %extracted_slice_1197 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2448 = iree_tensor_ext.bitcast %expanded_1198 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1199 = tensor.extract_slice %expanded_1196[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2449 = iree_tensor_ext.bitcast %extracted_slice_1199 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1200 = tensor.collapse_shape %2448 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2450 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1200, %2449 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1201 = tensor.expand_shape %2446 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2451 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1201, %2450 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2452 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2451 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2453 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2452 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %2454 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2453, %2452 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2455 = iree_tensor_ext.bitcast %170 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1202 = tensor.expand_shape %2455 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1203 = tensor.extract_slice %expanded_1202[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1204 = tensor.expand_shape %extracted_slice_1203 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2456 = iree_tensor_ext.bitcast %expanded_1204 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1205 = tensor.extract_slice %expanded_1202[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2457 = iree_tensor_ext.bitcast %extracted_slice_1205 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1206 = tensor.collapse_shape %2456 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2458 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1206, %2457 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %2459 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1201, %2458 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2460 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2459 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2461 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2454, %2460 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2462 = iree_tensor_ext.bitcast %171 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1207 = tensor.expand_shape %2462 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1208 = tensor.extract_slice %expanded_1207[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1209 = tensor.expand_shape %extracted_slice_1208 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2463 = iree_tensor_ext.bitcast %expanded_1209 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1210 = tensor.extract_slice %expanded_1207[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2464 = iree_tensor_ext.bitcast %extracted_slice_1210 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1211 = tensor.collapse_shape %2463 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2465 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1211, %2464 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1212 = tensor.expand_shape %2461 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2466 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1212, %2465 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2467 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2466 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2468 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2436, %2467 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2469 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2468 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2470 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2469 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2471 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2470 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2472 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2471 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2473 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2472 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2474 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2473 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2475 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2469, %2474 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2476 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2475 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2477 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%172, %2476 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2478 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2477 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2479 = iree_tensor_ext.bitcast %173 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1213 = tensor.expand_shape %2479 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1214 = tensor.extract_slice %expanded_1213[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1215 = tensor.expand_shape %extracted_slice_1214 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2480 = iree_tensor_ext.bitcast %expanded_1215 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1216 = tensor.extract_slice %expanded_1213[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2481 = iree_tensor_ext.bitcast %extracted_slice_1216 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1217 = tensor.collapse_shape %2480 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2482 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1217, %2481 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1218 = tensor.expand_shape %2478 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2483 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1218, %2482 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2484 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2483 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2485 = iree_tensor_ext.bitcast %174 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1219 = tensor.expand_shape %2485 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1220 = tensor.extract_slice %expanded_1219[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1221 = tensor.expand_shape %extracted_slice_1220 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2486 = iree_tensor_ext.bitcast %expanded_1221 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1222 = tensor.extract_slice %expanded_1219[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2487 = iree_tensor_ext.bitcast %extracted_slice_1222 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1223 = tensor.collapse_shape %2486 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2488 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1223, %2487 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2489 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1218, %2488 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2490 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2489 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %2491 = iree_tensor_ext.bitcast %175 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1224 = tensor.expand_shape %2491 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1225 = tensor.extract_slice %expanded_1224[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1226 = tensor.expand_shape %extracted_slice_1225 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2492 = iree_tensor_ext.bitcast %expanded_1226 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1227 = tensor.extract_slice %expanded_1224[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2493 = iree_tensor_ext.bitcast %extracted_slice_1227 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1228 = tensor.collapse_shape %2492 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2494 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1228, %2493 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2495 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1218, %2494 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2496 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2495 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_1229 = tensor.expand_shape %2484 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1230 = tensor.expand_shape %2490 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_122 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_122 : tensor<4x4x1x8x1xf32>
    %2497 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_122 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1231 = linalg.unpack %2497 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1232 = tensor.collapse_shape %unpack_1231 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2498 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1232 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2499 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2498, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2500 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2499 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2501 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1232 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2502 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2501, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2503 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2502 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1233 = tensor.extract_slice %expanded_1229[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_1234 = tensor.extract_slice %expanded_1229[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %2504 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1233, %2500 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2505 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1234, %2503 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2506 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2504, %2505 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2507 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1234, %2500 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2508 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1233, %2503 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2509 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2507, %2508 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2510 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2506, %2509 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_124 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_124 : tensor<4x4x1x8x1xf32>
    %2511 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_124 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1235 = linalg.unpack %2511 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1236 = tensor.collapse_shape %unpack_1235 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2512 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1236 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2513 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2512, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2514 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2513 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2515 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1236 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2516 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2515, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2517 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2516 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1237 = tensor.extract_slice %expanded_1230[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_1238 = tensor.extract_slice %expanded_1230[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %2518 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1237, %2514 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2519 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1238, %2517 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2520 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2518, %2519 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2521 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1238, %2514 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2522 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1237, %2517 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2523 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2521, %2522 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2524 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2520, %2523 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %2525 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %2526 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2525 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2527 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2526 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c19_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2528 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2527 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2529 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2528, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2530 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2529 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2531 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2530, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2532 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2531 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2533 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2532, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1239 = tensor.collapse_shape %2533 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_1240 = tensor.collapse_shape %2524 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %2534 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1240, %collapsed_1239 : tensor<16x64xf16>, tensor<16xi64>) outs(%2424 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2535 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2528, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2536 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2535 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2537 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2536, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2538 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2537 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2539 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2538, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1241 = tensor.collapse_shape %2539 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_1242 = tensor.expand_shape %2496 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_1243 = tensor.collapse_shape %expanded_1242 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %2540 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1243, %collapsed_1241 : tensor<16x64xf16>, tensor<16xi64>) outs(%2534 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1244 = tensor.expand_shape %2540 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1245 = tensor.extract_slice %expanded_1244[0, 19, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2541 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1245, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1246 = tensor.extract_slice %expanded_1244[0, 19, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2542 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1246, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %2543 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2541 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_1247 = tensor.collapse_shape %2543 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_1248 = tensor.collapse_shape %2510 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %2544 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2542 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_1249 = tensor.collapse_shape %2544 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %2545 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_1248, %collapsed_1247, %collapsed_1249, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_1250 = tensor.expand_shape %2545 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_1251 = tensor.collapse_shape %expanded_1250 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2546 = iree_tensor_ext.bitcast %176 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1252 = tensor.expand_shape %2546 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1253 = tensor.extract_slice %expanded_1252[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1254 = tensor.expand_shape %extracted_slice_1253 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2547 = iree_tensor_ext.bitcast %expanded_1254 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1255 = tensor.extract_slice %expanded_1252[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2548 = iree_tensor_ext.bitcast %extracted_slice_1255 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1256 = tensor.collapse_shape %2547 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2549 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1256, %2548 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1257 = tensor.expand_shape %collapsed_1251 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_1258 = tensor.collapse_shape %expanded_1257 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %2550 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_1258, %2549 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2551 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2550 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2552 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2468, %2551 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2553 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2552 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2554 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2553 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2555 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2554 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2556 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2555 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2557 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2556 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2558 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2557 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2559 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2553, %2558 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2560 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2559 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2561 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%177, %2560 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2562 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2561 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2563 = iree_tensor_ext.bitcast %178 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1259 = tensor.expand_shape %2563 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1260 = tensor.extract_slice %expanded_1259[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1261 = tensor.expand_shape %extracted_slice_1260 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2564 = iree_tensor_ext.bitcast %expanded_1261 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1262 = tensor.extract_slice %expanded_1259[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2565 = iree_tensor_ext.bitcast %extracted_slice_1262 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1263 = tensor.collapse_shape %2564 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2566 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1263, %2565 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1264 = tensor.expand_shape %2562 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2567 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1264, %2566 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2568 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2567 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2569 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2568 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %2570 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2569, %2568 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2571 = iree_tensor_ext.bitcast %179 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1265 = tensor.expand_shape %2571 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1266 = tensor.extract_slice %expanded_1265[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1267 = tensor.expand_shape %extracted_slice_1266 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2572 = iree_tensor_ext.bitcast %expanded_1267 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1268 = tensor.extract_slice %expanded_1265[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2573 = iree_tensor_ext.bitcast %extracted_slice_1268 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1269 = tensor.collapse_shape %2572 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2574 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1269, %2573 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %2575 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1264, %2574 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2576 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2575 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2577 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2570, %2576 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2578 = iree_tensor_ext.bitcast %180 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1270 = tensor.expand_shape %2578 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1271 = tensor.extract_slice %expanded_1270[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1272 = tensor.expand_shape %extracted_slice_1271 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2579 = iree_tensor_ext.bitcast %expanded_1272 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1273 = tensor.extract_slice %expanded_1270[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2580 = iree_tensor_ext.bitcast %extracted_slice_1273 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1274 = tensor.collapse_shape %2579 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2581 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1274, %2580 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1275 = tensor.expand_shape %2577 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2582 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1275, %2581 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2583 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2582 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2584 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2552, %2583 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2585 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2584 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2586 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2585 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2587 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2586 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2588 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2587 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2589 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2588 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2590 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2589 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2591 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2585, %2590 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2592 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2591 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2593 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%181, %2592 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2594 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2593 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2595 = iree_tensor_ext.bitcast %182 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1276 = tensor.expand_shape %2595 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1277 = tensor.extract_slice %expanded_1276[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1278 = tensor.expand_shape %extracted_slice_1277 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2596 = iree_tensor_ext.bitcast %expanded_1278 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1279 = tensor.extract_slice %expanded_1276[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2597 = iree_tensor_ext.bitcast %extracted_slice_1279 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1280 = tensor.collapse_shape %2596 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2598 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1280, %2597 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1281 = tensor.expand_shape %2594 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2599 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1281, %2598 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2600 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2599 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2601 = iree_tensor_ext.bitcast %183 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1282 = tensor.expand_shape %2601 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1283 = tensor.extract_slice %expanded_1282[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1284 = tensor.expand_shape %extracted_slice_1283 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2602 = iree_tensor_ext.bitcast %expanded_1284 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1285 = tensor.extract_slice %expanded_1282[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2603 = iree_tensor_ext.bitcast %extracted_slice_1285 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1286 = tensor.collapse_shape %2602 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2604 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1286, %2603 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2605 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1281, %2604 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2606 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2605 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %2607 = iree_tensor_ext.bitcast %184 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1287 = tensor.expand_shape %2607 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1288 = tensor.extract_slice %expanded_1287[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1289 = tensor.expand_shape %extracted_slice_1288 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2608 = iree_tensor_ext.bitcast %expanded_1289 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1290 = tensor.extract_slice %expanded_1287[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2609 = iree_tensor_ext.bitcast %extracted_slice_1290 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1291 = tensor.collapse_shape %2608 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2610 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1291, %2609 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2611 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1281, %2610 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2612 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2611 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_1292 = tensor.expand_shape %2600 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1293 = tensor.expand_shape %2606 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_126 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_126 : tensor<4x4x1x8x1xf32>
    %2613 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_126 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1294 = linalg.unpack %2613 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1295 = tensor.collapse_shape %unpack_1294 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2614 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1295 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2615 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2614, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2616 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2615 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2617 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1295 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2618 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2617, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2619 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2618 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1296 = tensor.extract_slice %expanded_1292[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_1297 = tensor.extract_slice %expanded_1292[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %2620 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1296, %2616 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2621 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1297, %2619 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2622 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2620, %2621 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2623 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1297, %2616 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2624 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1296, %2619 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2625 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2623, %2624 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2626 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2622, %2625 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_128 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_128 : tensor<4x4x1x8x1xf32>
    %2627 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_128 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1298 = linalg.unpack %2627 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1299 = tensor.collapse_shape %unpack_1298 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2628 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1299 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2629 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2628, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2630 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2629 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2631 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1299 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2632 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2631, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2633 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2632 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1300 = tensor.extract_slice %expanded_1293[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_1301 = tensor.extract_slice %expanded_1293[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %2634 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1300, %2630 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2635 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1301, %2633 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2636 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2634, %2635 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2637 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1301, %2630 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2638 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1300, %2633 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2639 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2637, %2638 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2640 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2636, %2639 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %2641 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %2642 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2641 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2643 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2642 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c20_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2644 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2643 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2645 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2644, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2646 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2645 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2647 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2646, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2648 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2647 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2649 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2648, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1302 = tensor.collapse_shape %2649 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_1303 = tensor.collapse_shape %2640 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %2650 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1303, %collapsed_1302 : tensor<16x64xf16>, tensor<16xi64>) outs(%2540 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2651 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2644, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2652 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2651 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2653 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2652, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2654 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2653 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2655 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2654, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1304 = tensor.collapse_shape %2655 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_1305 = tensor.expand_shape %2612 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_1306 = tensor.collapse_shape %expanded_1305 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %2656 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1306, %collapsed_1304 : tensor<16x64xf16>, tensor<16xi64>) outs(%2650 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1307 = tensor.expand_shape %2656 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %extracted_slice_1308 = tensor.extract_slice %expanded_1307[0, 20, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2657 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1308, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1309 = tensor.extract_slice %expanded_1307[0, 20, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2658 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1309, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %2659 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2657 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_1310 = tensor.collapse_shape %2659 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_1311 = tensor.collapse_shape %2626 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %2660 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2658 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_1312 = tensor.collapse_shape %2660 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %2661 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_1311, %collapsed_1310, %collapsed_1312, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_1313 = tensor.expand_shape %2661 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_1314 = tensor.collapse_shape %expanded_1313 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2662 = iree_tensor_ext.bitcast %185 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1315 = tensor.expand_shape %2662 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1316 = tensor.extract_slice %expanded_1315[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1317 = tensor.expand_shape %extracted_slice_1316 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2663 = iree_tensor_ext.bitcast %expanded_1317 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1318 = tensor.extract_slice %expanded_1315[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2664 = iree_tensor_ext.bitcast %extracted_slice_1318 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1319 = tensor.collapse_shape %2663 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2665 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1319, %2664 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1320 = tensor.expand_shape %collapsed_1314 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_1321 = tensor.collapse_shape %expanded_1320 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %2666 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_1321, %2665 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2667 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2666 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2668 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2584, %2667 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2669 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2668 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2670 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2669 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2671 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2670 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2672 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2671 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2673 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2672 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2674 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2673 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2675 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2669, %2674 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2676 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2675 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2677 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%186, %2676 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2678 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2677 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2679 = iree_tensor_ext.bitcast %187 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1322 = tensor.expand_shape %2679 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1323 = tensor.extract_slice %expanded_1322[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1324 = tensor.expand_shape %extracted_slice_1323 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2680 = iree_tensor_ext.bitcast %expanded_1324 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1325 = tensor.extract_slice %expanded_1322[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2681 = iree_tensor_ext.bitcast %extracted_slice_1325 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1326 = tensor.collapse_shape %2680 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2682 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1326, %2681 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1327 = tensor.expand_shape %2678 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2683 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1327, %2682 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2684 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2683 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2685 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2684 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %2686 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2685, %2684 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2687 = iree_tensor_ext.bitcast %188 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1328 = tensor.expand_shape %2687 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1329 = tensor.extract_slice %expanded_1328[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1330 = tensor.expand_shape %extracted_slice_1329 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2688 = iree_tensor_ext.bitcast %expanded_1330 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1331 = tensor.extract_slice %expanded_1328[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2689 = iree_tensor_ext.bitcast %extracted_slice_1331 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1332 = tensor.collapse_shape %2688 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2690 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1332, %2689 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %2691 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1327, %2690 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2692 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2691 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2693 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2686, %2692 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2694 = iree_tensor_ext.bitcast %189 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1333 = tensor.expand_shape %2694 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1334 = tensor.extract_slice %expanded_1333[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1335 = tensor.expand_shape %extracted_slice_1334 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2695 = iree_tensor_ext.bitcast %expanded_1335 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1336 = tensor.extract_slice %expanded_1333[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2696 = iree_tensor_ext.bitcast %extracted_slice_1336 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1337 = tensor.collapse_shape %2695 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2697 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1337, %2696 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1338 = tensor.expand_shape %2693 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2698 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1338, %2697 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2699 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2698 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2700 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2668, %2699 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2701 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2700 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2702 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2701 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2703 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2702 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2704 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2703 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2705 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2704 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2706 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2705 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2707 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2701, %2706 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2708 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2707 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2709 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%190, %2708 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2710 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2709 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2711 = iree_tensor_ext.bitcast %191 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1339 = tensor.expand_shape %2711 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1340 = tensor.extract_slice %expanded_1339[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1341 = tensor.expand_shape %extracted_slice_1340 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2712 = iree_tensor_ext.bitcast %expanded_1341 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1342 = tensor.extract_slice %expanded_1339[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2713 = iree_tensor_ext.bitcast %extracted_slice_1342 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1343 = tensor.collapse_shape %2712 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2714 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1343, %2713 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1344 = tensor.expand_shape %2710 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2715 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1344, %2714 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2716 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2715 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2717 = iree_tensor_ext.bitcast %192 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1345 = tensor.expand_shape %2717 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1346 = tensor.extract_slice %expanded_1345[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1347 = tensor.expand_shape %extracted_slice_1346 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2718 = iree_tensor_ext.bitcast %expanded_1347 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1348 = tensor.extract_slice %expanded_1345[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2719 = iree_tensor_ext.bitcast %extracted_slice_1348 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1349 = tensor.collapse_shape %2718 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2720 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1349, %2719 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2721 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1344, %2720 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2722 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2721 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %2723 = iree_tensor_ext.bitcast %193 : tensor<256x2176xi8> -> tensor<256x1088xi16>
    %expanded_1350 = tensor.expand_shape %2723 [[0], [1, 2]] output_shape [256, 64, 17] : tensor<256x1088xi16> into tensor<256x64x17xi16>
    %extracted_slice_1351 = tensor.extract_slice %expanded_1350[0, 0, 0] [256, 64, 1] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64xi16>
    %expanded_1352 = tensor.expand_shape %extracted_slice_1351 [[0], [1, 2]] output_shape [256, 64, 1] : tensor<256x64xi16> into tensor<256x64x1xi16>
    %2724 = iree_tensor_ext.bitcast %expanded_1352 : tensor<256x64x1xi16> -> tensor<256x64x1xf16>
    %extracted_slice_1353 = tensor.extract_slice %expanded_1350[0, 0, 1] [256, 64, 16] [1, 1, 1] : tensor<256x64x17xi16> to tensor<256x64x16xi16>
    %2725 = iree_tensor_ext.bitcast %extracted_slice_1353 : tensor<256x64x16xi16> -> tensor<256x64x32xi8>
    %collapsed_1354 = tensor.collapse_shape %2724 [[0], [1, 2]] : tensor<256x64x1xf16> into tensor<256x64xf16>
    %2726 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1354, %2725 : tensor<256x64xf16>, tensor<256x64x32xi8>) outs(%244 : tensor<256x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<256x64x32xf16>
    %2727 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1344, %2726 : tensor<4x64x32xf16>, tensor<256x64x32xf16>) outs(%247 : tensor<4x256xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x256xf32>
    %2728 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2727 : tensor<4x256xf32>) outs(%249 : tensor<4x256xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x256xf16>
    %expanded_1355 = tensor.expand_shape %2716 [[0, 1], [2, 3]] output_shape [4, 1, 32, 64] : tensor<4x2048xf16> into tensor<4x1x32x64xf16>
    %expanded_1356 = tensor.expand_shape %2722 [[0, 1], [2, 3]] output_shape [4, 1, 4, 64] : tensor<4x256xf16> into tensor<4x1x4x64xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_130 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_130 : tensor<4x4x1x8x1xf32>
    %2729 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_130 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1357 = linalg.unpack %2729 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1358 = tensor.collapse_shape %unpack_1357 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2730 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1358 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2731 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2730, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2732 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2731 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2733 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1358 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2734 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2733, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2735 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2734 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1359 = tensor.extract_slice %expanded_1355[0, 0, 0, 0] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %extracted_slice_1360 = tensor.extract_slice %expanded_1355[0, 0, 0, 1] [4, 1, 32, 32] [1, 1, 1, 2] : tensor<4x1x32x64xf16> to tensor<4x32x32xf16>
    %2736 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1359, %2732 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2737 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1360, %2735 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2738 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2736, %2737 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2739 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1360, %2732 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2740 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1359, %2735 : tensor<4x32x32xf16>, tensor<4x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2741 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2739, %2740 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%274 : tensor<4x32x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x32x32xf16>
    %2742 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2738, %2741 : tensor<4x32x32xf16>, tensor<4x32x32xf16>) outs(%281 : tensor<4x32x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x32x2x32xf16>
    %__hoisted_tensor_4x4x1x8x1xf32_132 = util.global.load immutable @__hoisted_tensor_4x4x1x8x1xf32_132 : tensor<4x4x1x8x1xf32>
    %2743 = linalg.batch_mmt4d ins(%expanded_31, %__hoisted_tensor_4x4x1x8x1xf32_132 : tensor<4x1x1x1x1xf32>, tensor<4x4x1x8x1xf32>) outs(%264 : tensor<4x1x4x1x8xf32>) -> tensor<4x1x4x1x8xf32>
    %unpack_1361 = linalg.unpack %2743 outer_dims_perm = [0, 2, 1] inner_dims_pos = [2, 1] inner_tiles = [1, 8] into %266 : tensor<4x1x4x1x8xf32> -> tensor<4x32x1xf32>
    %collapsed_1362 = tensor.collapse_shape %unpack_1361 [[0], [1, 2]] : tensor<4x32x1xf32> into tensor<4x32xf32>
    %2744 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1362 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.cos %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2745 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2744, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2746 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2745 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %2747 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%collapsed_1362 : tensor<4x32xf32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.sin %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2748 = linalg.generic {indexing_maps = [#map2, #map8, #map2], iterator_types = ["parallel", "parallel"]} ins(%2747, %cst_4 : tensor<4x32xf32>, tensor<f32>) outs(%261 : tensor<4x32xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x32xf32>
    %2749 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2748 : tensor<4x32xf32>) outs(%269 : tensor<4x32xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32xf16>
    %extracted_slice_1363 = tensor.extract_slice %expanded_1356[0, 0, 0, 0] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %extracted_slice_1364 = tensor.extract_slice %expanded_1356[0, 0, 0, 1] [4, 1, 4, 32] [1, 1, 1, 2] : tensor<4x1x4x64xf16> to tensor<4x4x32xf16>
    %2750 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1363, %2746 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2751 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1364, %2749 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2752 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2750, %2751 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.subf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2753 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1364, %2746 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2754 = linalg.generic {indexing_maps = [#map, #map17, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%extracted_slice_1363, %2749 : tensor<4x4x32xf16>, tensor<4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2755 = linalg.generic {indexing_maps = [#map, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%2753, %2754 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%290 : tensor<4x4x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x4x32xf16>
    %2756 = linalg.generic {indexing_maps = [#map32, #map32, #map9], iterator_types = ["parallel", "parallel", "parallel", "parallel"]} ins(%2752, %2755 : tensor<4x4x32xf16>, tensor<4x4x32xf16>) outs(%297 : tensor<4x4x2x32xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = linalg.index 2 : index
      %2840 = arith.cmpi eq, %2839, %c0 : index
      %2841 = arith.select %2840, %in, %in_1410 : f16
      linalg.yield %2841 : f16
    } -> tensor<4x4x2x32xf16>
    %2757 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%299 : tensor<4xi64>) outs(%300 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = linalg.index 0 : index
      %2840 = arith.index_cast %in : i64 to index
      %2841 = arith.cmpi slt, %2840, %208 : index
      cf.assert %2841, "index must be smaller than dim size"
      %2842 = arith.cmpi sge, %in, %c0_i64 : i64
      cf.assert %2842, "index must be larger or equal to 0"
      %extracted = tensor.extract %209[%2839, %2840] : tensor<4x?xi64>
      linalg.yield %extracted : i64
    } -> tensor<4xi64>
    %2758 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2757 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c22_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2759 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2758 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.addi %in, %c21_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2760 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2759 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c2_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2761 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2760, %cst_5 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2762 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2761 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2763 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2762, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2764 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2763 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2765 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2764, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1365 = tensor.collapse_shape %2765 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %collapsed_1366 = tensor.collapse_shape %2756 [[0, 1], [2, 3]] : tensor<4x4x2x32xf16> into tensor<16x64xf16>
    %2766 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1366, %collapsed_1365 : tensor<16x64xf16>, tensor<16xi64>) outs(%2656 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %2767 = linalg.generic {indexing_maps = [#map7, #map31, #map7], iterator_types = ["parallel"]} ins(%2760, %cst_8 : tensor<4xi64>, tensor<i64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2768 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2767 : tensor<4xi64>) outs(%259 : tensor<4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c4_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4xi64>
    %2769 = linalg.generic {indexing_maps = [#map15, #map14, #map2], iterator_types = ["parallel", "parallel"]} ins(%2768, %303 : tensor<4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2770 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2769 : tensor<4x4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %out: i64):
      %2839 = arith.muli %in, %c32_i64 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %2771 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2770, %302 : tensor<4x4xi64>, tensor<4xi64>) outs(%308 : tensor<4x4xi64>) {
    ^bb0(%in: i64, %in_1410: i64, %out: i64):
      %2839 = arith.addi %in, %in_1410 : i64
      linalg.yield %2839 : i64
    } -> tensor<4x4xi64>
    %collapsed_1367 = tensor.collapse_shape %2771 [[0, 1]] : tensor<4x4xi64> into tensor<16xi64>
    %expanded_1368 = tensor.expand_shape %2728 [[0], [1, 2]] output_shape [4, 4, 64] : tensor<4x256xf16> into tensor<4x4x64xf16>
    %collapsed_1369 = tensor.collapse_shape %expanded_1368 [[0, 1], [2]] : tensor<4x4x64xf16> into tensor<16x64xf16>
    %2772 = iree_linalg_ext.scatter dimension_map = [0] unique_indices(true) ins(%collapsed_1369, %collapsed_1367 : tensor<16x64xf16>, tensor<16xi64>) outs(%2766 : tensor<?x64xf16>) {
    ^bb0(%arg7: f16, %arg8: f16):
      iree_linalg_ext.yield %arg7 : f16
    } -> tensor<?x64xf16>
    %expanded_1370 = tensor.expand_shape %2772 [[0, 1, 2, 3, 4], [5]] output_shape [%210, 22, 2, 4, 32, 64] : tensor<?x64xf16> into tensor<?x22x2x4x32x64xf16>
    %collapsed_1371 = tensor.collapse_shape %expanded_1370 [[0], [1, 2, 3, 4, 5]] : tensor<?x22x2x4x32x64xf16> into tensor<?x360448xf16>
    %extracted_slice_1372 = tensor.extract_slice %expanded_1370[0, 21, 0, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2773 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1372, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %extracted_slice_1373 = tensor.extract_slice %expanded_1370[0, 21, 1, 0, 0, 0] [%210, 1, 1, 4, 32, 64] [1, 1, 1, 1, 1, 1] : tensor<?x22x2x4x32x64xf16> to tensor<?x4x32x64xf16>
    %2774 = iree_linalg_ext.gather dimension_map = [0] ins(%extracted_slice_1373, %209 : tensor<?x4x32x64xf16>, tensor<4x?xi64>) outs(%319 : tensor<4x?x4x32x64xf16>) -> tensor<4x?x4x32x64xf16>
    %2775 = linalg.generic {indexing_maps = [#map33, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2773 : tensor<4x?x4x32x64xf16>) outs(%329 : tensor<4x4x8x?x32x64xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x?x32x64xf16>
    %collapsed_1374 = tensor.collapse_shape %2775 [[0, 1, 2], [3, 4], [5]] : tensor<4x4x8x?x32x64xf16> into tensor<128x?x64xf16>
    %collapsed_1375 = tensor.collapse_shape %2742 [[0, 1], [2, 3]] : tensor<4x32x2x32xf16> into tensor<128x64xf16>
    %2776 = linalg.generic {indexing_maps = [#map35, #map34], iterator_types = ["parallel", "parallel", "parallel", "parallel", "parallel", "parallel"]} ins(%2774 : tensor<4x?x4x32x64xf16>) outs(%334 : tensor<4x4x8x64x?x32xf16>) {
    ^bb0(%in: f16, %out: f16):
      linalg.yield %in : f16
    } -> tensor<4x4x8x64x?x32xf16>
    %collapsed_1376 = tensor.collapse_shape %2776 [[0, 1, 2], [3], [4, 5]] : tensor<4x4x8x64x?x32xf16> into tensor<128x64x?xf16>
    %2777 = iree_linalg_ext.attention {indexing_maps = [#map36, #map37, #map32, #map38, #map39, #map30]} ins(%collapsed_1375, %collapsed_1374, %collapsed_1376, %cst_7, %collapsed_51 : tensor<128x64xf16>, tensor<128x?x64xf16>, tensor<128x64x?xf16>, f16, tensor<128x?xf16>) outs(%333 : tensor<128x64xf16>) {
    ^bb0(%arg7: f32):
      iree_linalg_ext.yield %arg7 : f32
    } -> tensor<128x64xf16>
    %expanded_1377 = tensor.expand_shape %2777 [[0, 1, 2], [3]] output_shape [4, 1, 32, 64] : tensor<128x64xf16> into tensor<4x1x32x64xf16>
    %collapsed_1378 = tensor.collapse_shape %expanded_1377 [[0], [1], [2, 3]] : tensor<4x1x32x64xf16> into tensor<4x1x2048xf16>
    %2778 = iree_tensor_ext.bitcast %194 : tensor<2048x2176xi8> -> tensor<2048x1088xi16>
    %expanded_1379 = tensor.expand_shape %2778 [[0], [1, 2]] output_shape [2048, 64, 17] : tensor<2048x1088xi16> into tensor<2048x64x17xi16>
    %extracted_slice_1380 = tensor.extract_slice %expanded_1379[0, 0, 0] [2048, 64, 1] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64xi16>
    %expanded_1381 = tensor.expand_shape %extracted_slice_1380 [[0], [1, 2]] output_shape [2048, 64, 1] : tensor<2048x64xi16> into tensor<2048x64x1xi16>
    %2779 = iree_tensor_ext.bitcast %expanded_1381 : tensor<2048x64x1xi16> -> tensor<2048x64x1xf16>
    %extracted_slice_1382 = tensor.extract_slice %expanded_1379[0, 0, 1] [2048, 64, 16] [1, 1, 1] : tensor<2048x64x17xi16> to tensor<2048x64x16xi16>
    %2780 = iree_tensor_ext.bitcast %extracted_slice_1382 : tensor<2048x64x16xi16> -> tensor<2048x64x32xi8>
    %collapsed_1383 = tensor.collapse_shape %2779 [[0], [1, 2]] : tensor<2048x64x1xf16> into tensor<2048x64xf16>
    %2781 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1383, %2780 : tensor<2048x64xf16>, tensor<2048x64x32xi8>) outs(%236 : tensor<2048x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x64x32xf16>
    %expanded_1384 = tensor.expand_shape %collapsed_1378 [[0], [1], [2, 3]] output_shape [4, 1, 64, 32] : tensor<4x1x2048xf16> into tensor<4x1x64x32xf16>
    %collapsed_1385 = tensor.collapse_shape %expanded_1384 [[0, 1], [2], [3]] : tensor<4x1x64x32xf16> into tensor<4x64x32xf16>
    %2782 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%collapsed_1385, %2781 : tensor<4x64x32xf16>, tensor<2048x64x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2783 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2782 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2784 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2700, %2783 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2785 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2784 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2786 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2785 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2787 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2786 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2788 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2787 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2789 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2788 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2790 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2789 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2791 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2785, %2790 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2792 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2791 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2793 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%195, %2792 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2794 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2793 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2795 = iree_tensor_ext.bitcast %196 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1386 = tensor.expand_shape %2795 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1387 = tensor.extract_slice %expanded_1386[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1388 = tensor.expand_shape %extracted_slice_1387 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2796 = iree_tensor_ext.bitcast %expanded_1388 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1389 = tensor.extract_slice %expanded_1386[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2797 = iree_tensor_ext.bitcast %extracted_slice_1389 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1390 = tensor.collapse_shape %2796 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2798 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1390, %2797 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %expanded_1391 = tensor.expand_shape %2794 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2799 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1391, %2798 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2800 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2799 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2801 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2800 : tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %out: f16):
      %2839 = arith.negf %in : f16
      %2840 = math.exp %2839 : f16
      %2841 = arith.addf %2840, %cst_2 : f16
      %2842 = arith.divf %cst_2, %2841 : f16
      linalg.yield %2842 : f16
    } -> tensor<4x5632xf16>
    %2802 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2801, %2800 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2803 = iree_tensor_ext.bitcast %197 : tensor<5632x2176xi8> -> tensor<5632x1088xi16>
    %expanded_1392 = tensor.expand_shape %2803 [[0], [1, 2]] output_shape [5632, 64, 17] : tensor<5632x1088xi16> into tensor<5632x64x17xi16>
    %extracted_slice_1393 = tensor.extract_slice %expanded_1392[0, 0, 0] [5632, 64, 1] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64xi16>
    %expanded_1394 = tensor.expand_shape %extracted_slice_1393 [[0], [1, 2]] output_shape [5632, 64, 1] : tensor<5632x64xi16> into tensor<5632x64x1xi16>
    %2804 = iree_tensor_ext.bitcast %expanded_1394 : tensor<5632x64x1xi16> -> tensor<5632x64x1xf16>
    %extracted_slice_1395 = tensor.extract_slice %expanded_1392[0, 0, 1] [5632, 64, 16] [1, 1, 1] : tensor<5632x64x17xi16> to tensor<5632x64x16xi16>
    %2805 = iree_tensor_ext.bitcast %extracted_slice_1395 : tensor<5632x64x16xi16> -> tensor<5632x64x32xi8>
    %collapsed_1396 = tensor.collapse_shape %2804 [[0], [1, 2]] : tensor<5632x64x1xf16> into tensor<5632x64xf16>
    %2806 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1396, %2805 : tensor<5632x64xf16>, tensor<5632x64x32xi8>) outs(%357 : tensor<5632x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<5632x64x32xf16>
    %2807 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1391, %2806 : tensor<4x64x32xf16>, tensor<5632x64x32xf16>) outs(%360 : tensor<4x5632xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x5632xf32>
    %2808 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2807 : tensor<4x5632xf32>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2809 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2802, %2808 : tensor<4x5632xf16>, tensor<4x5632xf16>) outs(%362 : tensor<4x5632xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.mulf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x5632xf16>
    %2810 = iree_tensor_ext.bitcast %198 : tensor<2048x5984xi8> -> tensor<2048x2992xi16>
    %expanded_1397 = tensor.expand_shape %2810 [[0], [1, 2]] output_shape [2048, 176, 17] : tensor<2048x2992xi16> into tensor<2048x176x17xi16>
    %extracted_slice_1398 = tensor.extract_slice %expanded_1397[0, 0, 0] [2048, 176, 1] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176xi16>
    %expanded_1399 = tensor.expand_shape %extracted_slice_1398 [[0], [1, 2]] output_shape [2048, 176, 1] : tensor<2048x176xi16> into tensor<2048x176x1xi16>
    %2811 = iree_tensor_ext.bitcast %expanded_1399 : tensor<2048x176x1xi16> -> tensor<2048x176x1xf16>
    %extracted_slice_1400 = tensor.extract_slice %expanded_1397[0, 0, 1] [2048, 176, 16] [1, 1, 1] : tensor<2048x176x17xi16> to tensor<2048x176x16xi16>
    %2812 = iree_tensor_ext.bitcast %extracted_slice_1400 : tensor<2048x176x16xi16> -> tensor<2048x176x32xi8>
    %collapsed_1401 = tensor.collapse_shape %2811 [[0], [1, 2]] : tensor<2048x176x1xf16> into tensor<2048x176xf16>
    %2813 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1401, %2812 : tensor<2048x176xf16>, tensor<2048x176x32xi8>) outs(%376 : tensor<2048x176x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<2048x176x32xf16>
    %expanded_1402 = tensor.expand_shape %2809 [[0], [1, 2]] output_shape [4, 176, 32] : tensor<4x5632xf16> into tensor<4x176x32xf16>
    %2814 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1402, %2813 : tensor<4x176x32xf16>, tensor<2048x176x32xf16>) outs(%238 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x2048xf32>
    %2815 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2814 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2816 = linalg.generic {indexing_maps = [#map2, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2784, %2815 : tensor<4x2048xf16>, tensor<4x2048xf16>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f16):
      %2839 = arith.addf %in, %in_1410 : f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2817 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2816 : tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f16, %out: f32):
      %2839 = arith.extf %in : f16 to f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2818 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2817 : tensor<4x2048xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.fpowi %in, %c2_i64 : f32, i64
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2819 = linalg.generic {indexing_maps = [#map2, #map15], iterator_types = ["parallel", "reduction"]} ins(%2818 : tensor<4x2048xf32>) outs(%224 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %out : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2820 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2819 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.divf %in, %cst_1 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2821 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2820 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = arith.addf %in, %cst_0 : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2822 = linalg.generic {indexing_maps = [#map7, #map7], iterator_types = ["parallel"]} ins(%2821 : tensor<4xf32>) outs(%223 : tensor<4xf32>) {
    ^bb0(%in: f32, %out: f32):
      %2839 = math.rsqrt %in : f32
      linalg.yield %2839 : f32
    } -> tensor<4xf32>
    %2823 = linalg.generic {indexing_maps = [#map2, #map15, #map2], iterator_types = ["parallel", "parallel"]} ins(%2817, %2822 : tensor<4x2048xf32>, tensor<4xf32>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f32, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f32
      linalg.yield %2839 : f32
    } -> tensor<4x2048xf32>
    %2824 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2823 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2825 = linalg.generic {indexing_maps = [#map14, #map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%199, %2824 : tensor<2048xf32>, tensor<4x2048xf16>) outs(%220 : tensor<4x2048xf32>) {
    ^bb0(%in: f32, %in_1410: f16, %out: f32):
      %2839 = arith.extf %in_1410 : f16 to f32
      %2840 = arith.mulf %in, %2839 : f32
      linalg.yield %2840 : f32
    } -> tensor<4x2048xf32>
    %2826 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2825 : tensor<4x2048xf32>) outs(%218 : tensor<4x2048xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x2048xf16>
    %2827 = iree_tensor_ext.bitcast %200 : tensor<32000x2176xi8> -> tensor<32000x1088xi16>
    %expanded_1403 = tensor.expand_shape %2827 [[0], [1, 2]] output_shape [32000, 64, 17] : tensor<32000x1088xi16> into tensor<32000x64x17xi16>
    %extracted_slice_1404 = tensor.extract_slice %expanded_1403[0, 0, 0] [32000, 64, 1] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64xi16>
    %expanded_1405 = tensor.expand_shape %extracted_slice_1404 [[0], [1, 2]] output_shape [32000, 64, 1] : tensor<32000x64xi16> into tensor<32000x64x1xi16>
    %2828 = iree_tensor_ext.bitcast %expanded_1405 : tensor<32000x64x1xi16> -> tensor<32000x64x1xf16>
    %extracted_slice_1406 = tensor.extract_slice %expanded_1403[0, 0, 1] [32000, 64, 16] [1, 1, 1] : tensor<32000x64x17xi16> to tensor<32000x64x16xi16>
    %2829 = iree_tensor_ext.bitcast %extracted_slice_1406 : tensor<32000x64x16xi16> -> tensor<32000x64x32xi8>
    %collapsed_1407 = tensor.collapse_shape %2828 [[0], [1, 2]] : tensor<32000x64x1xf16> into tensor<32000x64xf16>
    %2830 = linalg.generic {indexing_maps = [#map1, #map, #map], iterator_types = ["parallel", "parallel", "parallel"]} ins(%collapsed_1407, %2829 : tensor<32000x64xf16>, tensor<32000x64x32xi8>) outs(%215 : tensor<32000x64x32xf16>) {
    ^bb0(%in: f16, %in_1410: i8, %out: f16):
      %2839 = arith.extsi %in_1410 : i8 to i32
      %2840 = arith.sitofp %2839 : i32 to f16
      %2841 = arith.mulf %2840, %in : f16
      linalg.yield %2841 : f16
    } -> tensor<32000x64x32xf16>
    %expanded_1408 = tensor.expand_shape %2826 [[0], [1, 2]] output_shape [4, 64, 32] : tensor<4x2048xf16> into tensor<4x64x32xf16>
    %2831 = tensor.empty() : tensor<4x32000xf32>
    %2832 = linalg.fill ins(%cst_3 : f32) outs(%2831 : tensor<4x32000xf32>) -> tensor<4x32000xf32>
    %2833 = linalg.generic {indexing_maps = [#map21, #map29, #map30], iterator_types = ["parallel", "parallel", "reduction", "reduction"]} ins(%expanded_1408, %2830 : tensor<4x64x32xf16>, tensor<32000x64x32xf16>) outs(%2832 : tensor<4x32000xf32>) {
    ^bb0(%in: f16, %in_1410: f16, %out: f32):
      %2839 = arith.mulf %in, %in_1410 : f16
      %2840 = arith.extf %2839 : f16 to f32
      %2841 = arith.addf %2840, %out : f32
      linalg.yield %2841 : f32
    } -> tensor<4x32000xf32>
    %2834 = tensor.empty() : tensor<4x32000xf16>
    %2835 = linalg.generic {indexing_maps = [#map2, #map2], iterator_types = ["parallel", "parallel"]} ins(%2833 : tensor<4x32000xf32>) outs(%2834 : tensor<4x32000xf16>) {
    ^bb0(%in: f32, %out: f16):
      %2839 = arith.truncf %in : f32 to f16
      linalg.yield %2839 : f16
    } -> tensor<4x32000xf16>
    %expanded_1409 = tensor.expand_shape %2835 [[0, 1], [2]] output_shape [4, 1, 32000] : tensor<4x32000xf16> into tensor<4x1x32000xf16>
    %2836 = hal.tensor.alias on(#hal.device.affinity<@__device_0>) wait(%arg5) => %collapsed_1371 : tensor<?x360448xf16>{%210} to %arg4 : !hal.buffer_view
    %2837:2 = hal.tensor.barrier join(%2836, %expanded_1409 : tensor<?x360448xf16>, tensor<4x1x32000xf16>) => %arg6 : !hal.fence
    %2838 = hal.tensor.export %2837#1 : tensor<4x1x32000xf16> -> !hal.buffer_view
    util.return %2838 : !hal.buffer_view
  }
  util.func public @decode_bs4(%arg0: !hal.buffer_view, %arg1: !hal.buffer_view, %arg2: !hal.buffer_view, %arg3: !hal.buffer_view, %arg4: !hal.buffer_view) -> !hal.buffer_view attributes {iree.abi.stub} {
    %0 = util.null : !hal.fence
    %c-1_i32 = arith.constant -1 : i32
    %c0 = arith.constant 0 : index
    %device_0 = hal.devices.get %c0 : !hal.device
    %fence = hal.fence.create device(%device_0 : !hal.device) flags("None") : !hal.fence
    %1 = util.call @decode_bs4$async(%arg0, %arg1, %arg2, %arg3, %arg4, %0, %fence) : (!hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.buffer_view, !hal.fence, !hal.fence) -> !hal.buffer_view
    %status = hal.fence.await until([%fence]) timeout_millis(%c-1_i32) flags("None") : i32
    util.return %1 : !hal.buffer_view
  }
}
